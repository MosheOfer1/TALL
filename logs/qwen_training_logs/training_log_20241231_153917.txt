2024-12-31 15:39:17,866 - TrainingLogger - INFO - Using device: cuda
2024-12-31 15:39:17,866 - TrainingLogger - INFO - Model Architecture:
2024-12-31 15:39:17,866 - TrainingLogger - INFO - 
Detailed Model Architecture:
2024-12-31 15:39:17,871 - TrainingLogger - INFO - CustomLLM(
  (he_en_model_encoder): MarianEncoder(
    (embed_tokens): Embedding(60269, 1024, padding_idx=60268)
    (embed_positions): MarianSinusoidalPositionalEmbedding(1024, 1024)
    (layers): ModuleList(
      (0-5): 6 x MarianEncoderLayer(
        (self_attn): MarianAttention(
          (k_proj): Linear(in_features=1024, out_features=1024, bias=True)
          (v_proj): Linear(in_features=1024, out_features=1024, bias=True)
          (q_proj): Linear(in_features=1024, out_features=1024, bias=True)
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (activation_fn): ReLU()
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (embed_tokens): Embedding(151936, 896)
  (align_he_en): Sequential(
    (0): Linear(in_features=1024, out_features=1792, bias=True)
    (1): LayerNorm((1792,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1792, out_features=896, bias=True)
    (5): LayerNorm((896,), eps=1e-05, elementwise_affine=True)
  )
  (custom_decoder1): MarianDecoder(
    (embed_tokens): None
    (embed_positions): MarianSinusoidalPositionalEmbedding(1024, 896)
    (layers): ModuleList(
      (0-5): 6 x MarianDecoderLayer(
        (self_attn): MarianAttention(
          (k_proj): Linear(in_features=896, out_features=896, bias=True)
          (v_proj): Linear(in_features=896, out_features=896, bias=True)
          (q_proj): Linear(in_features=896, out_features=896, bias=True)
          (out_proj): Linear(in_features=896, out_features=896, bias=True)
        )
        (activation_fn): GELUActivation()
        (self_attn_layer_norm): LayerNorm((896,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MarianAttention(
          (k_proj): Linear(in_features=896, out_features=896, bias=True)
          (v_proj): Linear(in_features=896, out_features=896, bias=True)
          (q_proj): Linear(in_features=896, out_features=896, bias=True)
          (out_proj): Linear(in_features=896, out_features=896, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((896,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=896, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=896, bias=True)
        (final_layer_norm): LayerNorm((896,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (main_model): Qwen2Model(
    (embed_tokens): None
    (layers): ModuleList(
      (0-23): 24 x Qwen2DecoderLayer(
        (self_attn): Qwen2SdpaAttention(
          (q_proj): Linear(in_features=896, out_features=896, bias=True)
          (k_proj): Linear(in_features=896, out_features=128, bias=True)
          (v_proj): Linear(in_features=896, out_features=128, bias=True)
          (o_proj): Linear(in_features=896, out_features=896, bias=False)
          (rotary_emb): Qwen2RotaryEmbedding()
        )
        (mlp): Qwen2MLP(
          (gate_proj): Linear(in_features=896, out_features=4864, bias=False)
          (up_proj): Linear(in_features=896, out_features=4864, bias=False)
          (down_proj): Linear(in_features=4864, out_features=896, bias=False)
          (act_fn): SiLU()
        )
        (input_layernorm): Qwen2RMSNorm((896,), eps=1e-06)
        (post_attention_layernorm): Qwen2RMSNorm((896,), eps=1e-06)
      )
    )
    (norm): Qwen2RMSNorm((896,), eps=1e-06)
    (rotary_emb): Qwen2RotaryEmbedding()
  )
  (align_en_he): Sequential(
    (0): Linear(in_features=896, out_features=1024, bias=True)
    (1): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (2): GELU(approximate='none')
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1024, out_features=512, bias=True)
    (5): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (custom_encoder2): MarianEncoder(
    (embed_tokens): None
    (embed_positions): MarianSinusoidalPositionalEmbedding(512, 512)
    (layers): ModuleList(
      (0-5): 6 x MarianEncoderLayer(
        (self_attn): MarianAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (activation_fn): SiLU()
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (en_he_decoder): MarianDecoder(
    (embed_tokens): Embedding(65839, 512, padding_idx=65838)
    (embed_positions): MarianSinusoidalPositionalEmbedding(512, 512)
    (layers): ModuleList(
      (0-5): 6 x MarianDecoderLayer(
        (self_attn): MarianAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (activation_fn): SiLU()
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MarianAttention(
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (lm_head): Linear(in_features=512, out_features=65839, bias=False)
)
2024-12-31 15:39:17,872 - TrainingLogger - INFO - 
Total parameters: 799,239,680
2024-12-31 15:39:17,872 - TrainingLogger - INFO - Trainable parameters: 107,669,632
2024-12-31 15:39:17,872 - TrainingLogger - INFO - Percentage of trainable parameters: 13.47%
2024-12-31 15:39:17,872 - TrainingLogger - INFO - 
Detailed Layer-wise Information:
2024-12-31 15:39:17,872 - TrainingLogger - INFO - 
he_en_model_encoder:
2024-12-31 15:39:17,872 - TrainingLogger - INFO -   Total params: 138,341,376
2024-12-31 15:39:17,872 - TrainingLogger - INFO -   Trainable params: 0
2024-12-31 15:39:17,872 - TrainingLogger - INFO - 
embed_tokens:
2024-12-31 15:39:17,872 - TrainingLogger - INFO -   Total params: 136,134,656
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Trainable params: 0
2024-12-31 15:39:17,873 - TrainingLogger - INFO - 
align_he_en:
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Total params: 3,448,704
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Trainable params: 3,448,704
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     In features: 1024
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     Out features: 1792
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     In features: 1792
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     Out features: 896
2024-12-31 15:39:17,873 - TrainingLogger - INFO - 
custom_decoder1:
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Total params: 83,598,080
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Trainable params: 83,598,080
2024-12-31 15:39:17,873 - TrainingLogger - INFO - 
main_model:
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Total params: 357,898,112
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Trainable params: 0
2024-12-31 15:39:17,873 - TrainingLogger - INFO - 
align_en_he:
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Total params: 1,446,400
2024-12-31 15:39:17,873 - TrainingLogger - INFO -   Trainable params: 1,446,400
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     In features: 896
2024-12-31 15:39:17,873 - TrainingLogger - INFO -     Out features: 1024
2024-12-31 15:39:17,874 - TrainingLogger - INFO -     In features: 1024
2024-12-31 15:39:17,874 - TrainingLogger - INFO -     Out features: 512
2024-12-31 15:39:17,874 - TrainingLogger - INFO - 
custom_encoder2:
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Total params: 19,176,448
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Trainable params: 19,176,448
2024-12-31 15:39:17,874 - TrainingLogger - INFO - 
en_he_decoder:
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Total params: 59,195,904
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Trainable params: 0
2024-12-31 15:39:17,874 - TrainingLogger - INFO - 
lm_head:
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Total params: 33,709,568
2024-12-31 15:39:17,874 - TrainingLogger - INFO -   Trainable params: 0
2024-12-31 15:39:17,875 - TrainingLogger - INFO - Detailed model summary has been saved to 'detailed_model_summary.txt'
2024-12-31 15:39:17,876 - TrainingLogger - INFO - Starting training from epoch 0
2024-12-31 15:39:25,484 - TrainingLogger - INFO - Step 10, Batch metrics: Loss: 10.1093, Accuracy: 0.0000, Perplexity: 24570.7751
2024-12-31 15:39:32,915 - TrainingLogger - INFO - Step 20, Batch metrics: Loss: 9.6881, Accuracy: 0.0051, Perplexity: 16124.6070
2024-12-31 15:39:40,139 - TrainingLogger - INFO - Step 30, Batch metrics: Loss: 9.1391, Accuracy: 0.0000, Perplexity: 9312.5941
2024-12-31 15:39:46,751 - TrainingLogger - INFO - Step 40, Batch metrics: Loss: 9.4578, Accuracy: 0.0061, Perplexity: 12808.0296
2024-12-31 15:39:53,711 - TrainingLogger - INFO - Step 50, Batch metrics: Loss: 9.2853, Accuracy: 0.0138, Perplexity: 10778.4605
2024-12-31 15:39:59,811 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 37, 32), but is torch.Size([8, 1, 37, 28])
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 37, 32), but is torch.Size([8, 1, 37, 28])

2024-12-31 15:39:59,846 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 37]), device: cuda:0
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 37]), device: cuda:0
2024-12-31 15:39:59,846 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 15:39:59,847 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 33]), device: cuda:0
2024-12-31 15:39:59,847 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 15:39:59,847 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 33]), device: cuda:0
2024-12-31 15:39:59,847 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 15:39:59,847 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 15:40:02,055 - TrainingLogger - INFO - Step 60, Batch metrics: Loss: 9.0321, Accuracy: 0.0215, Perplexity: 8367.6737
2024-12-31 15:40:09,777 - TrainingLogger - INFO - Step 70, Batch metrics: Loss: 8.7500, Accuracy: 0.0085, Perplexity: 6310.9770
2024-12-31 15:40:17,265 - TrainingLogger - INFO - Step 80, Batch metrics: Loss: 8.9117, Accuracy: 0.0272, Perplexity: 7418.1713
2024-12-31 15:40:24,326 - TrainingLogger - INFO - Step 90, Batch metrics: Loss: 8.9530, Accuracy: 0.0380, Perplexity: 7730.9771
2024-12-31 15:40:31,962 - TrainingLogger - INFO - Step 100, Batch metrics: Loss: 8.9821, Accuracy: 0.0225, Perplexity: 7959.1812
2024-12-31 15:40:31,962 - TrainingLogger - INFO - Step 100, Prediction vs Actual:
2024-12-31 15:40:31,963 - TrainingLogger - INFO - Input 1: אם להתייחס למקצועו, בחיל האוויר ובאל על, אפשר לומר שהוא פועל בימים אלה על טייס אוטומטי
2024-12-31 15:40:31,963 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:40:31,963 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁אם          | ✗     |
|     1 | ,               | ▁להתייחס     | ✗     |
|     2 | ת               | ▁למקצוע      | ✗     |
|     3 | ה               | ו            | ✗     |
|     4 | "               | ,            | ✗     |
|     5 | ה               | ▁בחיל        | ✗     |
|     6 | ים              | ▁האוויר      | ✗     |
|     7 | ה               | ▁וב          | ✗     |
|     8 | ים              | אל           | ✗     |
|     9 | ים              | ▁על          | ✗     |
|    10 | ים              | ,            | ✗     |
|    11 | ה               | ▁אפשר        | ✗     |
|    12 | ים              | ▁לומר        | ✗     |
|    13 | ים              | ▁שהוא        | ✗     |
|    14 | ים              | ▁פועל        | ✗     |
|    15 | </s>            | ▁בימים       | ✗     |
|    16 | ▁לו             | ▁אלה         | ✗     |
|    17 | ▁אלה            | ▁על          | ✗     |
|    18 | ים              | ▁טייס        | ✗     |
|    19 | ים              | ▁אוטומטי     | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ה               | <pad>        | ✗     |
|    34 | ים              | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ים              |              | ✗     |

2024-12-31 15:40:31,963 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:40:31,981 - TrainingLogger - INFO - Gradient norm: 14.1461
2024-12-31 15:40:39,649 - TrainingLogger - INFO - Step 110, Batch metrics: Loss: 8.9350, Accuracy: 0.0357, Perplexity: 7592.9947
2024-12-31 15:40:46,967 - TrainingLogger - INFO - Step 120, Batch metrics: Loss: 8.9368, Accuracy: 0.0377, Perplexity: 7606.8671
2024-12-31 15:40:54,413 - TrainingLogger - INFO - Step 130, Batch metrics: Loss: 8.6878, Accuracy: 0.0227, Perplexity: 5930.1127
2024-12-31 15:41:01,521 - TrainingLogger - INFO - Step 140, Batch metrics: Loss: 8.3797, Accuracy: 0.0469, Perplexity: 4357.8414
2024-12-31 15:41:08,977 - TrainingLogger - INFO - Step 150, Batch metrics: Loss: 8.5480, Accuracy: 0.0510, Perplexity: 5156.5903
2024-12-31 15:41:16,815 - TrainingLogger - INFO - Step 160, Batch metrics: Loss: 8.7947, Accuracy: 0.0317, Perplexity: 6599.2929
2024-12-31 15:41:24,270 - TrainingLogger - INFO - Step 170, Batch metrics: Loss: 8.6815, Accuracy: 0.0245, Perplexity: 5892.7301
2024-12-31 15:41:31,552 - TrainingLogger - INFO - Step 180, Batch metrics: Loss: 9.0312, Accuracy: 0.0123, Perplexity: 8360.2875
2024-12-31 15:41:38,936 - TrainingLogger - INFO - Step 190, Batch metrics: Loss: 8.7817, Accuracy: 0.0244, Perplexity: 6514.0293
2024-12-31 15:41:45,970 - TrainingLogger - INFO - Step 200, Batch metrics: Loss: 8.0101, Accuracy: 0.0523, Perplexity: 3011.2825
2024-12-31 15:41:45,970 - TrainingLogger - INFO - Step 200, Prediction vs Actual:
2024-12-31 15:41:45,970 - TrainingLogger - INFO - Input 1: בית המשפט העליון של הודו הותיר היום ו על כנו את עונש המוות שנגזר על ארבעה גברים שבשנת 2012אנסו סטודנטית לרפואה בת 23 באוטובוס
2024-12-31 15:41:45,971 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:41:45,971 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁בית         | ✗     |
|     1 | ▁לא             | ▁המשפט       | ✗     |
|     2 | ית              | ▁העליון      | ✗     |
|     3 | ▁את             | ▁של          | ✗     |
|     4 | ▁המדינה         | ▁הודו        | ✗     |
|     5 | </s>            | ▁הותיר       | ✗     |
|     6 | ה               | ▁היום        | ✗     |
|     7 | ▁הוא            | ▁ו           | ✗     |
|     8 | '               | ▁על          | ✗     |
|     9 | ▁המדינה         | ▁כ           | ✗     |
|    10 | "               | נו           | ✗     |
|    11 | .               | ▁את          | ✗     |
|    12 | ▁המדינה         | ▁עונש        | ✗     |
|    13 | ו               | ▁המוות       | ✗     |
|    14 | ▁הזה            | ▁שנ          | ✗     |
|    15 | ▁לו             | גזר          | ✗     |
|    16 | ה               | ▁על          | ✗     |
|    17 | ▁המדינה         | ▁ארבעה       | ✗     |
|    18 | ▁ימים           | ▁גברים       | ✗     |
|    19 | ,               | ▁ש           | ✗     |
|    20 | ונים            | בשנת         | ✗     |
|    21 | ון              | ▁2012        | ✗     |
|    22 | ▁לא             | אנס          | ✗     |
|    23 | ים              | ו            | ✗     |
|    24 | ה               | ▁סטודנטית    | ✗     |
|    25 | ים              | ▁לרפואה      | ✗     |
|    26 | ,               | ▁בת          | ✗     |
|    27 | ל               | ▁23          | ✗     |
|    28 | ון              | ▁באוטובוס    | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ון              |              | ✗     |

2024-12-31 15:41:45,971 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:41:45,976 - TrainingLogger - INFO - Gradient norm: 20.4836
2024-12-31 15:41:53,025 - TrainingLogger - INFO - Step 210, Batch metrics: Loss: 8.8161, Accuracy: 0.0092, Perplexity: 6742.0235
2024-12-31 15:42:00,327 - TrainingLogger - INFO - Step 220, Batch metrics: Loss: 8.2046, Accuracy: 0.0473, Perplexity: 3657.8466
2024-12-31 15:42:07,571 - TrainingLogger - INFO - Step 230, Batch metrics: Loss: 8.4862, Accuracy: 0.0289, Perplexity: 4847.3154
2024-12-31 15:42:14,862 - TrainingLogger - INFO - Step 240, Batch metrics: Loss: 8.0484, Accuracy: 0.0417, Perplexity: 3128.7489
2024-12-31 15:42:22,573 - TrainingLogger - INFO - Step 250, Batch metrics: Loss: 8.0602, Accuracy: 0.0340, Perplexity: 3165.8047
2024-12-31 15:42:29,728 - TrainingLogger - INFO - Step 260, Batch metrics: Loss: 7.8772, Accuracy: 0.0636, Perplexity: 2636.5319
2024-12-31 15:42:36,928 - TrainingLogger - INFO - Step 270, Batch metrics: Loss: 8.2825, Accuracy: 0.0299, Perplexity: 3954.2606
2024-12-31 15:42:43,906 - TrainingLogger - INFO - Step 280, Batch metrics: Loss: 8.4643, Accuracy: 0.0423, Perplexity: 4742.4751
2024-12-31 15:42:51,096 - TrainingLogger - INFO - Step 290, Batch metrics: Loss: 8.0845, Accuracy: 0.0500, Perplexity: 3243.8821
2024-12-31 15:42:58,231 - TrainingLogger - INFO - Step 300, Batch metrics: Loss: 8.1260, Accuracy: 0.0606, Perplexity: 3381.0909
2024-12-31 15:42:58,231 - TrainingLogger - INFO - Step 300, Prediction vs Actual:
2024-12-31 15:42:58,231 - TrainingLogger - INFO - Input 1: אני בעד לבטל את ההיטל הזה וגם לבטל את נקודות הזיכוי בנוגע לעובדים זרים
2024-12-31 15:42:58,232 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:42:58,232 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלהם           | ▁אני         | ✗     |
|     1 | ▁תהיה           | ▁בעד         | ✗     |
|     2 | ות              | ▁לבטל        | ✗     |
|     3 | .               | ▁את          | ✗     |
|     4 | ▁המשימה         | ▁ההי         | ✗     |
|     5 | ר               | טל           | ✗     |
|     6 | ה               | ▁הזה         | ✗     |
|     7 | .               | ▁וגם         | ✗     |
|     8 | ▁עכשיו          | ▁לבטל        | ✗     |
|     9 | .               | ▁את          | ✗     |
|    10 | ▁ה              | ▁נקודות      | ✗     |
|    11 | -               | ▁הז          | ✗     |
|    12 | ג               | יכו          | ✗     |
|    13 | ות              | י            | ✗     |
|    14 | ▁שלו            | ▁בנוגע       | ✗     |
|    15 | ▁ל              | ▁ל           | ✓     |
|    16 | בחירות          | עובדים       | ✗     |
|    17 | ▁שלהם           | ▁זרים        | ✗     |
|    18 | ▁יותר           | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | ▁שלו            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁האחרונים       | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ▁האחרונים       | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | נים             | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | נים             | <pad>        | ✗     |
|    39 | רים             | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | ▁להם            | <pad>        | ✗     |
|    42 | ▁שלהם           | <pad>        | ✗     |
|    43 | ת               | <pad>        | ✗     |
|    44 | ,               |              | ✗     |

2024-12-31 15:42:58,232 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:42:58,238 - TrainingLogger - INFO - Gradient norm: 20.9981
2024-12-31 15:43:05,407 - TrainingLogger - INFO - Step 310, Batch metrics: Loss: 7.8716, Accuracy: 0.0667, Perplexity: 2621.6724
2024-12-31 15:43:12,820 - TrainingLogger - INFO - Step 320, Batch metrics: Loss: 8.2365, Accuracy: 0.0632, Perplexity: 3776.4794
2024-12-31 15:43:19,900 - TrainingLogger - INFO - Step 330, Batch metrics: Loss: 8.2390, Accuracy: 0.0149, Perplexity: 3785.7033
2024-12-31 15:43:27,336 - TrainingLogger - INFO - Step 340, Batch metrics: Loss: 7.9645, Accuracy: 0.0400, Perplexity: 2876.9284
2024-12-31 15:43:34,961 - TrainingLogger - INFO - Step 350, Batch metrics: Loss: 7.4914, Accuracy: 0.0657, Perplexity: 1792.4945
2024-12-31 15:43:42,108 - TrainingLogger - INFO - Step 360, Batch metrics: Loss: 8.0815, Accuracy: 0.0390, Perplexity: 3233.9298
2024-12-31 15:43:49,517 - TrainingLogger - INFO - Step 370, Batch metrics: Loss: 7.7733, Accuracy: 0.0592, Perplexity: 2376.3504
2024-12-31 15:43:56,790 - TrainingLogger - INFO - Step 380, Batch metrics: Loss: 7.2974, Accuracy: 0.0724, Perplexity: 1476.3907
2024-12-31 15:44:03,963 - TrainingLogger - INFO - Step 390, Batch metrics: Loss: 7.9174, Accuracy: 0.0462, Perplexity: 2744.5574
2024-12-31 15:44:11,315 - TrainingLogger - INFO - Step 400, Batch metrics: Loss: 8.4700, Accuracy: 0.0582, Perplexity: 4769.6350
2024-12-31 15:44:11,316 - TrainingLogger - INFO - Step 400, Prediction vs Actual:
2024-12-31 15:44:11,316 - TrainingLogger - INFO - Input 1: הפרויקטים הגדולים של סעודיה אמורים להבטיח שהמאזן הזה יישמר גם בעתידניום עיר טכנולוגיית העתידפרויקט הדגל שיוביל את סעודיה למאה ה-22 הואהקמת ניום NEOM, שמתיימרת להיות עיר העתיד, הראשונה מסוגה בעולם
2024-12-31 15:44:11,317 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:44:11,317 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הפרויקט     | ✗     |
|     1 | ▁-              | ים           | ✗     |
|     2 | ▁האלה           | ▁הגדולים     | ✗     |
|     3 | ▁האלה           | ▁של          | ✗     |
|     4 | ▁העיר           | ▁סע          | ✗     |
|     5 | ר               | ודי          | ✗     |
|     6 | ה               | ה            | ✓     |
|     7 | ▁יש             | ▁אמורים      | ✗     |
|     8 | ▁לעשות          | ▁להבטיח      | ✗     |
|     9 | ▁את             | ▁שה          | ✗     |
|    10 | נסי             | מאז          | ✗     |
|    11 | ונים            | ן            | ✗     |
|    12 | ▁לא             | ▁הזה         | ✗     |
|    13 | ,               | ▁יי          | ✗     |
|    14 | רש              | שמר          | ✗     |
|    15 | ו               | ▁גם          | ✗     |
|    16 | ▁הוא            | ▁בעתיד       | ✗     |
|    17 | .               | ניום         | ✗     |
|    18 | ▁שלהם           | ▁עיר         | ✗     |
|    19 | י               | ▁טכנולוגיי   | ✗     |
|    20 | ם               | ת            | ✗     |
|    21 | ▁ישראל          | ▁העתיד       | ✗     |
|    22 | י               | פרויקט       | ✗     |
|    23 | ים              | ▁הדגל        | ✗     |
|    24 | י               | ▁שיוביל      | ✗     |
|    25 | ו               | ▁את          | ✗     |
|    26 | ▁זה             | ▁סע          | ✗     |
|    27 | ים              | ודי          | ✗     |
|    28 | ה               | ה            | ✓     |
|    29 | .               | ▁למאה        | ✗     |
|    30 | ▁הזאת           | ▁ה           | ✗     |
|    31 | מוס             | -22          | ✗     |
|    32 | ה               | ▁הוא         | ✗     |
|    33 | ,               | ה            | ✗     |
|    34 | ,               | קמת          | ✗     |
|    35 | ▁בו             | ▁ניו         | ✗     |
|    36 | -               | ם            | ✗     |
|    37 | .               | ▁N           | ✗     |
|    38 | צים             | E            | ✗     |
|    39 | S               | OM           | ✗     |
|    40 | ▁ישראל          | ,            | ✗     |
|    41 | </s>            | ▁שמתי        | ✗     |
|    42 | י               | י            | ✓     |
|    43 | -               | מרת          | ✗     |
|    44 | ,               | ▁להיות       | ✗     |
|    45 | ▁חזקים          | ▁עיר         | ✗     |
|    46 | ▁חדשה           | ▁העתיד       | ✗     |
|    47 | ות              | ,            | ✗     |
|    48 | <pad>           | ▁הראשונה     | ✗     |
|    49 | ▁שלהם           | ▁מסוג        | ✗     |
|    50 | ו               | ה            | ✗     |
|    51 | ▁אחרת           | ▁בעולם       | ✗     |
|    52 | ▁הזה            |              | ✗     |

2024-12-31 15:44:11,317 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:44:11,323 - TrainingLogger - INFO - Gradient norm: 23.9051
2024-12-31 15:44:18,339 - TrainingLogger - INFO - Step 410, Batch metrics: Loss: 7.5223, Accuracy: 0.0585, Perplexity: 1848.7640
2024-12-31 15:44:25,799 - TrainingLogger - INFO - Step 420, Batch metrics: Loss: 8.1053, Accuracy: 0.0550, Perplexity: 3312.1044
2024-12-31 15:44:32,735 - TrainingLogger - INFO - Step 430, Batch metrics: Loss: 7.9314, Accuracy: 0.0657, Perplexity: 2783.4423
2024-12-31 15:44:40,323 - TrainingLogger - INFO - Step 440, Batch metrics: Loss: 7.7441, Accuracy: 0.0613, Perplexity: 2307.8673
2024-12-31 15:44:47,729 - TrainingLogger - INFO - Step 450, Batch metrics: Loss: 7.8439, Accuracy: 0.0650, Perplexity: 2550.0318
2024-12-31 15:44:55,209 - TrainingLogger - INFO - Step 460, Batch metrics: Loss: 7.8358, Accuracy: 0.0964, Perplexity: 2529.4563
2024-12-31 15:45:02,040 - TrainingLogger - INFO - Step 470, Batch metrics: Loss: 7.9475, Accuracy: 0.0513, Perplexity: 2828.3755
2024-12-31 15:45:08,779 - TrainingLogger - INFO - Step 480, Batch metrics: Loss: 7.8299, Accuracy: 0.0430, Perplexity: 2514.7625
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 229376
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 229376

2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 32]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 32]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 42]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 42]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 15:45:15,700 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 15:45:16,926 - TrainingLogger - INFO - Step 490, Batch metrics: Loss: 8.0593, Accuracy: 0.0414, Perplexity: 3163.1640
2024-12-31 15:45:24,183 - TrainingLogger - INFO - Step 500, Batch metrics: Loss: 7.7462, Accuracy: 0.0558, Perplexity: 2312.7497
2024-12-31 15:45:24,183 - TrainingLogger - INFO - Step 500, Prediction vs Actual:
2024-12-31 15:45:24,183 - TrainingLogger - INFO - Input 1: לסער אין סיכוי להקים ממשלה
2024-12-31 15:45:24,184 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:45:24,184 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁לס          | ✗     |
|     1 | תו              | ער           | ✗     |
|     2 | ו               | ▁אין         | ✗     |
|     3 | ▁רע             | ▁סיכוי       | ✗     |
|     4 | .               | ▁להקים       | ✗     |
|     5 | י               | ▁ממשלה       | ✗     |
|     6 | י               | <pad>        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | י               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | י               | <pad>        | ✗     |
|    14 | י               | <pad>        | ✗     |
|    15 | ית              | <pad>        | ✗     |
|    16 | י               | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | י               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | י               | <pad>        | ✗     |
|    24 | י               | <pad>        | ✗     |
|    25 | י               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | י               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | י               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ,               |              | ✗     |

2024-12-31 15:45:24,184 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:45:24,189 - TrainingLogger - INFO - Gradient norm: 19.1207
2024-12-31 15:45:31,206 - TrainingLogger - INFO - Step 510, Batch metrics: Loss: 7.7446, Accuracy: 0.0726, Perplexity: 2309.1265
2024-12-31 15:45:38,089 - TrainingLogger - INFO - Step 520, Batch metrics: Loss: 7.7339, Accuracy: 0.0710, Perplexity: 2284.5065
2024-12-31 15:45:45,295 - TrainingLogger - INFO - Step 530, Batch metrics: Loss: 8.0708, Accuracy: 0.0362, Perplexity: 3199.7424
2024-12-31 15:45:52,905 - TrainingLogger - INFO - Step 540, Batch metrics: Loss: 7.8363, Accuracy: 0.0625, Perplexity: 2530.8871
2024-12-31 15:45:54,619 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 265216
2024-12-31 15:45:54,620 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 265216

2024-12-31 15:45:54,620 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 37]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 37]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 15:45:54,621 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 15:46:01,216 - TrainingLogger - INFO - Step 550, Batch metrics: Loss: 7.5989, Accuracy: 0.0494, Perplexity: 1996.0521
2024-12-31 15:46:08,717 - TrainingLogger - INFO - Step 560, Batch metrics: Loss: 7.8535, Accuracy: 0.0599, Perplexity: 2574.6353
2024-12-31 15:46:16,063 - TrainingLogger - INFO - Step 570, Batch metrics: Loss: 7.7515, Accuracy: 0.0647, Perplexity: 2325.1054
2024-12-31 15:46:23,069 - TrainingLogger - INFO - Step 580, Batch metrics: Loss: 7.8495, Accuracy: 0.0424, Perplexity: 2564.3410
2024-12-31 15:46:30,253 - TrainingLogger - INFO - Step 590, Batch metrics: Loss: 7.3477, Accuracy: 0.0825, Perplexity: 1552.6964
2024-12-31 15:46:37,482 - TrainingLogger - INFO - Step 600, Batch metrics: Loss: 7.5310, Accuracy: 0.0789, Perplexity: 1865.0125
2024-12-31 15:46:37,482 - TrainingLogger - INFO - Step 600, Prediction vs Actual:
2024-12-31 15:46:37,482 - TrainingLogger - INFO - Input 1: אם הליכוד לא הצליח להרכיב קואליציה, או שנתניהו נכשל בכך, אין סיבה לשרוף את המועדון ולשנות את המסורת הדמוקרטית הישראלית
2024-12-31 15:46:37,483 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:46:37,483 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁אם          | ✗     |
|     1 | ▁כן             | ▁הלי         | ✗     |
|     2 | מן              | כו           | ✗     |
|     3 | ר               | ד            | ✗     |
|     4 | ,               | ▁לא          | ✗     |
|     5 | ו               | ▁הצליח       | ✗     |
|     6 | ,               | ▁להרכיב      | ✗     |
|     7 | ▁את             | ▁קו          | ✗     |
|     8 | או              | אלי          | ✗     |
|     9 | ו               | ציה          | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | <pad>           | ▁או          | ✗     |
|    12 | ▁לא             | ▁שנת         | ✗     |
|    13 | י               | ניה          | ✗     |
|    14 | ו               | ו            | ✓     |
|    15 | ▁של             | ▁נכשל        | ✗     |
|    16 | ו               | ▁בכך         | ✗     |
|    17 | ,               | ,            | ✓     |
|    18 | <pad>           | ▁אין         | ✗     |
|    19 | ▁לי             | ▁סיבה        | ✗     |
|    20 | ▁אחרת           | ▁לשרוף       | ✗     |
|    21 | ▁אותו           | ▁את          | ✗     |
|    22 | ▁זה             | ▁המועדון     | ✗     |
|    23 | ות              | ▁ול          | ✗     |
|    24 | ו               | שנות         | ✗     |
|    25 | ▁את             | ▁את          | ✓     |
|    26 | ▁עצמו           | ▁המסורת      | ✗     |
|    27 | ,               | ▁הדמוקרטי    | ✗     |
|    28 | ה               | ת            | ✗     |
|    29 | .               | ▁הישראלי     | ✗     |
|    30 | ת               | ת            | ✓     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 15:46:37,483 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:46:37,489 - TrainingLogger - INFO - Gradient norm: 45.1562
2024-12-31 15:46:45,221 - TrainingLogger - INFO - Step 610, Batch metrics: Loss: 7.9205, Accuracy: 0.0541, Perplexity: 2753.0312
2024-12-31 15:46:52,296 - TrainingLogger - INFO - Step 620, Batch metrics: Loss: 7.6410, Accuracy: 0.0592, Perplexity: 2081.8649
2024-12-31 15:46:59,438 - TrainingLogger - INFO - Step 630, Batch metrics: Loss: 7.3445, Accuracy: 0.0870, Perplexity: 1547.6699
2024-12-31 15:47:07,067 - TrainingLogger - INFO - Step 640, Batch metrics: Loss: 8.0123, Accuracy: 0.0657, Perplexity: 3017.7049
2024-12-31 15:47:14,642 - TrainingLogger - INFO - Step 650, Batch metrics: Loss: 7.3309, Accuracy: 0.0581, Perplexity: 1526.6893
2024-12-31 15:47:21,878 - TrainingLogger - INFO - Step 660, Batch metrics: Loss: 7.4159, Accuracy: 0.1012, Perplexity: 1662.2191
2024-12-31 15:47:29,305 - TrainingLogger - INFO - Step 670, Batch metrics: Loss: 7.4422, Accuracy: 0.0695, Perplexity: 1706.4739
2024-12-31 15:47:36,789 - TrainingLogger - INFO - Step 680, Batch metrics: Loss: 7.6273, Accuracy: 0.0691, Perplexity: 2053.4262
2024-12-31 15:47:44,431 - TrainingLogger - INFO - Step 690, Batch metrics: Loss: 7.6774, Accuracy: 0.0706, Perplexity: 2159.0992
2024-12-31 15:47:51,740 - TrainingLogger - INFO - Step 700, Batch metrics: Loss: 7.2986, Accuracy: 0.0407, Perplexity: 1478.2856
2024-12-31 15:47:51,741 - TrainingLogger - INFO - Step 700, Prediction vs Actual:
2024-12-31 15:47:51,741 - TrainingLogger - INFO - Input 1: אלו אנשים שנקראים תג מחיר
2024-12-31 15:47:51,741 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:47:51,741 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אלו         | ✗     |
|     1 | .               | ▁אנשים       | ✗     |
|     2 | .               | ▁שנקרא       | ✗     |
|     3 | ו               | ים           | ✗     |
|     4 | ▁"              | ▁תג          | ✗     |
|     5 | י               | ▁מחיר        | ✗     |
|     6 | .               | <pad>        | ✗     |
|     7 | י               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ים              | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               |              | ✗     |

2024-12-31 15:47:51,741 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:47:51,746 - TrainingLogger - INFO - Gradient norm: 18.7538
2024-12-31 15:47:59,103 - TrainingLogger - INFO - Step 710, Batch metrics: Loss: 7.5117, Accuracy: 0.0628, Perplexity: 1829.3812
2024-12-31 15:48:07,120 - TrainingLogger - INFO - Step 720, Batch metrics: Loss: 7.7205, Accuracy: 0.0688, Perplexity: 2254.0025
2024-12-31 15:48:14,315 - TrainingLogger - INFO - Step 730, Batch metrics: Loss: 7.6811, Accuracy: 0.0926, Perplexity: 2166.9172
2024-12-31 15:48:22,171 - TrainingLogger - INFO - Step 740, Batch metrics: Loss: 7.6532, Accuracy: 0.0582, Perplexity: 2107.4219
2024-12-31 15:48:29,472 - TrainingLogger - INFO - Step 750, Batch metrics: Loss: 7.3756, Accuracy: 0.0606, Perplexity: 1596.5340
2024-12-31 15:48:37,163 - TrainingLogger - INFO - Step 760, Batch metrics: Loss: 7.7240, Accuracy: 0.0749, Perplexity: 2262.0477
2024-12-31 15:48:44,435 - TrainingLogger - INFO - Step 770, Batch metrics: Loss: 8.1708, Accuracy: 0.0647, Perplexity: 3536.3411
2024-12-31 15:48:52,315 - TrainingLogger - INFO - Step 780, Batch metrics: Loss: 7.7186, Accuracy: 0.0833, Perplexity: 2249.7160
2024-12-31 15:48:59,094 - TrainingLogger - INFO - Step 790, Batch metrics: Loss: 8.6298, Accuracy: 0.0479, Perplexity: 5596.0381
2024-12-31 15:49:06,651 - TrainingLogger - INFO - Step 800, Batch metrics: Loss: 7.5781, Accuracy: 0.0423, Perplexity: 1954.9628
2024-12-31 15:49:06,652 - TrainingLogger - INFO - Step 800, Prediction vs Actual:
2024-12-31 15:49:06,652 - TrainingLogger - INFO - Input 1: דבר אחד ברור הוא החליט שהוא לא מעוניין להיכנס לממשלה ולכן הוא הציב תנאי שהיה ברור שהוא תנאי בלתי אפשרי
2024-12-31 15:49:06,653 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:49:06,653 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁דבר         | ✗     |
|     1 | ▁לא             | ▁אחד         | ✗     |
|     2 | ,               | ▁ברור        | ✗     |
|     3 | ▁יותר           | ▁הוא         | ✗     |
|     4 | ▁אחד            | ▁החליט       | ✗     |
|     5 | ▁לצאת           | ▁שהוא        | ✗     |
|     6 | ▁היה            | ▁לא          | ✗     |
|     7 | ▁יכול           | ▁מעוניין     | ✗     |
|     8 | </s>            | ▁להיכנס      | ✗     |
|     9 | ▁לזה            | ▁לממשלה      | ✗     |
|    10 | .               | ▁ולכן        | ✗     |
|    11 | ▁הוא            | ▁הוא         | ✓     |
|    12 | ▁עשה            | ▁הציב        | ✗     |
|    13 | ה               | ▁תנאי        | ✗     |
|    14 | .               | ▁שהיה        | ✗     |
|    15 | ה               | ▁ברור        | ✗     |
|    16 | .               | ▁שהוא        | ✗     |
|    17 | ▁היה            | ▁תנאי        | ✗     |
|    18 | ▁לכך            | ▁בלתי        | ✗     |
|    19 | ▁רשמי           | ▁אפשרי       | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁לכך            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 15:49:06,653 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:49:06,658 - TrainingLogger - INFO - Gradient norm: 18.0693
2024-12-31 15:49:13,853 - TrainingLogger - INFO - Step 810, Batch metrics: Loss: 7.7475, Accuracy: 0.0634, Perplexity: 2315.7060
2024-12-31 15:49:21,439 - TrainingLogger - INFO - Step 820, Batch metrics: Loss: 7.8362, Accuracy: 0.0446, Perplexity: 2530.6591
2024-12-31 15:49:27,870 - TrainingLogger - INFO - Step 830, Batch metrics: Loss: 8.5355, Accuracy: 0.0517, Perplexity: 5092.1417
2024-12-31 15:49:35,241 - TrainingLogger - INFO - Step 840, Batch metrics: Loss: 7.7448, Accuracy: 0.0361, Perplexity: 2309.4393
2024-12-31 15:49:42,668 - TrainingLogger - INFO - Step 850, Batch metrics: Loss: 7.1382, Accuracy: 0.0798, Perplexity: 1259.1176
2024-12-31 15:49:49,655 - TrainingLogger - INFO - Step 860, Batch metrics: Loss: 7.4734, Accuracy: 0.0625, Perplexity: 1760.5500
2024-12-31 15:49:57,444 - TrainingLogger - INFO - Step 870, Batch metrics: Loss: 7.6661, Accuracy: 0.0894, Perplexity: 2134.8192
2024-12-31 15:50:04,403 - TrainingLogger - INFO - Step 880, Batch metrics: Loss: 7.2791, Accuracy: 0.0985, Perplexity: 1449.7538
2024-12-31 15:50:11,162 - TrainingLogger - INFO - Step 890, Batch metrics: Loss: 7.8152, Accuracy: 0.0800, Perplexity: 2478.0660
2024-12-31 15:50:18,343 - TrainingLogger - INFO - Step 900, Batch metrics: Loss: 8.1094, Accuracy: 0.0479, Perplexity: 3325.6607
2024-12-31 15:50:18,343 - TrainingLogger - INFO - Step 900, Prediction vs Actual:
2024-12-31 15:50:18,344 - TrainingLogger - INFO - Input 1: האירוע האלים החל בסביבות השעה שמונה בבוקר
2024-12-31 15:50:18,344 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:50:18,344 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁האירוע      | ✗     |
|     1 | י               | ▁האלים       | ✗     |
|     2 | -               | ▁החל         | ✗     |
|     3 | י               | ▁בסביבות     | ✗     |
|     4 | ▁השנייה         | ▁השעה        | ✗     |
|     5 | ▁השנייה         | ▁שמונה       | ✗     |
|     6 | .               | ▁בבוקר       | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁השנייה         | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               |              | ✗     |

2024-12-31 15:50:18,344 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:50:18,349 - TrainingLogger - INFO - Gradient norm: 16.6883
2024-12-31 15:50:25,324 - TrainingLogger - INFO - Step 910, Batch metrics: Loss: 8.0028, Accuracy: 0.0674, Perplexity: 2989.2109
2024-12-31 15:50:32,689 - TrainingLogger - INFO - Step 920, Batch metrics: Loss: 7.5581, Accuracy: 0.0633, Perplexity: 1916.1880
2024-12-31 15:50:40,095 - TrainingLogger - INFO - Step 930, Batch metrics: Loss: 7.5476, Accuracy: 0.0648, Perplexity: 1896.2430
2024-12-31 15:50:46,955 - TrainingLogger - INFO - Step 940, Batch metrics: Loss: 8.4287, Accuracy: 0.0136, Perplexity: 4576.6841
2024-12-31 15:50:55,204 - TrainingLogger - INFO - Step 950, Batch metrics: Loss: 7.7928, Accuracy: 0.0522, Perplexity: 2423.1504
2024-12-31 15:51:02,549 - TrainingLogger - INFO - Step 960, Batch metrics: Loss: 7.2185, Accuracy: 0.0802, Perplexity: 1364.3988
2024-12-31 15:51:06,333 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 258048
2024-12-31 15:51:06,333 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 258048

2024-12-31 15:51:06,333 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 51]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - input_ids_2 min: 6, max: 151643
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 51]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 15:51:06,334 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 15:51:10,499 - TrainingLogger - INFO - Step 970, Batch metrics: Loss: 8.0849, Accuracy: 0.0382, Perplexity: 3244.9712
2024-12-31 15:51:17,754 - TrainingLogger - INFO - Step 980, Batch metrics: Loss: 7.3797, Accuracy: 0.0449, Perplexity: 1603.1366
2024-12-31 15:51:25,068 - TrainingLogger - INFO - Step 990, Batch metrics: Loss: 7.3942, Accuracy: 0.0709, Perplexity: 1626.5369
2024-12-31 15:51:31,590 - TrainingLogger - INFO - Step 1000, Batch metrics: Loss: 7.7597, Accuracy: 0.0705, Perplexity: 2344.0890
2024-12-31 15:51:31,591 - TrainingLogger - INFO - Step 1000, Prediction vs Actual:
2024-12-31 15:51:31,591 - TrainingLogger - INFO - Input 1: שר החקלאות עודד פורר אמר בנושא בשלושת החודשים הבאים הנושא יידון בין משרד החקלאות ללולנים במטרה להביא לנוסחה מוסכמת
2024-12-31 15:51:31,591 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:51:31,591 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁שר          | ✗     |
|     1 | נו              | ▁ה           | ✗     |
|     2 | ▁ר              | חקלאות       | ✗     |
|     3 | </s>            | ▁עודד        | ✗     |
|     4 | ▁אותנו          | ▁פור         | ✗     |
|     5 | ה               | ר            | ✗     |
|     6 | -               | ▁אמר         | ✗     |
|     7 | ▁את             | ▁בנושא       | ✗     |
|     8 | ▁הזה            | ▁בשלושת      | ✗     |
|     9 | ▁הימים          | ▁החודשים     | ✗     |
|    10 | ▁האחרונים       | ▁הבאים       | ✗     |
|    11 | .               | ▁הנושא       | ✗     |
|    12 | .               | ▁יי          | ✗     |
|    13 | פקד             | דון          | ✗     |
|    14 | .               | ▁בין         | ✗     |
|    15 | ▁לאומי          | ▁משרד        | ✗     |
|    16 | י               | ▁ה           | ✗     |
|    17 | נסי             | חקלאות       | ✗     |
|    18 | ▁לבין           | ▁ל           | ✗     |
|    19 | נסי             | לול          | ✗     |
|    20 | .               | נים          | ✗     |
|    21 | .               | ▁במטרה       | ✗     |
|    22 | ▁זה             | ▁להביא       | ✗     |
|    23 | ▁את             | ▁ל           | ✗     |
|    24 | עידן            | נוסח         | ✗     |
|    25 | ה               | ה            | ✓     |
|    26 | .               | ▁מוס         | ✗     |
|    27 | א               | כ            | ✗     |
|    28 | יזם             | מת           | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               |              | ✗     |

2024-12-31 15:51:31,591 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:51:31,596 - TrainingLogger - INFO - Gradient norm: 16.7274
2024-12-31 15:51:38,504 - TrainingLogger - INFO - Step 1010, Batch metrics: Loss: 7.8624, Accuracy: 0.0688, Perplexity: 2597.7377
2024-12-31 15:51:45,936 - TrainingLogger - INFO - Step 1020, Batch metrics: Loss: 7.9327, Accuracy: 0.0710, Perplexity: 2786.9033
2024-12-31 15:51:53,031 - TrainingLogger - INFO - Step 1030, Batch metrics: Loss: 7.4153, Accuracy: 0.1224, Perplexity: 1661.1819
2024-12-31 15:52:00,246 - TrainingLogger - INFO - Step 1040, Batch metrics: Loss: 7.6542, Accuracy: 0.0763, Perplexity: 2109.4468
2024-12-31 15:52:07,626 - TrainingLogger - INFO - Step 1050, Batch metrics: Loss: 7.9730, Accuracy: 0.0819, Perplexity: 2901.5339
2024-12-31 15:52:14,665 - TrainingLogger - INFO - Step 1060, Batch metrics: Loss: 7.9580, Accuracy: 0.0497, Perplexity: 2858.4274
2024-12-31 15:52:22,496 - TrainingLogger - INFO - Step 1070, Batch metrics: Loss: 8.0368, Accuracy: 0.0471, Perplexity: 3092.5574
2024-12-31 15:52:30,512 - TrainingLogger - INFO - Step 1080, Batch metrics: Loss: 7.4554, Accuracy: 0.0533, Perplexity: 1729.1252
2024-12-31 15:52:37,779 - TrainingLogger - INFO - Step 1090, Batch metrics: Loss: 7.7312, Accuracy: 0.0629, Perplexity: 2278.3416
2024-12-31 15:52:45,150 - TrainingLogger - INFO - Step 1100, Batch metrics: Loss: 7.6972, Accuracy: 0.0423, Perplexity: 2202.0658
2024-12-31 15:52:45,150 - TrainingLogger - INFO - Step 1100, Prediction vs Actual:
2024-12-31 15:52:45,151 - TrainingLogger - INFO - Input 1: זוהי התבטאות לא ראויה למי שעומד בראש פירמידת צבא העם
2024-12-31 15:52:45,151 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:52:45,151 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁ישראל          | ▁זוהי        | ✗     |
|     1 | ,               | ▁התבטא       | ✗     |
|     2 | ,               | ות           | ✗     |
|     3 | ▁טובה           | ▁לא          | ✗     |
|     4 | ▁רק             | ▁ראויה       | ✗     |
|     5 | .               | ▁למי         | ✗     |
|     6 | ,               | ▁שעומד       | ✗     |
|     7 | .               | ▁בראש        | ✗     |
|     8 | .               | ▁פיר         | ✗     |
|     9 | ורים            | מידת         | ✗     |
|    10 | ו               | ▁צבא         | ✗     |
|    11 | .               | ▁העם         | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ית              | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 15:52:45,151 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:52:45,156 - TrainingLogger - INFO - Gradient norm: 13.9254
2024-12-31 15:52:52,692 - TrainingLogger - INFO - Step 1110, Batch metrics: Loss: 8.1267, Accuracy: 0.0601, Perplexity: 3383.4552
2024-12-31 15:52:59,954 - TrainingLogger - INFO - Step 1120, Batch metrics: Loss: 7.5523, Accuracy: 0.0714, Perplexity: 1905.2057
2024-12-31 15:53:07,548 - TrainingLogger - INFO - Step 1130, Batch metrics: Loss: 7.7438, Accuracy: 0.0650, Perplexity: 2307.3248
2024-12-31 15:53:14,879 - TrainingLogger - INFO - Step 1140, Batch metrics: Loss: 7.6096, Accuracy: 0.0710, Perplexity: 2017.5375
2024-12-31 15:53:22,314 - TrainingLogger - INFO - Step 1150, Batch metrics: Loss: 7.4034, Accuracy: 0.0765, Perplexity: 1641.6008
2024-12-31 15:53:29,548 - TrainingLogger - INFO - Step 1160, Batch metrics: Loss: 8.1688, Accuracy: 0.0309, Perplexity: 3529.1852
2024-12-31 15:53:36,472 - TrainingLogger - INFO - Step 1170, Batch metrics: Loss: 7.6322, Accuracy: 0.0629, Perplexity: 2063.5116
2024-12-31 15:53:44,382 - TrainingLogger - INFO - Step 1180, Batch metrics: Loss: 7.0415, Accuracy: 0.0638, Perplexity: 1143.0651
2024-12-31 15:53:52,147 - TrainingLogger - INFO - Step 1190, Batch metrics: Loss: 7.8007, Accuracy: 0.0762, Perplexity: 2442.2835
2024-12-31 15:54:00,074 - TrainingLogger - INFO - Step 1200, Batch metrics: Loss: 7.4867, Accuracy: 0.0598, Perplexity: 1784.1845
2024-12-31 15:54:00,074 - TrainingLogger - INFO - Step 1200, Prediction vs Actual:
2024-12-31 15:54:00,074 - TrainingLogger - INFO - Input 1: אנחנו נחושים להיות מודל להצלחה גם בארץ וגם בעולם, כתב ברק באיגרת ששלח למשקיעים באפריל
2024-12-31 15:54:00,075 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:54:00,075 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁אנחנו       | ✗     |
|     1 | .               | ▁נחושים      | ✗     |
|     2 | </s>            | ▁להיות       | ✗     |
|     3 | ▁טובים          | ▁מודל        | ✗     |
|     4 | ים              | ▁להצלחה      | ✗     |
|     5 | ▁גדולה          | ▁גם          | ✗     |
|     6 | ▁כן             | ▁בארץ        | ✗     |
|     7 | ▁הזאת           | ▁וגם         | ✗     |
|     8 | .               | ▁בעולם       | ✗     |
|     9 | .               | ,            | ✗     |
|    10 | </s>            | ▁כתב         | ✗     |
|    11 | ▁יד             | ▁ברק         | ✗     |
|    12 | ה               | ▁באי         | ✗     |
|    13 | נטל             | גרת          | ✗     |
|    14 | ▁החדשה          | ▁ששלח        | ✗     |
|    15 | ו               | ▁למ          | ✗     |
|    16 | אס              | שקיע         | ✗     |
|    17 | ים              | ים           | ✓     |
|    18 | ,               | ▁באפריל      | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            |              | ✗     |

2024-12-31 15:54:00,075 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:54:00,080 - TrainingLogger - INFO - Gradient norm: 18.5385
2024-12-31 15:54:07,550 - TrainingLogger - INFO - Step 1210, Batch metrics: Loss: 7.2163, Accuracy: 0.0794, Perplexity: 1361.3788
2024-12-31 15:54:14,956 - TrainingLogger - INFO - Step 1220, Batch metrics: Loss: 7.3758, Accuracy: 0.0704, Perplexity: 1596.8233
2024-12-31 15:54:22,150 - TrainingLogger - INFO - Step 1230, Batch metrics: Loss: 7.8044, Accuracy: 0.0747, Perplexity: 2451.4495
2024-12-31 15:54:29,902 - TrainingLogger - INFO - Step 1240, Batch metrics: Loss: 7.6555, Accuracy: 0.0549, Perplexity: 2112.2117
2024-12-31 15:54:37,266 - TrainingLogger - INFO - Step 1250, Batch metrics: Loss: 7.3229, Accuracy: 0.0825, Perplexity: 1514.5687
2024-12-31 15:54:44,709 - TrainingLogger - INFO - Step 1260, Batch metrics: Loss: 7.3580, Accuracy: 0.0812, Perplexity: 1568.6830
2024-12-31 15:54:52,088 - TrainingLogger - INFO - Step 1270, Batch metrics: Loss: 7.4918, Accuracy: 0.0599, Perplexity: 1793.2802
2024-12-31 15:54:59,903 - TrainingLogger - INFO - Step 1280, Batch metrics: Loss: 7.9053, Accuracy: 0.0428, Perplexity: 2711.6266
2024-12-31 15:55:07,464 - TrainingLogger - INFO - Step 1290, Batch metrics: Loss: 7.8143, Accuracy: 0.0472, Perplexity: 2475.7558
2024-12-31 15:55:14,559 - TrainingLogger - INFO - Step 1300, Batch metrics: Loss: 7.5670, Accuracy: 0.0802, Perplexity: 1933.2401
2024-12-31 15:55:14,559 - TrainingLogger - INFO - Step 1300, Prediction vs Actual:
2024-12-31 15:55:14,559 - TrainingLogger - INFO - Input 1: כעת הם מבקשים שליטה על המינויים והעברת הכוח מהפקידים לפוליטיקאים
2024-12-31 15:55:14,560 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:55:14,560 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כעת         | ✗     |
|     1 | ,               | ▁הם          | ✗     |
|     2 | .               | ▁מבקשים      | ✗     |
|     3 | </s>            | ▁שליטה       | ✗     |
|     4 | .               | ▁על          | ✗     |
|     5 | ▁החוק           | ▁המ          | ✗     |
|     6 | בנים            | ינו          | ✗     |
|     7 | י               | יים          | ✗     |
|     8 | .               | ▁וה          | ✗     |
|     9 | ירו             | עברת         | ✗     |
|    10 | ים              | ▁הכוח        | ✗     |
|    11 | .               | ▁מה          | ✗     |
|    12 | ות              | פקיד         | ✗     |
|    13 | ים              | ים           | ✓     |
|    14 | .               | ▁ל           | ✗     |
|    15 | מדינות          | פוליטיקאי    | ✗     |
|    16 | ם               | ם            | ✓     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 15:55:14,560 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:55:14,565 - TrainingLogger - INFO - Gradient norm: 16.7197
2024-12-31 15:55:21,939 - TrainingLogger - INFO - Step 1310, Batch metrics: Loss: 7.7413, Accuracy: 0.0828, Perplexity: 2301.5087
2024-12-31 15:55:29,234 - TrainingLogger - INFO - Step 1320, Batch metrics: Loss: 7.7030, Accuracy: 0.0737, Perplexity: 2214.9039
2024-12-31 15:55:36,515 - TrainingLogger - INFO - Step 1330, Batch metrics: Loss: 7.6657, Accuracy: 0.0526, Perplexity: 2133.8676
2024-12-31 15:55:43,508 - TrainingLogger - INFO - Step 1340, Batch metrics: Loss: 7.6797, Accuracy: 0.0469, Perplexity: 2164.0260
2024-12-31 15:55:51,400 - TrainingLogger - INFO - Step 1350, Batch metrics: Loss: 7.6085, Accuracy: 0.0656, Perplexity: 2015.2001
2024-12-31 15:55:58,149 - TrainingLogger - INFO - Step 1360, Batch metrics: Loss: 7.7525, Accuracy: 0.0704, Perplexity: 2327.3105
2024-12-31 15:56:05,519 - TrainingLogger - INFO - Step 1370, Batch metrics: Loss: 7.2699, Accuracy: 0.0647, Perplexity: 1436.3997
2024-12-31 15:56:13,158 - TrainingLogger - INFO - Step 1380, Batch metrics: Loss: 7.4924, Accuracy: 0.0640, Perplexity: 1794.4307
2024-12-31 15:56:20,419 - TrainingLogger - INFO - Step 1390, Batch metrics: Loss: 7.5933, Accuracy: 0.0585, Perplexity: 1984.7881
2024-12-31 15:56:27,995 - TrainingLogger - INFO - Step 1400, Batch metrics: Loss: 7.4415, Accuracy: 0.0704, Perplexity: 1705.3155
2024-12-31 15:56:27,996 - TrainingLogger - INFO - Step 1400, Prediction vs Actual:
2024-12-31 15:56:27,996 - TrainingLogger - INFO - Input 1: זוהר צריך ללכת הביתה חכ שלמה קרעי, שנמנה על הנענשים, אמר כי מיקי פועל באופן שקרי ומניפולטיבי לקידום תוכנית נטו מיקי זוהר
2024-12-31 15:56:27,997 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:56:27,997 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁זוהר        | ✗     |
|     1 | ה               | ▁צריך        | ✗     |
|     2 | ▁להגיע          | ▁ללכת        | ✗     |
|     3 | .               | ▁הביתה       | ✗     |
|     4 | .               | ▁ח           | ✗     |
|     5 | .               | כ            | ✗     |
|     6 | מ               | ▁שלמה        | ✗     |
|     7 | .               | ▁קרע         | ✗     |
|     8 | ים              | י            | ✗     |
|     9 | ▁העם            | ,            | ✗     |
|    10 | </s>            | ▁שנ          | ✗     |
|    11 | טש              | מנה          | ✗     |
|    12 | ו               | ▁על          | ✗     |
|    13 | ▁פני            | ▁הנע         | ✗     |
|    14 | ה               | נשים         | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁אמר         | ✗     |
|    17 | ▁להם            | ▁כי          | ✗     |
|    18 | </s>            | ▁מיקי        | ✗     |
|    19 | ,               | ▁פועל        | ✗     |
|    20 | .               | ▁באופן       | ✗     |
|    21 | ▁חוקי           | ▁שקר         | ✗     |
|    22 | י               | י            | ✓     |
|    23 | .               | ▁ומ          | ✗     |
|    24 | חוק             | ני           | ✗     |
|    25 | מלי             | פול          | ✗     |
|    26 | .               | טיבי         | ✗     |
|    27 | .               | ▁לקידום      | ✗     |
|    28 | ▁המדינה         | ▁תוכנית      | ✗     |
|    29 | ו               | ▁            | ✗     |
|    30 | נטו             | נטו          | ✓     |
|    31 | .               | ▁מיקי        | ✗     |
|    32 | ו               | ▁זוהר        | ✗     |
|    33 | ת               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               |              | ✗     |

2024-12-31 15:56:27,997 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:56:28,002 - TrainingLogger - INFO - Gradient norm: 12.7272
2024-12-31 15:56:35,829 - TrainingLogger - INFO - Step 1410, Batch metrics: Loss: 7.4888, Accuracy: 0.0859, Perplexity: 1787.8858
2024-12-31 15:56:42,827 - TrainingLogger - INFO - Step 1420, Batch metrics: Loss: 7.1202, Accuracy: 0.0956, Perplexity: 1236.6968
2024-12-31 15:56:50,049 - TrainingLogger - INFO - Step 1430, Batch metrics: Loss: 8.2235, Accuracy: 0.0427, Perplexity: 3727.3704
2024-12-31 15:56:57,121 - TrainingLogger - INFO - Step 1440, Batch metrics: Loss: 7.2320, Accuracy: 0.1026, Perplexity: 1382.9737
2024-12-31 15:57:04,671 - TrainingLogger - INFO - Step 1450, Batch metrics: Loss: 7.8921, Accuracy: 0.0576, Perplexity: 2676.0472
2024-12-31 15:57:11,715 - TrainingLogger - INFO - Step 1460, Batch metrics: Loss: 7.6379, Accuracy: 0.0610, Perplexity: 2075.4361
2024-12-31 15:57:19,409 - TrainingLogger - INFO - Step 1470, Batch metrics: Loss: 7.5283, Accuracy: 0.0706, Perplexity: 1859.9077
2024-12-31 15:57:26,691 - TrainingLogger - INFO - Step 1480, Batch metrics: Loss: 7.5451, Accuracy: 0.0800, Perplexity: 1891.4487
2024-12-31 15:57:33,703 - TrainingLogger - INFO - Step 1490, Batch metrics: Loss: 7.3787, Accuracy: 0.0882, Perplexity: 1601.5137
2024-12-31 15:57:41,295 - TrainingLogger - INFO - Step 1500, Batch metrics: Loss: 7.9837, Accuracy: 0.0471, Perplexity: 2932.8637
2024-12-31 15:57:41,295 - TrainingLogger - INFO - Step 1500, Prediction vs Actual:
2024-12-31 15:57:41,295 - TrainingLogger - INFO - Input 1: נולדה למוריס מוראן זל, שעלה לארץ מאיזמיר שבטורקיה בגיל 12, והיה, לדבריה, המתווך הראשון בהרצליה פיתוח, ולהלנה מוראן, ילידת פינלנד
2024-12-31 15:57:41,296 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:57:41,296 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁נולדה       | ✗     |
|     1 | ▁ישראל          | ▁ל           | ✗     |
|     2 | חל              | מוריס        | ✗     |
|     3 | ו               | ▁מור         | ✗     |
|     4 | ל               | אן           | ✗     |
|     5 | </s>            | ▁ז           | ✗     |
|     6 | לין             | ל            | ✗     |
|     7 | אס              | ,            | ✗     |
|     8 | </s>            | ▁שעלה        | ✗     |
|     9 | ם               | ▁לארץ        | ✗     |
|    10 | ▁ישראל          | ▁מאי         | ✗     |
|    11 | נה              | זמיר         | ✗     |
|    12 | ה               | ▁שב          | ✗     |
|    13 | דיה             | טורקיה       | ✗     |
|    14 | .               | ▁בגיל        | ✗     |
|    15 | יץ              | ▁12,         | ✗     |
|    16 | </s>            | ▁והיה        | ✗     |
|    17 | ▁זה             | ,            | ✗     |
|    18 | </s>            | ▁לדבר        | ✗     |
|    19 | ▁איתו           | יה           | ✗     |
|    20 | ן               | ,            | ✗     |
|    21 | </s>            | ▁המתווך      | ✗     |
|    22 | .               | ▁הראשון      | ✗     |
|    23 | נה              | ▁בה          | ✗     |
|    24 | ת               | רצ           | ✗     |
|    25 | אה              | ליה          | ✗     |
|    26 | .               | ▁פיתוח       | ✗     |
|    27 | ,               | ,            | ✓     |
|    28 | </s>            | ▁ולה         | ✗     |
|    29 | יות             | לנה          | ✗     |
|    30 | ,               | ▁מור         | ✗     |
|    31 | ה               | אן           | ✗     |
|    32 | .               | ,            | ✗     |
|    33 | </s>            | ▁יליד        | ✗     |
|    34 | ▁המדינה         | ת            | ✗     |
|    35 | ▁ישראל          | ▁            | ✗     |
|    36 | ים              | פינלנד       | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | -               | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | ,               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ,               |              | ✗     |

2024-12-31 15:57:41,296 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:57:41,302 - TrainingLogger - INFO - Gradient norm: 16.7769
2024-12-31 15:57:48,350 - TrainingLogger - INFO - Step 1510, Batch metrics: Loss: 7.1781, Accuracy: 0.0794, Perplexity: 1310.3994
2024-12-31 15:57:55,606 - TrainingLogger - INFO - Step 1520, Batch metrics: Loss: 7.3457, Accuracy: 0.0982, Perplexity: 1549.4738
2024-12-31 15:58:03,426 - TrainingLogger - INFO - Step 1530, Batch metrics: Loss: 7.7462, Accuracy: 0.0517, Perplexity: 2312.8457
2024-12-31 15:58:10,898 - TrainingLogger - INFO - Step 1540, Batch metrics: Loss: 7.4686, Accuracy: 0.0751, Perplexity: 1752.1566
2024-12-31 15:58:18,864 - TrainingLogger - INFO - Step 1550, Batch metrics: Loss: 7.1751, Accuracy: 0.0734, Perplexity: 1306.4550
2024-12-31 15:58:25,609 - TrainingLogger - INFO - Step 1560, Batch metrics: Loss: 7.1441, Accuracy: 0.0552, Perplexity: 1266.6226
2024-12-31 15:58:32,881 - TrainingLogger - INFO - Step 1570, Batch metrics: Loss: 6.8602, Accuracy: 0.0982, Perplexity: 953.5650
2024-12-31 15:58:39,783 - TrainingLogger - INFO - Step 1580, Batch metrics: Loss: 7.5501, Accuracy: 0.0671, Perplexity: 1900.9869
2024-12-31 15:58:47,484 - TrainingLogger - INFO - Step 1590, Batch metrics: Loss: 7.3896, Accuracy: 0.0825, Perplexity: 1619.0959
2024-12-31 15:58:54,569 - TrainingLogger - INFO - Step 1600, Batch metrics: Loss: 7.6351, Accuracy: 0.0737, Perplexity: 2069.5669
2024-12-31 15:58:54,570 - TrainingLogger - INFO - Step 1600, Prediction vs Actual:
2024-12-31 15:58:54,570 - TrainingLogger - INFO - Input 1: ועדיין, נדמה שיש חטא אחד - מוּם ממש - שעיר של לילה אינו מוחל עליו
2024-12-31 15:58:54,570 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 15:58:54,570 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ועדיין      | ✗     |
|     1 | ▁לא             | ,            | ✗     |
|     2 | ▁לא             | ▁נדמה        | ✗     |
|     3 | ▁כי             | ▁שיש         | ✗     |
|     4 | ▁לנו            | ▁חטא         | ✗     |
|     5 | ,               | ▁אחד         | ✗     |
|     6 | ,               | ▁-           | ✗     |
|     7 | -               | ▁מ           | ✗     |
|     8 | ועצת            | וּ           | ✗     |
|     9 | ך               | ם            | ✗     |
|    10 | ,               | ▁ממש         | ✗     |
|    11 | י               | ▁-           | ✗     |
|    12 | -               | ▁שעיר        | ✗     |
|    13 | ▁יותר           | ▁של          | ✗     |
|    14 | ▁ימינו          | ▁לילה        | ✗     |
|    15 | .               | ▁אינו        | ✗     |
|    16 | ▁מוצא           | ▁מוח         | ✗     |
|    17 | ץ               | ל            | ✗     |
|    18 | .               | ▁עליו        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 15:58:54,570 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 15:58:54,576 - TrainingLogger - INFO - Gradient norm: 16.2539
2024-12-31 15:59:01,855 - TrainingLogger - INFO - Step 1610, Batch metrics: Loss: 7.8260, Accuracy: 0.0379, Perplexity: 2504.8688
2024-12-31 15:59:09,576 - TrainingLogger - INFO - Step 1620, Batch metrics: Loss: 7.3852, Accuracy: 0.0625, Perplexity: 1611.8841
2024-12-31 15:59:16,766 - TrainingLogger - INFO - Step 1630, Batch metrics: Loss: 7.7752, Accuracy: 0.0700, Perplexity: 2380.8680
2024-12-31 15:59:24,264 - TrainingLogger - INFO - Step 1640, Batch metrics: Loss: 7.4766, Accuracy: 0.0802, Perplexity: 1766.2097
2024-12-31 15:59:31,285 - TrainingLogger - INFO - Step 1650, Batch metrics: Loss: 7.6317, Accuracy: 0.0897, Perplexity: 2062.4886
2024-12-31 15:59:38,291 - TrainingLogger - INFO - Step 1660, Batch metrics: Loss: 7.5553, Accuracy: 0.0462, Perplexity: 1910.8165
2024-12-31 15:59:45,874 - TrainingLogger - INFO - Step 1670, Batch metrics: Loss: 7.3918, Accuracy: 0.0625, Perplexity: 1622.6117
2024-12-31 15:59:53,646 - TrainingLogger - INFO - Step 1680, Batch metrics: Loss: 7.3552, Accuracy: 0.0651, Perplexity: 1564.2543
2024-12-31 16:00:01,031 - TrainingLogger - INFO - Step 1690, Batch metrics: Loss: 7.5068, Accuracy: 0.0588, Perplexity: 1820.4010
2024-12-31 16:00:08,872 - TrainingLogger - INFO - Step 1700, Batch metrics: Loss: 7.4135, Accuracy: 0.0837, Perplexity: 1658.1991
2024-12-31 16:00:08,872 - TrainingLogger - INFO - Step 1700, Prediction vs Actual:
2024-12-31 16:00:08,872 - TrainingLogger - INFO - Input 1: הכובע כמו בנוי מוורידים המובילים את הדם אל לבו הפועם של אדם, הנתפר בהשראת האקורדיון
2024-12-31 16:00:08,873 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:00:08,873 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלו            | ▁הכובע       | ✗     |
|     1 | י               | ▁כמו         | ✗     |
|     2 | ה               | ▁בנוי        | ✗     |
|     3 | </s>            | ▁מו          | ✗     |
|     4 | י               | וריד         | ✗     |
|     5 | ים              | ים           | ✓     |
|     6 | </s>            | ▁המובילים    | ✗     |
|     7 | </s>            | ▁את          | ✗     |
|     8 | ▁זה             | ▁הדם         | ✗     |
|     9 | </s>            | ▁אל          | ✗     |
|    10 | ים              | ▁לבו         | ✗     |
|    11 | </s>            | ▁הפו         | ✗     |
|    12 | עה              | עם           | ✗     |
|    13 | </s>            | ▁של          | ✗     |
|    14 | ▁ישו            | ▁אדם         | ✗     |
|    15 | ▁אחר            | ,            | ✗     |
|    16 | </s>            | ▁הנ          | ✗     |
|    17 | מש              | ת            | ✗     |
|    18 | עה              | פר           | ✗     |
|    19 | ▁הוא            | ▁בהשראת      | ✗     |
|    20 | ו               | ▁הא          | ✗     |
|    21 | מנו             | קורדי        | ✗     |
|    22 | ה               | ון           | ✗     |
|    23 | ▁שלו            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ▁שלו            | <pad>        | ✗     |
|    26 | ▁עצמו           | <pad>        | ✗     |
|    27 | ▁שלו            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁עצמו           | <pad>        | ✗     |
|    31 | ▁שלו            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | מות             | <pad>        | ✗     |
|    40 | ▁עצמו           | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 16:00:08,873 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:00:08,878 - TrainingLogger - INFO - Gradient norm: 13.1882
2024-12-31 16:00:15,882 - TrainingLogger - INFO - Step 1710, Batch metrics: Loss: 7.3773, Accuracy: 0.1118, Perplexity: 1599.2671
2024-12-31 16:00:22,875 - TrainingLogger - INFO - Step 1720, Batch metrics: Loss: 7.2715, Accuracy: 0.0844, Perplexity: 1438.6796
2024-12-31 16:00:30,090 - TrainingLogger - INFO - Step 1730, Batch metrics: Loss: 7.4495, Accuracy: 0.0616, Perplexity: 1719.0331
2024-12-31 16:00:37,179 - TrainingLogger - INFO - Step 1740, Batch metrics: Loss: 7.3632, Accuracy: 0.0824, Perplexity: 1576.8733
2024-12-31 16:00:44,547 - TrainingLogger - INFO - Step 1750, Batch metrics: Loss: 8.0842, Accuracy: 0.0732, Perplexity: 3242.9634
2024-12-31 16:00:51,487 - TrainingLogger - INFO - Step 1760, Batch metrics: Loss: 7.7965, Accuracy: 0.0838, Perplexity: 2432.0486
2024-12-31 16:00:58,732 - TrainingLogger - INFO - Step 1770, Batch metrics: Loss: 7.6265, Accuracy: 0.0698, Perplexity: 2051.7779
2024-12-31 16:01:06,387 - TrainingLogger - INFO - Step 1780, Batch metrics: Loss: 7.4057, Accuracy: 0.0504, Perplexity: 1645.3702
2024-12-31 16:01:13,997 - TrainingLogger - INFO - Step 1790, Batch metrics: Loss: 7.7055, Accuracy: 0.0510, Perplexity: 2220.4694
2024-12-31 16:01:21,672 - TrainingLogger - INFO - Step 1800, Batch metrics: Loss: 7.6648, Accuracy: 0.0681, Perplexity: 2132.0409
2024-12-31 16:01:21,672 - TrainingLogger - INFO - Step 1800, Prediction vs Actual:
2024-12-31 16:01:21,672 - TrainingLogger - INFO - Input 1: כולי תקווה שמחר בהשקת הקמפיין יראו מקבלי ההחלטות את הילדים מול עיניהם ולא אף אחד אחר
2024-12-31 16:01:21,673 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:01:21,673 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | יהם             | ▁כולי        | ✗     |
|     1 | ▁כך             | ▁תקווה       | ✗     |
|     2 | .               | ▁שמח         | ✗     |
|     3 | .               | ר            | ✗     |
|     4 | ▁יום            | ▁בה          | ✗     |
|     5 | מה              | שק           | ✗     |
|     6 | פות             | ת            | ✗     |
|     7 | ▁נשים           | ▁הקמפיין     | ✗     |
|     8 | .               | ▁יראו        | ✗     |
|     9 | ▁אותנו          | ▁מקבל        | ✗     |
|    10 | ▁את             | י            | ✗     |
|    11 | ▁פנים           | ▁ההחלטות     | ✗     |
|    12 | ▁הללו           | ▁את          | ✗     |
|    13 | ▁כל             | ▁הילדים      | ✗     |
|    14 | ▁החדשים         | ▁מול         | ✗     |
|    15 | ם               | ▁עיניהם      | ✗     |
|    16 | .               | ▁ולא         | ✗     |
|    17 | ▁שמים           | ▁אף          | ✗     |
|    18 | ▁אחד            | ▁אחד         | ✓     |
|    19 | ▁לא             | ▁אחר         | ✗     |
|    20 | ▁לא             | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               |              | ✗     |

2024-12-31 16:01:21,673 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:01:21,678 - TrainingLogger - INFO - Gradient norm: 16.6159
2024-12-31 16:01:28,520 - TrainingLogger - INFO - Step 1810, Batch metrics: Loss: 7.2615, Accuracy: 0.0738, Perplexity: 1424.3275
2024-12-31 16:01:35,800 - TrainingLogger - INFO - Step 1820, Batch metrics: Loss: 7.3742, Accuracy: 0.0882, Perplexity: 1594.3111
2024-12-31 16:01:43,212 - TrainingLogger - INFO - Step 1830, Batch metrics: Loss: 7.5894, Accuracy: 0.0705, Perplexity: 1977.2048
2024-12-31 16:01:50,438 - TrainingLogger - INFO - Step 1840, Batch metrics: Loss: 7.8246, Accuracy: 0.0417, Perplexity: 2501.2642
2024-12-31 16:01:57,838 - TrainingLogger - INFO - Step 1850, Batch metrics: Loss: 7.2551, Accuracy: 0.0902, Perplexity: 1415.3649
2024-12-31 16:02:05,451 - TrainingLogger - INFO - Step 1860, Batch metrics: Loss: 7.2256, Accuracy: 0.0833, Perplexity: 1374.2202
2024-12-31 16:02:12,711 - TrainingLogger - INFO - Step 1870, Batch metrics: Loss: 7.2956, Accuracy: 0.0602, Perplexity: 1473.7924
2024-12-31 16:02:19,845 - TrainingLogger - INFO - Step 1880, Batch metrics: Loss: 7.3192, Accuracy: 0.0650, Perplexity: 1508.9920
2024-12-31 16:02:26,971 - TrainingLogger - INFO - Step 1890, Batch metrics: Loss: 7.6770, Accuracy: 0.0861, Perplexity: 2158.2026
2024-12-31 16:02:34,285 - TrainingLogger - INFO - Step 1900, Batch metrics: Loss: 7.5237, Accuracy: 0.0635, Perplexity: 1851.3532
2024-12-31 16:02:34,286 - TrainingLogger - INFO - Step 1900, Prediction vs Actual:
2024-12-31 16:02:34,286 - TrainingLogger - INFO - Input 1: ייתכן שדלתא תפיק מזה יותר פוטנציאל עי פיתוח דגמים חדשניים יותר לנייקי, לא רק בתחום הגרביים, אבל עוד חזון למועד
2024-12-31 16:02:34,286 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:02:34,286 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ייתכן       | ✗     |
|     1 | ▁ו              | ▁ש           | ✗     |
|     2 | סטה             | דלת          | ✗     |
|     3 | ▁לא             | א            | ✗     |
|     4 | מנה             | ▁ת           | ✗     |
|     5 | תבצע            | פיק          | ✗     |
|     6 | מה              | ▁מזה         | ✗     |
|     7 | .               | ▁יותר        | ✗     |
|     8 | ▁טובה           | ▁פוטנציאל    | ✗     |
|     9 | .               | ▁עי          | ✗     |
|    10 | נית             | ▁פיתוח       | ✗     |
|    11 | י               | ▁דג          | ✗     |
|    12 | א               | מים          | ✗     |
|    13 | .               | ▁חדש         | ✗     |
|    14 | .               | ניים         | ✗     |
|    15 | .               | ▁יותר        | ✗     |
|    16 | ▁מאשר           | ▁לני         | ✗     |
|    17 | צו              | יקי          | ✗     |
|    18 | ה               | ,            | ✗     |
|    19 | </s>            | ▁לא          | ✗     |
|    20 | ▁משנה           | ▁רק          | ✗     |
|    21 | ▁הפעם           | ▁בתחום       | ✗     |
|    22 | ▁הזה            | ▁הגרביים     | ✗     |
|    23 | ,               | ,            | ✓     |
|    24 | </s>            | ▁אבל         | ✗     |
|    25 | ▁הם             | ▁עוד         | ✗     |
|    26 | ▁לא             | ▁חזון        | ✗     |
|    27 | ▁לא             | ▁למועד       | ✗     |
|    28 | ▁אחר            | <pad>        | ✗     |
|    29 | ▁אחר            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ▁הבחירות        | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁החקירה         | <pad>        | ✗     |
|    36 | ▁זה             | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 16:02:34,286 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:02:34,292 - TrainingLogger - INFO - Gradient norm: 15.6501
2024-12-31 16:02:41,939 - TrainingLogger - INFO - Step 1910, Batch metrics: Loss: 7.3352, Accuracy: 0.0552, Perplexity: 1533.3444
2024-12-31 16:02:49,206 - TrainingLogger - INFO - Step 1920, Batch metrics: Loss: 7.7782, Accuracy: 0.0279, Perplexity: 2387.9229
2024-12-31 16:02:56,301 - TrainingLogger - INFO - Step 1930, Batch metrics: Loss: 7.6181, Accuracy: 0.0573, Perplexity: 2034.6298
2024-12-31 16:03:03,267 - TrainingLogger - INFO - Step 1940, Batch metrics: Loss: 7.4716, Accuracy: 0.0420, Perplexity: 1757.4214
2024-12-31 16:03:10,310 - TrainingLogger - INFO - Step 1950, Batch metrics: Loss: 7.2625, Accuracy: 0.0899, Perplexity: 1425.7987
2024-12-31 16:03:17,537 - TrainingLogger - INFO - Step 1960, Batch metrics: Loss: 7.2506, Accuracy: 0.0610, Perplexity: 1408.9437
2024-12-31 16:03:24,806 - TrainingLogger - INFO - Step 1970, Batch metrics: Loss: 7.6058, Accuracy: 0.0482, Perplexity: 2009.7686
2024-12-31 16:03:32,511 - TrainingLogger - INFO - Step 1980, Batch metrics: Loss: 7.6544, Accuracy: 0.0928, Perplexity: 2109.8532
2024-12-31 16:03:40,221 - TrainingLogger - INFO - Step 1990, Batch metrics: Loss: 7.4242, Accuracy: 0.0567, Perplexity: 1676.0663
2024-12-31 16:03:47,519 - TrainingLogger - INFO - Step 2000, Batch metrics: Loss: 7.5145, Accuracy: 0.0990, Perplexity: 1834.4949
2024-12-31 16:03:47,519 - TrainingLogger - INFO - Step 2000, Prediction vs Actual:
2024-12-31 16:03:47,519 - TrainingLogger - INFO - Input 1: עם המשכורת הקודמת היה ממש קשה בשבילי לחיות
2024-12-31 16:03:47,520 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:03:47,520 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁בספרדית        | ▁עם          | ✗     |
|     1 | .               | ▁המשכורת     | ✗     |
|     2 | ▁טובה           | ▁הקודמת      | ✗     |
|     3 | .               | ▁היה         | ✗     |
|     4 | ▁הכי            | ▁ממש         | ✗     |
|     5 | ▁טוב            | ▁קשה         | ✗     |
|     6 | .               | ▁בשבילי      | ✗     |
|     7 | </s>            | ▁לחיות       | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | ▁טובה           | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ▁יותר           | <pad>        | ✗     |
|    14 | ▁טובה           | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁יותר           | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁הזה            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁קשה            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 16:03:47,520 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:03:47,525 - TrainingLogger - INFO - Gradient norm: 15.9335
2024-12-31 16:03:54,925 - TrainingLogger - INFO - Step 2010, Batch metrics: Loss: 7.5917, Accuracy: 0.0549, Perplexity: 1981.7732
2024-12-31 16:04:02,105 - TrainingLogger - INFO - Step 2020, Batch metrics: Loss: 7.3574, Accuracy: 0.0928, Perplexity: 1567.7146
2024-12-31 16:04:09,839 - TrainingLogger - INFO - Step 2030, Batch metrics: Loss: 7.7620, Accuracy: 0.0496, Perplexity: 2349.6587
2024-12-31 16:04:16,867 - TrainingLogger - INFO - Step 2040, Batch metrics: Loss: 7.9664, Accuracy: 0.0149, Perplexity: 2882.6024
2024-12-31 16:04:24,010 - TrainingLogger - INFO - Step 2050, Batch metrics: Loss: 7.5313, Accuracy: 0.0839, Perplexity: 1865.4999
2024-12-31 16:04:30,699 - TrainingLogger - INFO - Step 2060, Batch metrics: Loss: 7.8351, Accuracy: 0.0585, Perplexity: 2527.9032
2024-12-31 16:04:37,752 - TrainingLogger - INFO - Step 2070, Batch metrics: Loss: 7.5655, Accuracy: 0.0510, Perplexity: 1930.3818
2024-12-31 16:04:45,293 - TrainingLogger - INFO - Step 2080, Batch metrics: Loss: 7.5733, Accuracy: 0.0734, Perplexity: 1945.4728
2024-12-31 16:04:52,732 - TrainingLogger - INFO - Step 2090, Batch metrics: Loss: 7.7426, Accuracy: 0.0556, Perplexity: 2304.3605
2024-12-31 16:04:53,555 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 16:04:53,556 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 16:04:53,556 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 33]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 33]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:04:53,557 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:05:01,086 - TrainingLogger - INFO - Step 2100, Batch metrics: Loss: 7.3554, Accuracy: 0.0621, Perplexity: 1564.6139
2024-12-31 16:05:01,087 - TrainingLogger - INFO - Step 2100, Prediction vs Actual:
2024-12-31 16:05:01,087 - TrainingLogger - INFO - Input 1: שלשום התברר גם כי שני תלמידים בכיתות ד ו-ו משני בתי ספר יסודיים בכפר יונה אובחנו כחיוביים לנגיף
2024-12-31 16:05:01,087 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:05:01,088 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁של          | ✗     |
|     1 | .               | שום          | ✗     |
|     2 | .               | ▁התברר       | ✗     |
|     3 | ▁כי             | ▁גם          | ✗     |
|     4 | ▁שהוא           | ▁כי          | ✗     |
|     5 | ▁הוא            | ▁שני         | ✗     |
|     6 | ▁הצדדים         | ▁תלמידים     | ✗     |
|     7 | ▁אחרים          | ▁בכית        | ✗     |
|     8 | ים              | ות           | ✗     |
|     9 | ▁טובות          | ▁ד           | ✗     |
|    10 | "               | ▁ו           | ✗     |
|    11 | ונס             | -            | ✗     |
|    12 | ו               | ו            | ✓     |
|    13 | סון             | ▁משני        | ✗     |
|    14 | ▁הצדדים         | ▁בתי         | ✗     |
|    15 | ▁הדין           | ▁ספר         | ✗     |
|    16 | ▁שונים          | ▁יסודי       | ✗     |
|    17 | ים              | ים           | ✓     |
|    18 | ,               | ▁בכפר        | ✗     |
|    19 | ים              | ▁יונה        | ✗     |
|    20 | .               | ▁או          | ✗     |
|    21 | דו              | בחנו         | ✗     |
|    22 | ▁על             | ▁כ           | ✗     |
|    23 | "               | חיובי        | ✗     |
|    24 | ה               | ים           | ✗     |
|    25 | .               | ▁ל           | ✗     |
|    26 | מדינות          | נגיף         | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ים              |              | ✗     |

2024-12-31 16:05:01,088 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:05:01,093 - TrainingLogger - INFO - Gradient norm: 16.1732
2024-12-31 16:05:08,612 - TrainingLogger - INFO - Step 2110, Batch metrics: Loss: 7.5483, Accuracy: 0.0421, Perplexity: 1897.4840
2024-12-31 16:05:15,723 - TrainingLogger - INFO - Step 2120, Batch metrics: Loss: 7.6534, Accuracy: 0.0342, Perplexity: 2107.6973
2024-12-31 16:05:22,989 - TrainingLogger - INFO - Step 2130, Batch metrics: Loss: 7.6892, Accuracy: 0.0759, Perplexity: 2184.5645
2024-12-31 16:05:30,351 - TrainingLogger - INFO - Step 2140, Batch metrics: Loss: 7.7361, Accuracy: 0.0582, Perplexity: 2289.4968
2024-12-31 16:05:37,192 - TrainingLogger - INFO - Step 2150, Batch metrics: Loss: 7.7314, Accuracy: 0.0900, Perplexity: 2278.6903
2024-12-31 16:05:44,531 - TrainingLogger - INFO - Step 2160, Batch metrics: Loss: 7.2463, Accuracy: 0.0919, Perplexity: 1402.9095
2024-12-31 16:05:51,590 - TrainingLogger - INFO - Step 2170, Batch metrics: Loss: 7.7698, Accuracy: 0.0600, Perplexity: 2368.0941
2024-12-31 16:05:58,839 - TrainingLogger - INFO - Step 2180, Batch metrics: Loss: 7.6325, Accuracy: 0.0510, Perplexity: 2064.2783
2024-12-31 16:06:05,676 - TrainingLogger - INFO - Step 2190, Batch metrics: Loss: 7.5183, Accuracy: 0.0307, Perplexity: 1841.3746
2024-12-31 16:06:12,945 - TrainingLogger - INFO - Step 2200, Batch metrics: Loss: 7.6687, Accuracy: 0.0513, Perplexity: 2140.3967
2024-12-31 16:06:12,945 - TrainingLogger - INFO - Step 2200, Prediction vs Actual:
2024-12-31 16:06:12,945 - TrainingLogger - INFO - Input 1: 20 אחוז ירידה במשקי המים, המצב הרדוד של הכנרת בסוף החורף, אנחנו רואים ירידה עקבית בכנרת וירדן ויותר בנגב ומרכז הארץ
2024-12-31 16:06:12,946 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:06:12,946 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁20          | ✗     |
|     1 | .               | ▁אחוז        | ✗     |
|     2 | .               | ▁ירידה       | ✗     |
|     3 | .               | ▁במש         | ✗     |
|     4 | ה               | קי           | ✗     |
|     5 | ▁הגוף           | ▁המים        | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | </s>            | ▁המצב        | ✗     |
|     8 | ▁לא             | ▁הר          | ✗     |
|     9 | רי              | דוד          | ✗     |
|    10 | .               | ▁של          | ✗     |
|    11 | ▁הגוף           | ▁הכ          | ✗     |
|    12 | פת              | נר           | ✗     |
|    13 | .               | ת            | ✗     |
|    14 | ,               | ▁בסוף        | ✗     |
|    15 | .               | ▁החורף       | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | </s>            | ▁אנחנו       | ✗     |
|    18 | ▁צריכים         | ▁רואים       | ✗     |
|    19 | ▁את             | ▁ירידה       | ✗     |
|    20 | ,               | ▁עקב         | ✗     |
|    21 | ים              | ית           | ✗     |
|    22 | .               | ▁בכ          | ✗     |
|    23 | פה              | נר           | ✗     |
|    24 | ית              | ת            | ✗     |
|    25 | ,               | ▁וירד        | ✗     |
|    26 | ית              | ן            | ✗     |
|    27 | .               | ▁ויותר       | ✗     |
|    28 | .               | ▁בנג         | ✗     |
|    29 | יה              | ב            | ✗     |
|    30 | .               | ▁ו           | ✗     |
|    31 | סביב            | מרכז         | ✗     |
|    32 | .               | ▁הארץ        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 16:06:12,946 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:06:12,951 - TrainingLogger - INFO - Gradient norm: 16.1185
2024-12-31 16:06:19,675 - TrainingLogger - INFO - Step 2210, Batch metrics: Loss: 7.7007, Accuracy: 0.0820, Perplexity: 2209.8075
2024-12-31 16:06:26,812 - TrainingLogger - INFO - Step 2220, Batch metrics: Loss: 7.5734, Accuracy: 0.0765, Perplexity: 1945.7984
2024-12-31 16:06:34,732 - TrainingLogger - INFO - Step 2230, Batch metrics: Loss: 7.6666, Accuracy: 0.0625, Perplexity: 2135.8801
2024-12-31 16:06:41,501 - TrainingLogger - INFO - Step 2240, Batch metrics: Loss: 7.9545, Accuracy: 0.0582, Perplexity: 2848.3413
2024-12-31 16:06:48,479 - TrainingLogger - INFO - Step 2250, Batch metrics: Loss: 7.5754, Accuracy: 0.0342, Perplexity: 1949.7132
2024-12-31 16:06:54,938 - TrainingLogger - INFO - Step 2260, Batch metrics: Loss: 7.2937, Accuracy: 0.1008, Perplexity: 1471.0465
2024-12-31 16:07:02,020 - TrainingLogger - INFO - Step 2270, Batch metrics: Loss: 7.1484, Accuracy: 0.0996, Perplexity: 1272.0130
2024-12-31 16:07:02,858 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 379904
2024-12-31 16:07:02,858 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 379904

2024-12-31 16:07:02,858 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 53]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 53]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 64]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 64]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 55]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 55]), device: cuda:0
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:07:02,860 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:07:09,922 - TrainingLogger - INFO - Step 2280, Batch metrics: Loss: 7.0929, Accuracy: 0.0727, Perplexity: 1203.3860
2024-12-31 16:07:17,132 - TrainingLogger - INFO - Step 2290, Batch metrics: Loss: 7.1724, Accuracy: 0.1168, Perplexity: 1302.9114
2024-12-31 16:07:25,022 - TrainingLogger - INFO - Step 2300, Batch metrics: Loss: 8.0066, Accuracy: 0.0570, Perplexity: 3000.7071
2024-12-31 16:07:25,022 - TrainingLogger - INFO - Step 2300, Prediction vs Actual:
2024-12-31 16:07:25,022 - TrainingLogger - INFO - Input 1: אנגלמן הדגיש בתשובתו לרמטכל כי אין חולק על חשיבותה ותרומתה של הקמת ועדת חקירה ממלכתית לחקר האירועים, ואמר כי כשתוקם ייקבעו גבולות הגזרה בין מבקר המדינה לבינה
2024-12-31 16:07:25,023 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:07:25,023 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אנג         | ✗     |
|     1 | ▁-              | למן          | ✗     |
|     2 | :               | ▁הדגיש       | ✗     |
|     3 | ▁את             | ▁ב           | ✗     |
|     4 | -19             | תשובת        | ✗     |
|     5 | ו               | ו            | ✓     |
|     6 | ▁של             | ▁לר          | ✗     |
|     7 | צות             | מט           | ✗     |
|     8 | ▁את             | כל           | ✗     |
|     9 | ▁את             | ▁כי          | ✗     |
|    10 | ון              | ▁אין         | ✗     |
|    11 | ▁ברירה          | ▁חולק        | ✗     |
|    12 | ▁על             | ▁על          | ✓     |
|    13 | ▁כך             | ▁חשיבות      | ✗     |
|    14 | ו               | ה            | ✗     |
|    15 | .               | ▁ותר         | ✗     |
|    16 | ה               | ומת          | ✗     |
|    17 | ה               | ה            | ✓     |
|    18 | .               | ▁של          | ✗     |
|    19 | ▁המדינה         | ▁הקמת        | ✗     |
|    20 | ו               | ▁ועדת        | ✗     |
|    21 | ▁הבחירות        | ▁חקירה       | ✗     |
|    22 | ▁חדשה           | ▁ממלכת       | ✗     |
|    23 | ית              | ית           | ✓     |
|    24 | .               | ▁לחקר        | ✗     |
|    25 | ▁הסביבה         | ▁האירועים    | ✗     |
|    26 | .               | ,            | ✗     |
|    27 | </s>            | ▁ואמר        | ✗     |
|    28 | ות              | ▁כי          | ✗     |
|    29 | ▁"              | ▁כ           | ✗     |
|    30 | ונה             | שתוק         | ✗     |
|    31 | ה               | ם            | ✗     |
|    32 | ▁ל              | ▁יי          | ✗     |
|    33 | אמר             | קבע          | ✗     |
|    34 | ו               | ו            | ✓     |
|    35 | ▁כי             | ▁גבולות      | ✗     |
|    36 | .               | ▁הגזר        | ✗     |
|    37 | ה               | ה            | ✓     |
|    38 | ▁שלהם           | ▁בין         | ✗     |
|    39 | ▁המדינות        | ▁מבקר        | ✗     |
|    40 | י               | ▁המדינה      | ✗     |
|    41 | .               | ▁לב          | ✗     |
|    42 | ינה             | ינה          | ✓     |
|    43 | ם               |              | ✗     |

2024-12-31 16:07:25,023 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:07:25,028 - TrainingLogger - INFO - Gradient norm: 15.1250
2024-12-31 16:07:32,135 - TrainingLogger - INFO - Step 2310, Batch metrics: Loss: 7.0132, Accuracy: 0.0750, Perplexity: 1111.1600
2024-12-31 16:07:39,030 - TrainingLogger - INFO - Step 2320, Batch metrics: Loss: 7.8007, Accuracy: 0.0644, Perplexity: 2442.2788
2024-12-31 16:07:46,369 - TrainingLogger - INFO - Step 2330, Batch metrics: Loss: 7.3891, Accuracy: 0.0952, Perplexity: 1618.2368
2024-12-31 16:07:53,884 - TrainingLogger - INFO - Step 2340, Batch metrics: Loss: 7.6546, Accuracy: 0.0394, Perplexity: 2110.3804
2024-12-31 16:08:01,384 - TrainingLogger - INFO - Step 2350, Batch metrics: Loss: 7.2913, Accuracy: 0.0705, Perplexity: 1467.4307
2024-12-31 16:08:08,053 - TrainingLogger - INFO - Step 2360, Batch metrics: Loss: 7.4429, Accuracy: 0.0752, Perplexity: 1707.6232
2024-12-31 16:08:14,907 - TrainingLogger - INFO - Step 2370, Batch metrics: Loss: 7.3494, Accuracy: 0.0718, Perplexity: 1555.2780
2024-12-31 16:08:22,499 - TrainingLogger - INFO - Step 2380, Batch metrics: Loss: 7.5090, Accuracy: 0.0856, Perplexity: 1824.4218
2024-12-31 16:08:28,999 - TrainingLogger - INFO - Step 2390, Batch metrics: Loss: 8.0077, Accuracy: 0.0329, Perplexity: 3003.8910
2024-12-31 16:08:36,262 - TrainingLogger - INFO - Step 2400, Batch metrics: Loss: 8.0896, Accuracy: 0.0523, Perplexity: 3260.4347
2024-12-31 16:08:36,263 - TrainingLogger - INFO - Step 2400, Prediction vs Actual:
2024-12-31 16:08:36,263 - TrainingLogger - INFO - Input 1: הוא צריך אותו הערב במלוא האנרגיות ורעב מתמיד
2024-12-31 16:08:36,263 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:08:36,263 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כמונו          | ▁הוא         | ✗     |
|     1 | ,               | ▁צריך        | ✗     |
|     2 | ▁להיות          | ▁אותו        | ✗     |
|     3 | ▁כדי            | ▁הערב        | ✗     |
|     4 | </s>            | ▁במלוא       | ✗     |
|     5 | ו               | ▁האנ         | ✗     |
|     6 | רס              | רג           | ✗     |
|     7 | ות              | יות          | ✗     |
|     8 | ▁שלו            | ▁ו           | ✗     |
|     9 | .               | רעב          | ✗     |
|    10 | </s>            | ▁מתמיד       | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁שלו            | <pad>        | ✗     |
|    28 | ▁שלו            | <pad>        | ✗     |
|    29 | ▁שלו            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | רי              | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁שלו            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 16:08:36,263 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:08:36,269 - TrainingLogger - INFO - Gradient norm: 12.3873
2024-12-31 16:08:42,913 - TrainingLogger - INFO - Step 2410, Batch metrics: Loss: 7.6768, Accuracy: 0.0595, Perplexity: 2157.7530
2024-12-31 16:08:50,330 - TrainingLogger - INFO - Step 2420, Batch metrics: Loss: 6.8108, Accuracy: 0.0960, Perplexity: 907.6304
2024-12-31 16:08:57,803 - TrainingLogger - INFO - Step 2430, Batch metrics: Loss: 7.5826, Accuracy: 0.0524, Perplexity: 1963.7629
2024-12-31 16:09:05,100 - TrainingLogger - INFO - Step 2440, Batch metrics: Loss: 7.1013, Accuracy: 0.0591, Perplexity: 1213.5972
2024-12-31 16:09:12,430 - TrainingLogger - INFO - Step 2450, Batch metrics: Loss: 7.0588, Accuracy: 0.0952, Perplexity: 1163.0401
2024-12-31 16:09:19,983 - TrainingLogger - INFO - Step 2460, Batch metrics: Loss: 7.8170, Accuracy: 0.0625, Perplexity: 2482.4419
2024-12-31 16:09:27,634 - TrainingLogger - INFO - Step 2470, Batch metrics: Loss: 7.5792, Accuracy: 0.0796, Perplexity: 1957.0931
2024-12-31 16:09:34,749 - TrainingLogger - INFO - Step 2480, Batch metrics: Loss: 7.5900, Accuracy: 0.0838, Perplexity: 1978.3402
2024-12-31 16:09:41,377 - TrainingLogger - INFO - Step 2490, Batch metrics: Loss: 7.8044, Accuracy: 0.0429, Perplexity: 2451.3233
2024-12-31 16:09:49,053 - TrainingLogger - INFO - Step 2500, Batch metrics: Loss: 7.3765, Accuracy: 0.0804, Perplexity: 1597.9484
2024-12-31 16:09:49,053 - TrainingLogger - INFO - Step 2500, Prediction vs Actual:
2024-12-31 16:09:49,054 - TrainingLogger - INFO - Input 1: יש על השולחן הצעות שקיבלו שס ויהדות התורה, אמר ליברמן
2024-12-31 16:09:49,054 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:09:49,054 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁בספרדית        | ▁יש          | ✗     |
|     1 | ,               | ▁על          | ✗     |
|     2 | ,               | ▁השולחן      | ✗     |
|     3 | .               | ▁הצעות       | ✗     |
|     4 | .               | ▁שקיבלו      | ✗     |
|     5 | .               | ▁שס          | ✗     |
|     6 | ה               | ▁ויה         | ✗     |
|     7 | ▁הייתה          | דות          | ✗     |
|     8 | ▁לו             | ▁התורה       | ✗     |
|     9 | </s>            | ,            | ✗     |
|    10 | <pad>           | ▁אמר         | ✗     |
|    11 | :               | ▁לי          | ✗     |
|    12 | ,               | ברמן         | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 16:09:49,054 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:09:49,059 - TrainingLogger - INFO - Gradient norm: 14.4627
2024-12-31 16:09:56,135 - TrainingLogger - INFO - Step 2510, Batch metrics: Loss: 7.4957, Accuracy: 0.0795, Perplexity: 1800.3478
2024-12-31 16:10:03,684 - TrainingLogger - INFO - Step 2520, Batch metrics: Loss: 7.8466, Accuracy: 0.0576, Perplexity: 2556.9709
2024-12-31 16:10:10,238 - TrainingLogger - INFO - Step 2530, Batch metrics: Loss: 7.7222, Accuracy: 0.0411, Perplexity: 2257.9967
2024-12-31 16:10:10,959 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 16:10:10,959 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 16:10:10,959 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - input_ids_2 min: 6, max: 151643
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 16:10:10,960 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:10:10,961 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 16:10:10,961 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:10:10,961 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:10:18,524 - TrainingLogger - INFO - Step 2540, Batch metrics: Loss: 7.6270, Accuracy: 0.0625, Perplexity: 2052.9043
2024-12-31 16:10:25,079 - TrainingLogger - INFO - Step 2550, Batch metrics: Loss: 7.7184, Accuracy: 0.0476, Perplexity: 2249.2558
2024-12-31 16:10:31,796 - TrainingLogger - INFO - Step 2560, Batch metrics: Loss: 7.8636, Accuracy: 0.0568, Perplexity: 2600.9653
2024-12-31 16:10:38,688 - TrainingLogger - INFO - Step 2570, Batch metrics: Loss: 7.3718, Accuracy: 0.0667, Perplexity: 1590.4235
2024-12-31 16:10:46,065 - TrainingLogger - INFO - Step 2580, Batch metrics: Loss: 7.4992, Accuracy: 0.0652, Perplexity: 1806.5446
2024-12-31 16:10:52,801 - TrainingLogger - INFO - Step 2590, Batch metrics: Loss: 7.3224, Accuracy: 0.0658, Perplexity: 1513.7774
2024-12-31 16:10:59,977 - TrainingLogger - INFO - Step 2600, Batch metrics: Loss: 7.4734, Accuracy: 0.0829, Perplexity: 1760.5307
2024-12-31 16:10:59,978 - TrainingLogger - INFO - Step 2600, Prediction vs Actual:
2024-12-31 16:10:59,978 - TrainingLogger - INFO - Input 1: בליכוד יש מקום ריאלי, וביש עתיד יש בחורה מהקהילה פנינה תמנו שטה וג שהיא פעילה מאוד
2024-12-31 16:10:59,978 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:10:59,978 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בלי         | ✗     |
|     1 | .               | כו           | ✗     |
|     2 | ד               | ד            | ✓     |
|     3 | </s>            | ▁יש          | ✗     |
|     4 | ה               | ▁מקום        | ✗     |
|     5 | ▁אחר            | ▁ריאלי       | ✗     |
|     6 | ה               | ,            | ✗     |
|     7 | </s>            | ▁וב          | ✗     |
|     8 | ירי             | יש           | ✗     |
|     9 | ה               | ▁עתיד        | ✗     |
|    10 | ה               | ▁יש          | ✗     |
|    11 | ▁לנו            | ▁בחורה       | ✗     |
|    12 | ▁חדשה           | ▁מה          | ✗     |
|    13 | יחידה           | קהילה        | ✗     |
|    14 | ▁הזאת           | ▁פני         | ✗     |
|    15 | נה              | נה           | ✓     |
|    16 | ל               | ▁ת           | ✗     |
|    17 | מדי             | מנו          | ✗     |
|    18 | נים             | ▁ש           | ✗     |
|    19 | ייט             | טה           | ✗     |
|    20 | </s>            | ▁וג          | ✗     |
|    21 | '               | ▁שהיא        | ✗     |
|    22 | </s>            | ▁פעילה       | ✗     |
|    23 | </s>            | ▁מאוד        | ✗     |
|    24 | ▁חשובה          | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 16:10:59,978 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:10:59,984 - TrainingLogger - INFO - Gradient norm: 10.5685
2024-12-31 16:11:07,067 - TrainingLogger - INFO - Step 2610, Batch metrics: Loss: 7.5671, Accuracy: 0.0683, Perplexity: 1933.5130
2024-12-31 16:11:13,766 - TrainingLogger - INFO - Step 2620, Batch metrics: Loss: 7.4629, Accuracy: 0.0733, Perplexity: 1742.2748
2024-12-31 16:11:21,035 - TrainingLogger - INFO - Step 2630, Batch metrics: Loss: 7.1010, Accuracy: 0.0625, Perplexity: 1213.1228
2024-12-31 16:11:28,274 - TrainingLogger - INFO - Step 2640, Batch metrics: Loss: 7.4396, Accuracy: 0.1018, Perplexity: 1702.1025
2024-12-31 16:11:35,428 - TrainingLogger - INFO - Step 2650, Batch metrics: Loss: 7.2032, Accuracy: 0.0966, Perplexity: 1343.7499
2024-12-31 16:11:42,782 - TrainingLogger - INFO - Step 2660, Batch metrics: Loss: 7.3495, Accuracy: 0.0638, Perplexity: 1555.4768
2024-12-31 16:11:50,289 - TrainingLogger - INFO - Step 2670, Batch metrics: Loss: 7.6797, Accuracy: 0.0609, Perplexity: 2164.0384
2024-12-31 16:11:57,799 - TrainingLogger - INFO - Step 2680, Batch metrics: Loss: 7.4092, Accuracy: 0.0966, Perplexity: 1651.0769
2024-12-31 16:12:05,259 - TrainingLogger - INFO - Step 2690, Batch metrics: Loss: 7.6623, Accuracy: 0.0533, Perplexity: 2126.6819
2024-12-31 16:12:12,558 - TrainingLogger - INFO - Step 2700, Batch metrics: Loss: 7.4162, Accuracy: 0.0678, Perplexity: 1662.7431
2024-12-31 16:12:12,558 - TrainingLogger - INFO - Step 2700, Prediction vs Actual:
2024-12-31 16:12:12,558 - TrainingLogger - INFO - Input 1: במהלך המסע השיל סאבין ארבעה קילוגרמים
2024-12-31 16:12:12,558 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:12:12,558 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הזה            | ▁במהלך       | ✗     |
|     1 | ,               | ▁המסע        | ✗     |
|     2 | .               | ▁השי         | ✗     |
|     3 | י               | ל            | ✗     |
|     4 | .               | ▁סאב         | ✗     |
|     5 | ה               | ין           | ✗     |
|     6 | ,               | ▁ארבעה       | ✗     |
|     7 | ▁חודשים         | ▁קילוגרמים   | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ו               | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | ה               | <pad>        | ✗     |
|    13 | נים             | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ה               | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ▁(              | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ▁(              | <pad>        | ✗     |
|    27 | ה               |              | ✗     |

2024-12-31 16:12:12,558 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:12:12,563 - TrainingLogger - INFO - Gradient norm: 16.8427
2024-12-31 16:12:20,117 - TrainingLogger - INFO - Step 2710, Batch metrics: Loss: 7.3538, Accuracy: 0.0877, Perplexity: 1562.1650
2024-12-31 16:12:27,546 - TrainingLogger - INFO - Step 2720, Batch metrics: Loss: 7.5546, Accuracy: 0.0435, Perplexity: 1909.4603
2024-12-31 16:12:34,659 - TrainingLogger - INFO - Step 2730, Batch metrics: Loss: 6.9470, Accuracy: 0.0833, Perplexity: 1040.0012
2024-12-31 16:12:41,770 - TrainingLogger - INFO - Step 2740, Batch metrics: Loss: 7.1400, Accuracy: 0.1186, Perplexity: 1261.3825
2024-12-31 16:12:48,210 - TrainingLogger - INFO - Step 2750, Batch metrics: Loss: 7.1936, Accuracy: 0.0962, Perplexity: 1330.9298
2024-12-31 16:12:55,199 - TrainingLogger - INFO - Step 2760, Batch metrics: Loss: 7.6016, Accuracy: 0.0410, Perplexity: 2001.3177
2024-12-31 16:13:02,333 - TrainingLogger - INFO - Step 2770, Batch metrics: Loss: 8.0077, Accuracy: 0.0595, Perplexity: 3003.8709
2024-12-31 16:13:08,785 - TrainingLogger - INFO - Step 2780, Batch metrics: Loss: 7.6518, Accuracy: 0.0610, Perplexity: 2104.5278
2024-12-31 16:13:16,014 - TrainingLogger - INFO - Step 2790, Batch metrics: Loss: 7.2457, Accuracy: 0.0816, Perplexity: 1402.0020
2024-12-31 16:13:23,233 - TrainingLogger - INFO - Step 2800, Batch metrics: Loss: 7.9705, Accuracy: 0.0642, Perplexity: 2894.1992
2024-12-31 16:13:23,233 - TrainingLogger - INFO - Step 2800, Prediction vs Actual:
2024-12-31 16:13:23,233 - TrainingLogger - INFO - Input 1: למעט גורמי ממשל, רק בני מלוכה גברים יורשו להשתתף בטקס - מסורת שהממשלה דבקה בה למרות הביקורת שנמתחת על כך בציבור
2024-12-31 16:13:23,234 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:13:23,234 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁למעט        | ✗     |
|     1 | ...             | ▁גורמי       | ✗     |
|     2 | ה               | ▁ממש         | ✗     |
|     3 | יים             | ל            | ✗     |
|     4 | .               | ,            | ✗     |
|     5 | <pad>           | ▁רק          | ✗     |
|     6 | ▁לחשוב          | ▁בני         | ✗     |
|     7 | ▁אדם            | ▁מל          | ✗     |
|     8 | ה               | וכה          | ✗     |
|     9 | .               | ▁גברים       | ✗     |
|    10 | .               | ▁יורש        | ✗     |
|    11 | י               | ו            | ✗     |
|    12 | ▁לי             | ▁להשתתף      | ✗     |
|    13 | .               | ▁בטקס        | ✗     |
|    14 | .               | ▁-           | ✗     |
|    15 | -               | ▁מסורת       | ✗     |
|    16 | ▁חדשה           | ▁שהממשלה     | ✗     |
|    17 | ▁שלהם           | ▁דבק         | ✗     |
|    18 | ה               | ה            | ✓     |
|    19 | ▁ב              | ▁בה          | ✗     |
|    20 | מש              | ▁למרות       | ✗     |
|    21 | ▁כל             | ▁הביקורת     | ✗     |
|    22 | .               | ▁שנ          | ✗     |
|    23 | גזר             | מתחת         | ✗     |
|    24 | ▁ל              | ▁על          | ✗     |
|    25 | ▁פני            | ▁כך          | ✗     |
|    26 | .               | ▁בציבור      | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               |              | ✗     |

2024-12-31 16:13:23,234 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:13:23,238 - TrainingLogger - INFO - Gradient norm: 14.1439
2024-12-31 16:13:32,304 - TrainingLogger - INFO - Step 2810, Batch metrics: Loss: 7.1641, Accuracy: 0.1024, Perplexity: 1292.1521
2024-12-31 16:13:39,236 - TrainingLogger - INFO - Step 2820, Batch metrics: Loss: 7.2819, Accuracy: 0.0512, Perplexity: 1453.7557
2024-12-31 16:13:46,927 - TrainingLogger - INFO - Step 2830, Batch metrics: Loss: 6.9617, Accuracy: 0.0794, Perplexity: 1055.3885
2024-12-31 16:13:54,299 - TrainingLogger - INFO - Step 2840, Batch metrics: Loss: 7.5988, Accuracy: 0.0366, Perplexity: 1995.7066
2024-12-31 16:14:02,166 - TrainingLogger - INFO - Step 2850, Batch metrics: Loss: 7.5512, Accuracy: 0.0667, Perplexity: 1903.0829
2024-12-31 16:14:09,193 - TrainingLogger - INFO - Step 2860, Batch metrics: Loss: 7.6449, Accuracy: 0.0561, Perplexity: 2090.0021
2024-12-31 16:14:16,248 - TrainingLogger - INFO - Step 2870, Batch metrics: Loss: 7.5697, Accuracy: 0.0570, Perplexity: 1938.6330
2024-12-31 16:14:22,829 - TrainingLogger - INFO - Step 2880, Batch metrics: Loss: 7.4528, Accuracy: 0.0949, Perplexity: 1724.7320
2024-12-31 16:14:29,861 - TrainingLogger - INFO - Step 2890, Batch metrics: Loss: 7.4976, Accuracy: 0.0814, Perplexity: 1803.6526
2024-12-31 16:14:36,714 - TrainingLogger - INFO - Step 2900, Batch metrics: Loss: 7.0025, Accuracy: 0.0939, Perplexity: 1099.3672
2024-12-31 16:14:36,714 - TrainingLogger - INFO - Step 2900, Prediction vs Actual:
2024-12-31 16:14:36,714 - TrainingLogger - INFO - Input 1: רעם זו הפעם הראשונה זה שנים שמפלגת רעם רצה לבדה ולא יחד עם מפלגה נוספת או במסגרת הרשימה המשותפת
2024-12-31 16:14:36,715 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:14:36,715 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁רע          | ✗     |
|     1 | .               | ם            | ✗     |
|     2 | .               | ▁זו          | ✗     |
|     3 | .               | ▁הפעם        | ✗     |
|     4 | ▁הראשונה        | ▁הראשונה     | ✓     |
|     5 | .               | ▁זה          | ✗     |
|     6 | .               | ▁שנים        | ✗     |
|     7 | .               | ▁ש           | ✗     |
|     8 | .               | מפלגת        | ✗     |
|     9 | י               | ▁רע          | ✗     |
|    10 | ינו             | ם            | ✗     |
|    11 | <pad>           | ▁רצה         | ✗     |
|    12 | ▁לעשות          | ▁לבדה        | ✗     |
|    13 | .               | ▁ולא         | ✗     |
|    14 | ▁היה            | ▁יחד         | ✗     |
|    15 | ▁עם             | ▁עם          | ✓     |
|    16 | ▁ישראל          | ▁מפל         | ✗     |
|    17 | ה               | גה           | ✗     |
|    18 | ▁זו             | ▁נוספת       | ✗     |
|    19 | .               | ▁או          | ✗     |
|    20 | ▁לא             | ▁במסגרת      | ✗     |
|    21 | ה               | ▁הרשימה      | ✗     |
|    22 | .               | ▁המשותפת     | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ▁שלה            | <pad>        | ✗     |
|    26 | ▁הזאת           | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ▁הזאת           | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 16:14:36,715 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:14:36,720 - TrainingLogger - INFO - Gradient norm: 9.4026
2024-12-31 16:14:43,753 - TrainingLogger - INFO - Step 2910, Batch metrics: Loss: 7.1991, Accuracy: 0.0987, Perplexity: 1338.2705
2024-12-31 16:14:51,037 - TrainingLogger - INFO - Step 2920, Batch metrics: Loss: 7.6001, Accuracy: 0.0743, Perplexity: 1998.4739
2024-12-31 16:14:58,158 - TrainingLogger - INFO - Step 2930, Batch metrics: Loss: 7.4787, Accuracy: 0.0987, Perplexity: 1769.8846
2024-12-31 16:15:05,189 - TrainingLogger - INFO - Step 2940, Batch metrics: Loss: 7.4276, Accuracy: 0.0821, Perplexity: 1681.8233
2024-12-31 16:15:12,544 - TrainingLogger - INFO - Step 2950, Batch metrics: Loss: 7.3649, Accuracy: 0.1046, Perplexity: 1579.5275
2024-12-31 16:15:20,107 - TrainingLogger - INFO - Step 2960, Batch metrics: Loss: 7.3458, Accuracy: 0.0815, Perplexity: 1549.7229
2024-12-31 16:15:27,164 - TrainingLogger - INFO - Step 2970, Batch metrics: Loss: 7.3648, Accuracy: 0.0628, Perplexity: 1579.3550
2024-12-31 16:15:34,389 - TrainingLogger - INFO - Step 2980, Batch metrics: Loss: 7.5204, Accuracy: 0.0408, Perplexity: 1845.2798
2024-12-31 16:15:41,557 - TrainingLogger - INFO - Step 2990, Batch metrics: Loss: 7.8019, Accuracy: 0.0647, Perplexity: 2445.2013
2024-12-31 16:15:49,133 - TrainingLogger - INFO - Step 3000, Batch metrics: Loss: 7.5801, Accuracy: 0.0888, Perplexity: 1958.8661
2024-12-31 16:15:49,133 - TrainingLogger - INFO - Step 3000, Prediction vs Actual:
2024-12-31 16:15:49,133 - TrainingLogger - INFO - Input 1: במקרה כזה, אגב, נתניהו עשוי שלא להיאבק בניסיון לקיום פריימריז, ולפי ההערכה - אם התרחיש שאליו הוא מכוון יתממש, הוא מתכונן לפריימריז מול סער ויאפשר התמודדות
2024-12-31 16:15:49,134 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:15:49,134 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁במקרה       | ✗     |
|     1 | ▁אחר            | ▁כזה         | ✗     |
|     2 | ▁יותר           | ,            | ✗     |
|     3 | ▁אני            | ▁אגב         | ✗     |
|     4 | ה               | ,            | ✗     |
|     5 | ▁אני            | ▁נתנ         | ✗     |
|     6 | ים              | יהו          | ✗     |
|     7 | ▁גם             | ▁עשוי        | ✗     |
|     8 | ▁להיות          | ▁שלא         | ✗     |
|     9 | ▁היה            | ▁להיאבק      | ✗     |
|    10 | ▁על             | ▁בניסיון     | ✗     |
|    11 | ▁זה             | ▁לקיום       | ✗     |
|    12 | .               | ▁פריי        | ✗     |
|    13 | ה               | מר           | ✗     |
|    14 | ,               | יז           | ✗     |
|    15 | ,               | ,            | ✓     |
|    16 | </s>            | ▁ולפי        | ✗     |
|    17 | ו               | ▁ההערכה      | ✗     |
|    18 | ▁שלו            | ▁-           | ✗     |
|    19 | </s>            | ▁אם          | ✗     |
|    20 | ▁כן             | ▁התר         | ✗     |
|    21 | ח               | ח            | ✓     |
|    22 | ח               | יש           | ✗     |
|    23 | ה               | ▁שאליו       | ✗     |
|    24 | ▁הגיע           | ▁הוא         | ✗     |
|    25 | ▁מגיע           | ▁מכוון       | ✗     |
|    26 | ,               | ▁ית          | ✗     |
|    27 | פרסם            | ממש          | ✗     |
|    28 | ▁בקרוב          | ,            | ✗     |
|    29 | </s>            | ▁הוא         | ✗     |
|    30 | ▁י              | ▁מתכונן      | ✗     |
|    31 | ▁ל              | ▁לפר         | ✗     |
|    32 | ך               | יימר         | ✗     |
|    33 | ציה             | יז           | ✗     |
|    34 | ,               | ▁מול         | ✗     |
|    35 | ם               | ▁סע          | ✗     |
|    36 | ר               | ר            | ✓     |
|    37 | ,               | ▁וי          | ✗     |
|    38 | מש              | אפשר         | ✗     |
|    39 | ▁לו             | ▁התמודדות    | ✗     |
|    40 | .               |              | ✗     |

2024-12-31 16:15:49,134 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:15:49,139 - TrainingLogger - INFO - Gradient norm: 12.1231
2024-12-31 16:15:55,967 - TrainingLogger - INFO - Step 3010, Batch metrics: Loss: 7.6752, Accuracy: 0.0909, Perplexity: 2154.2596
2024-12-31 16:16:03,127 - TrainingLogger - INFO - Step 3020, Batch metrics: Loss: 7.5941, Accuracy: 0.0657, Perplexity: 1986.3513
2024-12-31 16:16:10,336 - TrainingLogger - INFO - Step 3030, Batch metrics: Loss: 7.1887, Accuracy: 0.0870, Perplexity: 1324.3339
2024-12-31 16:16:17,327 - TrainingLogger - INFO - Step 3040, Batch metrics: Loss: 7.1932, Accuracy: 0.1111, Perplexity: 1330.3917
2024-12-31 16:16:25,004 - TrainingLogger - INFO - Step 3050, Batch metrics: Loss: 7.0732, Accuracy: 0.0625, Perplexity: 1179.8859
2024-12-31 16:16:31,923 - TrainingLogger - INFO - Step 3060, Batch metrics: Loss: 7.4997, Accuracy: 0.0819, Perplexity: 1807.4528
2024-12-31 16:16:40,015 - TrainingLogger - INFO - Step 3070, Batch metrics: Loss: 7.4822, Accuracy: 0.0615, Perplexity: 1776.1460
2024-12-31 16:16:47,458 - TrainingLogger - INFO - Step 3080, Batch metrics: Loss: 7.3260, Accuracy: 0.0653, Perplexity: 1519.3427
2024-12-31 16:16:55,240 - TrainingLogger - INFO - Step 3090, Batch metrics: Loss: 7.3271, Accuracy: 0.0874, Perplexity: 1520.9672
2024-12-31 16:17:02,560 - TrainingLogger - INFO - Step 3100, Batch metrics: Loss: 7.3133, Accuracy: 0.0747, Perplexity: 1500.1404
2024-12-31 16:17:02,561 - TrainingLogger - INFO - Step 3100, Prediction vs Actual:
2024-12-31 16:17:02,561 - TrainingLogger - INFO - Input 1: כידוע מדינת ישראל מתמודדת עם גל הגירה ממדינות מאפריקה, כיום חיים בישראל כ- 39,000 מבקשי מקלט מאריתראה, רובם נשים עם ילדים ועוד כ- 10,000 מסודן ועוד אלפים בודדים ממדינות שונות
2024-12-31 16:17:02,562 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:17:02,562 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כידוע       | ✗     |
|     1 | ▁ל              | ▁מדינת       | ✗     |
|     2 | ה               | ▁ישראל       | ✗     |
|     3 | ה               | ▁מתמודדת     | ✗     |
|     4 | ▁המדינה         | ▁עם          | ✗     |
|     5 | ▁הנשיא          | ▁גל          | ✗     |
|     6 | אס              | ▁הגיר        | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | ▁של             | ▁מ           | ✗     |
|     9 | מאי             | מדינות       | ✗     |
|    10 | ▁אחרות          | ▁מ           | ✗     |
|    11 | ונות            | אפריקה       | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | </s>            | ▁כיום        | ✗     |
|    14 | ▁הוא            | ▁חיים        | ✗     |
|    15 | ▁חיים           | ▁בישראל      | ✗     |
|    16 | ות              | ▁כ           | ✗     |
|    17 | מדינה           | -            | ✗     |
|    18 | 27              | ▁39          | ✗     |
|    19 | .               | ,            | ✗     |
|    20 | </s>            | 000          | ✗     |
|    21 | ▁צרפת           | ▁מבקש        | ✗     |
|    22 | ת               | י            | ✗     |
|    23 | ▁מלחמה          | ▁מקלט        | ✗     |
|    24 | ים              | ▁מארי        | ✗     |
|    25 | נים             | תראה         | ✗     |
|    26 | ,               | ,            | ✓     |
|    27 | </s>            | ▁רובם        | ✗     |
|    28 | ▁אמריקאים       | ▁נשים        | ✗     |
|    29 | ▁אחרות          | ▁עם          | ✗     |
|    30 | ▁נשים           | ▁ילדים       | ✗     |
|    31 | .               | ▁ועוד        | ✗     |
|    32 | ▁נשים           | ▁כ           | ✗     |
|    33 | סוכנים          | -            | ✗     |
|    34 | מ               | ▁10,000      | ✗     |
|    35 | ▁חיילים         | ▁מסו         | ✗     |
|    36 | מנים            | דן           | ✗     |
|    37 | .               | ▁ועוד        | ✗     |
|    38 | ▁חיילים         | ▁אלפים       | ✗     |
|    39 | .               | ▁בודדים      | ✗     |
|    40 | .               | ▁מ           | ✗     |
|    41 | מדינות          | מדינות       | ✓     |
|    42 | ▁אחרות          | ▁שונות       | ✗     |
|    43 | .               |              | ✗     |

2024-12-31 16:17:02,562 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:17:02,567 - TrainingLogger - INFO - Gradient norm: 13.4515
2024-12-31 16:17:09,818 - TrainingLogger - INFO - Step 3110, Batch metrics: Loss: 7.6549, Accuracy: 0.0515, Perplexity: 2110.8846
2024-12-31 16:17:17,049 - TrainingLogger - INFO - Step 3120, Batch metrics: Loss: 7.6772, Accuracy: 0.0696, Perplexity: 2158.5454
2024-12-31 16:17:24,236 - TrainingLogger - INFO - Step 3130, Batch metrics: Loss: 7.7278, Accuracy: 0.0896, Perplexity: 2270.6022
2024-12-31 16:17:30,938 - TrainingLogger - INFO - Step 3140, Batch metrics: Loss: 7.6047, Accuracy: 0.0274, Perplexity: 2007.5752
2024-12-31 16:17:37,976 - TrainingLogger - INFO - Step 3150, Batch metrics: Loss: 7.5929, Accuracy: 0.0714, Perplexity: 1983.9621
2024-12-31 16:17:41,312 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 215040
2024-12-31 16:17:41,312 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 215040

2024-12-31 16:17:41,312 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:17:41,313 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:17:45,801 - TrainingLogger - INFO - Step 3160, Batch metrics: Loss: 7.8502, Accuracy: 0.0545, Perplexity: 2566.2198
2024-12-31 16:17:53,183 - TrainingLogger - INFO - Step 3170, Batch metrics: Loss: 6.8515, Accuracy: 0.1288, Perplexity: 945.3222
2024-12-31 16:18:01,140 - TrainingLogger - INFO - Step 3180, Batch metrics: Loss: 7.3166, Accuracy: 0.0682, Perplexity: 1505.0132
2024-12-31 16:18:04,793 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 179200
2024-12-31 16:18:04,793 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 179200

2024-12-31 16:18:04,793 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 25]), device: cuda:0
2024-12-31 16:18:04,793 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 25]), device: cuda:0
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 19]), device: cuda:0
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 19]), device: cuda:0
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:18:04,794 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:18:08,940 - TrainingLogger - INFO - Step 3190, Batch metrics: Loss: 8.0165, Accuracy: 0.0450, Perplexity: 3030.5243
2024-12-31 16:18:15,918 - TrainingLogger - INFO - Step 3200, Batch metrics: Loss: 7.5763, Accuracy: 0.0556, Perplexity: 1951.4115
2024-12-31 16:18:15,918 - TrainingLogger - INFO - Step 3200, Prediction vs Actual:
2024-12-31 16:18:15,918 - TrainingLogger - INFO - Input 1: בנתינה לארגון טרור יש ויתורים כואבים
2024-12-31 16:18:15,919 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:18:15,919 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | עים             | ▁ב           | ✗     |
|     1 | ▁'              | נת           | ✗     |
|     2 | ון              | ינה          | ✗     |
|     3 | .               | ▁לארגון      | ✗     |
|     4 | ה               | ▁טרור        | ✗     |
|     5 | ה               | ▁יש          | ✗     |
|     6 | ▁לנו            | ▁וית         | ✗     |
|     7 | עה              | ורים         | ✗     |
|     8 | .               | ▁כואב        | ✗     |
|     9 | ים              | ים           | ✓     |
|    10 | .               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ו               | <pad>        | ✗     |
|    29 | ים              |              | ✗     |

2024-12-31 16:18:15,919 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:18:15,924 - TrainingLogger - INFO - Gradient norm: 12.5390
2024-12-31 16:18:23,361 - TrainingLogger - INFO - Step 3210, Batch metrics: Loss: 6.6052, Accuracy: 0.0872, Perplexity: 738.9187
2024-12-31 16:18:30,268 - TrainingLogger - INFO - Step 3220, Batch metrics: Loss: 7.4873, Accuracy: 0.0698, Perplexity: 1785.2398
2024-12-31 16:18:37,149 - TrainingLogger - INFO - Step 3230, Batch metrics: Loss: 7.6725, Accuracy: 0.0394, Perplexity: 2148.5066
2024-12-31 16:18:44,587 - TrainingLogger - INFO - Step 3240, Batch metrics: Loss: 7.4205, Accuracy: 0.0877, Perplexity: 1669.9029
2024-12-31 16:18:51,903 - TrainingLogger - INFO - Step 3250, Batch metrics: Loss: 7.1212, Accuracy: 0.0825, Perplexity: 1237.9116
2024-12-31 16:18:58,399 - TrainingLogger - INFO - Step 3260, Batch metrics: Loss: 7.9682, Accuracy: 0.0533, Perplexity: 2887.7106
2024-12-31 16:19:05,466 - TrainingLogger - INFO - Step 3270, Batch metrics: Loss: 7.9027, Accuracy: 0.0629, Perplexity: 2704.4728
2024-12-31 16:19:12,517 - TrainingLogger - INFO - Step 3280, Batch metrics: Loss: 7.1674, Accuracy: 0.0847, Perplexity: 1296.4148
2024-12-31 16:19:19,495 - TrainingLogger - INFO - Step 3290, Batch metrics: Loss: 7.6079, Accuracy: 0.0671, Perplexity: 2014.1242
2024-12-31 16:19:26,826 - TrainingLogger - INFO - Step 3300, Batch metrics: Loss: 6.9346, Accuracy: 0.0981, Perplexity: 1027.2042
2024-12-31 16:19:26,826 - TrainingLogger - INFO - Step 3300, Prediction vs Actual:
2024-12-31 16:19:26,827 - TrainingLogger - INFO - Input 1: הצוות הרפואי נחמד ואדיב מאוד, למעט רופא אחד חסר סבלנות שצועק לעברי, לא צריך, אל תבואי לפה
2024-12-31 16:19:26,827 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:19:26,827 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הצוות       | ✗     |
|     1 | ▁את             | ▁הרפואי      | ✗     |
|     2 | ,               | ▁נחמד        | ✗     |
|     3 | .               | ▁וא          | ✗     |
|     4 | מין             | דיב          | ✗     |
|     5 | ▁במיוחד         | ▁מאוד        | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | </s>            | ▁למעט        | ✗     |
|     8 | .               | ▁רופא        | ✗     |
|     9 | י               | ▁אחד         | ✗     |
|    10 | .               | ▁חסר         | ✗     |
|    11 | ▁חשיבות         | ▁סבלנות      | ✗     |
|    12 | .               | ▁ש           | ✗     |
|    13 | כמו             | צועק         | ✗     |
|    14 | ה               | ▁לעברי       | ✗     |
|    15 | :               | ,            | ✗     |
|    16 | </s>            | ▁לא          | ✗     |
|    17 | ▁רע             | ▁צריך        | ✗     |
|    18 | ▁להיות          | ,            | ✗     |
|    19 | ▁אבל            | ▁אל          | ✗     |
|    20 | .               | ▁תבואי       | ✗     |
|    21 | ▁איתנו          | ▁לפה         | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               |              | ✗     |

2024-12-31 16:19:26,827 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:19:26,832 - TrainingLogger - INFO - Gradient norm: 13.0561
2024-12-31 16:19:34,135 - TrainingLogger - INFO - Step 3310, Batch metrics: Loss: 7.1123, Accuracy: 0.0845, Perplexity: 1227.0160
2024-12-31 16:19:41,140 - TrainingLogger - INFO - Step 3320, Batch metrics: Loss: 7.4448, Accuracy: 0.0622, Perplexity: 1710.9853
2024-12-31 16:19:48,323 - TrainingLogger - INFO - Step 3330, Batch metrics: Loss: 7.4455, Accuracy: 0.0457, Perplexity: 1712.1475
2024-12-31 16:19:55,316 - TrainingLogger - INFO - Step 3340, Batch metrics: Loss: 7.9568, Accuracy: 0.0413, Perplexity: 2854.9606
2024-12-31 16:20:02,237 - TrainingLogger - INFO - Step 3350, Batch metrics: Loss: 7.0672, Accuracy: 0.0966, Perplexity: 1172.8020
2024-12-31 16:20:09,224 - TrainingLogger - INFO - Step 3360, Batch metrics: Loss: 7.1029, Accuracy: 0.0995, Perplexity: 1215.5362
2024-12-31 16:20:16,596 - TrainingLogger - INFO - Step 3370, Batch metrics: Loss: 7.8151, Accuracy: 0.0625, Perplexity: 2477.6407
2024-12-31 16:20:24,095 - TrainingLogger - INFO - Step 3380, Batch metrics: Loss: 7.1963, Accuracy: 0.0872, Perplexity: 1334.5375
2024-12-31 16:20:31,952 - TrainingLogger - INFO - Step 3390, Batch metrics: Loss: 7.4923, Accuracy: 0.0561, Perplexity: 1794.2356
2024-12-31 16:20:38,918 - TrainingLogger - INFO - Step 3400, Batch metrics: Loss: 7.2145, Accuracy: 0.1400, Perplexity: 1359.0561
2024-12-31 16:20:38,919 - TrainingLogger - INFO - Step 3400, Prediction vs Actual:
2024-12-31 16:20:38,919 - TrainingLogger - INFO - Input 1: הגיפים שלי ושל המחט היו בקו אש ראשון
2024-12-31 16:20:38,919 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:20:38,919 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלו            | ▁הג          | ✗     |
|     1 | י               | יפים         | ✗     |
|     2 | ▁של             | ▁שלי         | ✗     |
|     3 | .               | ▁ושל         | ✗     |
|     4 | ו               | ▁המחט        | ✗     |
|     5 | ים              | ▁היו         | ✗     |
|     6 | יים             | ▁בקו         | ✗     |
|     7 | ה               | ▁אש          | ✗     |
|     8 | .               | ▁ראשון       | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               |              | ✗     |

2024-12-31 16:20:38,919 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:20:38,924 - TrainingLogger - INFO - Gradient norm: 12.1881
2024-12-31 16:20:47,397 - TrainingLogger - INFO - Step 3410, Batch metrics: Loss: 8.1072, Accuracy: 0.0357, Perplexity: 3318.4120
2024-12-31 16:20:54,790 - TrainingLogger - INFO - Step 3420, Batch metrics: Loss: 7.2183, Accuracy: 0.0862, Perplexity: 1364.2218
2024-12-31 16:21:02,144 - TrainingLogger - INFO - Step 3430, Batch metrics: Loss: 7.9169, Accuracy: 0.0425, Perplexity: 2743.3144
2024-12-31 16:21:09,777 - TrainingLogger - INFO - Step 3440, Batch metrics: Loss: 7.4194, Accuracy: 0.0684, Perplexity: 1668.0121
2024-12-31 16:21:16,740 - TrainingLogger - INFO - Step 3450, Batch metrics: Loss: 7.0628, Accuracy: 0.1092, Perplexity: 1167.6845
2024-12-31 16:21:23,970 - TrainingLogger - INFO - Step 3460, Batch metrics: Loss: 7.1817, Accuracy: 0.0882, Perplexity: 1315.1205
2024-12-31 16:21:30,973 - TrainingLogger - INFO - Step 3470, Batch metrics: Loss: 7.2180, Accuracy: 0.0769, Perplexity: 1363.8179
2024-12-31 16:21:38,216 - TrainingLogger - INFO - Step 3480, Batch metrics: Loss: 7.7280, Accuracy: 0.0638, Perplexity: 2271.1393
2024-12-31 16:21:45,447 - TrainingLogger - INFO - Step 3490, Batch metrics: Loss: 7.3822, Accuracy: 0.0987, Perplexity: 1607.1066
2024-12-31 16:21:52,590 - TrainingLogger - INFO - Step 3500, Batch metrics: Loss: 7.2504, Accuracy: 0.0714, Perplexity: 1408.7200
2024-12-31 16:21:52,590 - TrainingLogger - INFO - Step 3500, Prediction vs Actual:
2024-12-31 16:21:52,590 - TrainingLogger - INFO - Input 1: מחובתינו ליידע את ציבור שומרי השבת על מכשירים שהם לא מנגנון שבת כדי שיחליטו אם להשתמש בהם או לאו
2024-12-31 16:21:52,591 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:21:52,591 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מחו         | ✗     |
|     1 | .               | בתי          | ✗     |
|     2 | י               | נו           | ✗     |
|     3 | ר               | ▁לי          | ✗     |
|     4 | ו               | ידע          | ✗     |
|     5 | ▁את             | ▁את          | ✓     |
|     6 | ▁המדינה         | ▁ציבור       | ✗     |
|     7 | ם               | ▁שומרי       | ✗     |
|     8 | ▁המדינה         | ▁השבת        | ✗     |
|     9 | .               | ▁על          | ✗     |
|    10 | ▁המדינה         | ▁מכשיר       | ✗     |
|    11 | ▁זה             | ים           | ✗     |
|    12 | ▁אלה            | ▁שהם         | ✗     |
|    13 | ▁לא             | ▁לא          | ✓     |
|    14 | ▁קיימים         | ▁מנגנון      | ✗     |
|    15 | ,               | ▁שבת         | ✗     |
|    16 | ים              | ▁כדי         | ✗     |
|    17 | ▁להשיג          | ▁שיח         | ✗     |
|    18 | יו              | ליט          | ✗     |
|    19 | ▁בהם            | ו            | ✗     |
|    20 | </s>            | ▁אם          | ✗     |
|    21 | ▁זה             | ▁להשתמש      | ✗     |
|    22 | ▁בהם            | ▁בהם         | ✓     |
|    23 | ,               | ▁או          | ✗     |
|    24 | ▁לא             | ▁לא          | ✓     |
|    25 | ,               | ו            | ✗     |
|    26 | הל              | <pad>        | ✗     |
|    27 | ▁בעצמם          | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁אלקטרוני       | <pad>        | ✗     |
|    30 | ▁נוספים         | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | .               |              | ✗     |

2024-12-31 16:21:52,591 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:21:52,596 - TrainingLogger - INFO - Gradient norm: 11.9838
2024-12-31 16:22:00,319 - TrainingLogger - INFO - Step 3510, Batch metrics: Loss: 7.0475, Accuracy: 0.0769, Perplexity: 1150.0292
2024-12-31 16:22:07,246 - TrainingLogger - INFO - Step 3520, Batch metrics: Loss: 7.4514, Accuracy: 0.0788, Perplexity: 1722.2033
2024-12-31 16:22:14,802 - TrainingLogger - INFO - Step 3530, Batch metrics: Loss: 7.6812, Accuracy: 0.0462, Perplexity: 2167.1859
2024-12-31 16:22:22,335 - TrainingLogger - INFO - Step 3540, Batch metrics: Loss: 7.3075, Accuracy: 0.1149, Perplexity: 1491.3783
2024-12-31 16:22:29,847 - TrainingLogger - INFO - Step 3550, Batch metrics: Loss: 7.6521, Accuracy: 0.0556, Perplexity: 2105.0045
2024-12-31 16:22:35,651 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 243712
2024-12-31 16:22:35,652 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 243712

2024-12-31 16:22:35,652 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:22:35,653 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:22:37,711 - TrainingLogger - INFO - Step 3560, Batch metrics: Loss: 7.0931, Accuracy: 0.0718, Perplexity: 1203.6730
2024-12-31 16:22:44,538 - TrainingLogger - INFO - Step 3570, Batch metrics: Loss: 7.1603, Accuracy: 0.0859, Perplexity: 1287.2796
2024-12-31 16:22:51,863 - TrainingLogger - INFO - Step 3580, Batch metrics: Loss: 7.3865, Accuracy: 0.0556, Perplexity: 1614.0392
2024-12-31 16:22:59,448 - TrainingLogger - INFO - Step 3590, Batch metrics: Loss: 7.6011, Accuracy: 0.0719, Perplexity: 2000.4170
2024-12-31 16:23:06,227 - TrainingLogger - INFO - Step 3600, Batch metrics: Loss: 7.6778, Accuracy: 0.0764, Perplexity: 2159.9415
2024-12-31 16:23:06,228 - TrainingLogger - INFO - Step 3600, Prediction vs Actual:
2024-12-31 16:23:06,228 - TrainingLogger - INFO - Input 1: אדם בלי חברים אבל עם צורך אדיר באהבה, בתשומת לב
2024-12-31 16:23:06,228 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:23:06,228 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אדם         | ✗     |
|     1 | ▁-              | ▁בלי         | ✗     |
|     2 | י               | ▁חברים       | ✗     |
|     3 | .               | ▁אבל         | ✗     |
|     4 | ▁אני            | ▁עם          | ✗     |
|     5 | ▁זה             | ▁צורך        | ✗     |
|     6 | ▁בזה            | ▁אדיר        | ✗     |
|     7 | .               | ▁באהבה       | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | </s>            | ▁ב           | ✗     |
|    10 | יט              | תשומת        | ✗     |
|    11 | ▁לב             | ▁לב          | ✓     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁ראשונה         | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 16:23:06,228 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:23:06,233 - TrainingLogger - INFO - Gradient norm: 10.5151
2024-12-31 16:23:13,320 - TrainingLogger - INFO - Step 3610, Batch metrics: Loss: 7.4797, Accuracy: 0.0696, Perplexity: 1771.6240
2024-12-31 16:23:20,416 - TrainingLogger - INFO - Step 3620, Batch metrics: Loss: 7.6092, Accuracy: 0.0622, Perplexity: 2016.6891
2024-12-31 16:23:27,509 - TrainingLogger - INFO - Step 3630, Batch metrics: Loss: 6.9234, Accuracy: 0.0683, Perplexity: 1015.7376
2024-12-31 16:23:34,193 - TrainingLogger - INFO - Step 3640, Batch metrics: Loss: 7.4284, Accuracy: 0.0674, Perplexity: 1683.0595
2024-12-31 16:23:41,547 - TrainingLogger - INFO - Step 3650, Batch metrics: Loss: 7.3035, Accuracy: 0.0758, Perplexity: 1485.5243
2024-12-31 16:23:48,243 - TrainingLogger - INFO - Step 3660, Batch metrics: Loss: 7.3336, Accuracy: 0.0684, Perplexity: 1530.9276
2024-12-31 16:23:55,383 - TrainingLogger - INFO - Step 3670, Batch metrics: Loss: 7.5461, Accuracy: 0.0640, Perplexity: 1893.3608
2024-12-31 16:24:02,704 - TrainingLogger - INFO - Step 3680, Batch metrics: Loss: 7.1056, Accuracy: 0.0892, Perplexity: 1218.7410
2024-12-31 16:24:10,168 - TrainingLogger - INFO - Step 3690, Batch metrics: Loss: 6.8556, Accuracy: 0.1250, Perplexity: 949.1678
2024-12-31 16:24:17,560 - TrainingLogger - INFO - Step 3700, Batch metrics: Loss: 7.4070, Accuracy: 0.0800, Perplexity: 1647.4515
2024-12-31 16:24:17,560 - TrainingLogger - INFO - Step 3700, Prediction vs Actual:
2024-12-31 16:24:17,560 - TrainingLogger - INFO - Input 1: בדיקטטורה יש קוד אתי נורמטיבי
2024-12-31 16:24:17,561 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:24:17,561 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | רה              | ▁ב           | ✗     |
|     1 | ▁               | דיקטטור      | ✗     |
|     2 | ו               | ה            | ✗     |
|     3 | ▁שב             | ▁יש          | ✗     |
|     4 | בן              | ▁קוד         | ✗     |
|     5 | ד               | ▁את          | ✗     |
|     6 | י               | י            | ✓     |
|     7 | .               | ▁נור         | ✗     |
|     8 | מה              | מטי          | ✗     |
|     9 | בית             | בי           | ✗     |
|    10 | ה               | <pad>        | ✗     |
|    11 | ה               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | י               | <pad>        | ✗     |
|    14 | ה               | <pad>        | ✗     |
|    15 | י               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | מה              | <pad>        | ✗     |
|    27 | י               | <pad>        | ✗     |
|    28 | י               |              | ✗     |

2024-12-31 16:24:17,561 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:24:17,566 - TrainingLogger - INFO - Gradient norm: 11.6057
2024-12-31 16:24:24,411 - TrainingLogger - INFO - Step 3710, Batch metrics: Loss: 7.1701, Accuracy: 0.0637, Perplexity: 1299.9953
2024-12-31 16:24:30,934 - TrainingLogger - INFO - Step 3720, Batch metrics: Loss: 7.2028, Accuracy: 0.0484, Perplexity: 1343.1426
2024-12-31 16:24:37,643 - TrainingLogger - INFO - Step 3730, Batch metrics: Loss: 7.3981, Accuracy: 0.0483, Perplexity: 1632.8679
2024-12-31 16:24:44,657 - TrainingLogger - INFO - Step 3740, Batch metrics: Loss: 7.6623, Accuracy: 0.0556, Perplexity: 2126.5804
2024-12-31 16:24:51,922 - TrainingLogger - INFO - Step 3750, Batch metrics: Loss: 7.3604, Accuracy: 0.0812, Perplexity: 1572.3953
2024-12-31 16:24:58,781 - TrainingLogger - INFO - Step 3760, Batch metrics: Loss: 7.5099, Accuracy: 0.0565, Perplexity: 1825.9405
2024-12-31 16:25:05,702 - TrainingLogger - INFO - Step 3770, Batch metrics: Loss: 7.1909, Accuracy: 0.1065, Perplexity: 1327.3078
2024-12-31 16:25:13,191 - TrainingLogger - INFO - Step 3780, Batch metrics: Loss: 7.0244, Accuracy: 0.0842, Perplexity: 1123.7574
2024-12-31 16:25:20,737 - TrainingLogger - INFO - Step 3790, Batch metrics: Loss: 8.0135, Accuracy: 0.0420, Perplexity: 3021.4399
2024-12-31 16:25:27,891 - TrainingLogger - INFO - Step 3800, Batch metrics: Loss: 7.8974, Accuracy: 0.0507, Perplexity: 2690.2449
2024-12-31 16:25:27,891 - TrainingLogger - INFO - Step 3800, Prediction vs Actual:
2024-12-31 16:25:27,891 - TrainingLogger - INFO - Input 1: 13 שרים לא הנידו עפעף ותמכו בתוספת השערורייתית, שמחירה בשנים הבאות עוד יגדל
2024-12-31 16:25:27,891 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:25:27,891 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁13          | ✗     |
|     1 | ה               | ▁שרים        | ✗     |
|     2 | ▁עונה           | ▁לא          | ✗     |
|     3 | ▁רשמי           | ▁הני         | ✗     |
|     4 | ר               | דו           | ✗     |
|     5 | פס              | ▁עפ          | ✗     |
|     6 | ניים            | עף           | ✗     |
|     7 | :               | ▁ות          | ✗     |
|     8 | שעה             | מכו          | ✗     |
|     9 | ▁בהם            | ▁בתוספת      | ✗     |
|    10 | ן               | ▁השער        | ✗     |
|    11 | ה               | ו            | ✗     |
|    12 | רייה            | ריית         | ✗     |
|    13 | ו               | ית           | ✗     |
|    14 | <pad>           | ,            | ✗     |
|    15 | <pad>           | ▁שמח         | ✗     |
|    16 | ת               | ירה          | ✗     |
|    17 | ▁את             | ▁בשנים       | ✗     |
|    18 | ▁האחרונות       | ▁הבאות       | ✗     |
|    19 | ,               | ▁עוד         | ✗     |
|    20 | ▁יותר           | ▁יגדל        | ✗     |
|    21 | ו               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               |              | ✗     |

2024-12-31 16:25:27,891 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:25:27,896 - TrainingLogger - INFO - Gradient norm: 11.1238
2024-12-31 16:25:34,859 - TrainingLogger - INFO - Step 3810, Batch metrics: Loss: 6.9149, Accuracy: 0.0983, Perplexity: 1007.1370
2024-12-31 16:25:42,164 - TrainingLogger - INFO - Step 3820, Batch metrics: Loss: 7.2019, Accuracy: 0.0795, Perplexity: 1342.0306
2024-12-31 16:25:49,110 - TrainingLogger - INFO - Step 3830, Batch metrics: Loss: 7.5550, Accuracy: 0.1027, Perplexity: 1910.1980
2024-12-31 16:25:56,379 - TrainingLogger - INFO - Step 3840, Batch metrics: Loss: 7.7716, Accuracy: 0.0680, Perplexity: 2372.1672
2024-12-31 16:26:03,446 - TrainingLogger - INFO - Step 3850, Batch metrics: Loss: 7.5543, Accuracy: 0.0870, Perplexity: 1908.8404
2024-12-31 16:26:10,404 - TrainingLogger - INFO - Step 3860, Batch metrics: Loss: 7.4597, Accuracy: 0.0573, Perplexity: 1736.7009
2024-12-31 16:26:17,771 - TrainingLogger - INFO - Step 3870, Batch metrics: Loss: 7.4906, Accuracy: 0.0578, Perplexity: 1791.1804
2024-12-31 16:26:25,543 - TrainingLogger - INFO - Step 3880, Batch metrics: Loss: 7.5393, Accuracy: 0.0854, Perplexity: 1880.6001
2024-12-31 16:26:32,464 - TrainingLogger - INFO - Step 3890, Batch metrics: Loss: 7.2954, Accuracy: 0.0723, Perplexity: 1473.4551
2024-12-31 16:26:39,681 - TrainingLogger - INFO - Step 3900, Batch metrics: Loss: 7.6171, Accuracy: 0.0617, Perplexity: 2032.7262
2024-12-31 16:26:39,682 - TrainingLogger - INFO - Step 3900, Prediction vs Actual:
2024-12-31 16:26:39,682 - TrainingLogger - INFO - Input 1: חכ גלעד קריב העבודה הדהד את דבריו של כהנא בריאיון לאולפן ynet, והוסיף כי ההסכם מקטין דרמטית את התלות של לבנון באיראן, בכסף איראני
2024-12-31 16:26:39,683 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:26:39,683 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁ח           | ✗     |
|     1 | ח               | כ            | ✗     |
|     2 | א               | ▁גלעד        | ✗     |
|     3 | ה               | ▁קרי         | ✗     |
|     4 | ב               | ב            | ✓     |
|     5 | .               | ▁העבודה      | ✗     |
|     6 | ▁הקשה           | ▁הד          | ✗     |
|     7 | ח               | הד           | ✗     |
|     8 | יש              | ▁את          | ✗     |
|     9 | י               | ▁דבריו       | ✗     |
|    10 | ▁של             | ▁של          | ✓     |
|    11 | ▁ג              | ▁כה          | ✗     |
|    12 | ונת             | נא           | ✗     |
|    13 | ת               | ▁בריא        | ✗     |
|    14 | ,               | יון          | ✗     |
|    15 | ▁חופשי          | ▁לא          | ✗     |
|    16 | ▁רע             | ול           | ✗     |
|    17 | פן              | פן           | ✓     |
|    18 | .               | ▁y           | ✗     |
|    19 | .               | net          | ✗     |
|    20 | י               | ,            | ✗     |
|    21 | </s>            | ▁והו         | ✗     |
|    22 | טל              | סיף          | ✗     |
|    23 | ▁ל              | ▁כי          | ✗     |
|    24 | ▁הוא            | ▁ההסכם       | ✗     |
|    25 | ה               | ▁מ           | ✗     |
|    26 | ובה             | קטין         | ✗     |
|    27 | ▁את             | ▁דרמטי       | ✗     |
|    28 | .               | ת            | ✗     |
|    29 | .               | ▁את          | ✗     |
|    30 | ▁עצמו           | ▁התל         | ✗     |
|    31 | ות              | ות           | ✓     |
|    32 | יות             | ▁של          | ✗     |
|    33 | ▁כולם           | ▁לב          | ✗     |
|    34 | ודה             | נון          | ✗     |
|    35 | .               | ▁באי         | ✗     |
|    36 | -               | ראן          | ✗     |
|    37 | .               | ,            | ✗     |
|    38 | </s>            | ▁בכסף        | ✗     |
|    39 | ,               | ▁אירא        | ✗     |
|    40 | ין              | ני           | ✗     |
|    41 | ב               | <pad>        | ✗     |
|    42 | ▁מוסר           | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | ▁ישראל          | <pad>        | ✗     |
|    45 | ▁ישראל          | <pad>        | ✗     |
|    46 | צ               | <pad>        | ✗     |
|    47 | ▁ישראל          | <pad>        | ✗     |
|    48 | ▁ישראל          | <pad>        | ✗     |
|    49 | צ               | <pad>        | ✗     |
|    50 | מן              | <pad>        | ✗     |
|    51 | ה               | <pad>        | ✗     |
|    52 | ה               | <pad>        | ✗     |
|    53 | ▁ישראל          |              | ✗     |

2024-12-31 16:26:39,683 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:26:39,688 - TrainingLogger - INFO - Gradient norm: 14.0085
2024-12-31 16:26:46,905 - TrainingLogger - INFO - Step 3910, Batch metrics: Loss: 6.8882, Accuracy: 0.0994, Perplexity: 980.6588
2024-12-31 16:26:52,210 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 336896
2024-12-31 16:26:52,211 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 336896

2024-12-31 16:26:52,211 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 62]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 62]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 51]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 51]), device: cuda:0
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:26:52,212 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:26:54,480 - TrainingLogger - INFO - Step 3920, Batch metrics: Loss: 7.5377, Accuracy: 0.0490, Perplexity: 1877.5313
2024-12-31 16:27:01,623 - TrainingLogger - INFO - Step 3930, Batch metrics: Loss: 7.5390, Accuracy: 0.0571, Perplexity: 1879.9761
2024-12-31 16:27:09,374 - TrainingLogger - INFO - Step 3940, Batch metrics: Loss: 7.3420, Accuracy: 0.0746, Perplexity: 1543.7444
2024-12-31 16:27:17,015 - TrainingLogger - INFO - Step 3950, Batch metrics: Loss: 7.4734, Accuracy: 0.0637, Perplexity: 1760.5961
2024-12-31 16:27:24,300 - TrainingLogger - INFO - Step 3960, Batch metrics: Loss: 7.2879, Accuracy: 0.0825, Perplexity: 1462.4829
2024-12-31 16:27:31,562 - TrainingLogger - INFO - Step 3970, Batch metrics: Loss: 6.8244, Accuracy: 0.0880, Perplexity: 919.9935
2024-12-31 16:27:38,660 - TrainingLogger - INFO - Step 3980, Batch metrics: Loss: 7.4800, Accuracy: 0.0930, Perplexity: 1772.1757
2024-12-31 16:27:45,454 - TrainingLogger - INFO - Step 3990, Batch metrics: Loss: 6.7591, Accuracy: 0.0819, Perplexity: 861.8448
2024-12-31 16:27:52,306 - TrainingLogger - INFO - Step 4000, Batch metrics: Loss: 7.0203, Accuracy: 0.0784, Perplexity: 1119.1484
2024-12-31 16:27:52,306 - TrainingLogger - INFO - Step 4000, Prediction vs Actual:
2024-12-31 16:27:52,306 - TrainingLogger - INFO - Input 1: הרקע הוא העלייה הדרמטית בשיעור ההצבעה במגזר הערבי, שם נרשםאחוז ההצבעה הגבוה ביותר מאז 1999
2024-12-31 16:27:52,307 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:27:52,307 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הרקע        | ✗     |
|     1 | ▁-              | ▁הוא         | ✗     |
|     2 | ▁לא             | ▁העלייה      | ✗     |
|     3 | .               | ▁הדר         | ✗     |
|     4 | בית             | מטי          | ✗     |
|     5 | ת               | ת            | ✓     |
|     6 | .               | ▁בשיעור      | ✗     |
|     7 | ים              | ▁ההצבעה      | ✗     |
|     8 | .               | ▁במ          | ✗     |
|     9 | פלג             | גזר          | ✗     |
|    10 | ים              | ▁הערב        | ✗     |
|    11 | י               | י            | ✓     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁שם          | ✗     |
|    14 | ▁הוא            | ▁נרשם        | ✗     |
|    15 | ▁רק             | אחוז         | ✗     |
|    16 | תה              | ▁ההצבעה      | ✗     |
|    17 | .               | ▁הגבוה       | ✗     |
|    18 | ▁ביותר          | ▁ביותר       | ✓     |
|    19 | .               | ▁מאז         | ✗     |
|    20 | ▁אותו           | ▁1999        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               |              | ✗     |

2024-12-31 16:27:52,307 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:27:52,312 - TrainingLogger - INFO - Gradient norm: 13.1083
2024-12-31 16:27:59,633 - TrainingLogger - INFO - Step 4010, Batch metrics: Loss: 7.5626, Accuracy: 0.0561, Perplexity: 1924.9008
2024-12-31 16:28:06,992 - TrainingLogger - INFO - Step 4020, Batch metrics: Loss: 7.9335, Accuracy: 0.0611, Perplexity: 2789.2897
2024-12-31 16:28:14,633 - TrainingLogger - INFO - Step 4030, Batch metrics: Loss: 7.5945, Accuracy: 0.0524, Perplexity: 1987.2617
2024-12-31 16:28:21,926 - TrainingLogger - INFO - Step 4040, Batch metrics: Loss: 7.8224, Accuracy: 0.0663, Perplexity: 2495.7684
2024-12-31 16:28:29,059 - TrainingLogger - INFO - Step 4050, Batch metrics: Loss: 7.2644, Accuracy: 0.0855, Perplexity: 1428.5977
2024-12-31 16:28:36,564 - TrainingLogger - INFO - Step 4060, Batch metrics: Loss: 7.4417, Accuracy: 0.0470, Perplexity: 1705.6799
2024-12-31 16:28:43,259 - TrainingLogger - INFO - Step 4070, Batch metrics: Loss: 7.5100, Accuracy: 0.0645, Perplexity: 1826.2706
2024-12-31 16:28:50,223 - TrainingLogger - INFO - Step 4080, Batch metrics: Loss: 7.0569, Accuracy: 0.1029, Perplexity: 1160.8648
2024-12-31 16:28:57,418 - TrainingLogger - INFO - Step 4090, Batch metrics: Loss: 7.1302, Accuracy: 0.1061, Perplexity: 1249.0653
2024-12-31 16:29:04,490 - TrainingLogger - INFO - Step 4100, Batch metrics: Loss: 7.0163, Accuracy: 0.0667, Perplexity: 1114.6752
2024-12-31 16:29:04,490 - TrainingLogger - INFO - Step 4100, Prediction vs Actual:
2024-12-31 16:29:04,490 - TrainingLogger - INFO - Input 1: אשתו של המחט פתחה קבוצת וואטסאפ של הנשים של המפקדים וסיפרה שהיא רוצה ללכת לבקר משפחות שכולות ופצועים
2024-12-31 16:29:04,491 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:29:04,491 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אשתו        | ✗     |
|     1 | .               | ▁של          | ✗     |
|     2 | ▁דבר            | ▁המחט        | ✗     |
|     3 | .               | ▁פתחה        | ✗     |
|     4 | ▁את             | ▁קבוצת       | ✗     |
|     5 | י               | ▁ווא         | ✗     |
|     6 | זר              | טס           | ✗     |
|     7 | .               | אפ           | ✗     |
|     8 | אק              | ▁של          | ✗     |
|     9 | ▁בית            | ▁הנשים       | ✗     |
|    10 | ▁שלנו           | ▁של          | ✗     |
|    11 | ד               | ▁המפקד       | ✗     |
|    12 | .               | ים           | ✗     |
|    13 | .               | ▁וסיפר       | ✗     |
|    14 | ו               | ה            | ✗     |
|    15 | ▁לי             | ▁שהיא        | ✗     |
|    16 | ▁קיבלה          | ▁רוצה        | ✗     |
|    17 | ▁את             | ▁ללכת        | ✗     |
|    18 | ▁לבית           | ▁לבקר        | ✗     |
|    19 | .               | ▁משפחות      | ✗     |
|    20 | ▁אחרות          | ▁שכול        | ✗     |
|    21 | ה               | ות           | ✗     |
|    22 | יה              | ▁ו           | ✗     |
|    23 | יפות            | פצוע         | ✗     |
|    24 | ים              | ים           | ✓     |
|    25 | .               | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 16:29:04,491 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:29:04,496 - TrainingLogger - INFO - Gradient norm: 10.3757
2024-12-31 16:29:12,246 - TrainingLogger - INFO - Step 4110, Batch metrics: Loss: 7.2541, Accuracy: 0.0791, Perplexity: 1413.8230
2024-12-31 16:29:19,508 - TrainingLogger - INFO - Step 4120, Batch metrics: Loss: 7.1107, Accuracy: 0.0633, Perplexity: 1224.9494
2024-12-31 16:29:26,857 - TrainingLogger - INFO - Step 4130, Batch metrics: Loss: 7.3025, Accuracy: 0.0736, Perplexity: 1483.9484
2024-12-31 16:29:34,455 - TrainingLogger - INFO - Step 4140, Batch metrics: Loss: 7.5523, Accuracy: 0.0631, Perplexity: 1905.1576
2024-12-31 16:29:41,380 - TrainingLogger - INFO - Step 4150, Batch metrics: Loss: 7.3855, Accuracy: 0.1008, Perplexity: 1612.4422
2024-12-31 16:29:48,982 - TrainingLogger - INFO - Step 4160, Batch metrics: Loss: 7.5170, Accuracy: 0.0546, Perplexity: 1838.9546
2024-12-31 16:29:56,360 - TrainingLogger - INFO - Step 4170, Batch metrics: Loss: 7.2102, Accuracy: 0.0914, Perplexity: 1353.1078
2024-12-31 16:30:03,794 - TrainingLogger - INFO - Step 4180, Batch metrics: Loss: 7.3259, Accuracy: 0.0874, Perplexity: 1519.1457
2024-12-31 16:30:10,772 - TrainingLogger - INFO - Step 4190, Batch metrics: Loss: 7.5218, Accuracy: 0.0460, Perplexity: 1847.9681
2024-12-31 16:30:17,683 - TrainingLogger - INFO - Step 4200, Batch metrics: Loss: 7.3834, Accuracy: 0.0828, Perplexity: 1608.9990
2024-12-31 16:30:17,683 - TrainingLogger - INFO - Step 4200, Prediction vs Actual:
2024-12-31 16:30:17,683 - TrainingLogger - INFO - Input 1: וזה אולי נשמע רע יחסית למקרו, אבל אני רוצה להתמקד באפשר ולהיות מעשי בקשר לזה
2024-12-31 16:30:17,684 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:30:17,684 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁וזה         | ✗     |
|     1 | </s>            | ▁אולי        | ✗     |
|     2 | .               | ▁נשמע        | ✗     |
|     3 | ▁לי             | ▁רע          | ✗     |
|     4 | .               | ▁יחסית       | ✗     |
|     5 | .               | ▁למ          | ✗     |
|     6 | אס              | קרו          | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | </s>            | ▁אבל         | ✗     |
|     9 | ...             | ▁אני         | ✗     |
|    10 | ▁לא             | ▁רוצה        | ✗     |
|    11 | ▁להיות          | ▁להתמקד      | ✗     |
|    12 | ,               | ▁ב           | ✗     |
|    13 | תוצאה           | אפשר         | ✗     |
|    14 | י               | ▁ולהיות      | ✗     |
|    15 | ▁ביחד           | ▁מעשי        | ✗     |
|    16 | יה              | ▁בקשר        | ✗     |
|    17 | ▁לזה            | ▁לזה         | ✓     |
|    18 | .               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁זה             | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               |              | ✗     |

2024-12-31 16:30:17,684 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:30:17,689 - TrainingLogger - INFO - Gradient norm: 13.8751
2024-12-31 16:30:25,115 - TrainingLogger - INFO - Step 4210, Batch metrics: Loss: 7.5268, Accuracy: 0.0802, Perplexity: 1857.2357
2024-12-31 16:30:32,684 - TrainingLogger - INFO - Step 4220, Batch metrics: Loss: 7.6027, Accuracy: 0.0920, Perplexity: 2003.6160
2024-12-31 16:30:40,023 - TrainingLogger - INFO - Step 4230, Batch metrics: Loss: 7.3945, Accuracy: 0.0660, Perplexity: 1626.9775
2024-12-31 16:30:46,751 - TrainingLogger - INFO - Step 4240, Batch metrics: Loss: 7.0595, Accuracy: 0.0703, Perplexity: 1163.8051
2024-12-31 16:30:53,746 - TrainingLogger - INFO - Step 4250, Batch metrics: Loss: 7.3385, Accuracy: 0.0855, Perplexity: 1538.3830
2024-12-31 16:31:01,170 - TrainingLogger - INFO - Step 4260, Batch metrics: Loss: 7.2430, Accuracy: 0.0964, Perplexity: 1398.2832
2024-12-31 16:31:08,698 - TrainingLogger - INFO - Step 4270, Batch metrics: Loss: 7.0228, Accuracy: 0.0859, Perplexity: 1121.8909
2024-12-31 16:31:15,606 - TrainingLogger - INFO - Step 4280, Batch metrics: Loss: 7.1693, Accuracy: 0.0854, Perplexity: 1298.9327
2024-12-31 16:31:22,953 - TrainingLogger - INFO - Step 4290, Batch metrics: Loss: 7.2279, Accuracy: 0.0708, Perplexity: 1377.2608
2024-12-31 16:31:31,063 - TrainingLogger - INFO - Step 4300, Batch metrics: Loss: 7.0875, Accuracy: 0.0809, Perplexity: 1196.9028
2024-12-31 16:31:31,063 - TrainingLogger - INFO - Step 4300, Prediction vs Actual:
2024-12-31 16:31:31,063 - TrainingLogger - INFO - Input 1: כך גם לגבי האמירות והרמזים מכיוון כחול לבן שלפיהם מתקיימים מגעים בין הצדדים או תיאום כלשהו
2024-12-31 16:31:31,064 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:31:31,064 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁כך          | ✗     |
|     1 | </s>            | ▁גם          | ✗     |
|     2 | </s>            | ▁לגבי        | ✗     |
|     3 | </s>            | ▁האמ         | ✗     |
|     4 | </s>            | ירות         | ✗     |
|     5 | </s>            | ▁וה          | ✗     |
|     6 | רווח            | רמז          | ✗     |
|     7 | יות             | ים           | ✗     |
|     8 | </s>            | ▁מכיוון      | ✗     |
|     9 | </s>            | ▁כחול        | ✗     |
|    10 | </s>            | ▁לבן         | ✗     |
|    11 | </s>            | ▁של          | ✗     |
|    12 | ד               | פיהם         | ✗     |
|    13 | </s>            | ▁מת          | ✗     |
|    14 | </s>            | קיימים       | ✗     |
|    15 | </s>            | ▁מגע         | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ▁רבים           | ▁בין         | ✗     |
|    18 | ▁היתר           | ▁הצדדים      | ✗     |
|    19 | </s>            | ▁או          | ✗     |
|    20 | מות             | ▁תיאו        | ✗     |
|    21 | ם               | ם            | ✓     |
|    22 | </s>            | ▁כלשהו       | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 16:31:31,064 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:31:31,069 - TrainingLogger - INFO - Gradient norm: 12.6086
2024-12-31 16:31:38,178 - TrainingLogger - INFO - Step 4310, Batch metrics: Loss: 7.1976, Accuracy: 0.0876, Perplexity: 1336.2593
2024-12-31 16:31:45,684 - TrainingLogger - INFO - Step 4320, Batch metrics: Loss: 6.6622, Accuracy: 0.1224, Perplexity: 782.3014
2024-12-31 16:31:53,014 - TrainingLogger - INFO - Step 4330, Batch metrics: Loss: 7.5516, Accuracy: 0.0541, Perplexity: 1903.8081
2024-12-31 16:32:00,418 - TrainingLogger - INFO - Step 4340, Batch metrics: Loss: 7.6109, Accuracy: 0.0793, Perplexity: 2020.1135
2024-12-31 16:32:07,123 - TrainingLogger - INFO - Step 4350, Batch metrics: Loss: 7.1644, Accuracy: 0.0828, Perplexity: 1292.6488
2024-12-31 16:32:14,185 - TrainingLogger - INFO - Step 4360, Batch metrics: Loss: 7.5432, Accuracy: 0.0651, Perplexity: 1887.9120
2024-12-31 16:32:21,806 - TrainingLogger - INFO - Step 4370, Batch metrics: Loss: 7.0385, Accuracy: 0.1086, Perplexity: 1139.6446
2024-12-31 16:32:29,214 - TrainingLogger - INFO - Step 4380, Batch metrics: Loss: 7.6627, Accuracy: 0.0664, Perplexity: 2127.4456
2024-12-31 16:32:36,693 - TrainingLogger - INFO - Step 4390, Batch metrics: Loss: 7.3230, Accuracy: 0.0946, Perplexity: 1514.6698
2024-12-31 16:32:43,899 - TrainingLogger - INFO - Step 4400, Batch metrics: Loss: 7.5487, Accuracy: 0.0559, Perplexity: 1898.3039
2024-12-31 16:32:43,899 - TrainingLogger - INFO - Step 4400, Prediction vs Actual:
2024-12-31 16:32:43,899 - TrainingLogger - INFO - Input 1: לדבריו, פתיחת חקירה ושימוש בצעדים פולשניים חייבים להתבצע רק כאשר נחיצות האמצעים ברורה
2024-12-31 16:32:43,900 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:32:43,900 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁לדבריו      | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | <pad>           | ▁פתיחת       | ✗     |
|     3 | ▁תקופה          | ▁חקירה       | ✗     |
|     4 | ▁רשמית          | ▁ו           | ✗     |
|     5 | עידה            | שימוש        | ✗     |
|     6 | ▁ב              | ▁בצעד        | ✗     |
|     7 | ים              | ים           | ✓     |
|     8 | .               | ▁פול         | ✗     |
|     9 | נים             | שניים        | ✗     |
|    10 | .               | ▁חייבים      | ✗     |
|    11 | ▁להיות          | ▁להתבצע      | ✗     |
|    12 | .               | ▁רק          | ✗     |
|    13 | ▁על             | ▁כאשר        | ✗     |
|    14 | ▁הם             | ▁נח          | ✗     |
|    15 | ו               | י            | ✗     |
|    16 | צות             | צות          | ✓     |
|    17 | יות             | ▁האמצעים     | ✗     |
|    18 | ▁של             | ▁ברורה       | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 16:32:43,900 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:32:43,905 - TrainingLogger - INFO - Gradient norm: 12.3414
2024-12-31 16:32:51,294 - TrainingLogger - INFO - Step 4410, Batch metrics: Loss: 7.7590, Accuracy: 0.0533, Perplexity: 2342.4800
2024-12-31 16:32:57,953 - TrainingLogger - INFO - Step 4420, Batch metrics: Loss: 7.4359, Accuracy: 0.0984, Perplexity: 1695.8297
2024-12-31 16:33:04,999 - TrainingLogger - INFO - Step 4430, Batch metrics: Loss: 7.5534, Accuracy: 0.0704, Perplexity: 1907.1681
2024-12-31 16:33:11,962 - TrainingLogger - INFO - Step 4440, Batch metrics: Loss: 7.3028, Accuracy: 0.0688, Perplexity: 1484.4020
2024-12-31 16:33:19,012 - TrainingLogger - INFO - Step 4450, Batch metrics: Loss: 7.2349, Accuracy: 0.1038, Perplexity: 1387.0002
2024-12-31 16:33:25,853 - TrainingLogger - INFO - Step 4460, Batch metrics: Loss: 7.9240, Accuracy: 0.0640, Perplexity: 2762.6784
2024-12-31 16:33:32,895 - TrainingLogger - INFO - Step 4470, Batch metrics: Loss: 7.5764, Accuracy: 0.0657, Perplexity: 1951.6265
2024-12-31 16:33:40,276 - TrainingLogger - INFO - Step 4480, Batch metrics: Loss: 7.4919, Accuracy: 0.0827, Perplexity: 1793.3743
2024-12-31 16:33:47,534 - TrainingLogger - INFO - Step 4490, Batch metrics: Loss: 7.4546, Accuracy: 0.0682, Perplexity: 1727.8065
2024-12-31 16:33:55,471 - TrainingLogger - INFO - Step 4500, Batch metrics: Loss: 7.3797, Accuracy: 0.0720, Perplexity: 1603.1205
2024-12-31 16:33:55,472 - TrainingLogger - INFO - Step 4500, Prediction vs Actual:
2024-12-31 16:33:55,472 - TrainingLogger - INFO - Input 1: בנוסף, חברת דוקטק שנותנת מענה לחוסר היכולת לדעת את העומקים בנמלים בזמן אמת
2024-12-31 16:33:55,472 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:33:55,472 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁בנוסף       | ✗     |
|     1 | .               | ,            | ✗     |
|     2 | ▁לכל            | ▁חברת        | ✗     |
|     3 | ▁התעופה         | ▁דוק         | ✗     |
|     4 | ,               | טק           | ✗     |
|     5 | ה               | ▁ש           | ✗     |
|     6 | ות              | נותנת        | ✗     |
|     7 | ▁את             | ▁מענה        | ✗     |
|     8 | ▁לה             | ▁ל           | ✗     |
|     9 | -               | חוסר         | ✗     |
|    10 | ▁אחריות         | ▁היכולת      | ✗     |
|    11 | ▁שלו            | ▁לדעת        | ✗     |
|    12 | ▁את             | ▁את          | ✓     |
|    13 | ▁האמת           | ▁ה           | ✗     |
|    14 | נטל             | עומק         | ✗     |
|    15 | ▁שלו            | ים           | ✗     |
|    16 | ▁שלהם           | ▁בנמל        | ✗     |
|    17 | ים              | ים           | ✓     |
|    18 | ,               | ▁בזמן        | ✗     |
|    19 | ▁הקרוב          | ▁אמת         | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 16:33:55,472 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:33:55,477 - TrainingLogger - INFO - Gradient norm: 11.4224
2024-12-31 16:34:02,571 - TrainingLogger - INFO - Step 4510, Batch metrics: Loss: 7.4709, Accuracy: 0.0427, Perplexity: 1756.1674
2024-12-31 16:34:09,565 - TrainingLogger - INFO - Step 4520, Batch metrics: Loss: 7.7185, Accuracy: 0.0915, Perplexity: 2249.5529
2024-12-31 16:34:16,999 - TrainingLogger - INFO - Step 4530, Batch metrics: Loss: 7.4541, Accuracy: 0.0591, Perplexity: 1726.9680
2024-12-31 16:34:24,069 - TrainingLogger - INFO - Step 4540, Batch metrics: Loss: 7.6630, Accuracy: 0.0530, Perplexity: 2128.1771
2024-12-31 16:34:31,257 - TrainingLogger - INFO - Step 4550, Batch metrics: Loss: 7.9117, Accuracy: 0.0314, Perplexity: 2729.1137
2024-12-31 16:34:38,467 - TrainingLogger - INFO - Step 4560, Batch metrics: Loss: 7.2625, Accuracy: 0.0978, Perplexity: 1425.7864
2024-12-31 16:34:45,485 - TrainingLogger - INFO - Step 4570, Batch metrics: Loss: 6.9600, Accuracy: 0.0917, Perplexity: 1053.6416
2024-12-31 16:34:52,268 - TrainingLogger - INFO - Step 4580, Batch metrics: Loss: 7.5190, Accuracy: 0.0706, Perplexity: 1842.7791
2024-12-31 16:34:59,360 - TrainingLogger - INFO - Step 4590, Batch metrics: Loss: 6.9334, Accuracy: 0.0789, Perplexity: 1025.9310
2024-12-31 16:35:06,530 - TrainingLogger - INFO - Step 4600, Batch metrics: Loss: 7.1888, Accuracy: 0.0482, Perplexity: 1324.4956
2024-12-31 16:35:06,530 - TrainingLogger - INFO - Step 4600, Prediction vs Actual:
2024-12-31 16:35:06,530 - TrainingLogger - INFO - Input 1: הוא היה גאה בשירות הצבאי שלו
2024-12-31 16:35:06,531 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:35:06,531 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הוא         | ✗     |
|     1 | ,               | ▁היה         | ✗     |
|     2 | </s>            | ▁גאה         | ✗     |
|     3 | ▁בו             | ▁בשירות      | ✗     |
|     4 | ו               | ▁הצבאי       | ✗     |
|     5 | </s>            | ▁שלו         | ✗     |
|     6 | </s>            | <pad>        | ✗     |
|     7 | ▁מאז            | <pad>        | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | ▁הוא            | <pad>        | ✗     |
|    10 | ▁היה            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁הוא            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 16:35:06,531 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:35:06,536 - TrainingLogger - INFO - Gradient norm: 10.8530
2024-12-31 16:35:13,768 - TrainingLogger - INFO - Step 4610, Batch metrics: Loss: 7.7464, Accuracy: 0.0526, Perplexity: 2313.2703
2024-12-31 16:35:20,793 - TrainingLogger - INFO - Step 4620, Batch metrics: Loss: 7.7630, Accuracy: 0.0874, Perplexity: 2351.9802
2024-12-31 16:35:27,796 - TrainingLogger - INFO - Step 4630, Batch metrics: Loss: 7.2351, Accuracy: 0.0686, Perplexity: 1387.3104
2024-12-31 16:35:35,216 - TrainingLogger - INFO - Step 4640, Batch metrics: Loss: 7.3136, Accuracy: 0.0756, Perplexity: 1500.5045
2024-12-31 16:35:42,583 - TrainingLogger - INFO - Step 4650, Batch metrics: Loss: 7.5584, Accuracy: 0.0737, Perplexity: 1916.7080
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 186368
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 186368

2024-12-31 16:35:43,341 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 26]), device: cuda:0
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 26]), device: cuda:0
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:35:43,341 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 36]), device: cuda:0
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 36]), device: cuda:0
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:35:43,342 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:35:50,257 - TrainingLogger - INFO - Step 4660, Batch metrics: Loss: 7.7087, Accuracy: 0.0667, Perplexity: 2227.5747
2024-12-31 16:35:57,779 - TrainingLogger - INFO - Step 4670, Batch metrics: Loss: 7.4286, Accuracy: 0.0736, Perplexity: 1683.4544
2024-12-31 16:36:04,967 - TrainingLogger - INFO - Step 4680, Batch metrics: Loss: 7.8260, Accuracy: 0.0278, Perplexity: 2504.7685
2024-12-31 16:36:11,968 - TrainingLogger - INFO - Step 4690, Batch metrics: Loss: 7.0776, Accuracy: 0.0803, Perplexity: 1185.1067
2024-12-31 16:36:19,339 - TrainingLogger - INFO - Step 4700, Batch metrics: Loss: 7.2704, Accuracy: 0.0633, Perplexity: 1437.1835
2024-12-31 16:36:19,339 - TrainingLogger - INFO - Step 4700, Prediction vs Actual:
2024-12-31 16:36:19,339 - TrainingLogger - INFO - Input 1: בעיקר הטחת אשמה וטיעונים פתלתלים
2024-12-31 16:36:19,339 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:36:19,339 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בעיקר       | ✗     |
|     1 | ▁כן             | ▁הט          | ✗     |
|     2 | ▁כן             | חת           | ✗     |
|     3 | ▁דם             | ▁אשמה        | ✗     |
|     4 | .               | ▁ו           | ✗     |
|     5 | רווח            | טיעונים      | ✗     |
|     6 | ▁שלך            | ▁פת          | ✗     |
|     7 | ים              | לת           | ✗     |
|     8 | ים              | לים          | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | ▁הו             | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | ים              | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | יים             | <pad>        | ✗     |
|    18 | ▁לא             | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | ▁לא             | <pad>        | ✗     |
|    21 | ▁לא             | <pad>        | ✗     |
|    22 | ▁שה             | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ▁לא             | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | ▁לא             | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 16:36:19,339 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:36:19,344 - TrainingLogger - INFO - Gradient norm: 17.2164
2024-12-31 16:36:26,314 - TrainingLogger - INFO - Step 4710, Batch metrics: Loss: 7.8310, Accuracy: 0.0380, Perplexity: 2517.4680
2024-12-31 16:36:33,511 - TrainingLogger - INFO - Step 4720, Batch metrics: Loss: 6.4844, Accuracy: 0.1385, Perplexity: 654.8330
2024-12-31 16:36:40,510 - TrainingLogger - INFO - Step 4730, Batch metrics: Loss: 7.8571, Accuracy: 0.0745, Perplexity: 2584.0393
2024-12-31 16:36:48,038 - TrainingLogger - INFO - Step 4740, Batch metrics: Loss: 7.4010, Accuracy: 0.0706, Perplexity: 1637.6088
2024-12-31 16:36:55,087 - TrainingLogger - INFO - Step 4750, Batch metrics: Loss: 7.3745, Accuracy: 0.0494, Perplexity: 1594.7323
2024-12-31 16:37:02,043 - TrainingLogger - INFO - Step 4760, Batch metrics: Loss: 7.2252, Accuracy: 0.1282, Perplexity: 1373.5585
2024-12-31 16:37:09,508 - TrainingLogger - INFO - Step 4770, Batch metrics: Loss: 6.6397, Accuracy: 0.0988, Perplexity: 764.8651
2024-12-31 16:37:16,794 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 47, 40), but is torch.Size([8, 1, 47, 35])
2024-12-31 16:37:16,794 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 47, 40), but is torch.Size([8, 1, 47, 35])

2024-12-31 16:37:16,794 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 16:37:16,795 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 16:37:16,795 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 16:37:16,795 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 16:37:16,795 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 47]), device: cuda:0
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 47]), device: cuda:0
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 16:37:16,796 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 16:37:17,526 - TrainingLogger - INFO - Step 4780, Batch metrics: Loss: 7.8666, Accuracy: 0.0506, Perplexity: 2608.7644
2024-12-31 16:37:24,815 - TrainingLogger - INFO - Step 4790, Batch metrics: Loss: 7.0125, Accuracy: 0.0791, Perplexity: 1110.4745
2024-12-31 16:37:32,306 - TrainingLogger - INFO - Step 4800, Batch metrics: Loss: 7.1106, Accuracy: 0.0825, Perplexity: 1224.8974
2024-12-31 16:37:32,307 - TrainingLogger - INFO - Step 4800, Prediction vs Actual:
2024-12-31 16:37:32,307 - TrainingLogger - INFO - Input 1: דרעי וליצמן בסיור בנתבגצילום שאול גולן השר ליצמן הוסיף לצערנו אנחנו כמעט בטוחים שהנגיף יגיע לארץ, ואנחנו נערכים לעשות כל מה שצריך כדי לטפל בו
2024-12-31 16:37:32,308 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:37:32,308 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁דר          | ✗     |
|     1 | ן               | עי           | ✗     |
|     2 | י               | ▁ול          | ✗     |
|     3 | ות              | יצ           | ✗     |
|     4 | ר               | מן           | ✗     |
|     5 | </s>            | ▁בסיור       | ✗     |
|     6 | ים              | ▁ב           | ✗     |
|     7 | -19             | נת           | ✗     |
|     8 | וני             | בג           | ✗     |
|     9 | '               | צילום        | ✗     |
|    10 | :               | ▁שאול        | ✗     |
|    11 | י               | ▁גול         | ✗     |
|    12 | ה               | ן            | ✗     |
|    13 | :               | ▁השר         | ✗     |
|    14 | ות              | ▁לי          | ✗     |
|    15 | ח               | צ            | ✗     |
|    16 | ק               | מן           | ✗     |
|    17 | :               | ▁הוסיף       | ✗     |
|    18 | ▁את             | ▁ל           | ✗     |
|    19 | -               | צער          | ✗     |
|    20 | ▁המדינה         | נו           | ✗     |
|    21 | .               | ▁אנחנו       | ✗     |
|    22 | ב               | ▁כמעט        | ✗     |
|    23 | ▁לא             | ▁בטוחים      | ✗     |
|    24 | ▁כי             | ▁שה          | ✗     |
|    25 | י               | נגיף         | ✗     |
|    26 | ▁הזה            | ▁יגיע        | ✗     |
|    27 | ▁לשיא           | ▁לארץ        | ✗     |
|    28 | .               | ,            | ✗     |
|    29 | </s>            | ▁ואנחנו      | ✗     |
|    30 | ▁לא             | ▁נער         | ✗     |
|    31 | ף               | כים          | ✗     |
|    32 | ▁בו             | ▁לעשות       | ✗     |
|    33 | ▁זאת            | ▁כל          | ✗     |
|    34 | ▁כך             | ▁מה          | ✗     |
|    35 | ▁שהוא           | ▁שצריך       | ✗     |
|    36 | ▁כדי            | ▁כדי         | ✓     |
|    37 | ▁להגיע          | ▁לטפל        | ✗     |
|    38 | ▁בו             | ▁בו          | ✓     |
|    39 | .               |              | ✗     |

2024-12-31 16:37:32,308 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:37:32,313 - TrainingLogger - INFO - Gradient norm: 12.0032
2024-12-31 16:37:39,831 - TrainingLogger - INFO - Step 4810, Batch metrics: Loss: 7.2427, Accuracy: 0.1159, Perplexity: 1397.8526
2024-12-31 16:37:46,936 - TrainingLogger - INFO - Step 4820, Batch metrics: Loss: 7.4211, Accuracy: 0.0379, Perplexity: 1670.8468
2024-12-31 16:37:53,916 - TrainingLogger - INFO - Step 4830, Batch metrics: Loss: 7.1918, Accuracy: 0.1192, Perplexity: 1328.4488
2024-12-31 16:38:01,199 - TrainingLogger - INFO - Step 4840, Batch metrics: Loss: 7.8793, Accuracy: 0.0629, Perplexity: 2642.0102
2024-12-31 16:38:08,881 - TrainingLogger - INFO - Step 4850, Batch metrics: Loss: 7.3480, Accuracy: 0.0972, Perplexity: 1553.1510
2024-12-31 16:38:16,020 - TrainingLogger - INFO - Step 4860, Batch metrics: Loss: 7.4788, Accuracy: 0.0543, Perplexity: 1770.0281
2024-12-31 16:38:23,443 - TrainingLogger - INFO - Step 4870, Batch metrics: Loss: 7.3361, Accuracy: 0.0773, Perplexity: 1534.7642
2024-12-31 16:38:30,735 - TrainingLogger - INFO - Step 4880, Batch metrics: Loss: 7.0379, Accuracy: 0.1256, Perplexity: 1138.9986
2024-12-31 16:38:37,556 - TrainingLogger - INFO - Step 4890, Batch metrics: Loss: 7.1346, Accuracy: 0.1314, Perplexity: 1254.5766
2024-12-31 16:38:45,226 - TrainingLogger - INFO - Step 4900, Batch metrics: Loss: 7.4927, Accuracy: 0.0595, Perplexity: 1794.9091
2024-12-31 16:38:45,226 - TrainingLogger - INFO - Step 4900, Prediction vs Actual:
2024-12-31 16:38:45,226 - TrainingLogger - INFO - Input 1: ראשי העבודה וגשר ינטשו?צילום יאיר שגיא כבר עם פרסום תוצאות הבחירות, ערך נתניהו שיחות עם ראשי מפלגות הימין והחרדים וביקש מהם להתלכד סביבו בניסיון להקים ממשלה
2024-12-31 16:38:45,227 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:38:45,227 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ראשי        | ✗     |
|     1 | :               | ▁העבודה      | ✗     |
|     2 | ▁הטובה          | ▁ו           | ✗     |
|     3 | ▁צוות           | גשר          | ✗     |
|     4 | ▁-              | ▁י           | ✗     |
|     5 | ועדה            | נט           | ✗     |
|     6 | ז               | שו           | ✗     |
|     7 | ▁אותי           | ?            | ✗     |
|     8 | </s>            | צילום        | ✗     |
|     9 | :               | ▁יאיר        | ✗     |
|    10 | :               | ▁שג          | ✗     |
|    11 | ות              | יא           | ✗     |
|    12 | טוס             | ▁כבר         | ✗     |
|    13 | ▁אחריו          | ▁עם          | ✗     |
|    14 | <pad>           | ▁פרסום       | ✗     |
|    15 | ▁חדש            | ▁תוצאות      | ✗     |
|    16 | ▁הבדיקה         | ▁הבחירות     | ✗     |
|    17 | ▁שלו            | ,            | ✗     |
|    18 | <pad>           | ▁ערך         | ✗     |
|    19 | ▁החברה          | ▁נתנ         | ✗     |
|    20 | י               | יהו          | ✗     |
|    21 | .               | ▁שיחות       | ✗     |
|    22 | ▁חדשות          | ▁עם          | ✗     |
|    23 | ▁חבר            | ▁ראשי        | ✗     |
|    24 | -               | ▁מ           | ✗     |
|    25 | ועצת            | פלג          | ✗     |
|    26 | ות              | ות           | ✓     |
|    27 | ▁שונות          | ▁הי          | ✗     |
|    28 | נן              | מין          | ✗     |
|    29 | -               | ▁והח         | ✗     |
|    30 | מה              | רד           | ✗     |
|    31 | ות              | ים           | ✗     |
|    32 | .               | ▁וביקש       | ✗     |
|    33 | ו               | ▁מהם         | ✗     |
|    34 | </s>            | ▁להת         | ✗     |
|    35 | יי              | לכד          | ✗     |
|    36 | ות              | ▁סביבו       | ✗     |
|    37 | .               | ▁בניסיון     | ✗     |
|    38 | ▁להציל          | ▁להקים       | ✗     |
|    39 | ▁את             | ▁ממשלה       | ✗     |
|    40 | ▁חדשה           | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               |              | ✗     |

2024-12-31 16:38:45,227 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:38:45,232 - TrainingLogger - INFO - Gradient norm: 9.8199
2024-12-31 16:38:52,115 - TrainingLogger - INFO - Step 4910, Batch metrics: Loss: 7.5076, Accuracy: 0.0889, Perplexity: 1821.8808
2024-12-31 16:38:59,034 - TrainingLogger - INFO - Step 4920, Batch metrics: Loss: 7.1898, Accuracy: 0.0950, Perplexity: 1325.9009
2024-12-31 16:39:06,512 - TrainingLogger - INFO - Step 4930, Batch metrics: Loss: 7.7226, Accuracy: 0.0872, Perplexity: 2258.8033
2024-12-31 16:39:13,760 - TrainingLogger - INFO - Step 4940, Batch metrics: Loss: 7.2866, Accuracy: 0.0833, Perplexity: 1460.5887
2024-12-31 16:39:21,072 - TrainingLogger - INFO - Step 4950, Batch metrics: Loss: 7.3572, Accuracy: 0.1007, Perplexity: 1567.5143
2024-12-31 16:39:28,380 - TrainingLogger - INFO - Step 4960, Batch metrics: Loss: 7.4935, Accuracy: 0.0704, Perplexity: 1796.2396
2024-12-31 16:39:36,236 - TrainingLogger - INFO - Step 4970, Batch metrics: Loss: 7.6034, Accuracy: 0.0725, Perplexity: 2005.0888
2024-12-31 16:39:43,321 - TrainingLogger - INFO - Step 4980, Batch metrics: Loss: 7.2401, Accuracy: 0.0856, Perplexity: 1394.2678
2024-12-31 16:39:51,038 - TrainingLogger - INFO - Step 4990, Batch metrics: Loss: 7.2490, Accuracy: 0.0909, Perplexity: 1406.6607
2024-12-31 16:39:57,564 - TrainingLogger - INFO - Step 5000, Batch metrics: Loss: 7.2907, Accuracy: 0.0625, Perplexity: 1466.5675
2024-12-31 16:39:57,564 - TrainingLogger - INFO - Step 5000, Prediction vs Actual:
2024-12-31 16:39:57,565 - TrainingLogger - INFO - Input 1: אנשים כמו אלון שוסטר, למשל, הם אנשי שמאל מובהק
2024-12-31 16:39:57,565 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:39:57,565 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אנשים       | ✗     |
|     1 | ▁אחרים          | ▁כמו         | ✗     |
|     2 | :               | ▁אל          | ✗     |
|     3 | .               | ון           | ✗     |
|     4 | .               | ▁שו          | ✗     |
|     5 | ה               | סטר          | ✗     |
|     6 | ון              | ,            | ✗     |
|     7 | <pad>           | ▁למשל        | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | </s>            | ▁הם          | ✗     |
|    10 | ▁היו            | ▁אנשי        | ✗     |
|    11 | ▁צבא            | ▁שמאל        | ✗     |
|    12 | ,               | ▁מ           | ✗     |
|    13 | הממשלה          | ובה          | ✗     |
|    14 | קים             | ק            | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 16:39:57,565 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:39:57,570 - TrainingLogger - INFO - Gradient norm: 14.5039
2024-12-31 16:40:04,628 - TrainingLogger - INFO - Step 5010, Batch metrics: Loss: 7.5228, Accuracy: 0.0734, Perplexity: 1849.8001
2024-12-31 16:40:11,887 - TrainingLogger - INFO - Step 5020, Batch metrics: Loss: 7.1796, Accuracy: 0.0765, Perplexity: 1312.4198
2024-12-31 16:40:19,405 - TrainingLogger - INFO - Step 5030, Batch metrics: Loss: 7.5607, Accuracy: 0.0794, Perplexity: 1921.2502
2024-12-31 16:40:26,239 - TrainingLogger - INFO - Step 5040, Batch metrics: Loss: 7.2848, Accuracy: 0.0820, Perplexity: 1457.9091
2024-12-31 16:40:32,763 - TrainingLogger - INFO - Step 5050, Batch metrics: Loss: 7.2812, Accuracy: 0.0928, Perplexity: 1452.6831
2024-12-31 16:40:39,931 - TrainingLogger - INFO - Step 5060, Batch metrics: Loss: 7.6117, Accuracy: 0.0682, Perplexity: 2021.7835
2024-12-31 16:40:47,412 - TrainingLogger - INFO - Step 5070, Batch metrics: Loss: 7.6298, Accuracy: 0.0681, Perplexity: 2058.5417
2024-12-31 16:40:54,600 - TrainingLogger - INFO - Step 5080, Batch metrics: Loss: 7.4334, Accuracy: 0.0688, Perplexity: 1691.5864
2024-12-31 16:41:01,429 - TrainingLogger - INFO - Step 5090, Batch metrics: Loss: 6.8033, Accuracy: 0.0949, Perplexity: 900.7746
2024-12-31 16:41:08,243 - TrainingLogger - INFO - Step 5100, Batch metrics: Loss: 7.7206, Accuracy: 0.0811, Perplexity: 2254.2615
2024-12-31 16:41:08,243 - TrainingLogger - INFO - Step 5100, Prediction vs Actual:
2024-12-31 16:41:08,243 - TrainingLogger - INFO - Input 1: אתמול ננעל המסחר בוול סטריט בירידות שערים חדות את הנפילות הוביל מדד מניות הטכנולוגיה נאסדק שצלל ב-37
2024-12-31 16:41:08,244 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:41:08,244 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אתמול       | ✗     |
|     1 | .               | ▁ננעל        | ✗     |
|     2 | ה               | ▁המסחר       | ✗     |
|     3 | י               | ▁בוול        | ✗     |
|     4 | אס              | ▁סטריט       | ✗     |
|     5 | לנד             | ▁ביריד       | ✗     |
|     6 | ה               | ות           | ✗     |
|     7 | ▁גבוהה          | ▁שער         | ✗     |
|     8 | ים              | ים           | ✓     |
|     9 | .               | ▁חדות        | ✗     |
|    10 | .               | ▁את          | ✗     |
|    11 | ר               | ▁ה           | ✗     |
|    12 | -1              | נפיל         | ✗     |
|    13 | ות              | ות           | ✓     |
|    14 | .               | ▁הוביל       | ✗     |
|    15 | ות              | ▁מדד         | ✗     |
|    16 | ים              | ▁מניות       | ✗     |
|    17 | .               | ▁הטכנולוגיה  | ✗     |
|    18 | .               | ▁נא          | ✗     |
|    19 | ים              | סדק          | ✗     |
|    20 | ות              | ▁שצ          | ✗     |
|    21 | בר              | לל           | ✗     |
|    22 | ▁את             | ▁ב           | ✗     |
|    23 | -20             | -            | ✗     |
|    24 | 26              | 37           | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | ▁את             |              | ✗     |

2024-12-31 16:41:08,244 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:41:08,249 - TrainingLogger - INFO - Gradient norm: 10.9858
2024-12-31 16:41:15,779 - TrainingLogger - INFO - Step 5110, Batch metrics: Loss: 7.1352, Accuracy: 0.0582, Perplexity: 1255.3270
2024-12-31 16:41:23,243 - TrainingLogger - INFO - Step 5120, Batch metrics: Loss: 7.7587, Accuracy: 0.0533, Perplexity: 2341.7519
2024-12-31 16:41:30,607 - TrainingLogger - INFO - Step 5130, Batch metrics: Loss: 7.4976, Accuracy: 0.0562, Perplexity: 1803.7583
2024-12-31 16:41:37,390 - TrainingLogger - INFO - Step 5140, Batch metrics: Loss: 7.2758, Accuracy: 0.0815, Perplexity: 1444.9029
2024-12-31 16:41:44,983 - TrainingLogger - INFO - Step 5150, Batch metrics: Loss: 7.4678, Accuracy: 0.0691, Perplexity: 1750.7919
2024-12-31 16:41:51,992 - TrainingLogger - INFO - Step 5160, Batch metrics: Loss: 7.2267, Accuracy: 0.0941, Perplexity: 1375.6521
2024-12-31 16:41:58,403 - TrainingLogger - INFO - Step 5170, Batch metrics: Loss: 7.6705, Accuracy: 0.0757, Perplexity: 2144.1958
2024-12-31 16:42:05,926 - TrainingLogger - INFO - Step 5180, Batch metrics: Loss: 7.6414, Accuracy: 0.0821, Perplexity: 2082.7118
2024-12-31 16:42:13,025 - TrainingLogger - INFO - Step 5190, Batch metrics: Loss: 7.2094, Accuracy: 0.0798, Perplexity: 1352.0462
2024-12-31 16:42:19,648 - TrainingLogger - INFO - Step 5200, Batch metrics: Loss: 7.4728, Accuracy: 0.0905, Perplexity: 1759.4799
2024-12-31 16:42:19,648 - TrainingLogger - INFO - Step 5200, Prediction vs Actual:
2024-12-31 16:42:19,648 - TrainingLogger - INFO - Input 1: בעבר, דברים מסוג זה נכפו על ידי החלטות שיפוטיות
2024-12-31 16:42:19,649 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:42:19,649 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | -               | ▁בעבר        | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | <pad>           | ▁דברים       | ✗     |
|     3 | ▁כאלה           | ▁מסוג        | ✗     |
|     4 | ▁זה             | ▁זה          | ✓     |
|     5 | .               | ▁נ           | ✗     |
|     6 | מתח             | כפו          | ✗     |
|     7 | ים              | ▁על          | ✗     |
|     8 | ▁ידי            | ▁ידי         | ✓     |
|     9 | ▁אנשים          | ▁החלטות      | ✗     |
|    10 | ▁אחרות          | ▁שיפוט       | ✗     |
|    11 | יות             | יות          | ✓     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | יות             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 16:42:19,649 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:42:19,654 - TrainingLogger - INFO - Gradient norm: 12.5760
2024-12-31 16:42:27,254 - TrainingLogger - INFO - Step 5210, Batch metrics: Loss: 7.1664, Accuracy: 0.0761, Perplexity: 1295.1155
2024-12-31 16:42:34,236 - TrainingLogger - INFO - Step 5220, Batch metrics: Loss: 7.3729, Accuracy: 0.1163, Perplexity: 1592.1733
2024-12-31 16:42:41,250 - TrainingLogger - INFO - Step 5230, Batch metrics: Loss: 7.1856, Accuracy: 0.0776, Perplexity: 1320.2425
2024-12-31 16:42:48,533 - TrainingLogger - INFO - Step 5240, Batch metrics: Loss: 6.8026, Accuracy: 0.0724, Perplexity: 900.2095
2024-12-31 16:42:55,543 - TrainingLogger - INFO - Step 5250, Batch metrics: Loss: 6.6947, Accuracy: 0.0857, Perplexity: 808.0801
2024-12-31 16:43:02,918 - TrainingLogger - INFO - Step 5260, Batch metrics: Loss: 7.5115, Accuracy: 0.0653, Perplexity: 1828.8954
2024-12-31 16:43:09,575 - TrainingLogger - INFO - Step 5270, Batch metrics: Loss: 7.5035, Accuracy: 0.0526, Perplexity: 1814.4007
2024-12-31 16:43:17,374 - TrainingLogger - INFO - Step 5280, Batch metrics: Loss: 7.7182, Accuracy: 0.0833, Perplexity: 2248.9888
2024-12-31 16:43:24,665 - TrainingLogger - INFO - Step 5290, Batch metrics: Loss: 7.6637, Accuracy: 0.0833, Perplexity: 2129.6075
2024-12-31 16:43:32,149 - TrainingLogger - INFO - Step 5300, Batch metrics: Loss: 7.1034, Accuracy: 0.0878, Perplexity: 1216.1148
2024-12-31 16:43:32,150 - TrainingLogger - INFO - Step 5300, Prediction vs Actual:
2024-12-31 16:43:32,150 - TrainingLogger - INFO - Input 1: רצה לומר אם זה מה שמעניין אותך
2024-12-31 16:43:32,150 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:43:32,150 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁רצה         | ✗     |
|     1 | ה               | ▁לומר        | ✗     |
|     2 | ▁לך             | ▁אם          | ✗     |
|     3 | ▁אתה            | ▁זה          | ✗     |
|     4 | ▁נכון           | ▁מה          | ✗     |
|     5 | ▁שאני           | ▁שמעניין     | ✗     |
|     6 | ,               | ▁אותך        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ,               |              | ✗     |

2024-12-31 16:43:32,150 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:43:32,155 - TrainingLogger - INFO - Gradient norm: 16.7260
2024-12-31 16:43:39,510 - TrainingLogger - INFO - Step 5310, Batch metrics: Loss: 7.5936, Accuracy: 0.0736, Perplexity: 1985.4725
2024-12-31 16:43:47,104 - TrainingLogger - INFO - Step 5320, Batch metrics: Loss: 7.7113, Accuracy: 0.0652, Perplexity: 2233.4628
2024-12-31 16:43:54,403 - TrainingLogger - INFO - Step 5330, Batch metrics: Loss: 7.2927, Accuracy: 0.1016, Perplexity: 1469.6022
2024-12-31 16:44:01,610 - TrainingLogger - INFO - Step 5340, Batch metrics: Loss: 7.2072, Accuracy: 0.1019, Perplexity: 1349.1057
2024-12-31 16:44:09,052 - TrainingLogger - INFO - Step 5350, Batch metrics: Loss: 7.5792, Accuracy: 0.0503, Perplexity: 1957.1052
2024-12-31 16:44:16,149 - TrainingLogger - INFO - Step 5360, Batch metrics: Loss: 7.4249, Accuracy: 0.0864, Perplexity: 1677.2807
2024-12-31 16:44:23,473 - TrainingLogger - INFO - Step 5370, Batch metrics: Loss: 7.2430, Accuracy: 0.0859, Perplexity: 1398.2532
2024-12-31 16:44:30,504 - TrainingLogger - INFO - Step 5380, Batch metrics: Loss: 7.5332, Accuracy: 0.0833, Perplexity: 1869.0507
2024-12-31 16:44:38,229 - TrainingLogger - INFO - Step 5390, Batch metrics: Loss: 7.2107, Accuracy: 0.0881, Perplexity: 1353.7745
2024-12-31 16:44:45,284 - TrainingLogger - INFO - Step 5400, Batch metrics: Loss: 7.2328, Accuracy: 0.0761, Perplexity: 1384.1275
2024-12-31 16:44:45,284 - TrainingLogger - INFO - Step 5400, Prediction vs Actual:
2024-12-31 16:44:45,284 - TrainingLogger - INFO - Input 1: מישל בוסקילהצילום דודו פאן הצילום זה מאוד מצער לומר שבגלל נתניהו לא הצלחנו להקים ממשלה, הוא הוסיף
2024-12-31 16:44:45,285 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:44:45,285 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מישל        | ✗     |
|     1 | ▁היא            | ▁בו          | ✗     |
|     2 | רלי             | סקי          | ✗     |
|     3 | ונה             | לה           | ✗     |
|     4 | ונה             | צילום        | ✗     |
|     5 | מה              | ▁דוד         | ✗     |
|     6 | ן               | ו            | ✗     |
|     7 | ▁שרה            | ▁פא          | ✗     |
|     8 | נסי             | ן            | ✗     |
|     9 | -               | ▁הצילום      | ✗     |
|    10 | ▁של             | ▁זה          | ✗     |
|    11 | ▁עתה            | ▁מאוד        | ✗     |
|    12 | ▁קשה            | ▁מצער        | ✗     |
|    13 | .               | ▁לומר        | ✗     |
|    14 | ▁את             | ▁שבגלל       | ✗     |
|    15 | ▁זה             | ▁נתנ         | ✗     |
|    16 | יה              | יהו          | ✗     |
|    17 | סון             | ▁לא          | ✗     |
|    18 | ▁היה            | ▁הצלחנו      | ✗     |
|    19 | ▁להשיג          | ▁להקים       | ✗     |
|    20 | ▁אותו           | ▁ממשלה       | ✗     |
|    21 | </s>            | ,            | ✗     |
|    22 | </s>            | ▁הוא         | ✗     |
|    23 | ▁לא             | ▁הוסיף       | ✗     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | ▁ל              | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | ▁את             | <pad>        | ✗     |
|    33 | ▁ל              | <pad>        | ✗     |
|    34 | <pad>           |              | ✗     |

2024-12-31 16:44:45,285 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:44:45,290 - TrainingLogger - INFO - Gradient norm: 11.3433
2024-12-31 16:44:52,719 - TrainingLogger - INFO - Step 5410, Batch metrics: Loss: 7.2933, Accuracy: 0.0581, Perplexity: 1470.4735
2024-12-31 16:45:00,217 - TrainingLogger - INFO - Step 5420, Batch metrics: Loss: 7.4151, Accuracy: 0.0670, Perplexity: 1660.8461
2024-12-31 16:45:07,636 - TrainingLogger - INFO - Step 5430, Batch metrics: Loss: 7.3214, Accuracy: 0.0644, Perplexity: 1512.3741
2024-12-31 16:45:14,640 - TrainingLogger - INFO - Step 5440, Batch metrics: Loss: 8.3490, Accuracy: 0.0318, Perplexity: 4226.1138
2024-12-31 16:45:21,540 - TrainingLogger - INFO - Step 5450, Batch metrics: Loss: 7.4460, Accuracy: 0.0688, Perplexity: 1712.9788
2024-12-31 16:45:28,789 - TrainingLogger - INFO - Step 5460, Batch metrics: Loss: 7.4549, Accuracy: 0.0664, Perplexity: 1728.2844
2024-12-31 16:45:35,505 - TrainingLogger - INFO - Step 5470, Batch metrics: Loss: 7.3499, Accuracy: 0.0670, Perplexity: 1555.9849
2024-12-31 16:45:42,882 - TrainingLogger - INFO - Step 5480, Batch metrics: Loss: 7.3643, Accuracy: 0.0955, Perplexity: 1578.6059
2024-12-31 16:45:49,914 - TrainingLogger - INFO - Step 5490, Batch metrics: Loss: 7.1649, Accuracy: 0.0939, Perplexity: 1293.2684
2024-12-31 16:45:57,115 - TrainingLogger - INFO - Step 5500, Batch metrics: Loss: 7.0984, Accuracy: 0.0876, Perplexity: 1210.0163
2024-12-31 16:45:57,115 - TrainingLogger - INFO - Step 5500, Prediction vs Actual:
2024-12-31 16:45:57,115 - TrainingLogger - INFO - Input 1: ואז, לרגע אחד בתוך כל הריצות, משום מה נעצרתי, הסתכלתי למעלה והרגשתי תחושה של ניתוק וחופש
2024-12-31 16:45:57,116 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:45:57,116 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁ואז         | ✗     |
|     1 | ...             | ,            | ✗     |
|     2 | ▁מה             | ▁לרגע        | ✗     |
|     3 | ...             | ▁אחד         | ✗     |
|     4 | ...             | ▁בתוך        | ✗     |
|     5 | ▁זה             | ▁כל          | ✗     |
|     6 | ▁יום            | ▁הרי         | ✗     |
|     7 | ונות            | צות          | ✗     |
|     8 | ▁האלה           | ,            | ✗     |
|     9 | </s>            | ▁משום        | ✗     |
|    10 | ▁שהוא           | ▁מה          | ✗     |
|    11 | ,               | ▁נעצר        | ✗     |
|    12 | תי              | תי           | ✓     |
|    13 | .               | ,            | ✗     |
|    14 | </s>            | ▁הסתכלתי     | ✗     |
|    15 | ▁עליו           | ▁למעלה       | ✗     |
|    16 | ,               | ▁והרגשתי     | ✗     |
|    17 | ...             | ▁תחושה       | ✗     |
|    18 | ▁רעה            | ▁של          | ✗     |
|    19 | ▁תקווה          | ▁ניתוק       | ✗     |
|    20 | .               | ▁ו           | ✗     |
|    21 | חרדה            | חופש         | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 16:45:57,116 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:45:57,121 - TrainingLogger - INFO - Gradient norm: 10.8873
2024-12-31 16:46:04,637 - TrainingLogger - INFO - Step 5510, Batch metrics: Loss: 7.3164, Accuracy: 0.0529, Perplexity: 1504.8460
2024-12-31 16:46:11,368 - TrainingLogger - INFO - Step 5520, Batch metrics: Loss: 7.1736, Accuracy: 0.1125, Perplexity: 1304.5893
2024-12-31 16:46:18,792 - TrainingLogger - INFO - Step 5530, Batch metrics: Loss: 7.9637, Accuracy: 0.1015, Perplexity: 2874.6357
2024-12-31 16:46:26,363 - TrainingLogger - INFO - Step 5540, Batch metrics: Loss: 7.0674, Accuracy: 0.0773, Perplexity: 1173.1365
2024-12-31 16:46:33,776 - TrainingLogger - INFO - Step 5550, Batch metrics: Loss: 6.8339, Accuracy: 0.0802, Perplexity: 928.8096
2024-12-31 16:46:40,699 - TrainingLogger - INFO - Step 5560, Batch metrics: Loss: 7.6478, Accuracy: 0.0582, Perplexity: 2095.9952
2024-12-31 16:46:47,844 - TrainingLogger - INFO - Step 5570, Batch metrics: Loss: 7.6782, Accuracy: 0.0562, Perplexity: 2160.8089
2024-12-31 16:46:55,281 - TrainingLogger - INFO - Step 5580, Batch metrics: Loss: 7.5672, Accuracy: 0.0534, Perplexity: 1933.6818
2024-12-31 16:47:01,941 - TrainingLogger - INFO - Step 5590, Batch metrics: Loss: 7.0507, Accuracy: 0.0636, Perplexity: 1153.6833
2024-12-31 16:47:09,360 - TrainingLogger - INFO - Step 5600, Batch metrics: Loss: 7.5938, Accuracy: 0.0817, Perplexity: 1985.8048
2024-12-31 16:47:09,361 - TrainingLogger - INFO - Step 5600, Prediction vs Actual:
2024-12-31 16:47:09,361 - TrainingLogger - INFO - Input 1: בכל הפרמטרים האחרים יש אי-הצלחה עד כישלון מהדהד
2024-12-31 16:47:09,361 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:47:09,361 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בכל         | ✗     |
|     1 | .               | ▁הפר         | ✗     |
|     2 | .               | מטר          | ✗     |
|     3 | ,               | ים           | ✗     |
|     4 | ▁שלך            | ▁האחרים      | ✗     |
|     5 | .               | ▁יש          | ✗     |
|     6 | ▁לנו            | ▁אי          | ✗     |
|     7 | -               | -            | ✓     |
|     8 | אלו             | הצלחה        | ✗     |
|     9 | ים              | ▁עד          | ✗     |
|    10 | ▁היום           | ▁כישלון      | ✗     |
|    11 | ים              | ▁מה          | ✗     |
|    12 | ות              | דה           | ✗     |
|    13 | ד               | ד            | ✓     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | ▁מחדש           | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ▁המדינה         | <pad>        | ✗     |
|    23 | -               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁הזה            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ▁החוק           | <pad>        | ✗     |
|    35 | -               | <pad>        | ✗     |
|    36 | ות              | <pad>        | ✗     |
|    37 | ▁אומר           | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | יות             | <pad>        | ✗     |
|    42 | ▁               | <pad>        | ✗     |
|    43 | ות              | <pad>        | ✗     |
|    44 | י               | <pad>        | ✗     |
|    45 | ויות            | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | -               | <pad>        | ✗     |
|    48 | יום             | <pad>        | ✗     |
|    49 | -               | <pad>        | ✗     |
|    50 | ▁המדינה         | <pad>        | ✗     |
|    51 | -               | <pad>        | ✗     |
|    52 | -               | <pad>        | ✗     |
|    53 | </s>            | <pad>        | ✗     |
|    54 | -               | <pad>        | ✗     |
|    55 | .               | <pad>        | ✗     |
|    56 | -               | <pad>        | ✗     |
|    57 | -               | <pad>        | ✗     |
|    58 | -               |              | ✗     |

2024-12-31 16:47:09,361 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:47:09,366 - TrainingLogger - INFO - Gradient norm: 10.8854
2024-12-31 16:47:16,172 - TrainingLogger - INFO - Step 5610, Batch metrics: Loss: 7.2622, Accuracy: 0.0659, Perplexity: 1425.3663
2024-12-31 16:47:23,481 - TrainingLogger - INFO - Step 5620, Batch metrics: Loss: 7.7968, Accuracy: 0.0638, Perplexity: 2432.9174
2024-12-31 16:47:31,105 - TrainingLogger - INFO - Step 5630, Batch metrics: Loss: 7.8481, Accuracy: 0.0490, Perplexity: 2560.8401
2024-12-31 16:47:37,890 - TrainingLogger - INFO - Step 5640, Batch metrics: Loss: 7.5198, Accuracy: 0.0480, Perplexity: 1844.2005
2024-12-31 16:47:45,155 - TrainingLogger - INFO - Step 5650, Batch metrics: Loss: 7.6215, Accuracy: 0.0805, Perplexity: 2041.5989
2024-12-31 16:47:53,033 - TrainingLogger - INFO - Step 5660, Batch metrics: Loss: 7.3908, Accuracy: 0.0710, Perplexity: 1621.0055
2024-12-31 16:48:00,235 - TrainingLogger - INFO - Step 5670, Batch metrics: Loss: 7.6378, Accuracy: 0.0542, Perplexity: 2075.0818
2024-12-31 16:48:06,993 - TrainingLogger - INFO - Step 5680, Batch metrics: Loss: 7.3874, Accuracy: 0.0604, Perplexity: 1615.5237
2024-12-31 16:48:14,288 - TrainingLogger - INFO - Step 5690, Batch metrics: Loss: 7.6397, Accuracy: 0.0882, Perplexity: 2079.0485
2024-12-31 16:48:21,688 - TrainingLogger - INFO - Step 5700, Batch metrics: Loss: 7.5505, Accuracy: 0.1022, Perplexity: 1901.6660
2024-12-31 16:48:21,689 - TrainingLogger - INFO - Step 5700, Prediction vs Actual:
2024-12-31 16:48:21,689 - TrainingLogger - INFO - Input 1: בשיר נצמד קצלסון לגישתו הרווחת ברבות מיצירתיו על אף הקושי הברור, יש לקוות לקיומו של אור בקצה המנהרה
2024-12-31 16:48:21,689 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:48:21,689 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בשיר        | ✗     |
|     1 | ון              | ▁נצמד        | ✗     |
|     2 | ▁-              | ▁קצ          | ✗     |
|     3 | יצ              | לס           | ✗     |
|     4 | ב               | ון           | ✗     |
|     5 | .               | ▁לג          | ✗     |
|     6 | '               | יש           | ✗     |
|     7 | אס              | תו           | ✗     |
|     8 | ▁הראשונה        | ▁הרווחת      | ✗     |
|     9 | ב               | ▁ב           | ✗     |
|    10 | -19             | רבות         | ✗     |
|    11 | ו               | ▁מ           | ✗     |
|    12 | מקומות          | יצירת        | ✗     |
|    13 | ו               | יו           | ✗     |
|    14 | ▁הקודמים        | ▁על          | ✗     |
|    15 | ▁מנת            | ▁אף          | ✗     |
|    16 | ▁שהוא           | ▁הקושי       | ✗     |
|    17 | ▁עם             | ▁ה           | ✗     |
|    18 | כנים            | ברור         | ✗     |
|    19 | ים              | ,            | ✗     |
|    20 | </s>            | ▁יש          | ✗     |
|    21 | ▁לנו            | ▁לקוות       | ✗     |
|    22 | .               | ▁לקיומו      | ✗     |
|    23 | ▁של             | ▁של          | ✓     |
|    24 | ▁עולם           | ▁אור         | ✗     |
|    25 | ▁יום            | ▁בקצה        | ✗     |
|    26 | ▁הצפוני         | ▁המנהרה      | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 16:48:21,689 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:48:21,694 - TrainingLogger - INFO - Gradient norm: 11.7110
2024-12-31 16:48:28,687 - TrainingLogger - INFO - Step 5710, Batch metrics: Loss: 7.4111, Accuracy: 0.0476, Perplexity: 1654.2212
2024-12-31 16:48:35,968 - TrainingLogger - INFO - Step 5720, Batch metrics: Loss: 7.2288, Accuracy: 0.0714, Perplexity: 1378.5348
2024-12-31 16:48:43,029 - TrainingLogger - INFO - Step 5730, Batch metrics: Loss: 7.2521, Accuracy: 0.0862, Perplexity: 1411.0925
2024-12-31 16:48:50,331 - TrainingLogger - INFO - Step 5740, Batch metrics: Loss: 7.3855, Accuracy: 0.0635, Perplexity: 1612.5137
2024-12-31 16:48:57,124 - TrainingLogger - INFO - Step 5750, Batch metrics: Loss: 7.4258, Accuracy: 0.0855, Perplexity: 1678.7009
2024-12-31 16:49:04,695 - TrainingLogger - INFO - Step 5760, Batch metrics: Loss: 7.2732, Accuracy: 0.0773, Perplexity: 1441.1170
2024-12-31 16:49:12,198 - TrainingLogger - INFO - Step 5770, Batch metrics: Loss: 7.6925, Accuracy: 0.0593, Perplexity: 2191.7964
2024-12-31 16:49:19,433 - TrainingLogger - INFO - Step 5780, Batch metrics: Loss: 8.2941, Accuracy: 0.0476, Perplexity: 4000.3533
2024-12-31 16:49:26,414 - TrainingLogger - INFO - Step 5790, Batch metrics: Loss: 7.3528, Accuracy: 0.0820, Perplexity: 1560.6074
2024-12-31 16:49:33,245 - TrainingLogger - INFO - Step 5800, Batch metrics: Loss: 7.0563, Accuracy: 0.0598, Perplexity: 1160.1936
2024-12-31 16:49:33,245 - TrainingLogger - INFO - Step 5800, Prediction vs Actual:
2024-12-31 16:49:33,245 - TrainingLogger - INFO - Input 1: עם זאת הדגישה כי היא תומכת בעמדה שלפיה יש לעודד את כולם לצאת לעבוד
2024-12-31 16:49:33,246 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:49:33,246 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁עם          | ✗     |
|     1 | .               | ▁זאת         | ✗     |
|     2 | ,               | ▁הדגיש       | ✗     |
|     3 | ▁את             | ה            | ✗     |
|     4 | ▁את             | ▁כי          | ✗     |
|     5 | ▁זה             | ▁היא         | ✗     |
|     6 | ▁אוהבת          | ▁תומכת       | ✗     |
|     7 | ▁ב              | ▁בעמדה       | ✗     |
|     8 | ▁חדשה           | ▁שלפיה       | ✗     |
|     9 | ▁הוא            | ▁יש          | ✗     |
|    10 | ▁לה             | ▁לעודד       | ✗     |
|    11 | </s>            | ▁את          | ✗     |
|    12 | ▁הילדים         | ▁כולם        | ✗     |
|    13 | .               | ▁לצאת        | ✗     |
|    14 | ▁לדרך           | ▁לעבוד       | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 16:49:33,246 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:49:33,251 - TrainingLogger - INFO - Gradient norm: 11.0377
2024-12-31 16:49:41,021 - TrainingLogger - INFO - Step 5810, Batch metrics: Loss: 7.2674, Accuracy: 0.0852, Perplexity: 1432.7674
2024-12-31 16:49:47,918 - TrainingLogger - INFO - Step 5820, Batch metrics: Loss: 7.4046, Accuracy: 0.0841, Perplexity: 1643.4680
2024-12-31 16:49:55,067 - TrainingLogger - INFO - Step 5830, Batch metrics: Loss: 7.1658, Accuracy: 0.0864, Perplexity: 1294.3326
2024-12-31 16:50:02,478 - TrainingLogger - INFO - Step 5840, Batch metrics: Loss: 7.0210, Accuracy: 0.0913, Perplexity: 1119.8760
2024-12-31 16:50:10,031 - TrainingLogger - INFO - Step 5850, Batch metrics: Loss: 7.2775, Accuracy: 0.0947, Perplexity: 1447.3915
2024-12-31 16:50:16,528 - TrainingLogger - INFO - Step 5860, Batch metrics: Loss: 7.0854, Accuracy: 0.1364, Perplexity: 1194.4443
2024-12-31 16:50:23,696 - TrainingLogger - INFO - Step 5870, Batch metrics: Loss: 7.2424, Accuracy: 0.0909, Perplexity: 1397.4467
2024-12-31 16:50:31,274 - TrainingLogger - INFO - Step 5880, Batch metrics: Loss: 7.2774, Accuracy: 0.0482, Perplexity: 1447.1597
2024-12-31 16:50:38,807 - TrainingLogger - INFO - Step 5890, Batch metrics: Loss: 6.9439, Accuracy: 0.1149, Perplexity: 1036.8233
2024-12-31 16:50:46,394 - TrainingLogger - INFO - Step 5900, Batch metrics: Loss: 7.2961, Accuracy: 0.1038, Perplexity: 1474.5565
2024-12-31 16:50:46,394 - TrainingLogger - INFO - Step 5900, Prediction vs Actual:
2024-12-31 16:50:46,395 - TrainingLogger - INFO - Input 1: גורם אמריקני המקורב לשיחות להפסקת אש אמר כי ישראל עדיין מתכננת לתקוף ברפיח, אך ארהב מחויבת לעצור זאת
2024-12-31 16:50:46,395 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:50:46,395 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁גורם        | ✗     |
|     1 | ▁ל              | ▁אמריקני     | ✗     |
|     2 | ▁קשה            | ▁המקור       | ✗     |
|     3 | ני              | ב            | ✗     |
|     4 | ▁ל              | ▁לשיחות      | ✗     |
|     5 | ▁קשות           | ▁ל           | ✗     |
|     6 | בחירה           | הפסקת        | ✗     |
|     7 | ▁אש             | ▁אש          | ✓     |
|     8 | ,               | ▁אמר         | ✗     |
|     9 | ות              | ▁כי          | ✗     |
|    10 | ...             | ▁ישראל       | ✗     |
|    11 | ▁הוא            | ▁עדיין       | ✗     |
|    12 | ▁לא             | ▁מתכננת      | ✗     |
|    13 | ▁את             | ▁לתקוף       | ✗     |
|    14 | ▁את             | ▁בר          | ✗     |
|    15 | -               | פיח          | ✗     |
|    16 | ה               | ,            | ✗     |
|    17 | </s>            | ▁אך          | ✗     |
|    18 | ▁לא             | ▁ארה         | ✗     |
|    19 | "               | ב            | ✗     |
|    20 | ▁עם             | ▁מחויב       | ✗     |
|    21 | ▁לה             | ת            | ✗     |
|    22 | ▁לכך            | ▁לעצור       | ✗     |
|    23 | ▁את             | ▁זאת         | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 16:50:46,395 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:50:46,400 - TrainingLogger - INFO - Gradient norm: 10.6359
2024-12-31 16:50:53,661 - TrainingLogger - INFO - Step 5910, Batch metrics: Loss: 7.4470, Accuracy: 0.0417, Perplexity: 1714.6394
2024-12-31 16:51:01,302 - TrainingLogger - INFO - Step 5920, Batch metrics: Loss: 7.4088, Accuracy: 0.0648, Perplexity: 1650.4551
2024-12-31 16:51:08,512 - TrainingLogger - INFO - Step 5930, Batch metrics: Loss: 7.7592, Accuracy: 0.0728, Perplexity: 2342.9403
2024-12-31 16:51:15,776 - TrainingLogger - INFO - Step 5940, Batch metrics: Loss: 7.5619, Accuracy: 0.0559, Perplexity: 1923.5630
2024-12-31 16:51:22,654 - TrainingLogger - INFO - Step 5950, Batch metrics: Loss: 7.9137, Accuracy: 0.0299, Perplexity: 2734.5809
2024-12-31 16:51:29,942 - TrainingLogger - INFO - Step 5960, Batch metrics: Loss: 7.1755, Accuracy: 0.0739, Perplexity: 1306.9803
2024-12-31 16:51:36,947 - TrainingLogger - INFO - Step 5970, Batch metrics: Loss: 7.5566, Accuracy: 0.1058, Perplexity: 1913.3558
2024-12-31 16:51:44,065 - TrainingLogger - INFO - Step 5980, Batch metrics: Loss: 6.6930, Accuracy: 0.1498, Perplexity: 806.7249
2024-12-31 16:51:51,878 - TrainingLogger - INFO - Step 5990, Batch metrics: Loss: 7.1702, Accuracy: 0.0842, Perplexity: 1300.1652
2024-12-31 16:51:59,469 - TrainingLogger - INFO - Step 6000, Batch metrics: Loss: 7.2034, Accuracy: 0.1081, Perplexity: 1343.9550
2024-12-31 16:51:59,470 - TrainingLogger - INFO - Step 6000, Prediction vs Actual:
2024-12-31 16:51:59,470 - TrainingLogger - INFO - Input 1: בדומה לאחרים שעבדו בסביבתה של רמון, בחרה קשת-מאור לציין את צניעותה של רמון כאחד המאפיינים המרכזיים באישיותה
2024-12-31 16:51:59,470 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:51:59,470 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁בדומה       | ✗     |
|     1 | ▁לזה            | ▁לאחרים      | ✗     |
|     2 | ,               | ▁שעבדו       | ✗     |
|     3 | תם              | ▁בסביבת      | ✗     |
|     4 | ם               | ה            | ✗     |
|     5 | ▁של             | ▁של          | ✓     |
|     6 | ▁המדינה         | ▁רמון        | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | ▁הוא            | ▁בחרה        | ✗     |
|     9 | ▁בו             | ▁קשת         | ✗     |
|    10 | ▁חדשה           | -            | ✗     |
|    11 | דין             | מ            | ✗     |
|    12 | ועצת            | אור          | ✗     |
|    13 | תו              | ▁לציין       | ✗     |
|    14 | ,               | ▁את          | ✗     |
|    15 | ו               | ▁צניעות      | ✗     |
|    16 | ה               | ה            | ✓     |
|    17 | ▁של             | ▁של          | ✓     |
|    18 | ▁המדינה         | ▁רמון        | ✗     |
|    19 | .               | ▁כאחד        | ✗     |
|    20 | .               | ▁המאפיינים   | ✗     |
|    21 | ▁שלו            | ▁המרכזי      | ✗     |
|    22 | ים              | ים           | ✓     |
|    23 | ▁שלו            | ▁באישיות     | ✗     |
|    24 | ▁שלו            | ה            | ✗     |
|    25 | ▁של             | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ▁שלה            | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 16:51:59,470 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:51:59,475 - TrainingLogger - INFO - Gradient norm: 11.5494
2024-12-31 16:52:06,512 - TrainingLogger - INFO - Step 6010, Batch metrics: Loss: 7.3630, Accuracy: 0.0796, Perplexity: 1576.6034
2024-12-31 16:52:13,212 - TrainingLogger - INFO - Step 6020, Batch metrics: Loss: 7.6434, Accuracy: 0.0806, Perplexity: 2086.9100
2024-12-31 16:52:20,916 - TrainingLogger - INFO - Step 6030, Batch metrics: Loss: 6.8797, Accuracy: 0.0995, Perplexity: 972.3186
2024-12-31 16:52:28,479 - TrainingLogger - INFO - Step 6040, Batch metrics: Loss: 8.2365, Accuracy: 0.0504, Perplexity: 3776.3677
2024-12-31 16:52:35,688 - TrainingLogger - INFO - Step 6050, Batch metrics: Loss: 7.1548, Accuracy: 0.1111, Perplexity: 1280.2705
2024-12-31 16:52:42,704 - TrainingLogger - INFO - Step 6060, Batch metrics: Loss: 6.6076, Accuracy: 0.1274, Perplexity: 740.6691
2024-12-31 16:52:49,680 - TrainingLogger - INFO - Step 6070, Batch metrics: Loss: 7.5720, Accuracy: 0.0736, Perplexity: 1943.1124
2024-12-31 16:52:56,938 - TrainingLogger - INFO - Step 6080, Batch metrics: Loss: 7.6406, Accuracy: 0.0966, Perplexity: 2081.0133
2024-12-31 16:53:04,236 - TrainingLogger - INFO - Step 6090, Batch metrics: Loss: 6.9763, Accuracy: 0.1005, Perplexity: 1070.9268
2024-12-31 16:53:11,686 - TrainingLogger - INFO - Step 6100, Batch metrics: Loss: 7.4979, Accuracy: 0.0815, Perplexity: 1804.3063
2024-12-31 16:53:11,687 - TrainingLogger - INFO - Step 6100, Prediction vs Actual:
2024-12-31 16:53:11,687 - TrainingLogger - INFO - Input 1: ההנהגה הנוכחית איבדה כל בושה
2024-12-31 16:53:11,687 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:53:11,687 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הה          | ✗     |
|     1 | ▁זה             | נהג          | ✗     |
|     2 | ה               | ה            | ✓     |
|     3 | ▁שלנו           | ▁הנוכחית     | ✗     |
|     4 | ▁שלנו           | ▁איבדה       | ✗     |
|     5 | ▁את             | ▁כל          | ✗     |
|     6 | ▁סיכוי          | ▁בושה        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ה               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁תקווה          | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁את             | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ▁את             |              | ✗     |

2024-12-31 16:53:11,687 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:53:11,692 - TrainingLogger - INFO - Gradient norm: 19.3869
2024-12-31 16:53:18,505 - TrainingLogger - INFO - Step 6110, Batch metrics: Loss: 7.4862, Accuracy: 0.0682, Perplexity: 1783.3450
2024-12-31 16:53:25,685 - TrainingLogger - INFO - Step 6120, Batch metrics: Loss: 7.4950, Accuracy: 0.0725, Perplexity: 1799.1078
2024-12-31 16:53:32,733 - TrainingLogger - INFO - Step 6130, Batch metrics: Loss: 7.4517, Accuracy: 0.0888, Perplexity: 1722.7881
2024-12-31 16:53:40,467 - TrainingLogger - INFO - Step 6140, Batch metrics: Loss: 7.3396, Accuracy: 0.0793, Perplexity: 1540.1401
2024-12-31 16:53:47,592 - TrainingLogger - INFO - Step 6150, Batch metrics: Loss: 6.7554, Accuracy: 0.0940, Perplexity: 858.7066
2024-12-31 16:53:54,692 - TrainingLogger - INFO - Step 6160, Batch metrics: Loss: 7.4688, Accuracy: 0.0741, Perplexity: 1752.5151
2024-12-31 16:54:01,861 - TrainingLogger - INFO - Step 6170, Batch metrics: Loss: 7.4924, Accuracy: 0.0625, Perplexity: 1794.2878
2024-12-31 16:54:08,982 - TrainingLogger - INFO - Step 6180, Batch metrics: Loss: 7.8194, Accuracy: 0.0894, Perplexity: 2488.5171
2024-12-31 16:54:16,283 - TrainingLogger - INFO - Step 6190, Batch metrics: Loss: 8.0551, Accuracy: 0.0547, Perplexity: 3149.7204
2024-12-31 16:54:22,900 - TrainingLogger - INFO - Step 6200, Batch metrics: Loss: 7.5663, Accuracy: 0.1011, Perplexity: 1932.0652
2024-12-31 16:54:22,901 - TrainingLogger - INFO - Step 6200, Prediction vs Actual:
2024-12-31 16:54:22,901 - TrainingLogger - INFO - Input 1: יודגש, כי עורכות הדין שבחרו את פסקי הדין לא ייצגו באותם תיקים
2024-12-31 16:54:22,902 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:54:22,902 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁יוד         | ✗     |
|     1 | ▁תודה           | גש           | ✗     |
|     2 | ▁ישראל          | ,            | ✗     |
|     3 | ה               | ▁כי          | ✗     |
|     4 | אה              | ▁עור         | ✗     |
|     5 | כם              | כות          | ✗     |
|     6 | ▁לו             | ▁הדין        | ✗     |
|     7 | ,               | ▁שבחר        | ✗     |
|     8 | ה               | ו            | ✗     |
|     9 | ,               | ▁את          | ✗     |
|    10 | ▁זה             | ▁פסק         | ✗     |
|    11 | ה               | י            | ✗     |
|    12 | ▁הדין           | ▁הדין        | ✓     |
|    13 | ,               | ▁לא          | ✗     |
|    14 | ום              | ▁ייצג        | ✗     |
|    15 | ו               | ו            | ✓     |
|    16 | ▁את             | ▁ב           | ✗     |
|    17 | רכו             | אותם         | ✗     |
|    18 | ▁ימים           | ▁תיקים       | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ▁יהודים         | <pad>        | ✗     |
|    44 | ,               | <pad>        | ✗     |
|    45 | יים             |              | ✗     |

2024-12-31 16:54:22,902 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:54:22,907 - TrainingLogger - INFO - Gradient norm: 9.5086
2024-12-31 16:54:31,751 - TrainingLogger - INFO - Step 6210, Batch metrics: Loss: 7.0745, Accuracy: 0.1250, Perplexity: 1181.4471
2024-12-31 16:54:38,694 - TrainingLogger - INFO - Step 6220, Batch metrics: Loss: 7.7445, Accuracy: 0.0619, Perplexity: 2308.8095
2024-12-31 16:54:45,232 - TrainingLogger - INFO - Step 6230, Batch metrics: Loss: 7.2283, Accuracy: 0.1073, Perplexity: 1377.9321
2024-12-31 16:54:52,002 - TrainingLogger - INFO - Step 6240, Batch metrics: Loss: 7.5287, Accuracy: 0.0663, Perplexity: 1860.6076
2024-12-31 16:54:58,825 - TrainingLogger - INFO - Step 6250, Batch metrics: Loss: 7.4785, Accuracy: 0.0714, Perplexity: 1769.5699
2024-12-31 16:55:05,342 - TrainingLogger - INFO - Step 6260, Batch metrics: Loss: 7.2520, Accuracy: 0.1014, Perplexity: 1410.8544
2024-12-31 16:55:12,520 - TrainingLogger - INFO - Step 6270, Batch metrics: Loss: 7.2243, Accuracy: 0.0732, Perplexity: 1372.4056
2024-12-31 16:55:20,100 - TrainingLogger - INFO - Step 6280, Batch metrics: Loss: 7.6289, Accuracy: 0.0347, Perplexity: 2056.7433
2024-12-31 16:55:26,972 - TrainingLogger - INFO - Step 6290, Batch metrics: Loss: 7.8231, Accuracy: 0.0745, Perplexity: 2497.5875
2024-12-31 16:55:34,128 - TrainingLogger - INFO - Step 6300, Batch metrics: Loss: 7.5183, Accuracy: 0.0634, Perplexity: 1841.5098
2024-12-31 16:55:34,129 - TrainingLogger - INFO - Step 6300, Prediction vs Actual:
2024-12-31 16:55:34,129 - TrainingLogger - INFO - Input 1: לדבריו, כל משחק הילדים שאנחנו רואים לא במקומו
2024-12-31 16:55:34,129 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:55:34,129 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁לדבריו      | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | <pad>           | ▁כל          | ✗     |
|     3 | ▁זה             | ▁משחק        | ✗     |
|     4 | ▁אחר            | ▁הילדים      | ✗     |
|     5 | ▁הזה            | ▁שאנחנו      | ✗     |
|     6 | ▁צריכים         | ▁רואים       | ✗     |
|     7 | ,               | ▁לא          | ✗     |
|     8 | ▁היה            | ▁במקומו      | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | <pad>           | <pad>        | ✓     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | </s>            |              | ✗     |

2024-12-31 16:55:34,129 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:55:34,134 - TrainingLogger - INFO - Gradient norm: 14.5849
2024-12-31 16:55:41,397 - TrainingLogger - INFO - Step 6310, Batch metrics: Loss: 7.0039, Accuracy: 0.1073, Perplexity: 1100.8691
2024-12-31 16:55:48,854 - TrainingLogger - INFO - Step 6320, Batch metrics: Loss: 7.4991, Accuracy: 0.0606, Perplexity: 1806.5024
2024-12-31 16:55:55,827 - TrainingLogger - INFO - Step 6330, Batch metrics: Loss: 7.4031, Accuracy: 0.0610, Perplexity: 1641.0099
2024-12-31 16:56:02,244 - TrainingLogger - INFO - Step 6340, Batch metrics: Loss: 7.5997, Accuracy: 0.0615, Perplexity: 1997.6670
2024-12-31 16:56:08,981 - TrainingLogger - INFO - Step 6350, Batch metrics: Loss: 7.8414, Accuracy: 0.0852, Perplexity: 2543.7482
2024-12-31 16:56:16,324 - TrainingLogger - INFO - Step 6360, Batch metrics: Loss: 7.4782, Accuracy: 0.0789, Perplexity: 1769.0662
2024-12-31 16:56:23,576 - TrainingLogger - INFO - Step 6370, Batch metrics: Loss: 7.8919, Accuracy: 0.0526, Perplexity: 2675.4322
2024-12-31 16:56:30,854 - TrainingLogger - INFO - Step 6380, Batch metrics: Loss: 7.2031, Accuracy: 0.0982, Perplexity: 1343.5987
2024-12-31 16:56:37,703 - TrainingLogger - INFO - Step 6390, Batch metrics: Loss: 7.6876, Accuracy: 0.1077, Perplexity: 2181.1079
2024-12-31 16:56:44,761 - TrainingLogger - INFO - Step 6400, Batch metrics: Loss: 6.9449, Accuracy: 0.1179, Perplexity: 1037.8046
2024-12-31 16:56:44,761 - TrainingLogger - INFO - Step 6400, Prediction vs Actual:
2024-12-31 16:56:44,761 - TrainingLogger - INFO - Input 1: היא קובעת למעשה את פניה של הרפואה היפנית בכל התחומים
2024-12-31 16:56:44,762 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:56:44,762 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היא         | ✗     |
|     1 | .               | ▁קובעת       | ✗     |
|     2 | .               | ▁למעשה       | ✗     |
|     3 | .               | ▁את          | ✗     |
|     4 | ▁המצב           | ▁פניה        | ✗     |
|     5 | .               | ▁של          | ✗     |
|     6 | ▁אישה           | ▁הרפואה      | ✗     |
|     7 | .               | ▁היפני       | ✗     |
|     8 | ת               | ת            | ✓     |
|     9 | .               | ▁בכל         | ✗     |
|    10 | ▁שנה            | ▁התח         | ✗     |
|    11 | ומים            | ומים         | ✓     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | ים              | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁היא            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 16:56:44,762 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:56:44,767 - TrainingLogger - INFO - Gradient norm: 11.3136
2024-12-31 16:56:51,781 - TrainingLogger - INFO - Step 6410, Batch metrics: Loss: 7.2232, Accuracy: 0.0851, Perplexity: 1370.8444
2024-12-31 16:56:59,298 - TrainingLogger - INFO - Step 6420, Batch metrics: Loss: 7.8555, Accuracy: 0.0854, Perplexity: 2579.9813
2024-12-31 16:57:07,242 - TrainingLogger - INFO - Step 6430, Batch metrics: Loss: 7.4934, Accuracy: 0.0792, Perplexity: 1796.1908
2024-12-31 16:57:14,409 - TrainingLogger - INFO - Step 6440, Batch metrics: Loss: 7.8114, Accuracy: 0.0426, Perplexity: 2468.5238
2024-12-31 16:57:21,498 - TrainingLogger - INFO - Step 6450, Batch metrics: Loss: 7.5057, Accuracy: 0.0851, Perplexity: 1818.4516
2024-12-31 16:57:29,207 - TrainingLogger - INFO - Step 6460, Batch metrics: Loss: 7.2303, Accuracy: 0.0581, Perplexity: 1380.6280
2024-12-31 16:57:36,550 - TrainingLogger - INFO - Step 6470, Batch metrics: Loss: 7.0458, Accuracy: 0.0815, Perplexity: 1148.0173
2024-12-31 16:57:43,531 - TrainingLogger - INFO - Step 6480, Batch metrics: Loss: 7.4313, Accuracy: 0.0738, Perplexity: 1688.0097
2024-12-31 16:57:50,546 - TrainingLogger - INFO - Step 6490, Batch metrics: Loss: 7.4277, Accuracy: 0.0794, Perplexity: 1681.9404
2024-12-31 16:57:57,796 - TrainingLogger - INFO - Step 6500, Batch metrics: Loss: 7.2501, Accuracy: 0.1037, Perplexity: 1408.2989
2024-12-31 16:57:57,797 - TrainingLogger - INFO - Step 6500, Prediction vs Actual:
2024-12-31 16:57:57,797 - TrainingLogger - INFO - Input 1: אני שואלת לפעמים את עצמי האם הוא שליח של עצמו או שליח של אחרים, זה פשוט בושה וחרפה
2024-12-31 16:57:57,797 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:57:57,797 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | ,               | ▁שואלת       | ✗     |
|     2 | </s>            | ▁לפעמים      | ✗     |
|     3 | </s>            | ▁את          | ✗     |
|     4 | ▁עצמי           | ▁עצמי        | ✓     |
|     5 | </s>            | ▁האם         | ✗     |
|     6 | ▁זה             | ▁הוא         | ✗     |
|     7 | ▁היה            | ▁שליח        | ✗     |
|     8 | ▁לי             | ▁של          | ✗     |
|     9 | ▁היום           | ▁עצמו        | ✗     |
|    10 | </s>            | ▁או          | ✗     |
|    11 | ▁לא             | ▁שליח        | ✗     |
|    12 | </s>            | ▁של          | ✗     |
|    13 | ▁המדינה         | ▁אחרים       | ✗     |
|    14 | </s>            | ,            | ✗     |
|    15 | <pad>           | ▁זה          | ✗     |
|    16 | ▁היה            | ▁פשוט        | ✗     |
|    17 | ▁לא             | ▁בושה        | ✗     |
|    18 | </s>            | ▁וחר         | ✗     |
|    19 | פה              | פה           | ✓     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            |              | ✗     |

2024-12-31 16:57:57,797 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:57:57,802 - TrainingLogger - INFO - Gradient norm: 10.5602
2024-12-31 16:58:04,930 - TrainingLogger - INFO - Step 6510, Batch metrics: Loss: 7.6901, Accuracy: 0.0765, Perplexity: 2186.4946
2024-12-31 16:58:12,912 - TrainingLogger - INFO - Step 6520, Batch metrics: Loss: 7.6979, Accuracy: 0.0383, Perplexity: 2203.7023
2024-12-31 16:58:19,703 - TrainingLogger - INFO - Step 6530, Batch metrics: Loss: 7.7214, Accuracy: 0.0735, Perplexity: 2256.1025
2024-12-31 16:58:26,634 - TrainingLogger - INFO - Step 6540, Batch metrics: Loss: 7.6259, Accuracy: 0.0286, Perplexity: 2050.7196
2024-12-31 16:58:33,962 - TrainingLogger - INFO - Step 6550, Batch metrics: Loss: 7.3505, Accuracy: 0.0719, Perplexity: 1557.0440
2024-12-31 16:58:41,642 - TrainingLogger - INFO - Step 6560, Batch metrics: Loss: 7.2669, Accuracy: 0.0838, Perplexity: 1432.1663
2024-12-31 16:58:48,759 - TrainingLogger - INFO - Step 6570, Batch metrics: Loss: 7.8710, Accuracy: 0.0588, Perplexity: 2620.2152
2024-12-31 16:58:56,115 - TrainingLogger - INFO - Step 6580, Batch metrics: Loss: 7.0663, Accuracy: 0.1135, Perplexity: 1171.7495
2024-12-31 16:59:03,298 - TrainingLogger - INFO - Step 6590, Batch metrics: Loss: 7.3055, Accuracy: 0.0872, Perplexity: 1488.4051
2024-12-31 16:59:10,696 - TrainingLogger - INFO - Step 6600, Batch metrics: Loss: 7.1628, Accuracy: 0.0978, Perplexity: 1290.5456
2024-12-31 16:59:10,696 - TrainingLogger - INFO - Step 6600, Prediction vs Actual:
2024-12-31 16:59:10,696 - TrainingLogger - INFO - Input 1: אחרי דין ודברים קצר עם כוחות הביטחון, שנגמר בזה שנשארים, האנשים נפרסים בשטח
2024-12-31 16:59:10,697 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 16:59:10,697 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אחרי        | ✗     |
|     1 | ▁-              | ▁דין         | ✗     |
|     2 | ▁זה             | ▁ודברים      | ✗     |
|     3 | ▁לא             | ▁קצר         | ✗     |
|     4 | ▁יותר           | ▁עם          | ✗     |
|     5 | <pad>           | ▁כוחות       | ✗     |
|     6 | .               | ▁הביטחון     | ✗     |
|     7 | ▁שלנו           | ,            | ✗     |
|     8 | <pad>           | ▁שנגמר       | ✗     |
|     9 | ו               | ▁בזה         | ✗     |
|    10 | .               | ▁שנשאר       | ✗     |
|    11 | ו               | ים           | ✗     |
|    12 | ▁בחיים          | ,            | ✗     |
|    13 | </s>            | ▁האנשים      | ✗     |
|    14 | ▁האלה           | ▁נ           | ✗     |
|    15 | כים             | פרס          | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ,               | ▁בשטח        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 16:59:10,697 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 16:59:10,702 - TrainingLogger - INFO - Gradient norm: 9.1267
2024-12-31 16:59:18,065 - TrainingLogger - INFO - Step 6610, Batch metrics: Loss: 7.8016, Accuracy: 0.0422, Perplexity: 2444.6266
2024-12-31 16:59:25,267 - TrainingLogger - INFO - Step 6620, Batch metrics: Loss: 7.3917, Accuracy: 0.0851, Perplexity: 1622.5057
2024-12-31 16:59:31,992 - TrainingLogger - INFO - Step 6630, Batch metrics: Loss: 6.8710, Accuracy: 0.0985, Perplexity: 963.8847
2024-12-31 16:59:39,198 - TrainingLogger - INFO - Step 6640, Batch metrics: Loss: 7.6176, Accuracy: 0.0956, Perplexity: 2033.6201
2024-12-31 16:59:45,928 - TrainingLogger - INFO - Step 6650, Batch metrics: Loss: 7.3282, Accuracy: 0.0634, Perplexity: 1522.6158
2024-12-31 16:59:53,333 - TrainingLogger - INFO - Step 6660, Batch metrics: Loss: 7.0611, Accuracy: 0.0857, Perplexity: 1165.7118
2024-12-31 17:00:00,349 - TrainingLogger - INFO - Step 6670, Batch metrics: Loss: 6.9491, Accuracy: 0.0890, Perplexity: 1042.2585
2024-12-31 17:00:07,601 - TrainingLogger - INFO - Step 6680, Batch metrics: Loss: 7.6151, Accuracy: 0.0682, Perplexity: 2028.5268
2024-12-31 17:00:15,228 - TrainingLogger - INFO - Step 6690, Batch metrics: Loss: 7.1398, Accuracy: 0.1066, Perplexity: 1261.1997
2024-12-31 17:00:22,075 - TrainingLogger - INFO - Step 6700, Batch metrics: Loss: 7.8800, Accuracy: 0.0791, Perplexity: 2643.8666
2024-12-31 17:00:22,075 - TrainingLogger - INFO - Step 6700, Prediction vs Actual:
2024-12-31 17:00:22,076 - TrainingLogger - INFO - Input 1: חמשת התכנים הכי נצפים באתר הם גלריה של יישובים אזרחיים, גלריה של המסיבה, גלריה של כוחות הביטחון, תמונה של מבוגר ללא לב לכאורה ותמונה של גופות בזיקים
2024-12-31 17:00:22,076 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:00:22,076 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁חמשת        | ✗     |
|     1 | ם               | ▁התכ         | ✗     |
|     2 | נים             | נים          | ✓     |
|     3 | ▁האלה           | ▁הכי         | ✗     |
|     4 | ▁טובים          | ▁נצ          | ✗     |
|     5 | ים              | פים          | ✗     |
|     6 | .               | ▁באתר        | ✗     |
|     7 | ים              | ▁הם          | ✗     |
|     8 | ▁רוצים          | ▁גלר         | ✗     |
|     9 | ים              | יה           | ✗     |
|    10 | </s>            | ▁של          | ✗     |
|    11 | ▁היום           | ▁יי          | ✗     |
|    12 | שוב             | שוב          | ✓     |
|    13 | ים              | ים           | ✓     |
|    14 | .               | ▁אזרחי       | ✗     |
|    15 | ה               | ים           | ✗     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁גלר         | ✗     |
|    18 | ים              | יה           | ✗     |
|    19 | ,               | ▁של          | ✗     |
|    20 | ▁ארצות          | ▁המסיבה      | ✗     |
|    21 | .               | ,            | ✗     |
|    22 | </s>            | ▁גלר         | ✗     |
|    23 | יה              | יה           | ✓     |
|    24 | ,               | ▁של          | ✗     |
|    25 | ▁ארצות          | ▁כוחות       | ✗     |
|    26 | ▁המדינה         | ▁הביטחון     | ✗     |
|    27 | ,               | ,            | ✓     |
|    28 | </s>            | ▁תמונה       | ✗     |
|    29 | ▁חדשה           | ▁של          | ✗     |
|    30 | ▁המדינה         | ▁מבוגר       | ✗     |
|    31 | י               | ▁ללא         | ✗     |
|    32 | ▁נשק            | ▁לב          | ✗     |
|    33 | ,               | ▁לכאורה      | ✗     |
|    34 | ,               | ▁ו           | ✗     |
|    35 | ורים            | תמונה        | ✗     |
|    36 | .               | ▁של          | ✗     |
|    37 | ▁עצמו           | ▁גופות       | ✗     |
|    38 | ,               | ▁בז          | ✗     |
|    39 | '               | יקים         | ✗     |
|    40 | ,               |              | ✗     |

2024-12-31 17:00:22,076 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:00:22,081 - TrainingLogger - INFO - Gradient norm: 12.0380
2024-12-31 17:00:29,564 - TrainingLogger - INFO - Step 6710, Batch metrics: Loss: 7.5408, Accuracy: 0.0838, Perplexity: 1883.3075
2024-12-31 17:00:36,844 - TrainingLogger - INFO - Step 6720, Batch metrics: Loss: 7.3015, Accuracy: 0.1071, Perplexity: 1482.5077
2024-12-31 17:00:43,377 - TrainingLogger - INFO - Step 6730, Batch metrics: Loss: 6.9537, Accuracy: 0.0979, Perplexity: 1046.9742
2024-12-31 17:00:50,669 - TrainingLogger - INFO - Step 6740, Batch metrics: Loss: 7.2688, Accuracy: 0.0667, Perplexity: 1434.8670
2024-12-31 17:00:57,807 - TrainingLogger - INFO - Step 6750, Batch metrics: Loss: 7.5132, Accuracy: 0.0725, Perplexity: 1832.0350
2024-12-31 17:01:04,315 - TrainingLogger - INFO - Step 6760, Batch metrics: Loss: 6.7385, Accuracy: 0.1172, Perplexity: 844.2874
2024-12-31 17:01:11,265 - TrainingLogger - INFO - Step 6770, Batch metrics: Loss: 7.1129, Accuracy: 0.0955, Perplexity: 1227.7510
2024-12-31 17:01:17,894 - TrainingLogger - INFO - Step 6780, Batch metrics: Loss: 7.2229, Accuracy: 0.0809, Perplexity: 1370.4314
2024-12-31 17:01:25,418 - TrainingLogger - INFO - Step 6790, Batch metrics: Loss: 7.5461, Accuracy: 0.0841, Perplexity: 1893.4150
2024-12-31 17:01:32,841 - TrainingLogger - INFO - Step 6800, Batch metrics: Loss: 7.7964, Accuracy: 0.0526, Perplexity: 2431.8677
2024-12-31 17:01:32,842 - TrainingLogger - INFO - Step 6800, Prediction vs Actual:
2024-12-31 17:01:32,842 - TrainingLogger - INFO - Input 1: מנגד, מקורבי ניסנקורן אמרו כי דרישות הליכוד מסוכנות ומטורפות
2024-12-31 17:01:32,842 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:01:32,842 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | -               | ▁מנגד        | ✗     |
|     1 | ▁את             | ,            | ✗     |
|     2 | ▁שלפיה          | ▁מקור        | ✗     |
|     3 | ▁זה             | בי           | ✗     |
|     4 | ,               | ▁ניס         | ✗     |
|     5 | ין              | נק           | ✗     |
|     6 | ולוגיה          | ורן          | ✗     |
|     7 | ,               | ▁אמרו        | ✗     |
|     8 | ▁שהוא           | ▁כי          | ✗     |
|     9 | </s>            | ▁דרישות      | ✗     |
|    10 | יהם             | ▁הלי         | ✗     |
|    11 | כות             | כו           | ✗     |
|    12 | ג               | ד            | ✗     |
|    13 | </s>            | ▁מסוכנות     | ✗     |
|    14 | ▁אחרות          | ▁ומ          | ✗     |
|    15 | עצמות           | טור          | ✗     |
|    16 | פות             | פות          | ✓     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ות              | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 17:01:32,842 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:01:32,847 - TrainingLogger - INFO - Gradient norm: 10.4535
2024-12-31 17:01:39,808 - TrainingLogger - INFO - Step 6810, Batch metrics: Loss: 6.7465, Accuracy: 0.0833, Perplexity: 851.0667
2024-12-31 17:01:46,338 - TrainingLogger - INFO - Step 6820, Batch metrics: Loss: 7.6112, Accuracy: 0.0561, Perplexity: 2020.7773
2024-12-31 17:01:53,781 - TrainingLogger - INFO - Step 6830, Batch metrics: Loss: 7.1153, Accuracy: 0.1143, Perplexity: 1230.6952
2024-12-31 17:02:00,474 - TrainingLogger - INFO - Step 6840, Batch metrics: Loss: 7.9959, Accuracy: 0.0636, Perplexity: 2968.6242
2024-12-31 17:02:08,051 - TrainingLogger - INFO - Step 6850, Batch metrics: Loss: 7.6429, Accuracy: 0.0701, Perplexity: 2085.8345
2024-12-31 17:02:14,807 - TrainingLogger - INFO - Step 6860, Batch metrics: Loss: 7.6873, Accuracy: 0.1210, Perplexity: 2180.5796
2024-12-31 17:02:22,201 - TrainingLogger - INFO - Step 6870, Batch metrics: Loss: 7.4805, Accuracy: 0.0825, Perplexity: 1773.1098
2024-12-31 17:02:29,628 - TrainingLogger - INFO - Step 6880, Batch metrics: Loss: 7.4004, Accuracy: 0.0733, Perplexity: 1636.7063
2024-12-31 17:02:36,819 - TrainingLogger - INFO - Step 6890, Batch metrics: Loss: 7.6092, Accuracy: 0.0393, Perplexity: 2016.6353
2024-12-31 17:02:44,039 - TrainingLogger - INFO - Step 6900, Batch metrics: Loss: 7.8040, Accuracy: 0.0667, Perplexity: 2450.4935
2024-12-31 17:02:44,039 - TrainingLogger - INFO - Step 6900, Prediction vs Actual:
2024-12-31 17:02:44,039 - TrainingLogger - INFO - Input 1: מחוז חוביי, שבו מתגוררים כ-60 מיליון בני אדם, נמצא תחת סגר כבר כמעט חודש
2024-12-31 17:02:44,040 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:02:44,040 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מחוז        | ✗     |
|     1 | ▁-              | ▁חוב         | ✗     |
|     2 | ,               | יי           | ✗     |
|     3 | ?               | ,            | ✗     |
|     4 | <pad>           | ▁שבו         | ✗     |
|     5 | ...             | ▁מתגורר      | ✗     |
|     6 | ים              | ים           | ✓     |
|     7 | ▁אנשים          | ▁כ           | ✗     |
|     8 | ורים            | -60          | ✗     |
|     9 | ▁אנשים          | ▁מיליון      | ✗     |
|    10 | ▁אנשים          | ▁בני         | ✗     |
|    11 | ▁אדם            | ▁אדם         | ✓     |
|    12 | .               | ,            | ✗     |
|    13 | </s>            | ▁נמצא        | ✗     |
|    14 | ▁פתרון          | ▁תחת         | ✗     |
|    15 | יה              | ▁סגר         | ✗     |
|    16 | יה              | ▁כבר         | ✗     |
|    17 | ות              | ▁כמעט        | ✗     |
|    18 | ▁כל             | ▁חודש        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 17:02:44,040 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:02:44,045 - TrainingLogger - INFO - Gradient norm: 11.2858
2024-12-31 17:02:51,694 - TrainingLogger - INFO - Step 6910, Batch metrics: Loss: 7.2592, Accuracy: 0.0641, Perplexity: 1421.0726
2024-12-31 17:02:58,876 - TrainingLogger - INFO - Step 6920, Batch metrics: Loss: 7.5283, Accuracy: 0.0498, Perplexity: 1859.8581
2024-12-31 17:03:06,329 - TrainingLogger - INFO - Step 6930, Batch metrics: Loss: 7.4160, Accuracy: 0.0507, Perplexity: 1662.3467
2024-12-31 17:03:13,658 - TrainingLogger - INFO - Step 6940, Batch metrics: Loss: 7.0152, Accuracy: 0.0671, Perplexity: 1113.4332
2024-12-31 17:03:20,853 - TrainingLogger - INFO - Step 6950, Batch metrics: Loss: 7.6955, Accuracy: 0.0559, Perplexity: 2198.4189
2024-12-31 17:03:27,562 - TrainingLogger - INFO - Step 6960, Batch metrics: Loss: 7.7526, Accuracy: 0.0564, Perplexity: 2327.5979
2024-12-31 17:03:34,131 - TrainingLogger - INFO - Step 6970, Batch metrics: Loss: 7.5322, Accuracy: 0.0848, Perplexity: 1867.2504
2024-12-31 17:03:41,344 - TrainingLogger - INFO - Step 6980, Batch metrics: Loss: 7.5078, Accuracy: 0.0631, Perplexity: 1822.1457
2024-12-31 17:03:49,033 - TrainingLogger - INFO - Step 6990, Batch metrics: Loss: 7.5963, Accuracy: 0.0718, Perplexity: 1990.8127
2024-12-31 17:03:55,828 - TrainingLogger - INFO - Step 7000, Batch metrics: Loss: 7.1661, Accuracy: 0.0621, Perplexity: 1294.8413
2024-12-31 17:03:55,829 - TrainingLogger - INFO - Step 7000, Prediction vs Actual:
2024-12-31 17:03:55,829 - TrainingLogger - INFO - Input 1: אנחנו משקיעים מאמץ גדול בלהתניע את המשק ולהחזיר אנשים לעבודה
2024-12-31 17:03:55,829 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:03:55,829 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁משקיעים     | ✗     |
|     2 | ▁זמן            | ▁מאמץ        | ✗     |
|     3 | ▁רב             | ▁גדול        | ✗     |
|     4 | .               | ▁בלה         | ✗     |
|     5 | ת               | תניע         | ✗     |
|     6 | ▁את             | ▁את          | ✓     |
|     7 | ▁כולם           | ▁המשק        | ✗     |
|     8 | עים             | ▁ולהחזיר     | ✗     |
|     9 | ▁את             | ▁אנשים       | ✗     |
|    10 | .               | ▁לעבודה      | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁את             | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁את             | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | <pad>           |              | ✗     |

2024-12-31 17:03:55,829 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:03:55,834 - TrainingLogger - INFO - Gradient norm: 9.4619
2024-12-31 17:04:03,212 - TrainingLogger - INFO - Step 7010, Batch metrics: Loss: 7.6968, Accuracy: 0.0750, Perplexity: 2201.3319
2024-12-31 17:04:10,692 - TrainingLogger - INFO - Step 7020, Batch metrics: Loss: 6.8510, Accuracy: 0.1036, Perplexity: 944.8620
2024-12-31 17:04:17,834 - TrainingLogger - INFO - Step 7030, Batch metrics: Loss: 7.8444, Accuracy: 0.0808, Perplexity: 2551.3247
2024-12-31 17:04:24,962 - TrainingLogger - INFO - Step 7040, Batch metrics: Loss: 7.3216, Accuracy: 0.0764, Perplexity: 1512.6402
2024-12-31 17:04:32,115 - TrainingLogger - INFO - Step 7050, Batch metrics: Loss: 7.5100, Accuracy: 0.0684, Perplexity: 1826.2505
2024-12-31 17:04:39,396 - TrainingLogger - INFO - Step 7060, Batch metrics: Loss: 7.2278, Accuracy: 0.0696, Perplexity: 1377.2536
2024-12-31 17:04:46,101 - TrainingLogger - INFO - Step 7070, Batch metrics: Loss: 7.3729, Accuracy: 0.0367, Perplexity: 1592.2742
2024-12-31 17:04:53,327 - TrainingLogger - INFO - Step 7080, Batch metrics: Loss: 7.2015, Accuracy: 0.0530, Perplexity: 1341.4516
2024-12-31 17:05:00,073 - TrainingLogger - INFO - Step 7090, Batch metrics: Loss: 7.6805, Accuracy: 0.0741, Perplexity: 2165.6683
2024-12-31 17:05:07,055 - TrainingLogger - INFO - Step 7100, Batch metrics: Loss: 7.6349, Accuracy: 0.0599, Perplexity: 2069.2176
2024-12-31 17:05:07,055 - TrainingLogger - INFO - Step 7100, Prediction vs Actual:
2024-12-31 17:05:07,055 - TrainingLogger - INFO - Input 1: מצד שני, מתן דגש על העובדה שימליצו על נתניהו להקמת הממשלה, מתוך ידיעה שרוב רובו של הציבור הימני שתומך בהם מצפה מהם להביע תמיכה בלתי מסוייגת
2024-12-31 17:05:07,056 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:05:07,056 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מצד         | ✗     |
|     1 | ▁-              | ▁שני         | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | <pad>           | ▁מתן         | ✗     |
|     4 | ▁-              | ▁דגש         | ✗     |
|     5 | ▁-              | ▁על          | ✗     |
|     6 | ▁כן             | ▁העובדה      | ✗     |
|     7 | ▁שאני           | ▁שי          | ✗     |
|     8 | זו              | מלי          | ✗     |
|     9 | ה               | צו           | ✗     |
|    10 | ▁לי             | ▁על          | ✗     |
|    11 | ▁כך             | ▁נתנ         | ✗     |
|    12 | ה               | יהו          | ✗     |
|    13 | .               | ▁לה          | ✗     |
|    14 | ור              | קמת          | ✗     |
|    15 | ▁בית            | ▁הממשלה      | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | <pad>           | ▁מתוך        | ✗     |
|    18 | ▁כבוד           | ▁ידיעה       | ✗     |
|    19 | .               | ▁שרוב        | ✗     |
|    20 | ▁האנשים         | ▁רוב         | ✗     |
|    21 | ▁הזמן           | ו            | ✗     |
|    22 | ▁היה            | ▁של          | ✗     |
|    23 | ▁בית            | ▁הציבור      | ✗     |
|    24 | ות              | ▁הימני       | ✗     |
|    25 | ים              | ▁ש           | ✗     |
|    26 | צו              | תומך         | ✗     |
|    27 | ▁בה             | ▁בהם         | ✗     |
|    28 | ,               | ▁מצפה        | ✗     |
|    29 | ▁לנו            | ▁מהם         | ✗     |
|    30 | .               | ▁להביע       | ✗     |
|    31 | ▁את             | ▁תמיכה       | ✗     |
|    32 | .               | ▁בלתי        | ✗     |
|    33 | ▁רשמית          | ▁מסו         | ✗     |
|    34 | לפת             | יי           | ✗     |
|    35 | גת              | גת           | ✓     |
|    36 | .               |              | ✗     |

2024-12-31 17:05:07,056 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:05:07,061 - TrainingLogger - INFO - Gradient norm: 9.5861
2024-12-31 17:05:14,401 - TrainingLogger - INFO - Step 7110, Batch metrics: Loss: 7.6485, Accuracy: 0.0430, Perplexity: 2097.4239
2024-12-31 17:05:21,643 - TrainingLogger - INFO - Step 7120, Batch metrics: Loss: 6.9423, Accuracy: 0.0707, Perplexity: 1035.1778
2024-12-31 17:05:29,043 - TrainingLogger - INFO - Step 7130, Batch metrics: Loss: 7.6924, Accuracy: 0.0640, Perplexity: 2191.7065
2024-12-31 17:05:35,766 - TrainingLogger - INFO - Step 7140, Batch metrics: Loss: 7.8685, Accuracy: 0.0856, Perplexity: 2613.5493
2024-12-31 17:05:43,203 - TrainingLogger - INFO - Step 7150, Batch metrics: Loss: 7.3201, Accuracy: 0.0710, Perplexity: 1510.3267
2024-12-31 17:05:51,127 - TrainingLogger - INFO - Step 7160, Batch metrics: Loss: 7.7406, Accuracy: 0.0706, Perplexity: 2299.9355
2024-12-31 17:05:58,129 - TrainingLogger - INFO - Step 7170, Batch metrics: Loss: 7.8120, Accuracy: 0.0718, Perplexity: 2470.0251
2024-12-31 17:06:05,594 - TrainingLogger - INFO - Step 7180, Batch metrics: Loss: 7.2119, Accuracy: 0.1104, Perplexity: 1355.4242
2024-12-31 17:06:13,451 - TrainingLogger - INFO - Step 7190, Batch metrics: Loss: 7.4678, Accuracy: 0.0744, Perplexity: 1750.6918
2024-12-31 17:06:20,390 - TrainingLogger - INFO - Step 7200, Batch metrics: Loss: 7.2195, Accuracy: 0.0984, Perplexity: 1365.8556
2024-12-31 17:06:20,391 - TrainingLogger - INFO - Step 7200, Prediction vs Actual:
2024-12-31 17:06:20,391 - TrainingLogger - INFO - Input 1: בוגרים רבים כבר השתלבו בעמדות מפתח בחברות מובילות במשק ובחברה הישראלית ותורמים תרומה משמעותית לפיתוחה ולשגשוגה של הכלכלה הישראלית
2024-12-31 17:06:20,391 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:06:20,391 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בוגרים      | ✗     |
|     1 | ,               | ▁רבים        | ✗     |
|     2 | ▁כיום           | ▁כבר         | ✗     |
|     3 | ▁שנים           | ▁השתל        | ✗     |
|     4 | ים              | בו           | ✗     |
|     5 | ▁עם             | ▁בעמדות      | ✗     |
|     6 | ▁שנים           | ▁מפתח        | ✗     |
|     7 | ▁זה             | ▁ב           | ✗     |
|     8 | ים              | חברות        | ✗     |
|     9 | ▁אחרות          | ▁מוביל       | ✗     |
|    10 | ,               | ות           | ✗     |
|    11 | ,               | ▁ב           | ✗     |
|    12 | אותם            | משק          | ✗     |
|    13 | עים             | ▁וב          | ✗     |
|    14 | מדינות          | חברה         | ✗     |
|    15 | ,               | ▁הישראלי     | ✗     |
|    16 | ת               | ת            | ✓     |
|    17 | ,               | ▁ו           | ✗     |
|    18 | נש              | תור          | ✗     |
|    19 | מה              | מים          | ✗     |
|    20 | ▁רבים           | ▁תרומה       | ✗     |
|    21 | ▁רבה            | ▁משמעותית    | ✗     |
|    22 | .               | ▁ל           | ✗     |
|    23 | מדינות          | פיתוח        | ✗     |
|    24 | .               | ה            | ✗     |
|    25 | ▁של             | ▁ולש         | ✗     |
|    26 | ם               | גשו          | ✗     |
|    27 | ג               | גה           | ✗     |
|    28 | .               | ▁של          | ✗     |
|    29 | ▁ארצות          | ▁הכלכלה      | ✗     |
|    30 | .               | ▁הישראלי     | ✗     |
|    31 | ת               | ת            | ✓     |
|    32 | .               |              | ✗     |

2024-12-31 17:06:20,391 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:06:20,396 - TrainingLogger - INFO - Gradient norm: 12.9147
2024-12-31 17:06:26,947 - TrainingLogger - INFO - Step 7210, Batch metrics: Loss: 7.4026, Accuracy: 0.0585, Perplexity: 1640.1853
2024-12-31 17:06:34,105 - TrainingLogger - INFO - Step 7220, Batch metrics: Loss: 7.5197, Accuracy: 0.0428, Perplexity: 1843.9446
2024-12-31 17:06:41,260 - TrainingLogger - INFO - Step 7230, Batch metrics: Loss: 7.3624, Accuracy: 0.1190, Perplexity: 1575.5768
2024-12-31 17:06:48,168 - TrainingLogger - INFO - Step 7240, Batch metrics: Loss: 7.1883, Accuracy: 0.1090, Perplexity: 1323.8844
2024-12-31 17:06:55,339 - TrainingLogger - INFO - Step 7250, Batch metrics: Loss: 7.6057, Accuracy: 0.0642, Perplexity: 2009.6316
2024-12-31 17:07:02,879 - TrainingLogger - INFO - Step 7260, Batch metrics: Loss: 7.2113, Accuracy: 0.0952, Perplexity: 1354.6178
2024-12-31 17:07:10,203 - TrainingLogger - INFO - Step 7270, Batch metrics: Loss: 7.4093, Accuracy: 0.0794, Perplexity: 1651.2430
2024-12-31 17:07:17,321 - TrainingLogger - INFO - Step 7280, Batch metrics: Loss: 7.4620, Accuracy: 0.1061, Perplexity: 1740.6464
2024-12-31 17:07:24,127 - TrainingLogger - INFO - Step 7290, Batch metrics: Loss: 7.9233, Accuracy: 0.0588, Perplexity: 2760.9256
2024-12-31 17:07:31,467 - TrainingLogger - INFO - Step 7300, Batch metrics: Loss: 7.0114, Accuracy: 0.0909, Perplexity: 1109.2304
2024-12-31 17:07:31,467 - TrainingLogger - INFO - Step 7300, Prediction vs Actual:
2024-12-31 17:07:31,467 - TrainingLogger - INFO - Input 1: במכון הטכנולוגי בחולון הוצגה לאחרונה טכנולוגיה חדשה ופורצת דרך לניהול רשת חשמל חכמה, תוצאה של חמש שנות מחקר משותף של חברות מובילות בתעשייה, דוגמת מוטורולה וECI, עם אוניברסיטאות ומכללות בארץ
2024-12-31 17:07:31,468 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:07:31,468 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁במכון       | ✗     |
|     1 | ▁המדינה         | ▁ה           | ✗     |
|     2 | -               | טכנולוגי     | ✗     |
|     3 | ▁של             | ▁בחול        | ✗     |
|     4 | .               | ון           | ✗     |
|     5 | ▁הנוכחי         | ▁הוצג        | ✗     |
|     6 | ה               | ה            | ✓     |
|     7 | ▁על             | ▁לאחרונה     | ✗     |
|     8 | ▁לראשונה        | ▁טכנולוגיה   | ✗     |
|     9 | ▁חדשה           | ▁חדשה        | ✓     |
|    10 | ,               | ▁ו           | ✗     |
|    11 | פור             | פור          | ✓     |
|    12 | ה               | צת           | ✗     |
|    13 | ▁על             | ▁דרך         | ✗     |
|    14 | ▁בשם            | ▁לניהול      | ✗     |
|    15 | ▁של             | ▁רשת         | ✗     |
|    16 | ית              | ▁חשמל        | ✗     |
|    17 | .               | ▁חכמה        | ✗     |
|    18 | .               | ,            | ✗     |
|    19 | </s>            | ▁תוצאה       | ✗     |
|    20 | ▁של             | ▁של          | ✓     |
|    21 | ▁מה             | ▁חמש         | ✗     |
|    22 | ▁שנים           | ▁שנות        | ✗     |
|    23 | ▁מאסר           | ▁מחקר        | ✗     |
|    24 | .               | ▁משותף       | ✗     |
|    25 | .               | ▁של          | ✗     |
|    26 | ▁ארצות          | ▁חברות       | ✗     |
|    27 | ▁אחרות          | ▁מוביל       | ✗     |
|    28 | ות              | ות           | ✓     |
|    29 | ▁ל              | ▁ב           | ✗     |
|    30 | פרלמנט          | תעשי         | ✗     |
|    31 | יה              | יה           | ✓     |
|    32 | .               | ,            | ✗     |
|    33 | </s>            | ▁דוגמת       | ✗     |
|    34 | ו               | ▁מו          | ✗     |
|    35 | רלי             | טור          | ✗     |
|    36 | מן              | ולה          | ✗     |
|    37 | .               | ▁ו           | ✗     |
|    38 | -               | E            | ✗     |
|    39 | .               | C            | ✗     |
|    40 | H               | I            | ✗     |
|    41 | A               | ,            | ✗     |
|    42 | ▁               | ▁עם          | ✗     |
|    43 | ▁ישראל          | ▁            | ✗     |
|    44 | IS              | אוניברס      | ✗     |
|    45 | יט              | יט           | ✓     |
|    46 | אה              | אות          | ✗     |
|    47 | ▁חדשות          | ▁ומכל        | ✗     |
|    48 | ה               | לות          | ✗     |
|    49 | ,               | ▁בארץ        | ✗     |
|    50 | ▁ישראל          |              | ✗     |

2024-12-31 17:07:31,468 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:07:31,473 - TrainingLogger - INFO - Gradient norm: 10.9678
2024-12-31 17:07:38,657 - TrainingLogger - INFO - Step 7310, Batch metrics: Loss: 7.2759, Accuracy: 0.1000, Perplexity: 1445.0475
2024-12-31 17:07:45,989 - TrainingLogger - INFO - Step 7320, Batch metrics: Loss: 7.3520, Accuracy: 0.0851, Perplexity: 1559.2812
2024-12-31 17:07:52,960 - TrainingLogger - INFO - Step 7330, Batch metrics: Loss: 7.6667, Accuracy: 0.0787, Perplexity: 2135.9463
2024-12-31 17:08:00,186 - TrainingLogger - INFO - Step 7340, Batch metrics: Loss: 7.3305, Accuracy: 0.0726, Perplexity: 1526.1281
2024-12-31 17:08:07,846 - TrainingLogger - INFO - Step 7350, Batch metrics: Loss: 7.3458, Accuracy: 0.0737, Perplexity: 1549.7229
2024-12-31 17:08:15,115 - TrainingLogger - INFO - Step 7360, Batch metrics: Loss: 7.5016, Accuracy: 0.0691, Perplexity: 1810.9726
2024-12-31 17:08:21,825 - TrainingLogger - INFO - Step 7370, Batch metrics: Loss: 7.2114, Accuracy: 0.0719, Perplexity: 1354.8180
2024-12-31 17:08:28,700 - TrainingLogger - INFO - Step 7380, Batch metrics: Loss: 7.6031, Accuracy: 0.0692, Perplexity: 2004.4636
2024-12-31 17:08:36,102 - TrainingLogger - INFO - Step 7390, Batch metrics: Loss: 7.5444, Accuracy: 0.0896, Perplexity: 1890.0801
2024-12-31 17:08:43,226 - TrainingLogger - INFO - Step 7400, Batch metrics: Loss: 7.1031, Accuracy: 0.0819, Perplexity: 1215.7078
2024-12-31 17:08:43,226 - TrainingLogger - INFO - Step 7400, Prediction vs Actual:
2024-12-31 17:08:43,226 - TrainingLogger - INFO - Input 1: מה שעבד בהצלחה בחוק האזרחות, יכול לעבוד גם בשגרה
2024-12-31 17:08:43,227 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:08:43,227 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁מה          | ✗     |
|     1 | י               | ▁שעבד        | ✗     |
|     2 | ▁עליו           | ▁בהצלחה      | ✗     |
|     3 | ,               | ▁בחוק        | ✗     |
|     4 | ים              | ▁האזרח       | ✗     |
|     5 | ות              | ות           | ✓     |
|     6 | ▁שלו            | ,            | ✗     |
|     7 | </s>            | ▁יכול        | ✗     |
|     8 | ▁להיות          | ▁לעבוד       | ✗     |
|     9 | ▁גם             | ▁גם          | ✓     |
|    10 | ▁היום           | ▁בש          | ✗     |
|    11 | עור             | גרה          | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 17:08:43,227 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:08:43,232 - TrainingLogger - INFO - Gradient norm: 11.7937
2024-12-31 17:08:50,150 - TrainingLogger - INFO - Step 7410, Batch metrics: Loss: 7.4963, Accuracy: 0.0849, Perplexity: 1801.3242
2024-12-31 17:08:57,759 - TrainingLogger - INFO - Step 7420, Batch metrics: Loss: 7.4376, Accuracy: 0.0504, Perplexity: 1698.5959
2024-12-31 17:09:05,050 - TrainingLogger - INFO - Step 7430, Batch metrics: Loss: 7.2717, Accuracy: 0.1068, Perplexity: 1438.9239
2024-12-31 17:09:12,612 - TrainingLogger - INFO - Step 7440, Batch metrics: Loss: 7.3305, Accuracy: 0.0647, Perplexity: 1526.1383
2024-12-31 17:09:19,622 - TrainingLogger - INFO - Step 7450, Batch metrics: Loss: 7.6994, Accuracy: 0.0610, Perplexity: 2206.9717
2024-12-31 17:09:26,458 - TrainingLogger - INFO - Step 7460, Batch metrics: Loss: 7.6882, Accuracy: 0.0437, Perplexity: 2182.3833
2024-12-31 17:09:33,588 - TrainingLogger - INFO - Step 7470, Batch metrics: Loss: 7.6267, Accuracy: 0.0722, Perplexity: 2052.2134
2024-12-31 17:09:40,503 - TrainingLogger - INFO - Step 7480, Batch metrics: Loss: 7.6866, Accuracy: 0.0601, Perplexity: 2179.0516
2024-12-31 17:09:48,194 - TrainingLogger - INFO - Step 7490, Batch metrics: Loss: 7.3586, Accuracy: 0.0497, Perplexity: 1569.6190
2024-12-31 17:09:55,676 - TrainingLogger - INFO - Step 7500, Batch metrics: Loss: 7.6312, Accuracy: 0.0615, Perplexity: 2061.5299
2024-12-31 17:09:55,676 - TrainingLogger - INFO - Step 7500, Prediction vs Actual:
2024-12-31 17:09:55,710 - TrainingLogger - INFO - Input 1: חברי ועידה פנו ליור המפלגה ודרשו לקיים הצבעה חשאית ולא גלויה על דרישותיו
2024-12-31 17:09:55,711 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:09:55,711 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁חברי        | ✗     |
|     1 | ▁אני            | ▁ו           | ✗     |
|     2 | ▁-              | עידה         | ✗     |
|     3 | ▁טובה           | ▁פנו         | ✗     |
|     4 | ה               | ▁לי          | ✗     |
|     5 | נה              | ור           | ✗     |
|     6 | ה               | ▁המפלגה      | ✗     |
|     7 | .               | ▁וד          | ✗     |
|     8 | "               | רשו          | ✗     |
|     9 | ▁לי             | ▁לקיים       | ✗     |
|    10 | ▁את             | ▁הצבעה       | ✗     |
|    11 | ▁זו             | ▁חשאי        | ✗     |
|    12 | ת               | ת            | ✓     |
|    13 | .               | ▁ולא         | ✗     |
|    14 | ור              | ▁גלויה       | ✗     |
|    15 | .               | ▁על          | ✗     |
|    16 | ה               | ▁דרישות      | ✗     |
|    17 | יהם             | יו           | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ס               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 17:09:55,711 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:09:55,716 - TrainingLogger - INFO - Gradient norm: 10.5983
2024-12-31 17:10:02,621 - TrainingLogger - INFO - Step 7510, Batch metrics: Loss: 7.3250, Accuracy: 0.0672, Perplexity: 1517.6991
2024-12-31 17:10:10,161 - TrainingLogger - INFO - Step 7520, Batch metrics: Loss: 7.3030, Accuracy: 0.0671, Perplexity: 1484.8119
2024-12-31 17:10:17,446 - TrainingLogger - INFO - Step 7530, Batch metrics: Loss: 7.2673, Accuracy: 0.1016, Perplexity: 1432.6239
2024-12-31 17:10:24,430 - TrainingLogger - INFO - Step 7540, Batch metrics: Loss: 7.4376, Accuracy: 0.0611, Perplexity: 1698.6372
2024-12-31 17:10:31,321 - TrainingLogger - INFO - Step 7550, Batch metrics: Loss: 7.3745, Accuracy: 0.0917, Perplexity: 1594.7559
2024-12-31 17:10:38,758 - TrainingLogger - INFO - Step 7560, Batch metrics: Loss: 7.3487, Accuracy: 0.0597, Perplexity: 1554.1037
2024-12-31 17:10:45,765 - TrainingLogger - INFO - Step 7570, Batch metrics: Loss: 7.1546, Accuracy: 0.0909, Perplexity: 1280.0281
2024-12-31 17:10:52,586 - TrainingLogger - INFO - Step 7580, Batch metrics: Loss: 7.3136, Accuracy: 0.1062, Perplexity: 1500.4981
2024-12-31 17:10:59,554 - TrainingLogger - INFO - Step 7590, Batch metrics: Loss: 7.5248, Accuracy: 0.0550, Perplexity: 1853.5146
2024-12-31 17:11:06,022 - TrainingLogger - INFO - Step 7600, Batch metrics: Loss: 7.2314, Accuracy: 0.0838, Perplexity: 1382.1120
2024-12-31 17:11:06,023 - TrainingLogger - INFO - Step 7600, Prediction vs Actual:
2024-12-31 17:11:06,023 - TrainingLogger - INFO - Input 1: מהנקודה הזאת היד הייתה עוד נטויה
2024-12-31 17:11:06,023 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:11:06,023 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מה          | ✗     |
|     1 | ▁-              | נקודה        | ✗     |
|     2 | ▁-              | ▁הזאת        | ✗     |
|     3 | ▁לא             | ▁היד         | ✗     |
|     4 | ▁-              | ▁הייתה       | ✗     |
|     5 | ▁ממש            | ▁עוד         | ✗     |
|     6 | ▁לא             | ▁נטוי        | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | .               | <pad>        | ✗     |
|     9 | <pad>           | <pad>        | ✓     |
|    10 | ▁היא            | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ,               |              | ✗     |

2024-12-31 17:11:06,023 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:11:06,028 - TrainingLogger - INFO - Gradient norm: 9.2681
2024-12-31 17:11:12,697 - TrainingLogger - INFO - Step 7610, Batch metrics: Loss: 7.7075, Accuracy: 0.0412, Perplexity: 2224.9622
2024-12-31 17:11:19,549 - TrainingLogger - INFO - Step 7620, Batch metrics: Loss: 7.3388, Accuracy: 0.0673, Perplexity: 1538.8093
2024-12-31 17:11:26,675 - TrainingLogger - INFO - Step 7630, Batch metrics: Loss: 7.1089, Accuracy: 0.0805, Perplexity: 1222.8368
2024-12-31 17:11:33,316 - TrainingLogger - INFO - Step 7640, Batch metrics: Loss: 7.1270, Accuracy: 0.0919, Perplexity: 1245.0740
2024-12-31 17:11:40,663 - TrainingLogger - INFO - Step 7650, Batch metrics: Loss: 7.1816, Accuracy: 0.1059, Perplexity: 1315.0559
2024-12-31 17:11:47,860 - TrainingLogger - INFO - Step 7660, Batch metrics: Loss: 7.6731, Accuracy: 0.0838, Perplexity: 2149.8153
2024-12-31 17:11:54,903 - TrainingLogger - INFO - Step 7670, Batch metrics: Loss: 6.8455, Accuracy: 0.0821, Perplexity: 939.6125
2024-12-31 17:12:01,711 - TrainingLogger - INFO - Step 7680, Batch metrics: Loss: 7.3483, Accuracy: 0.1146, Perplexity: 1553.6303
2024-12-31 17:12:08,761 - TrainingLogger - INFO - Step 7690, Batch metrics: Loss: 7.3091, Accuracy: 0.0629, Perplexity: 1493.8616
2024-12-31 17:12:15,876 - TrainingLogger - INFO - Step 7700, Batch metrics: Loss: 7.0114, Accuracy: 0.0734, Perplexity: 1109.2272
2024-12-31 17:12:15,876 - TrainingLogger - INFO - Step 7700, Prediction vs Actual:
2024-12-31 17:12:15,876 - TrainingLogger - INFO - Input 1: על כל פנים, ויליקאניה מזהירה שאם תעשיית האבוקדו של האזור תקרוס, הפשיעה בה רק תחמיר
2024-12-31 17:12:15,877 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:12:15,877 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁על          | ✗     |
|     1 | ▁-              | ▁כל          | ✗     |
|     2 | ▁אחד            | ▁פנים        | ✗     |
|     3 | ▁-              | ,            | ✗     |
|     4 | <pad>           | ▁וילי        | ✗     |
|     5 | ה               | ק            | ✗     |
|     6 | .               | אני          | ✗     |
|     7 | ס               | ה            | ✗     |
|     8 | .               | ▁מזהירה      | ✗     |
|     9 | .               | ▁שאם         | ✗     |
|    10 | ▁הוא            | ▁תעשיית      | ✗     |
|    11 | ▁החשמל          | ▁האב         | ✗     |
|    12 | רים             | ו            | ✗     |
|    13 | "               | קדו          | ✗     |
|    14 | ▁לא             | ▁של          | ✗     |
|    15 | ▁היום           | ▁האזור       | ✗     |
|    16 | ▁הזה            | ▁ת           | ✗     |
|    17 | תקבל            | קרוס         | ✗     |
|    18 | ה               | ,            | ✗     |
|    19 | </s>            | ▁ה           | ✗     |
|    20 | "               | פש           | ✗     |
|    21 | יעה             | יעה          | ✓     |
|    22 | ▁ת              | ▁בה          | ✗     |
|    23 | ת               | ▁רק          | ✗     |
|    24 | ▁ת              | ▁תח          | ✗     |
|    25 | קור             | מיר          | ✗     |
|    26 | ת               | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ת               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁את             | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 17:12:15,877 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:12:15,882 - TrainingLogger - INFO - Gradient norm: 8.5598
2024-12-31 17:12:23,455 - TrainingLogger - INFO - Step 7710, Batch metrics: Loss: 7.1805, Accuracy: 0.0979, Perplexity: 1313.5887
2024-12-31 17:12:30,087 - TrainingLogger - INFO - Step 7720, Batch metrics: Loss: 7.6897, Accuracy: 0.0662, Perplexity: 2185.8118
2024-12-31 17:12:37,142 - TrainingLogger - INFO - Step 7730, Batch metrics: Loss: 7.6505, Accuracy: 0.0580, Perplexity: 2101.7188
2024-12-31 17:12:44,080 - TrainingLogger - INFO - Step 7740, Batch metrics: Loss: 7.5079, Accuracy: 0.0874, Perplexity: 1822.3299
2024-12-31 17:12:51,328 - TrainingLogger - INFO - Step 7750, Batch metrics: Loss: 7.9866, Accuracy: 0.0497, Perplexity: 2941.1756
2024-12-31 17:12:58,875 - TrainingLogger - INFO - Step 7760, Batch metrics: Loss: 7.1101, Accuracy: 0.0747, Perplexity: 1224.2977
2024-12-31 17:13:06,016 - TrainingLogger - INFO - Step 7770, Batch metrics: Loss: 6.9000, Accuracy: 0.0977, Perplexity: 992.2535
2024-12-31 17:13:13,179 - TrainingLogger - INFO - Step 7780, Batch metrics: Loss: 7.7823, Accuracy: 0.0861, Perplexity: 2397.8325
2024-12-31 17:13:20,193 - TrainingLogger - INFO - Step 7790, Batch metrics: Loss: 7.1765, Accuracy: 0.0802, Perplexity: 1308.2623
2024-12-31 17:13:27,235 - TrainingLogger - INFO - Step 7800, Batch metrics: Loss: 7.5118, Accuracy: 0.0619, Perplexity: 1829.5627
2024-12-31 17:13:27,235 - TrainingLogger - INFO - Step 7800, Prediction vs Actual:
2024-12-31 17:13:27,235 - TrainingLogger - INFO - Input 1: אם כבר בארגון וסדר המשחק עסקינן, מי שלו חלק לא פחות גדול משל המאמן הוא הקפטן, נטע לביא
2024-12-31 17:13:27,236 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:13:27,236 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אם          | ✗     |
|     1 | ▁-              | ▁כבר         | ✗     |
|     2 | ▁-              | ▁בארגון      | ✗     |
|     3 | ▁זה             | ▁ו           | ✗     |
|     4 | ...             | סדר          | ✗     |
|     5 | ▁-              | ▁המשחק       | ✗     |
|     6 | ▁הזה            | ▁עסקי        | ✗     |
|     7 | ?               | נן           | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | <pad>           | ▁מי          | ✗     |
|    10 | ▁זה             | ▁שלו         | ✗     |
|    11 | מה              | ▁חלק         | ✗     |
|    12 | ▁מה             | ▁לא          | ✗     |
|    13 | ו               | ▁פחות        | ✗     |
|    14 | .               | ▁גדול        | ✗     |
|    15 | .               | ▁משל         | ✗     |
|    16 | ?               | ▁המאמן       | ✗     |
|    17 | .               | ▁הוא         | ✗     |
|    18 | ▁לא             | ▁הקפטן       | ✗     |
|    19 | .               | ,            | ✗     |
|    20 | <pad>           | ▁נטע         | ✗     |
|    21 | ן               | ▁לבי         | ✗     |
|    22 | מה              | א            | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁את             | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | </s>            |              | ✗     |

2024-12-31 17:13:27,236 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:13:27,241 - TrainingLogger - INFO - Gradient norm: 8.9594
2024-12-31 17:13:34,964 - TrainingLogger - INFO - Step 7810, Batch metrics: Loss: 7.3759, Accuracy: 0.0898, Perplexity: 1597.0982
2024-12-31 17:13:42,108 - TrainingLogger - INFO - Step 7820, Batch metrics: Loss: 7.2655, Accuracy: 0.0971, Perplexity: 1430.0570
2024-12-31 17:13:48,940 - TrainingLogger - INFO - Step 7830, Batch metrics: Loss: 7.1363, Accuracy: 0.0971, Perplexity: 1256.7387
2024-12-31 17:13:55,490 - TrainingLogger - INFO - Step 7840, Batch metrics: Loss: 7.8661, Accuracy: 0.0571, Perplexity: 2607.2733
2024-12-31 17:14:02,414 - TrainingLogger - INFO - Step 7850, Batch metrics: Loss: 7.4479, Accuracy: 0.0446, Perplexity: 1716.1714
2024-12-31 17:14:09,773 - TrainingLogger - INFO - Step 7860, Batch metrics: Loss: 7.3401, Accuracy: 0.0738, Perplexity: 1540.9372
2024-12-31 17:14:16,981 - TrainingLogger - INFO - Step 7870, Batch metrics: Loss: 7.6216, Accuracy: 0.0556, Perplexity: 2041.7975
2024-12-31 17:14:23,880 - TrainingLogger - INFO - Step 7880, Batch metrics: Loss: 7.7028, Accuracy: 0.0650, Perplexity: 2214.6209
2024-12-31 17:14:31,039 - TrainingLogger - INFO - Step 7890, Batch metrics: Loss: 7.5544, Accuracy: 0.0526, Perplexity: 1909.0707
2024-12-31 17:14:38,057 - TrainingLogger - INFO - Step 7900, Batch metrics: Loss: 7.0859, Accuracy: 0.0588, Perplexity: 1195.0425
2024-12-31 17:14:38,058 - TrainingLogger - INFO - Step 7900, Prediction vs Actual:
2024-12-31 17:14:38,058 - TrainingLogger - INFO - Input 1: בקדציה הנוכחית התחלנו לפעול בעניין, אך לצערי לא התקיים שיתוף פעולה מצד מרכיבי הקואליציה לחקיקת פסקת ההתגברות
2024-12-31 17:14:38,058 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:14:38,058 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בק          | ✗     |
|     1 | ב               | ד            | ✗     |
|     2 | ▁הו             | ציה          | ✗     |
|     3 | ,               | ▁הנוכחית     | ✗     |
|     4 | .               | ▁התחלנו      | ✗     |
|     5 | ▁ב              | ▁לפעול       | ✗     |
|     6 | ת               | ▁בעניין      | ✗     |
|     7 | ▁זה             | ,            | ✗     |
|     8 | </s>            | ▁אך          | ✗     |
|     9 | ▁הוא            | ▁לצערי       | ✗     |
|    10 | ,               | ▁לא          | ✗     |
|    11 | ▁ניתן           | ▁            | ✗     |
|    12 | שגשג            | התקיים       | ✗     |
|    13 | ▁זמן            | ▁שיתוף       | ✗     |
|    14 | ▁פעולה          | ▁פעולה       | ✓     |
|    15 | ▁עם             | ▁מצד         | ✗     |
|    16 | ה               | ▁מרכיב       | ✗     |
|    17 | ▁זה             | י            | ✗     |
|    18 | ▁החקירה         | ▁הקו         | ✗     |
|    19 | מות             | אלי          | ✗     |
|    20 | ציה             | ציה          | ✓     |
|    21 | .               | ▁לח          | ✗     |
|    22 | מה              | קי           | ✗     |
|    23 | ה               | קת           | ✗     |
|    24 | ▁המדינה         | ▁פסק         | ✗     |
|    25 | ה               | ת            | ✗     |
|    26 | ▁הדין           | ▁ההת         | ✗     |
|    27 | רעה             | גבר          | ✗     |
|    28 | ות              | ות           | ✓     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ▁היא            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            |              | ✗     |

2024-12-31 17:14:38,058 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:14:38,063 - TrainingLogger - INFO - Gradient norm: 10.9964
2024-12-31 17:14:45,125 - TrainingLogger - INFO - Step 7910, Batch metrics: Loss: 7.0222, Accuracy: 0.0811, Perplexity: 1121.2631
2024-12-31 17:14:52,292 - TrainingLogger - INFO - Step 7920, Batch metrics: Loss: 7.3903, Accuracy: 0.0789, Perplexity: 1620.2474
2024-12-31 17:14:59,429 - TrainingLogger - INFO - Step 7930, Batch metrics: Loss: 7.1945, Accuracy: 0.0461, Perplexity: 1332.0949
2024-12-31 17:15:07,110 - TrainingLogger - INFO - Step 7940, Batch metrics: Loss: 6.8581, Accuracy: 0.1267, Perplexity: 951.5864
2024-12-31 17:15:14,020 - TrainingLogger - INFO - Step 7950, Batch metrics: Loss: 7.4602, Accuracy: 0.0732, Perplexity: 1737.5093
2024-12-31 17:15:21,246 - TrainingLogger - INFO - Step 7960, Batch metrics: Loss: 8.1875, Accuracy: 0.0363, Perplexity: 3595.7183
2024-12-31 17:15:28,488 - TrainingLogger - INFO - Step 7970, Batch metrics: Loss: 7.0928, Accuracy: 0.1222, Perplexity: 1203.2822
2024-12-31 17:15:35,690 - TrainingLogger - INFO - Step 7980, Batch metrics: Loss: 7.7383, Accuracy: 0.0812, Perplexity: 2294.5920
2024-12-31 17:15:42,275 - TrainingLogger - INFO - Step 7990, Batch metrics: Loss: 7.4051, Accuracy: 0.0878, Perplexity: 1644.3224
2024-12-31 17:15:49,273 - TrainingLogger - INFO - Step 8000, Batch metrics: Loss: 7.4803, Accuracy: 0.0833, Perplexity: 1772.7978
2024-12-31 17:15:49,274 - TrainingLogger - INFO - Step 8000, Prediction vs Actual:
2024-12-31 17:15:49,274 - TrainingLogger - INFO - Input 1: בלינקן מגיע לכאן היישר ממסעו בסעודיה, שבו ניסה להשלים את המגעים לעסקת נורמליזציה בין ישראל לריאד, שכוללת ברית הגנה וגרעין אזרחי לממלכה עם העשרה מחוץ לאדמת סעודיה כנראה בארהב, אא
2024-12-31 17:15:49,275 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:15:49,275 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בלי         | ✗     |
|     1 | יט              | נקן          | ✗     |
|     2 | .               | ▁מגיע        | ✗     |
|     3 | ▁לכאן           | ▁לכאן        | ✓     |
|     4 | .               | ▁היישר       | ✗     |
|     5 | ▁מכאן           | ▁ממס         | ✗     |
|     6 | ה               | עו           | ✗     |
|     7 | .               | ▁בס          | ✗     |
|     8 | צ               | עוד          | ✗     |
|     9 | ה               | יה           | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁שבו         | ✗     |
|    12 | ה               | ▁ניסה        | ✗     |
|    13 | ▁להגיע          | ▁להשלים      | ✗     |
|    14 | ▁את             | ▁את          | ✓     |
|    15 | ו               | ▁המגע        | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ▁שלו            | ▁לעסק        | ✗     |
|    18 | ה               | ת            | ✗     |
|    19 | ▁עסקים          | ▁נורמלי      | ✗     |
|    20 | ות              | זציה         | ✗     |
|    21 | .               | ▁בין         | ✗     |
|    22 | -               | ▁ישראל       | ✗     |
|    23 | י               | ▁ל           | ✗     |
|    24 | מדינות          | רי           | ✗     |
|    25 | יץ              | אד           | ✗     |
|    26 | ,               | ,            | ✓     |
|    27 | </s>            | ▁שכול        | ✗     |
|    28 | ה               | לת           | ✗     |
|    29 | ▁את             | ▁ברית        | ✗     |
|    30 | ▁עם             | ▁הגנה        | ✗     |
|    31 | ▁עצמית          | ▁וגר         | ✗     |
|    32 | או              | עין          | ✗     |
|    33 | ▁את             | ▁אזרחי       | ✗     |
|    34 | ה               | ▁ל           | ✗     |
|    35 | מדינות          | ממלכה        | ✗     |
|    36 | ▁כולה           | ▁עם          | ✗     |
|    37 | ▁ישראל          | ▁העשרה       | ✗     |
|    38 | ▁מדינות         | ▁מחוץ        | ✗     |
|    39 | ▁לחוק           | ▁לא          | ✗     |
|    40 | ין              | ד            | ✗     |
|    41 | יפות            | מת           | ✗     |
|    42 | ▁המדינה         | ▁סע          | ✗     |
|    43 | ר               | ודי          | ✗     |
|    44 | ה               | ה            | ✓     |
|    45 | .               | ▁כנראה       | ✗     |
|    46 | ▁לא             | ▁בארה        | ✗     |
|    47 | ב               | ב            | ✓     |
|    48 | .               | ,            | ✗     |
|    49 | </s>            | ▁א           | ✗     |
|    50 | ץ               | א            | ✗     |
|    51 | נש              |              | ✗     |

2024-12-31 17:15:49,275 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:15:49,280 - TrainingLogger - INFO - Gradient norm: 11.0066
2024-12-31 17:15:56,600 - TrainingLogger - INFO - Step 8010, Batch metrics: Loss: 6.7560, Accuracy: 0.0853, Perplexity: 859.1740
2024-12-31 17:16:03,706 - TrainingLogger - INFO - Step 8020, Batch metrics: Loss: 7.2559, Accuracy: 0.0570, Perplexity: 1416.4877
2024-12-31 17:16:10,377 - TrainingLogger - INFO - Step 8030, Batch metrics: Loss: 7.7096, Accuracy: 0.0602, Perplexity: 2229.6289
2024-12-31 17:16:17,146 - TrainingLogger - INFO - Step 8040, Batch metrics: Loss: 7.1591, Accuracy: 0.0903, Perplexity: 1285.7699
2024-12-31 17:16:24,313 - TrainingLogger - INFO - Step 8050, Batch metrics: Loss: 7.5390, Accuracy: 0.0737, Perplexity: 1879.9483
2024-12-31 17:16:31,950 - TrainingLogger - INFO - Step 8060, Batch metrics: Loss: 7.2199, Accuracy: 0.0889, Perplexity: 1366.3396
2024-12-31 17:16:39,292 - TrainingLogger - INFO - Step 8070, Batch metrics: Loss: 7.7652, Accuracy: 0.0330, Perplexity: 2357.1864
2024-12-31 17:16:45,967 - TrainingLogger - INFO - Step 8080, Batch metrics: Loss: 7.3657, Accuracy: 0.0609, Perplexity: 1580.7753
2024-12-31 17:16:53,484 - TrainingLogger - INFO - Step 8090, Batch metrics: Loss: 7.4579, Accuracy: 0.0941, Perplexity: 1733.5899
2024-12-31 17:17:00,536 - TrainingLogger - INFO - Step 8100, Batch metrics: Loss: 7.1489, Accuracy: 0.1325, Perplexity: 1272.6427
2024-12-31 17:17:00,537 - TrainingLogger - INFO - Step 8100, Prediction vs Actual:
2024-12-31 17:17:00,537 - TrainingLogger - INFO - Input 1: ב-2018 הדקה העמוסה ביותר הייתה ב-1238, במהלכה בוצעו עסקות בהיקף של 215 מילון שקל
2024-12-31 17:17:00,537 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:17:00,537 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ב           | ✗     |
|     1 | ▁ר              | -20          | ✗     |
|     2 | ▁מה             | 18           | ✗     |
|     3 | </s>            | ▁הדק         | ✗     |
|     4 | ▁את             | ה            | ✗     |
|     5 | ▁את             | ▁ה           | ✗     |
|     6 | נוס             | עמוס         | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | ▁של             | ▁ביותר       | ✗     |
|     9 | ▁בעולם          | ▁הייתה       | ✗     |
|    10 | ▁               | ▁ב           | ✗     |
|    11 | ות              | -12          | ✗     |
|    12 | ▁במרץ           | 38           | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | </s>            | ▁במ          | ✗     |
|    15 | פלג             | הלכה         | ✗     |
|    16 | .               | ▁בוצע        | ✗     |
|    17 | ה               | ו            | ✗     |
|    18 | ▁בעיות          | ▁עסק         | ✗     |
|    19 | ות              | ות           | ✓     |
|    20 | ▁ב              | ▁ב           | ✓     |
|    21 | שלטון           | היקף         | ✗     |
|    22 | ▁גבוה           | ▁של          | ✗     |
|    23 | ▁כ              | ▁2           | ✗     |
|    24 | ▁מדינות         | 15           | ✗     |
|    25 | ים              | ▁מילון       | ✗     |
|    26 | .               | ▁שקל         | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              |              | ✗     |

2024-12-31 17:17:00,537 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:17:00,542 - TrainingLogger - INFO - Gradient norm: 10.7481
2024-12-31 17:17:07,481 - TrainingLogger - INFO - Step 8110, Batch metrics: Loss: 7.4514, Accuracy: 0.0637, Perplexity: 1722.2312
2024-12-31 17:17:14,584 - TrainingLogger - INFO - Step 8120, Batch metrics: Loss: 7.3330, Accuracy: 0.0732, Perplexity: 1530.0191
2024-12-31 17:17:21,965 - TrainingLogger - INFO - Step 8130, Batch metrics: Loss: 7.4501, Accuracy: 0.0442, Perplexity: 1720.1146
2024-12-31 17:17:29,084 - TrainingLogger - INFO - Step 8140, Batch metrics: Loss: 7.7297, Accuracy: 0.0684, Perplexity: 2274.8363
2024-12-31 17:17:35,876 - TrainingLogger - INFO - Step 8150, Batch metrics: Loss: 7.2026, Accuracy: 0.0811, Perplexity: 1342.9735
2024-12-31 17:17:42,750 - TrainingLogger - INFO - Step 8160, Batch metrics: Loss: 7.6407, Accuracy: 0.0992, Perplexity: 2081.2644
2024-12-31 17:17:49,744 - TrainingLogger - INFO - Step 8170, Batch metrics: Loss: 7.3176, Accuracy: 0.0819, Perplexity: 1506.6510
2024-12-31 17:17:57,161 - TrainingLogger - INFO - Step 8180, Batch metrics: Loss: 7.3509, Accuracy: 0.0884, Perplexity: 1557.5973
2024-12-31 17:18:04,620 - TrainingLogger - INFO - Step 8190, Batch metrics: Loss: 7.6059, Accuracy: 0.0857, Perplexity: 2009.9862
2024-12-31 17:18:11,169 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 286720
2024-12-31 17:18:11,169 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 286720

2024-12-31 17:18:11,169 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 34]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 34]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 17:18:11,170 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 17:18:12,640 - TrainingLogger - INFO - Step 8200, Batch metrics: Loss: 7.8626, Accuracy: 0.0585, Perplexity: 2598.2333
2024-12-31 17:18:12,640 - TrainingLogger - INFO - Step 8200, Prediction vs Actual:
2024-12-31 17:18:12,640 - TrainingLogger - INFO - Input 1: חברי הוועדה בחרו פה אחד בארבעה סגנים לשופטחנן מלצר, שמכהן כיור - חכדוד ביטןמהליכוד, גיל סגל מכחול לבן, הרב אברהם ובר מיהדות התורה וחכ משה ארבל משס
2024-12-31 17:18:12,641 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:18:12,641 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁חברי        | ✗     |
|     1 | ▁-              | ▁הוועדה      | ✗     |
|     2 | ▁שלך            | ▁בחרו        | ✗     |
|     3 | ▁-              | ▁פה          | ✗     |
|     4 | .               | ▁אחד         | ✗     |
|     5 | ▁כן             | ▁בארבע       | ✗     |
|     6 | ▁-              | ה            | ✗     |
|     7 | ▁ימים           | ▁ס           | ✗     |
|     8 | "               | גנים         | ✗     |
|     9 | .               | ▁לשופט       | ✗     |
|    10 | ים              | חנן          | ✗     |
|    11 | .               | ▁מלצר        | ✗     |
|    12 | ים              | ,            | ✗     |
|    13 | <pad>           | ▁ש           | ✗     |
|    14 | ייט             | מכה          | ✗     |
|    15 | ▁את             | ן            | ✗     |
|    16 | .               | ▁כי          | ✗     |
|    17 | ▁יש             | ור           | ✗     |
|    18 | ות              | ▁-           | ✗     |
|    19 | -               | ▁ח           | ✗     |
|    20 | ות              | כ            | ✗     |
|    21 | מ               | דוד          | ✗     |
|    22 | .               | ▁ב           | ✗     |
|    23 | אחר             | יטן          | ✗     |
|    24 | .               | מה           | ✗     |
|    25 | .               | לי           | ✗     |
|    26 | כות             | כו           | ✗     |
|    27 | ד               | ד            | ✓     |
|    28 | .               | ,            | ✗     |
|    29 | <pad>           | ▁גיל         | ✗     |
|    30 | ם               | ▁סגל         | ✗     |
|    31 | ה               | ▁מ           | ✗     |
|    32 | פלג             | כחול         | ✗     |
|    33 | ,               | ▁לבן         | ✗     |
|    34 | ▁ישראל          | ,            | ✗     |
|    35 | <pad>           | ▁הרב         | ✗     |
|    36 | נים             | ▁אברהם       | ✗     |
|    37 | ,               | ▁ובר         | ✗     |
|    38 | מה              | ▁מי          | ✗     |
|    39 | מן              | ה            | ✗     |
|    40 | ווה             | דות          | ✗     |
|    41 | ,               | ▁התורה       | ✗     |
|    42 | .               | ▁וח          | ✗     |
|    43 | מה              | כ            | ✗     |
|    44 | מת              | ▁משה         | ✗     |
|    45 | .               | ▁ארב         | ✗     |
|    46 | ה               | ל            | ✗     |
|    47 | יזם             | ▁מש          | ✗     |
|    48 | כן              | ס            | ✗     |
|    49 | דו              |              | ✗     |

2024-12-31 17:18:12,641 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:18:12,646 - TrainingLogger - INFO - Gradient norm: 14.7018
2024-12-31 17:18:21,374 - TrainingLogger - INFO - Step 8210, Batch metrics: Loss: 7.8191, Accuracy: 0.1043, Perplexity: 2487.7175
2024-12-31 17:18:29,209 - TrainingLogger - INFO - Step 8220, Batch metrics: Loss: 7.2247, Accuracy: 0.0833, Perplexity: 1372.9424
2024-12-31 17:18:36,632 - TrainingLogger - INFO - Step 8230, Batch metrics: Loss: 6.9023, Accuracy: 0.0988, Perplexity: 994.5889
2024-12-31 17:18:43,313 - TrainingLogger - INFO - Step 8240, Batch metrics: Loss: 7.4004, Accuracy: 0.0847, Perplexity: 1636.6626
2024-12-31 17:18:50,988 - TrainingLogger - INFO - Step 8250, Batch metrics: Loss: 6.9037, Accuracy: 0.0985, Perplexity: 995.9257
2024-12-31 17:18:57,773 - TrainingLogger - INFO - Step 8260, Batch metrics: Loss: 7.8222, Accuracy: 0.0667, Perplexity: 2495.2710
2024-12-31 17:19:04,822 - TrainingLogger - INFO - Step 8270, Batch metrics: Loss: 7.7992, Accuracy: 0.0781, Perplexity: 2438.6493
2024-12-31 17:19:12,066 - TrainingLogger - INFO - Step 8280, Batch metrics: Loss: 7.8726, Accuracy: 0.0645, Perplexity: 2624.3077
2024-12-31 17:19:19,010 - TrainingLogger - INFO - Step 8290, Batch metrics: Loss: 7.4110, Accuracy: 0.0833, Perplexity: 1654.1392
2024-12-31 17:19:26,311 - TrainingLogger - INFO - Step 8300, Batch metrics: Loss: 7.3787, Accuracy: 0.0483, Perplexity: 1601.5328
2024-12-31 17:19:26,311 - TrainingLogger - INFO - Step 8300, Prediction vs Actual:
2024-12-31 17:19:26,311 - TrainingLogger - INFO - Input 1: אלטרנטיבה חייבת להיות אחראית, מאופקת, דרכיה דרכי נועם וכל נתיבותיה ממלכתיות
2024-12-31 17:19:26,312 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:19:26,312 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁            | ✗     |
|     1 | </s>            | אלטרנטיב     | ✗     |
|     2 | ה               | ה            | ✓     |
|     3 | ▁טובה           | ▁חייבת       | ✗     |
|     4 | ▁להיות          | ▁להיות       | ✓     |
|     5 | ▁טובה           | ▁אחראית      | ✗     |
|     6 | ▁על             | ,            | ✗     |
|     7 | </s>            | ▁מאו         | ✗     |
|     8 | לץ              | פקת          | ✗     |
|     9 | ה               | ,            | ✗     |
|    10 | <pad>           | ▁דרכי        | ✗     |
|    11 | ,               | ה            | ✗     |
|    12 | ,               | ▁דרכי        | ✗     |
|    13 | הן              | ▁נו          | ✗     |
|    14 | ד               | עם           | ✗     |
|    15 | ,               | ▁וכל         | ✗     |
|    16 | ה               | ▁נתיב        | ✗     |
|    17 | ים              | ות           | ✗     |
|    18 | ,               | יה           | ✗     |
|    19 | .               | ▁ממלכת       | ✗     |
|    20 | יות             | יות          | ✓     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | יות             | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | יות             | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | י               | <pad>        | ✗     |
|    42 | .               |              | ✗     |

2024-12-31 17:19:26,312 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:19:26,317 - TrainingLogger - INFO - Gradient norm: 9.1836
2024-12-31 17:19:33,328 - TrainingLogger - INFO - Step 8310, Batch metrics: Loss: 7.5025, Accuracy: 0.0531, Perplexity: 1812.4983
2024-12-31 17:19:40,187 - TrainingLogger - INFO - Step 8320, Batch metrics: Loss: 7.1297, Accuracy: 0.0980, Perplexity: 1248.5204
2024-12-31 17:19:47,068 - TrainingLogger - INFO - Step 8330, Batch metrics: Loss: 7.6916, Accuracy: 0.0635, Perplexity: 2189.9431
2024-12-31 17:19:54,664 - TrainingLogger - INFO - Step 8340, Batch metrics: Loss: 7.2074, Accuracy: 0.0994, Perplexity: 1349.4248
2024-12-31 17:20:01,658 - TrainingLogger - INFO - Step 8350, Batch metrics: Loss: 7.5073, Accuracy: 0.0824, Perplexity: 1821.2067
2024-12-31 17:20:09,114 - TrainingLogger - INFO - Step 8360, Batch metrics: Loss: 7.5966, Accuracy: 0.0649, Perplexity: 1991.4488
2024-12-31 17:20:16,044 - TrainingLogger - INFO - Step 8370, Batch metrics: Loss: 6.8385, Accuracy: 0.0921, Perplexity: 933.1245
2024-12-31 17:20:23,264 - TrainingLogger - INFO - Step 8380, Batch metrics: Loss: 6.6673, Accuracy: 0.1204, Perplexity: 786.2816
2024-12-31 17:20:30,389 - TrainingLogger - INFO - Step 8390, Batch metrics: Loss: 7.0966, Accuracy: 0.0962, Perplexity: 1207.8678
2024-12-31 17:20:38,086 - TrainingLogger - INFO - Step 8400, Batch metrics: Loss: 7.2596, Accuracy: 0.0754, Perplexity: 1421.6168
2024-12-31 17:20:38,086 - TrainingLogger - INFO - Step 8400, Prediction vs Actual:
2024-12-31 17:20:38,086 - TrainingLogger - INFO - Input 1: אחוז ההצבעה עמד על 58, בדיוק כמו ב-2019, ובסך הכול הצביעו בפריימריז 79,735 מתפקדים, כל אחד מהם בחר 13 מועמדים 12 ברשימה הארצית, ומועמד נוסף כנציג המחוז שאליו הם משתייכים
2024-12-31 17:20:38,087 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:20:38,087 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אחוז        | ✗     |
|     1 | ▁-              | ▁ההצבעה      | ✗     |
|     2 | ▁על             | ▁עמד         | ✗     |
|     3 | ת               | ▁על          | ✗     |
|     4 | ▁כן             | ▁58          | ✗     |
|     5 | ▁שנה            | ,            | ✗     |
|     6 | ▁אז             | ▁בדיוק       | ✗     |
|     7 | ▁כך             | ▁כמו         | ✗     |
|     8 | ▁זה             | ▁ב           | ✗     |
|     9 | "               | -20          | ✗     |
|    10 | ▁שנה            | 19           | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | <pad>           | ▁וב          | ✗     |
|    13 | המשך            | ס            | ✗     |
|    14 | צ               | ך            | ✗     |
|    15 | ▁הכל            | ▁הכול        | ✗     |
|    16 | ,               | ▁הצביעו      | ✗     |
|    17 | ▁על             | ▁בפר         | ✗     |
|    18 | שה              | יימר         | ✗     |
|    19 | יס              | יז           | ✗     |
|    20 | .               | ▁79          | ✗     |
|    21 | .               | ,            | ✗     |
|    22 | <pad>           | 7            | ✗     |
|    23 | 76              | 35           | ✗     |
|    24 | .               | ▁מתפקד       | ✗     |
|    25 | ים              | ים           | ✓     |
|    26 | .               | ,            | ✗     |
|    27 | </s>            | ▁כל          | ✗     |
|    28 | ▁אחד            | ▁אחד         | ✓     |
|    29 | ▁מהם            | ▁מהם         | ✓     |
|    30 | ▁לא             | ▁בחר         | ✗     |
|    31 | ים              | ▁13          | ✗     |
|    32 | ▁שעות           | ▁מועמד       | ✗     |
|    33 | ים              | ים           | ✓     |
|    34 | ▁נוספים         | ▁12          | ✗     |
|    35 | .               | ▁ברשימה      | ✗     |
|    36 | .               | ▁הארצית      | ✗     |
|    37 | .               | ,            | ✗     |
|    38 | <pad>           | ▁ו           | ✗     |
|    39 | -               | מועמד        | ✗     |
|    40 | ים              | ▁נוסף        | ✗     |
|    41 | ▁ל              | ▁כ           | ✗     |
|    42 | נשיא            | נציג         | ✗     |
|    43 | ה               | ▁המחוז       | ✗     |
|    44 | .               | ▁שאליו       | ✗     |
|    45 | ▁הם             | ▁הם          | ✓     |
|    46 | ▁הולכים         | ▁משתי        | ✗     |
|    47 | כים             | י            | ✗     |
|    48 | כים             | כים          | ✓     |
|    49 | .               |              | ✗     |

2024-12-31 17:20:38,087 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:20:38,092 - TrainingLogger - INFO - Gradient norm: 10.5745
2024-12-31 17:20:45,210 - TrainingLogger - INFO - Step 8410, Batch metrics: Loss: 7.4983, Accuracy: 0.0962, Perplexity: 1804.9594
2024-12-31 17:20:51,650 - TrainingLogger - INFO - Step 8420, Batch metrics: Loss: 7.6326, Accuracy: 0.0657, Perplexity: 2064.3639
2024-12-31 17:20:58,298 - TrainingLogger - INFO - Step 8430, Batch metrics: Loss: 7.1158, Accuracy: 0.1033, Perplexity: 1231.2575
2024-12-31 17:21:05,650 - TrainingLogger - INFO - Step 8440, Batch metrics: Loss: 6.9701, Accuracy: 0.0854, Perplexity: 1064.2900
2024-12-31 17:21:12,873 - TrainingLogger - INFO - Step 8450, Batch metrics: Loss: 7.9394, Accuracy: 0.0492, Perplexity: 2805.6009
2024-12-31 17:21:19,939 - TrainingLogger - INFO - Step 8460, Batch metrics: Loss: 7.1722, Accuracy: 0.0439, Perplexity: 1302.7176
2024-12-31 17:21:27,447 - TrainingLogger - INFO - Step 8470, Batch metrics: Loss: 7.6389, Accuracy: 0.0791, Perplexity: 2077.5293
2024-12-31 17:21:34,755 - TrainingLogger - INFO - Step 8480, Batch metrics: Loss: 7.4089, Accuracy: 0.0697, Perplexity: 1650.5660
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 215040
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 215040

2024-12-31 17:21:37,621 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 35]), device: cuda:0
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 35]), device: cuda:0
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 17:21:37,621 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 17:21:37,622 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 17:21:37,622 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 17:21:37,622 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 17:21:37,622 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 17:21:42,589 - TrainingLogger - INFO - Step 8490, Batch metrics: Loss: 7.2324, Accuracy: 0.0649, Perplexity: 1383.5858
2024-12-31 17:21:50,113 - TrainingLogger - INFO - Step 8500, Batch metrics: Loss: 7.5357, Accuracy: 0.0543, Perplexity: 1873.7811
2024-12-31 17:21:50,113 - TrainingLogger - INFO - Step 8500, Prediction vs Actual:
2024-12-31 17:21:50,113 - TrainingLogger - INFO - Input 1: אלון אמר בדיון בקבינט שלדעתו יש כאן פספוס הזדמנות, ושהדבר עלול להכשיל את המגעים לעסקה
2024-12-31 17:21:50,114 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:21:50,114 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אל          | ✗     |
|     1 | במה             | ון           | ✗     |
|     2 | .               | ▁אמר         | ✗     |
|     3 | ▁לי             | ▁בדיון       | ✗     |
|     4 | .               | ▁בק          | ✗     |
|     5 | אס              | בי           | ✗     |
|     6 | טול             | נט           | ✗     |
|     7 | ה               | ▁של          | ✗     |
|     8 | דון             | דעת          | ✗     |
|     9 | ו               | ו            | ✓     |
|    10 | ▁הוא            | ▁יש          | ✗     |
|    11 | ▁לו             | ▁כאן         | ✗     |
|    12 | .               | ▁פס          | ✗     |
|    13 | ו               | פוס          | ✗     |
|    14 | ה               | ▁הזדמנות     | ✗     |
|    15 | ▁נוספת          | ,            | ✗     |
|    16 | </s>            | ▁וש          | ✗     |
|    17 | את              | הדבר         | ✗     |
|    18 | ▁הזה            | ▁עלול        | ✗     |
|    19 | ▁לקרות          | ▁להכשיל      | ✗     |
|    20 | ▁את             | ▁את          | ✓     |
|    21 | ▁המדינה         | ▁המגע        | ✗     |
|    22 | .               | ים           | ✗     |
|    23 | ▁שלו            | ▁לעסק        | ✗     |
|    24 | .               | ה            | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 17:21:50,114 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:21:50,119 - TrainingLogger - INFO - Gradient norm: 10.0084
2024-12-31 17:21:56,923 - TrainingLogger - INFO - Step 8510, Batch metrics: Loss: 7.8597, Accuracy: 0.0608, Perplexity: 2590.8523
2024-12-31 17:22:04,236 - TrainingLogger - INFO - Step 8520, Batch metrics: Loss: 7.0202, Accuracy: 0.0964, Perplexity: 1119.0646
2024-12-31 17:22:11,524 - TrainingLogger - INFO - Step 8530, Batch metrics: Loss: 7.2781, Accuracy: 0.1011, Perplexity: 1448.1703
2024-12-31 17:22:18,769 - TrainingLogger - INFO - Step 8540, Batch metrics: Loss: 7.3271, Accuracy: 0.0479, Perplexity: 1520.9650
2024-12-31 17:22:26,145 - TrainingLogger - INFO - Step 8550, Batch metrics: Loss: 7.2367, Accuracy: 0.0729, Perplexity: 1389.4428
2024-12-31 17:22:33,534 - TrainingLogger - INFO - Step 8560, Batch metrics: Loss: 7.4102, Accuracy: 0.0688, Perplexity: 1652.7500
2024-12-31 17:22:40,734 - TrainingLogger - INFO - Step 8570, Batch metrics: Loss: 7.2873, Accuracy: 0.0747, Perplexity: 1461.6387
2024-12-31 17:22:48,272 - TrainingLogger - INFO - Step 8580, Batch metrics: Loss: 7.6088, Accuracy: 0.0622, Perplexity: 2015.8094
2024-12-31 17:22:55,454 - TrainingLogger - INFO - Step 8590, Batch metrics: Loss: 7.3840, Accuracy: 0.0461, Perplexity: 1610.0067
2024-12-31 17:23:02,794 - TrainingLogger - INFO - Step 8600, Batch metrics: Loss: 7.6975, Accuracy: 0.0718, Perplexity: 2202.7526
2024-12-31 17:23:02,795 - TrainingLogger - INFO - Step 8600, Prediction vs Actual:
2024-12-31 17:23:02,795 - TrainingLogger - INFO - Input 1: באופן מוזר משהו, נתניהו צריך להחליט אם הוא בצד של הסכמי אברהם והברית האזורית בגיבוי ארהב, או שמא הוא בצד שרוקד לפי החליל של החמאס
2024-12-31 17:23:02,796 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:23:02,796 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁באופן       | ✗     |
|     1 | ▁דומה           | ▁מוזר        | ✗     |
|     2 | .               | ▁משהו        | ✗     |
|     3 | ▁כמו            | ,            | ✗     |
|     4 | </s>            | ▁נתנ         | ✗     |
|     5 | י               | יהו          | ✗     |
|     6 | ,               | ▁צריך        | ✗     |
|     7 | ▁להיות          | ▁להחליט      | ✗     |
|     8 | ▁על             | ▁אם          | ✗     |
|     9 | ▁הוא            | ▁הוא         | ✓     |
|    10 | ▁מוכן           | ▁בצד         | ✗     |
|    11 | ▁אחר            | ▁של          | ✗     |
|    12 | ▁המדינה         | ▁הס          | ✗     |
|    13 | צ               | כ            | ✗     |
|    14 | מי              | מי           | ✓     |
|    15 | ▁ה              | ▁אברהם       | ✗     |
|    16 | .               | ▁ו           | ✗     |
|    17 | סגן             | הברית        | ✗     |
|    18 | ▁שלו            | ▁האזור       | ✗     |
|    19 | יים             | ית           | ✗     |
|    20 | .               | ▁ב           | ✗     |
|    21 | כנס             | גיבוי        | ✗     |
|    22 | .               | ▁ארה         | ✗     |
|    23 | "               | ב            | ✗     |
|    24 | .               | ,            | ✗     |
|    25 | </s>            | ▁או          | ✗     |
|    26 | ▁שהוא           | ▁שמא         | ✗     |
|    27 | ▁הוא            | ▁הוא         | ✓     |
|    28 | ▁י              | ▁בצד         | ✗     |
|    29 | ▁השני           | ▁ש           | ✗     |
|    30 | ממנו            | רוקד         | ✗     |
|    31 | ▁את             | ▁לפי         | ✗     |
|    32 | ▁החוק           | ▁ה           | ✗     |
|    33 | פרלמנט          | חליל         | ✗     |
|    34 | ▁שלו            | ▁של          | ✗     |
|    35 | ▁המדינה         | ▁הח          | ✗     |
|    36 | צץ              | מ            | ✗     |
|    37 | אס              | אס           | ✓     |
|    38 | ים              | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ▁שלה            | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ה               | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | ▁שלה            | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2024-12-31 17:23:02,796 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:23:02,801 - TrainingLogger - INFO - Gradient norm: 12.5306
2024-12-31 17:23:09,921 - TrainingLogger - INFO - Step 8610, Batch metrics: Loss: 7.2928, Accuracy: 0.0651, Perplexity: 1469.7297
2024-12-31 17:23:16,820 - TrainingLogger - INFO - Step 8620, Batch metrics: Loss: 7.7419, Accuracy: 0.0588, Perplexity: 2302.8875
2024-12-31 17:23:23,567 - TrainingLogger - INFO - Step 8630, Batch metrics: Loss: 7.3713, Accuracy: 0.0794, Perplexity: 1589.6554
2024-12-31 17:23:30,034 - TrainingLogger - INFO - Step 8640, Batch metrics: Loss: 7.2351, Accuracy: 0.0763, Perplexity: 1387.3303
2024-12-31 17:23:32,997 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 279552
2024-12-31 17:23:32,997 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 279552

2024-12-31 17:23:32,998 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - input_ids_2 min: 6, max: 151643
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 17:23:32,999 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 17:23:37,569 - TrainingLogger - INFO - Step 8650, Batch metrics: Loss: 7.5316, Accuracy: 0.0581, Perplexity: 1866.0542
2024-12-31 17:23:45,058 - TrainingLogger - INFO - Step 8660, Batch metrics: Loss: 7.2919, Accuracy: 0.0631, Perplexity: 1468.3715
2024-12-31 17:23:52,260 - TrainingLogger - INFO - Step 8670, Batch metrics: Loss: 7.0095, Accuracy: 0.0930, Perplexity: 1107.1431
2024-12-31 17:23:59,151 - TrainingLogger - INFO - Step 8680, Batch metrics: Loss: 7.3173, Accuracy: 0.0496, Perplexity: 1506.1604
2024-12-31 17:24:06,595 - TrainingLogger - INFO - Step 8690, Batch metrics: Loss: 7.4950, Accuracy: 0.0569, Perplexity: 1799.0160
2024-12-31 17:24:13,950 - TrainingLogger - INFO - Step 8700, Batch metrics: Loss: 7.2044, Accuracy: 0.1040, Perplexity: 1345.3636
2024-12-31 17:24:13,950 - TrainingLogger - INFO - Step 8700, Prediction vs Actual:
2024-12-31 17:24:13,950 - TrainingLogger - INFO - Input 1: בצל הקריסה בשני משחקי הליגה האחרונים, כשמאחוריהם לפחות 15 אלף צהובים שחורים בטדי, המשימה אפשרית בהחלט
2024-12-31 17:24:13,951 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:24:13,951 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | -               | ▁בצל         | ✗     |
|     1 | .               | ▁הק          | ✗     |
|     2 | מה              | ריסה         | ✗     |
|     3 | .               | ▁בשני        | ✗     |
|     4 | ים              | ▁משחקי       | ✗     |
|     5 | ▁הווידאו        | ▁הליגה       | ✗     |
|     6 | .               | ▁האחרונים    | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | <pad>           | ▁כש          | ✗     |
|     9 | פים             | מאחורי       | ✗     |
|    10 | כם              | הם           | ✗     |
|    11 | ▁יש             | ▁לפחות       | ✗     |
|    12 | ▁יש             | ▁15          | ✗     |
|    13 | %               | ▁אלף         | ✗     |
|    14 | ▁דולר           | ▁צהוב        | ✗     |
|    15 | ים              | ים           | ✓     |
|    16 | .               | ▁שחורים      | ✗     |
|    17 | .               | ▁בט          | ✗     |
|    18 | טה              | די           | ✗     |
|    19 | ון              | ,            | ✗     |
|    20 | </s>            | ▁המשימה      | ✗     |
|    21 | ▁שלהם           | ▁אפשרית      | ✗     |
|    22 | .               | ▁בהחלט       | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 17:24:13,951 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:24:13,956 - TrainingLogger - INFO - Gradient norm: 8.1863
2024-12-31 17:24:21,412 - TrainingLogger - INFO - Step 8710, Batch metrics: Loss: 7.0294, Accuracy: 0.0874, Perplexity: 1129.3833
2024-12-31 17:24:28,644 - TrainingLogger - INFO - Step 8720, Batch metrics: Loss: 7.9916, Accuracy: 0.0541, Perplexity: 2956.0469
2024-12-31 17:24:35,902 - TrainingLogger - INFO - Step 8730, Batch metrics: Loss: 7.8311, Accuracy: 0.0613, Perplexity: 2517.8041
2024-12-31 17:24:43,616 - TrainingLogger - INFO - Step 8740, Batch metrics: Loss: 7.1878, Accuracy: 0.0990, Perplexity: 1323.1914
2024-12-31 17:24:50,507 - TrainingLogger - INFO - Step 8750, Batch metrics: Loss: 7.3039, Accuracy: 0.0805, Perplexity: 1486.0642
2024-12-31 17:24:57,442 - TrainingLogger - INFO - Step 8760, Batch metrics: Loss: 7.1455, Accuracy: 0.1053, Perplexity: 1268.3360
2024-12-31 17:25:04,354 - TrainingLogger - INFO - Step 8770, Batch metrics: Loss: 7.5645, Accuracy: 0.0659, Perplexity: 1928.4295
2024-12-31 17:25:11,405 - TrainingLogger - INFO - Step 8780, Batch metrics: Loss: 7.6649, Accuracy: 0.0629, Perplexity: 2132.1721
2024-12-31 17:25:18,431 - TrainingLogger - INFO - Step 8790, Batch metrics: Loss: 7.5092, Accuracy: 0.0693, Perplexity: 1824.7281
2024-12-31 17:25:26,260 - TrainingLogger - INFO - Step 8800, Batch metrics: Loss: 7.1644, Accuracy: 0.1081, Perplexity: 1292.6007
2024-12-31 17:25:26,261 - TrainingLogger - INFO - Step 8800, Prediction vs Actual:
2024-12-31 17:25:26,261 - TrainingLogger - INFO - Input 1: בכל מקרה, כפי שהודו גם בצהל, בשלב זה של המלחמה ציפו במערכת הביטחון שיחוסל לפחות בכיר משמעותי אחד בחמאס ברצועת עזה - סינוואר עצמו, אחיו מוחמד, מרואן עיסא ומוחמד דף
2024-12-31 17:25:26,261 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:25:26,261 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בכל         | ✗     |
|     1 | ,               | ▁מקרה        | ✗     |
|     2 | .               | ,            | ✗     |
|     3 | </s>            | ▁כפי         | ✗     |
|     4 | ▁שהוא           | ▁שהוד        | ✗     |
|     5 | ה               | ו            | ✗     |
|     6 | ,               | ▁גם          | ✗     |
|     7 | </s>            | ▁בצ          | ✗     |
|     8 | ו               | הל           | ✗     |
|     9 | ,               | ,            | ✓     |
|    10 | </s>            | ▁בשלב        | ✗     |
|    11 | ▁זה             | ▁זה          | ✓     |
|    12 | ,               | ▁של          | ✗     |
|    13 | ▁היום           | ▁המלחמה      | ✗     |
|    14 | ,               | ▁ציפו        | ✗     |
|    15 | ר               | ▁במערכת      | ✗     |
|    16 | .               | ▁הביטחון     | ✗     |
|    17 | </s>            | ▁שי          | ✗     |
|    18 | ועדה            | חוס          | ✗     |
|    19 | לה              | ל            | ✗     |
|    20 | ▁להם            | ▁לפחות       | ✗     |
|    21 | ▁עד             | ▁בכיר        | ✗     |
|    22 | ה               | ▁משמעותי     | ✗     |
|    23 | ים              | ▁אחד         | ✗     |
|    24 | ,               | ▁בח          | ✗     |
|    25 | זו              | מ            | ✗     |
|    26 | "               | אס           | ✗     |
|    27 | .               | ▁ב           | ✗     |
|    28 | -               | רצו          | ✗     |
|    29 | נה              | עת           | ✗     |
|    30 | ▁הראשונה        | ▁עזה         | ✗     |
|    31 | .               | ▁-           | ✗     |
|    32 | -               | ▁סינ         | ✗     |
|    33 | ים              | וואר         | ✗     |
|    34 | ה               | ▁עצמו        | ✗     |
|    35 | .               | ,            | ✗     |
|    36 | </s>            | ▁אחיו        | ✗     |
|    37 | ▁של             | ▁מוחמד       | ✗     |
|    38 | ,               | ,            | ✓     |
|    39 | </s>            | ▁מר          | ✗     |
|    40 | ינה             | ואן          | ✗     |
|    41 | ,               | ▁עי          | ✗     |
|    42 | מן              | סא           | ✗     |
|    43 | ה               | ▁ומו         | ✗     |
|    44 | סק              | חמד          | ✗     |
|    45 | ה               | ▁דף          | ✗     |
|    46 | ,               |              | ✗     |

2024-12-31 17:25:26,261 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:25:26,266 - TrainingLogger - INFO - Gradient norm: 8.4473
2024-12-31 17:25:33,343 - TrainingLogger - INFO - Step 8810, Batch metrics: Loss: 7.2223, Accuracy: 0.1135, Perplexity: 1369.6076
2024-12-31 17:25:40,463 - TrainingLogger - INFO - Step 8820, Batch metrics: Loss: 7.8916, Accuracy: 0.0486, Perplexity: 2674.6196
2024-12-31 17:25:47,593 - TrainingLogger - INFO - Step 8830, Batch metrics: Loss: 7.8203, Accuracy: 0.0667, Perplexity: 2490.6266
2024-12-31 17:25:55,044 - TrainingLogger - INFO - Step 8840, Batch metrics: Loss: 7.4552, Accuracy: 0.0678, Perplexity: 1728.7550
2024-12-31 17:26:01,794 - TrainingLogger - INFO - Step 8850, Batch metrics: Loss: 7.4908, Accuracy: 0.0652, Perplexity: 1791.5366
2024-12-31 17:26:09,377 - TrainingLogger - INFO - Step 8860, Batch metrics: Loss: 7.5257, Accuracy: 0.0524, Perplexity: 1855.0832
2024-12-31 17:26:17,159 - TrainingLogger - INFO - Step 8870, Batch metrics: Loss: 7.4330, Accuracy: 0.0957, Perplexity: 1690.8453
2024-12-31 17:26:24,483 - TrainingLogger - INFO - Step 8880, Batch metrics: Loss: 7.5825, Accuracy: 0.0842, Perplexity: 1963.5185
2024-12-31 17:26:31,750 - TrainingLogger - INFO - Step 8890, Batch metrics: Loss: 7.3920, Accuracy: 0.0736, Perplexity: 1622.9375
2024-12-31 17:26:38,824 - TrainingLogger - INFO - Step 8900, Batch metrics: Loss: 7.7631, Accuracy: 0.0751, Perplexity: 2352.1428
2024-12-31 17:26:38,825 - TrainingLogger - INFO - Step 8900, Prediction vs Actual:
2024-12-31 17:26:38,825 - TrainingLogger - INFO - Input 1: העימות היה צפוי, זה לא משנה אם זה חג המולד, אמר צאן, עובד מסעדה בן 28 שלקח חלק בהטחת העלבונות בשוטרים שהוצבו בקניון במונג קוק
2024-12-31 17:26:38,825 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:26:38,825 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ה           | ✗     |
|     1 | ▁-              | עימות        | ✗     |
|     2 | ▁הגדול          | ▁היה         | ✗     |
|     3 | ▁היום           | ▁צפוי        | ✗     |
|     4 | .               | ,            | ✗     |
|     5 | ▁אדוני          | ▁זה          | ✗     |
|     6 | ▁היה            | ▁לא          | ✗     |
|     7 | ▁היה            | ▁משנה        | ✗     |
|     8 | .               | ▁אם          | ✗     |
|     9 | ▁הוא            | ▁זה          | ✗     |
|    10 | ▁נכון           | ▁חג          | ✗     |
|    11 | ▁המולד          | ▁המולד       | ✓     |
|    12 | ,               | ,            | ✓     |
|    13 | </s>            | ▁אמר         | ✗     |
|    14 | ,               | ▁צאן         | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | <pad>           | ▁עובד        | ✗     |
|    17 | ▁קשה            | ▁מסעדה       | ✗     |
|    18 | ,               | ▁בן          | ✗     |
|    19 | -               | ▁28          | ✗     |
|    20 | ,               | ▁שלקח        | ✗     |
|    21 | ה               | ▁חלק         | ✗     |
|    22 | ,               | ▁בה          | ✗     |
|    23 | ,               | ט            | ✗     |
|    24 | ירה             | חת           | ✗     |
|    25 | ▁נשק            | ▁העל         | ✗     |
|    26 | יות             | ב            | ✗     |
|    27 | ונות            | ונות         | ✓     |
|    28 | ,               | ▁ב           | ✗     |
|    29 | -19             | שוטרים       | ✗     |
|    30 | .               | ▁שהו         | ✗     |
|    31 | קם              | צב           | ✗     |
|    32 | ו               | ו            | ✓     |
|    33 | ▁שם             | ▁בקניון      | ✗     |
|    34 | .               | ▁במ          | ✗     |
|    35 | אס              | ונג          | ✗     |
|    36 | ות              | ▁קוק         | ✗     |
|    37 | יה              |              | ✗     |

2024-12-31 17:26:38,825 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:26:38,830 - TrainingLogger - INFO - Gradient norm: 11.3922
2024-12-31 17:26:46,040 - TrainingLogger - INFO - Step 8910, Batch metrics: Loss: 7.4416, Accuracy: 0.0833, Perplexity: 1705.4936
2024-12-31 17:26:53,305 - TrainingLogger - INFO - Step 8920, Batch metrics: Loss: 7.8087, Accuracy: 0.0698, Perplexity: 2461.9022
2024-12-31 17:27:00,307 - TrainingLogger - INFO - Step 8930, Batch metrics: Loss: 7.6426, Accuracy: 0.0833, Perplexity: 2085.1275
2024-12-31 17:27:07,226 - TrainingLogger - INFO - Step 8940, Batch metrics: Loss: 7.6549, Accuracy: 0.0700, Perplexity: 2110.9410
2024-12-31 17:27:14,434 - TrainingLogger - INFO - Step 8950, Batch metrics: Loss: 7.0554, Accuracy: 0.0966, Perplexity: 1159.1247
2024-12-31 17:27:21,170 - TrainingLogger - INFO - Step 8960, Batch metrics: Loss: 7.6159, Accuracy: 0.0702, Perplexity: 2030.1331
2024-12-31 17:27:28,033 - TrainingLogger - INFO - Step 8970, Batch metrics: Loss: 7.5124, Accuracy: 0.0556, Perplexity: 1830.5889
2024-12-31 17:27:35,450 - TrainingLogger - INFO - Step 8980, Batch metrics: Loss: 7.2159, Accuracy: 0.0941, Perplexity: 1360.9537
2024-12-31 17:27:42,663 - TrainingLogger - INFO - Step 8990, Batch metrics: Loss: 7.8942, Accuracy: 0.0576, Perplexity: 2681.5653
2024-12-31 17:27:49,892 - TrainingLogger - INFO - Step 9000, Batch metrics: Loss: 7.2078, Accuracy: 0.1000, Perplexity: 1349.9178
2024-12-31 17:27:49,893 - TrainingLogger - INFO - Step 9000, Prediction vs Actual:
2024-12-31 17:27:49,893 - TrainingLogger - INFO - Input 1: בנוסף להנגבי ודיכטר שלא בטוח כלל שימונו לשרים ישנם שרים מכהנים נוספים שעדיין לא נמצא להם תפקיד שיספק אותם
2024-12-31 17:27:49,893 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:27:49,893 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בנוסף       | ✗     |
|     1 | ▁-              | ▁לה          | ✗     |
|     2 | ורי             | נג           | ✗     |
|     3 | ▁יש             | בי           | ✗     |
|     4 | ▁-              | ▁ודי         | ✗     |
|     5 | .               | כ            | ✗     |
|     6 | טה              | טר           | ✗     |
|     7 | אס              | ▁שלא         | ✗     |
|     8 | ▁היה            | ▁בטוח        | ✗     |
|     9 | .               | ▁כלל         | ✗     |
|    10 | ▁לא             | ▁שימו        | ✗     |
|    11 | ת               | נו           | ✗     |
|    12 | ▁לא             | ▁לשר         | ✗     |
|    13 | ך               | ים           | ✗     |
|    14 | .               | ▁ישנם        | ✗     |
|    15 | ▁חיים           | ▁שרים        | ✗     |
|    16 | ▁חדשים          | ▁מכה         | ✗     |
|    17 | יים             | נים          | ✗     |
|    18 | ▁רבים           | ▁נוספים      | ✗     |
|    19 | .               | ▁שעדיין      | ✗     |
|    20 | ▁לא             | ▁לא          | ✓     |
|    21 | ▁קיבלו          | ▁נמצא        | ✗     |
|    22 | ▁בהם            | ▁להם         | ✗     |
|    23 | ▁בראש           | ▁תפקיד       | ✗     |
|    24 | .               | ▁שי          | ✗     |
|    25 | צ               | ספק          | ✗     |
|    26 | ו               | ▁אותם        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ▁את             | <pad>        | ✗     |
|    31 | ▁יותר           | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ▁את             |              | ✗     |

2024-12-31 17:27:49,893 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:27:49,898 - TrainingLogger - INFO - Gradient norm: 9.5011
2024-12-31 17:27:57,194 - TrainingLogger - INFO - Step 9010, Batch metrics: Loss: 7.2529, Accuracy: 0.0621, Perplexity: 1412.2456
2024-12-31 17:28:04,303 - TrainingLogger - INFO - Step 9020, Batch metrics: Loss: 7.2277, Accuracy: 0.0957, Perplexity: 1377.1038
2024-12-31 17:28:11,189 - TrainingLogger - INFO - Step 9030, Batch metrics: Loss: 7.3316, Accuracy: 0.0943, Perplexity: 1527.7722
2024-12-31 17:28:18,605 - TrainingLogger - INFO - Step 9040, Batch metrics: Loss: 7.5436, Accuracy: 0.0763, Perplexity: 1888.6908
2024-12-31 17:28:25,760 - TrainingLogger - INFO - Step 9050, Batch metrics: Loss: 6.5749, Accuracy: 0.1097, Perplexity: 716.8669
2024-12-31 17:28:33,152 - TrainingLogger - INFO - Step 9060, Batch metrics: Loss: 7.1761, Accuracy: 0.0615, Perplexity: 1307.8375
2024-12-31 17:28:40,465 - TrainingLogger - INFO - Step 9070, Batch metrics: Loss: 7.7345, Accuracy: 0.0558, Perplexity: 2285.9732
2024-12-31 17:28:48,115 - TrainingLogger - INFO - Step 9080, Batch metrics: Loss: 7.3771, Accuracy: 0.0989, Perplexity: 1598.8912
2024-12-31 17:28:55,196 - TrainingLogger - INFO - Step 9090, Batch metrics: Loss: 7.7860, Accuracy: 0.0488, Perplexity: 2406.6470
2024-12-31 17:29:02,371 - TrainingLogger - INFO - Step 9100, Batch metrics: Loss: 6.7055, Accuracy: 0.1149, Perplexity: 816.8686
2024-12-31 17:29:02,372 - TrainingLogger - INFO - Step 9100, Prediction vs Actual:
2024-12-31 17:29:02,372 - TrainingLogger - INFO - Input 1: אני מבין שהילדים זקוקים למרחבים, ושגם אתם ההורים זקוקים לנשימה
2024-12-31 17:29:02,372 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:29:02,372 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | ,               | ▁מבין        | ✗     |
|     2 | ▁את             | ▁שהילדים     | ✗     |
|     3 | ▁שלי            | ▁זקוקים      | ✗     |
|     4 | ▁לו             | ▁ל           | ✗     |
|     5 | תרופות          | מרחב         | ✗     |
|     6 | .               | ים           | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | ▁אבל            | ▁וש          | ✗     |
|     9 | ות              | גם           | ✗     |
|    10 | ▁הם             | ▁אתם         | ✗     |
|    11 | ,               | ▁ההורים      | ✗     |
|    12 | ▁שלי            | ▁זקוקים      | ✗     |
|    13 | ▁לזה            | ▁ל           | ✗     |
|    14 | קצת             | נשימה        | ✗     |
|    15 | ▁אחת            | <pad>        | ✗     |
|    16 | ▁שלהם           | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | זו              | <pad>        | ✗     |
|    19 | ▁שלהם           | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁שלכם           | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ▁שלי            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁שלכם           | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁שלהם           | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 17:29:02,372 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:29:02,377 - TrainingLogger - INFO - Gradient norm: 10.2880
2024-12-31 17:29:09,220 - TrainingLogger - INFO - Step 9110, Batch metrics: Loss: 7.6319, Accuracy: 0.0884, Perplexity: 2062.8898
2024-12-31 17:29:16,048 - TrainingLogger - INFO - Step 9120, Batch metrics: Loss: 7.2643, Accuracy: 0.0833, Perplexity: 1428.4247
2024-12-31 17:29:23,696 - TrainingLogger - INFO - Step 9130, Batch metrics: Loss: 7.0432, Accuracy: 0.0885, Perplexity: 1145.0912
2024-12-31 17:29:30,892 - TrainingLogger - INFO - Step 9140, Batch metrics: Loss: 7.3480, Accuracy: 0.0843, Perplexity: 1553.0147
2024-12-31 17:29:38,637 - TrainingLogger - INFO - Step 9150, Batch metrics: Loss: 7.6141, Accuracy: 0.0791, Perplexity: 2026.5932
2024-12-31 17:29:46,337 - TrainingLogger - INFO - Step 9160, Batch metrics: Loss: 7.5633, Accuracy: 0.0655, Perplexity: 1926.2331
2024-12-31 17:29:53,540 - TrainingLogger - INFO - Step 9170, Batch metrics: Loss: 7.8840, Accuracy: 0.0520, Perplexity: 2654.4156
2024-12-31 17:30:00,727 - TrainingLogger - INFO - Step 9180, Batch metrics: Loss: 7.4694, Accuracy: 0.0819, Perplexity: 1753.5775
2024-12-31 17:30:08,487 - TrainingLogger - INFO - Step 9190, Batch metrics: Loss: 7.7086, Accuracy: 0.0714, Perplexity: 2227.3336
2024-12-31 17:30:15,658 - TrainingLogger - INFO - Step 9200, Batch metrics: Loss: 7.0861, Accuracy: 0.0865, Perplexity: 1195.2431
2024-12-31 17:30:15,658 - TrainingLogger - INFO - Step 9200, Prediction vs Actual:
2024-12-31 17:30:15,658 - TrainingLogger - INFO - Input 1: ב-7 באוקטובר היא הופקרה שוב כשלא באו לחלץ אותה
2024-12-31 17:30:15,659 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:30:15,659 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ב           | ✗     |
|     1 | :               | -7           | ✗     |
|     2 | .               | ▁באוקטובר    | ✗     |
|     3 | ▁19             | ▁היא         | ✗     |
|     4 | ▁עזבה           | ▁הופ         | ✗     |
|     5 | עה              | קרה          | ✗     |
|     6 | ▁ב              | ▁שוב         | ✗     |
|     7 | ▁ושוב           | ▁כשלא        | ✗     |
|     8 | ▁ראתה           | ▁באו         | ✗     |
|     9 | הל              | ▁לחלץ        | ✗     |
|    10 | ▁את             | ▁אותה        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ▁היא            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁היא            |              | ✗     |

2024-12-31 17:30:15,659 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:30:15,664 - TrainingLogger - INFO - Gradient norm: 11.1683
2024-12-31 17:30:22,823 - TrainingLogger - INFO - Step 9210, Batch metrics: Loss: 7.1478, Accuracy: 0.0833, Perplexity: 1271.3423
2024-12-31 17:30:30,187 - TrainingLogger - INFO - Step 9220, Batch metrics: Loss: 7.3970, Accuracy: 0.0988, Perplexity: 1631.0416
2024-12-31 17:30:37,210 - TrainingLogger - INFO - Step 9230, Batch metrics: Loss: 7.1196, Accuracy: 0.0851, Perplexity: 1235.9422
2024-12-31 17:30:44,429 - TrainingLogger - INFO - Step 9240, Batch metrics: Loss: 7.2515, Accuracy: 0.0976, Perplexity: 1410.1502
2024-12-31 17:30:51,139 - TrainingLogger - INFO - Step 9250, Batch metrics: Loss: 7.4688, Accuracy: 0.0778, Perplexity: 1752.4574
2024-12-31 17:30:58,380 - TrainingLogger - INFO - Step 9260, Batch metrics: Loss: 7.2093, Accuracy: 0.0973, Perplexity: 1351.9476
2024-12-31 17:31:05,571 - TrainingLogger - INFO - Step 9270, Batch metrics: Loss: 6.8138, Accuracy: 0.0732, Perplexity: 910.3524
2024-12-31 17:31:12,884 - TrainingLogger - INFO - Step 9280, Batch metrics: Loss: 7.3760, Accuracy: 0.0857, Perplexity: 1597.2193
2024-12-31 17:31:20,310 - TrainingLogger - INFO - Step 9290, Batch metrics: Loss: 7.5364, Accuracy: 0.0683, Perplexity: 1874.9797
2024-12-31 17:31:27,703 - TrainingLogger - INFO - Step 9300, Batch metrics: Loss: 7.7861, Accuracy: 0.0584, Perplexity: 2406.8180
2024-12-31 17:31:27,703 - TrainingLogger - INFO - Step 9300, Prediction vs Actual:
2024-12-31 17:31:27,703 - TrainingLogger - INFO - Input 1: מי שרוצה את טובתו ינהג אחרת
2024-12-31 17:31:27,704 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:31:27,704 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁פנים           | ▁מי          | ✗     |
|     1 | ▁-              | ▁שרוצה       | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁זה             | ▁טוב         | ✗     |
|     4 | ▁יותר           | תו           | ✗     |
|     5 | .               | ▁ינהג        | ✗     |
|     6 | ו               | ▁אחרת        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | .               |              | ✗     |

2024-12-31 17:31:27,704 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:31:27,709 - TrainingLogger - INFO - Gradient norm: 9.4462
2024-12-31 17:31:34,680 - TrainingLogger - INFO - Step 9310, Batch metrics: Loss: 7.0469, Accuracy: 0.0909, Perplexity: 1149.2979
2024-12-31 17:31:41,799 - TrainingLogger - INFO - Step 9320, Batch metrics: Loss: 7.5763, Accuracy: 0.0690, Perplexity: 1951.4004
2024-12-31 17:31:49,482 - TrainingLogger - INFO - Step 9330, Batch metrics: Loss: 7.7152, Accuracy: 0.0575, Perplexity: 2242.0910
2024-12-31 17:31:56,579 - TrainingLogger - INFO - Step 9340, Batch metrics: Loss: 7.5219, Accuracy: 0.0699, Perplexity: 1848.1488
2024-12-31 17:32:03,742 - TrainingLogger - INFO - Step 9350, Batch metrics: Loss: 7.1338, Accuracy: 0.0667, Perplexity: 1253.5995
2024-12-31 17:32:10,675 - TrainingLogger - INFO - Step 9360, Batch metrics: Loss: 7.2832, Accuracy: 0.0674, Perplexity: 1455.6841
2024-12-31 17:32:18,033 - TrainingLogger - INFO - Step 9370, Batch metrics: Loss: 7.1844, Accuracy: 0.1028, Perplexity: 1318.6847
2024-12-31 17:32:24,679 - TrainingLogger - INFO - Step 9380, Batch metrics: Loss: 7.7264, Accuracy: 0.0573, Perplexity: 2267.5327
2024-12-31 17:32:31,643 - TrainingLogger - INFO - Step 9390, Batch metrics: Loss: 7.3023, Accuracy: 0.1143, Perplexity: 1483.6597
2024-12-31 17:32:39,162 - TrainingLogger - INFO - Step 9400, Batch metrics: Loss: 7.0625, Accuracy: 0.0743, Perplexity: 1167.3477
2024-12-31 17:32:39,162 - TrainingLogger - INFO - Step 9400, Prediction vs Actual:
2024-12-31 17:32:39,162 - TrainingLogger - INFO - Input 1: אנחנו רוצים להגיע להסכמות, אבל לא נאפשר גרירת רגליים
2024-12-31 17:32:39,163 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:32:39,163 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אנחנו       | ✗     |
|     1 | ▁לא             | ▁רוצים       | ✗     |
|     2 | ▁ללכת           | ▁להגיע       | ✗     |
|     3 | ▁לבית           | ▁לה          | ✗     |
|     4 | פלג             | ס            | ✗     |
|     5 | כמה             | כמות         | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | <pad>           | ▁אבל         | ✗     |
|     8 | ▁לא             | ▁לא          | ✓     |
|     9 | ▁ממש            | ▁נ           | ✗     |
|    10 | קדים            | אפשר         | ✗     |
|    11 | ▁להם            | ▁גרי         | ✗     |
|    12 | ה               | רת           | ✗     |
|    13 | ▁דם             | ▁רגליים      | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               |              | ✗     |

2024-12-31 17:32:39,163 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:32:39,168 - TrainingLogger - INFO - Gradient norm: 9.4012
2024-12-31 17:32:46,392 - TrainingLogger - INFO - Step 9410, Batch metrics: Loss: 7.2264, Accuracy: 0.0872, Perplexity: 1375.3241
2024-12-31 17:32:53,360 - TrainingLogger - INFO - Step 9420, Batch metrics: Loss: 7.7350, Accuracy: 0.0909, Perplexity: 2286.9665
2024-12-31 17:33:01,930 - TrainingLogger - INFO - Step 9430, Batch metrics: Loss: 7.1252, Accuracy: 0.1189, Perplexity: 1242.9231
2024-12-31 17:33:09,193 - TrainingLogger - INFO - Step 9440, Batch metrics: Loss: 7.7491, Accuracy: 0.0526, Perplexity: 2319.3982
2024-12-31 17:33:16,663 - TrainingLogger - INFO - Step 9450, Batch metrics: Loss: 7.2136, Accuracy: 0.0802, Perplexity: 1357.7050
2024-12-31 17:33:23,666 - TrainingLogger - INFO - Step 9460, Batch metrics: Loss: 6.4122, Accuracy: 0.0735, Perplexity: 609.2296
2024-12-31 17:33:30,847 - TrainingLogger - INFO - Step 9470, Batch metrics: Loss: 7.1198, Accuracy: 0.0966, Perplexity: 1236.2003
2024-12-31 17:33:37,572 - TrainingLogger - INFO - Step 9480, Batch metrics: Loss: 7.0515, Accuracy: 0.0855, Perplexity: 1154.5357
2024-12-31 17:33:45,014 - TrainingLogger - INFO - Step 9490, Batch metrics: Loss: 7.3605, Accuracy: 0.0811, Perplexity: 1572.5925
2024-12-31 17:33:51,596 - TrainingLogger - INFO - Step 9500, Batch metrics: Loss: 7.2969, Accuracy: 0.0633, Perplexity: 1475.7847
2024-12-31 17:33:51,597 - TrainingLogger - INFO - Step 9500, Prediction vs Actual:
2024-12-31 17:33:51,597 - TrainingLogger - INFO - Input 1: אנחנו שומעים את הקולות, ואנחנו נשמע אותם בוועדת הכנסת
2024-12-31 17:33:51,597 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:33:51,597 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | ▁נ              | ▁שומעים      | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁אנחנו          | ▁הקולות      | ✗     |
|     4 | ▁האלה           | ,            | ✗     |
|     5 | <pad>           | ▁ואנחנו      | ✗     |
|     6 | ▁צריכים         | ▁נשמע        | ✗     |
|     7 | ▁אותם           | ▁אותם        | ✓     |
|     8 | ▁מדברים         | ▁בוועד       | ✗     |
|     9 | ה               | ת            | ✗     |
|    10 | ▁המשפט          | ▁הכנסת       | ✗     |
|    11 | ▁המזון          | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁את             | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ,               |              | ✗     |

2024-12-31 17:33:51,597 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:33:51,602 - TrainingLogger - INFO - Gradient norm: 9.2045
2024-12-31 17:33:58,299 - TrainingLogger - INFO - Step 9510, Batch metrics: Loss: 7.9424, Accuracy: 0.0585, Perplexity: 2813.9720
2024-12-31 17:34:05,222 - TrainingLogger - INFO - Step 9520, Batch metrics: Loss: 7.2371, Accuracy: 0.0750, Perplexity: 1389.9988
2024-12-31 17:34:12,523 - TrainingLogger - INFO - Step 9530, Batch metrics: Loss: 7.5078, Accuracy: 0.0681, Perplexity: 1822.2300
2024-12-31 17:34:19,226 - TrainingLogger - INFO - Step 9540, Batch metrics: Loss: 7.0815, Accuracy: 0.0800, Perplexity: 1189.7258
2024-12-31 17:34:26,250 - TrainingLogger - INFO - Step 9550, Batch metrics: Loss: 7.2538, Accuracy: 0.0791, Perplexity: 1413.4064
2024-12-31 17:34:33,692 - TrainingLogger - INFO - Step 9560, Batch metrics: Loss: 7.7758, Accuracy: 0.0714, Perplexity: 2382.1762
2024-12-31 17:34:40,901 - TrainingLogger - INFO - Step 9570, Batch metrics: Loss: 7.3054, Accuracy: 0.0775, Perplexity: 1488.3413
2024-12-31 17:34:48,093 - TrainingLogger - INFO - Step 9580, Batch metrics: Loss: 7.5631, Accuracy: 0.0769, Perplexity: 1925.7913
2024-12-31 17:34:55,186 - TrainingLogger - INFO - Step 9590, Batch metrics: Loss: 7.4690, Accuracy: 0.0802, Perplexity: 1752.7984
2024-12-31 17:35:02,086 - TrainingLogger - INFO - Step 9600, Batch metrics: Loss: 7.7202, Accuracy: 0.0476, Perplexity: 2253.3975
2024-12-31 17:35:02,086 - TrainingLogger - INFO - Step 9600, Prediction vs Actual:
2024-12-31 17:35:02,119 - TrainingLogger - INFO - Input 1: שיפור קל נרשם במצבו של חייל צהל שנפצע קשה בפיגוע הדריסהבמתחם התחנה בירושלים
2024-12-31 17:35:02,120 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:35:02,120 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁שיפור       | ✗     |
|     1 | ▁זה             | ▁קל          | ✗     |
|     2 | ן               | ▁נרשם        | ✗     |
|     3 | ▁ב              | ▁במצב        | ✗     |
|     4 | ▁חירום          | ו            | ✗     |
|     5 | ▁הכלכלי         | ▁של          | ✗     |
|     6 | ▁אדם            | ▁חייל        | ✗     |
|     7 | .               | ▁צ           | ✗     |
|     8 | '               | הל           | ✗     |
|     9 | ר               | ▁שנ          | ✗     |
|    10 | בע              | פצע          | ✗     |
|    11 | ▁על             | ▁קשה         | ✗     |
|    12 | .               | ▁בפי         | ✗     |
|    13 | נו              | גוע          | ✗     |
|    14 | </s>            | ▁הד          | ✗     |
|    15 | ח               | ריסה         | ✗     |
|    16 | .               | ב            | ✗     |
|    17 | .               | מתח          | ✗     |
|    18 | ▁דם             | ם            | ✗     |
|    19 | .               | ▁התחנה       | ✗     |
|    20 | .               | ▁בירושלים    | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ה               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | זו              | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | א               | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 17:35:02,120 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:35:02,125 - TrainingLogger - INFO - Gradient norm: 10.2770
2024-12-31 17:35:09,617 - TrainingLogger - INFO - Step 9610, Batch metrics: Loss: 7.6465, Accuracy: 0.0811, Perplexity: 2093.3054
2024-12-31 17:35:16,435 - TrainingLogger - INFO - Step 9620, Batch metrics: Loss: 7.4643, Accuracy: 0.0774, Perplexity: 1744.5917
2024-12-31 17:35:24,103 - TrainingLogger - INFO - Step 9630, Batch metrics: Loss: 7.0143, Accuracy: 0.0795, Perplexity: 1112.4503
2024-12-31 17:35:30,905 - TrainingLogger - INFO - Step 9640, Batch metrics: Loss: 7.9981, Accuracy: 0.0492, Perplexity: 2975.4366
2024-12-31 17:35:37,780 - TrainingLogger - INFO - Step 9650, Batch metrics: Loss: 7.1881, Accuracy: 0.0860, Perplexity: 1323.6092
2024-12-31 17:35:45,356 - TrainingLogger - INFO - Step 9660, Batch metrics: Loss: 7.2929, Accuracy: 0.0813, Perplexity: 1469.7690
2024-12-31 17:35:52,467 - TrainingLogger - INFO - Step 9670, Batch metrics: Loss: 7.1234, Accuracy: 0.1006, Perplexity: 1240.6133
2024-12-31 17:36:00,085 - TrainingLogger - INFO - Step 9680, Batch metrics: Loss: 7.6275, Accuracy: 0.0733, Perplexity: 2054.0098
2024-12-31 17:36:06,953 - TrainingLogger - INFO - Step 9690, Batch metrics: Loss: 7.1377, Accuracy: 0.0788, Perplexity: 1258.4843
2024-12-31 17:36:14,269 - TrainingLogger - INFO - Step 9700, Batch metrics: Loss: 7.2351, Accuracy: 0.0500, Perplexity: 1387.2707
2024-12-31 17:36:14,270 - TrainingLogger - INFO - Step 9700, Prediction vs Actual:
2024-12-31 17:36:14,270 - TrainingLogger - INFO - Input 1: ההפרדה גם לא מניבה ולעולם לא תניב את התוצאות היעילות כמובטח
2024-12-31 17:36:14,270 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:36:14,270 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הה          | ✗     |
|     1 | י               | פרד          | ✗     |
|     2 | ▁שלנו           | ה            | ✗     |
|     3 | ▁שלנו           | ▁גם          | ✗     |
|     4 | ▁כן             | ▁לא          | ✗     |
|     5 | ▁משנה           | ▁מניב        | ✗     |
|     6 | ה               | ה            | ✓     |
|     7 | ▁את             | ▁ולעולם      | ✗     |
|     8 | ▁לא             | ▁לא          | ✓     |
|     9 | .               | ▁תני         | ✗     |
|    10 | ▁לי             | ב            | ✗     |
|    11 | ▁את             | ▁את          | ✓     |
|    12 | ▁זה             | ▁התוצאות     | ✗     |
|    13 | .               | ▁ה           | ✗     |
|    14 | הן              | יעילות       | ✗     |
|    15 | ▁של             | ▁כמו         | ✗     |
|    16 | ▁שלך            | בטח          | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ות              | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁שלך            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁גם             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 17:36:14,270 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:36:14,275 - TrainingLogger - INFO - Gradient norm: 9.2481
2024-12-31 17:36:21,578 - TrainingLogger - INFO - Step 9710, Batch metrics: Loss: 7.0339, Accuracy: 0.0608, Perplexity: 1134.4190
2024-12-31 17:36:28,299 - TrainingLogger - INFO - Step 9720, Batch metrics: Loss: 7.5575, Accuracy: 0.0483, Perplexity: 1914.9713
2024-12-31 17:36:35,047 - TrainingLogger - INFO - Step 9730, Batch metrics: Loss: 7.3927, Accuracy: 0.0741, Perplexity: 1624.1521
2024-12-31 17:36:41,822 - TrainingLogger - INFO - Step 9740, Batch metrics: Loss: 7.0301, Accuracy: 0.0950, Perplexity: 1130.1688
2024-12-31 17:36:48,755 - TrainingLogger - INFO - Step 9750, Batch metrics: Loss: 6.4472, Accuracy: 0.0825, Perplexity: 630.9129
2024-12-31 17:36:56,293 - TrainingLogger - INFO - Step 9760, Batch metrics: Loss: 7.9526, Accuracy: 0.0405, Perplexity: 2843.0126
2024-12-31 17:37:03,371 - TrainingLogger - INFO - Step 9770, Batch metrics: Loss: 7.3599, Accuracy: 0.0741, Perplexity: 1571.7116
2024-12-31 17:37:10,839 - TrainingLogger - INFO - Step 9780, Batch metrics: Loss: 7.5206, Accuracy: 0.0778, Perplexity: 1845.7471
2024-12-31 17:37:18,074 - TrainingLogger - INFO - Step 9790, Batch metrics: Loss: 7.6409, Accuracy: 0.0731, Perplexity: 2081.5631
2024-12-31 17:37:25,597 - TrainingLogger - INFO - Step 9800, Batch metrics: Loss: 7.5796, Accuracy: 0.0414, Perplexity: 1957.8323
2024-12-31 17:37:25,597 - TrainingLogger - INFO - Step 9800, Prediction vs Actual:
2024-12-31 17:37:25,597 - TrainingLogger - INFO - Input 1: זה יהיה אסון אם המחלוקות ישכיחו זאת
2024-12-31 17:37:25,598 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:37:25,598 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זה          | ✗     |
|     1 | </s>            | ▁יהיה        | ✗     |
|     2 | ▁טוב            | ▁אסון        | ✗     |
|     3 | ▁גדול           | ▁אם          | ✗     |
|     4 | ▁זה             | ▁ה           | ✗     |
|     5 | פרלמנט          | מחלוקות      | ✗     |
|     6 | ▁שלנו           | ▁יש          | ✗     |
|     7 | ▁לי             | כי           | ✗     |
|     8 | </s>            | חו           | ✗     |
|     9 | </s>            | ▁זאת         | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | </s>            | <pad>        | ✗     |
|    52 | </s>            |              | ✗     |

2024-12-31 17:37:25,598 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:37:25,603 - TrainingLogger - INFO - Gradient norm: 8.8291
2024-12-31 17:37:32,774 - TrainingLogger - INFO - Step 9810, Batch metrics: Loss: 7.7258, Accuracy: 0.0761, Perplexity: 2266.0183
2024-12-31 17:37:40,131 - TrainingLogger - INFO - Step 9820, Batch metrics: Loss: 7.7396, Accuracy: 0.0583, Perplexity: 2297.5021
2024-12-31 17:37:49,259 - TrainingLogger - INFO - Step 9830, Batch metrics: Loss: 7.4033, Accuracy: 0.1033, Perplexity: 1641.3566
2024-12-31 17:37:56,206 - TrainingLogger - INFO - Step 9840, Batch metrics: Loss: 6.8979, Accuracy: 0.0902, Perplexity: 990.2414
2024-12-31 17:38:03,784 - TrainingLogger - INFO - Step 9850, Batch metrics: Loss: 7.2415, Accuracy: 0.0830, Perplexity: 1396.1639
2024-12-31 17:38:09,983 - TrainingLogger - INFO - Step 9860, Batch metrics: Loss: 7.3018, Accuracy: 0.0850, Perplexity: 1482.9022
2024-12-31 17:38:16,799 - TrainingLogger - INFO - Step 9870, Batch metrics: Loss: 7.6701, Accuracy: 0.0763, Perplexity: 2143.2880
2024-12-31 17:38:24,165 - TrainingLogger - INFO - Step 9880, Batch metrics: Loss: 7.1588, Accuracy: 0.0811, Perplexity: 1285.3297
2024-12-31 17:38:31,380 - TrainingLogger - INFO - Step 9890, Batch metrics: Loss: 7.0509, Accuracy: 0.0526, Perplexity: 1153.8858
2024-12-31 17:38:38,269 - TrainingLogger - INFO - Step 9900, Batch metrics: Loss: 7.5642, Accuracy: 0.0485, Perplexity: 1927.9689
2024-12-31 17:38:38,270 - TrainingLogger - INFO - Step 9900, Prediction vs Actual:
2024-12-31 17:38:38,303 - TrainingLogger - INFO - Input 1: הוא נותן אופק לבעלי העסקים, לאירועי הספורט, אולמות התרבות
2024-12-31 17:38:38,304 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:38:38,304 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הוא         | ✗     |
|     1 | ▁הוא            | ▁נותן        | ✗     |
|     2 | ▁לו             | ▁או          | ✗     |
|     3 | ▁שהוא           | פק           | ✗     |
|     4 | </s>            | ▁לבעלי       | ✗     |
|     5 | ▁חיים           | ▁העסקים      | ✗     |
|     6 | ▁שלו            | ,            | ✗     |
|     7 | </s>            | ▁לאירוע      | ✗     |
|     8 | ים              | י            | ✗     |
|     9 | ▁עבודה          | ▁הספורט      | ✗     |
|    10 | ▁שלו            | ,            | ✗     |
|    11 | </s>            | ▁או          | ✗     |
|    12 | ▁יותר           | למות         | ✗     |
|    13 | </s>            | ▁התרבות      | ✗     |
|    14 | ▁שלהם           | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | י               | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | ות              | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 17:38:38,304 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:38:38,309 - TrainingLogger - INFO - Gradient norm: 7.2541
2024-12-31 17:38:45,521 - TrainingLogger - INFO - Step 9910, Batch metrics: Loss: 7.7079, Accuracy: 0.0423, Perplexity: 2225.8950
2024-12-31 17:38:52,646 - TrainingLogger - INFO - Step 9920, Batch metrics: Loss: 7.5717, Accuracy: 0.0733, Perplexity: 1942.3842
2024-12-31 17:39:00,072 - TrainingLogger - INFO - Step 9930, Batch metrics: Loss: 8.0916, Accuracy: 0.0584, Perplexity: 3266.9679
2024-12-31 17:39:07,191 - TrainingLogger - INFO - Step 9940, Batch metrics: Loss: 7.5398, Accuracy: 0.0479, Perplexity: 1881.4720
2024-12-31 17:39:14,427 - TrainingLogger - INFO - Step 9950, Batch metrics: Loss: 7.3420, Accuracy: 0.0884, Perplexity: 1543.8128
2024-12-31 17:39:21,323 - TrainingLogger - INFO - Step 9960, Batch metrics: Loss: 7.4250, Accuracy: 0.0473, Perplexity: 1677.4631
2024-12-31 17:39:28,654 - TrainingLogger - INFO - Step 9970, Batch metrics: Loss: 8.1357, Accuracy: 0.0387, Perplexity: 3414.2743
2024-12-31 17:39:35,802 - TrainingLogger - INFO - Step 9980, Batch metrics: Loss: 7.1035, Accuracy: 0.1000, Perplexity: 1216.1873
2024-12-31 17:39:42,950 - TrainingLogger - INFO - Step 9990, Batch metrics: Loss: 7.6388, Accuracy: 0.0833, Perplexity: 2077.1578
2024-12-31 17:39:50,055 - TrainingLogger - INFO - Step 10000, Batch metrics: Loss: 7.0855, Accuracy: 0.1029, Perplexity: 1194.5440
2024-12-31 17:39:50,056 - TrainingLogger - INFO - Step 10000, Prediction vs Actual:
2024-12-31 17:39:50,056 - TrainingLogger - INFO - Input 1: ביום העשורא הם פוגעים בגופם עם סכינים, חרבות ושלשלאות - כדי להכות על חטא שלא יכלו להציל את חוסיין
2024-12-31 17:39:50,056 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:39:50,056 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ביום        | ✗     |
|     1 | ▁-              | ▁ה           | ✗     |
|     2 | ▁-              | עשו          | ✗     |
|     3 | ▁-              | רא           | ✗     |
|     4 | ▁-              | ▁הם          | ✗     |
|     5 | ▁לא             | ▁פוגעים      | ✗     |
|     6 | ▁בי             | ▁ב           | ✗     |
|     7 | אנשי            | גופם         | ✗     |
|     8 | .               | ▁עם          | ✗     |
|     9 | ▁כל             | ▁סכינים      | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | <pad>           | ▁חרבות       | ✗     |
|    12 | ,               | ▁ו           | ✗     |
|    13 | נו              | שלשלאות      | ✗     |
|    14 | ,               | ▁-           | ✗     |
|    15 | -               | ▁כדי         | ✗     |
|    16 | ▁לקבל           | ▁להכות       | ✗     |
|    17 | ▁את             | ▁על          | ✗     |
|    18 | ▁הקרקע          | ▁חטא         | ✗     |
|    19 | .               | ▁שלא         | ✗     |
|    20 | ▁ניתן           | ▁יכלו        | ✗     |
|    21 | ▁להתקיים        | ▁להציל       | ✗     |
|    22 | ▁את             | ▁את          | ✓     |
|    23 | ▁כולם           | ▁            | ✗     |
|    24 | פקיסטן          | חוס          | ✗     |
|    25 | נם              | יין          | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            |              | ✗     |

2024-12-31 17:39:50,056 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:39:50,061 - TrainingLogger - INFO - Gradient norm: 13.8505
2024-12-31 17:39:57,040 - TrainingLogger - INFO - Step 10010, Batch metrics: Loss: 7.3507, Accuracy: 0.0769, Perplexity: 1557.3470
2024-12-31 17:40:04,388 - TrainingLogger - INFO - Step 10020, Batch metrics: Loss: 6.8051, Accuracy: 0.0904, Perplexity: 902.4375
2024-12-31 17:40:11,595 - TrainingLogger - INFO - Step 10030, Batch metrics: Loss: 7.2833, Accuracy: 0.0829, Perplexity: 1455.8021
2024-12-31 17:40:18,539 - TrainingLogger - INFO - Step 10040, Batch metrics: Loss: 8.1001, Accuracy: 0.0616, Perplexity: 3294.9532
2024-12-31 17:40:25,718 - TrainingLogger - INFO - Step 10050, Batch metrics: Loss: 7.3347, Accuracy: 0.0611, Perplexity: 1532.4972
2024-12-31 17:40:30,069 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 236544
2024-12-31 17:40:30,070 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 236544

2024-12-31 17:40:30,070 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 33]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 33]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 48]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 48]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 17:40:30,071 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 17:40:33,590 - TrainingLogger - INFO - Step 10060, Batch metrics: Loss: 7.3583, Accuracy: 0.0667, Perplexity: 1569.2209
2024-12-31 17:40:40,816 - TrainingLogger - INFO - Step 10070, Batch metrics: Loss: 7.4912, Accuracy: 0.0513, Perplexity: 1792.1159
2024-12-31 17:40:48,744 - TrainingLogger - INFO - Step 10080, Batch metrics: Loss: 6.9714, Accuracy: 0.1193, Perplexity: 1065.6845
2024-12-31 17:40:56,362 - TrainingLogger - INFO - Step 10090, Batch metrics: Loss: 8.0335, Accuracy: 0.0647, Perplexity: 3082.5901
2024-12-31 17:41:03,855 - TrainingLogger - INFO - Step 10100, Batch metrics: Loss: 7.5999, Accuracy: 0.0976, Perplexity: 1997.9013
2024-12-31 17:41:03,855 - TrainingLogger - INFO - Step 10100, Prediction vs Actual:
2024-12-31 17:41:03,855 - TrainingLogger - INFO - Input 1: הציבור צריך להקשיב לנו כי אנחנו אחראים, אף אחד לא יודע את המצב מבחוץ, אמר ליצמן
2024-12-31 17:41:03,856 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:41:03,856 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הציבור      | ✗     |
|     1 | !               | ▁צריך        | ✗     |
|     2 | ▁לעשות          | ▁להקשיב      | ✗     |
|     3 | ▁לו             | ▁לנו         | ✗     |
|     4 | !               | ▁כי          | ✗     |
|     5 | ון              | ▁אנחנו       | ✗     |
|     6 | ▁צריכים         | ▁אחראים      | ✗     |
|     7 | ▁לו             | ,            | ✗     |
|     8 | <pad>           | ▁אף          | ✗     |
|     9 | ▁אחד            | ▁אחד         | ✓     |
|    10 | ▁לא             | ▁לא          | ✓     |
|    11 | ▁יודע           | ▁יודע        | ✓     |
|    12 | ▁מה             | ▁את          | ✗     |
|    13 | ▁זה             | ▁המצב        | ✗     |
|    14 | .               | ▁מבחוץ       | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁אמר         | ✗     |
|    17 | ▁לי             | ▁לי          | ✓     |
|    18 | ▁מה             | צ            | ✗     |
|    19 | '               | מן           | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁מה             | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁מה             | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 17:41:03,856 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:41:03,861 - TrainingLogger - INFO - Gradient norm: 12.5666
2024-12-31 17:41:10,848 - TrainingLogger - INFO - Step 10110, Batch metrics: Loss: 7.1413, Accuracy: 0.0495, Perplexity: 1263.1184
2024-12-31 17:41:18,099 - TrainingLogger - INFO - Step 10120, Batch metrics: Loss: 7.6090, Accuracy: 0.0608, Perplexity: 2016.2516
2024-12-31 17:41:25,260 - TrainingLogger - INFO - Step 10130, Batch metrics: Loss: 7.6816, Accuracy: 0.0588, Perplexity: 2167.9900
2024-12-31 17:41:32,739 - TrainingLogger - INFO - Step 10140, Batch metrics: Loss: 7.1532, Accuracy: 0.1053, Perplexity: 1278.2258
2024-12-31 17:41:40,124 - TrainingLogger - INFO - Step 10150, Batch metrics: Loss: 7.4656, Accuracy: 0.0783, Perplexity: 1746.9542
2024-12-31 17:41:47,217 - TrainingLogger - INFO - Step 10160, Batch metrics: Loss: 7.2830, Accuracy: 0.1161, Perplexity: 1455.3614
2024-12-31 17:41:54,729 - TrainingLogger - INFO - Step 10170, Batch metrics: Loss: 7.1943, Accuracy: 0.0821, Perplexity: 1331.7583
2024-12-31 17:42:01,882 - TrainingLogger - INFO - Step 10180, Batch metrics: Loss: 7.4010, Accuracy: 0.1058, Perplexity: 1637.6502
2024-12-31 17:42:08,517 - TrainingLogger - INFO - Step 10190, Batch metrics: Loss: 7.4414, Accuracy: 0.0569, Perplexity: 1705.1090
2024-12-31 17:42:15,365 - TrainingLogger - INFO - Step 10200, Batch metrics: Loss: 8.1531, Accuracy: 0.0697, Perplexity: 3474.2449
2024-12-31 17:42:15,366 - TrainingLogger - INFO - Step 10200, Prediction vs Actual:
2024-12-31 17:42:15,366 - TrainingLogger - INFO - Input 1: הביקורת מגיעה על כך שמדובר בממשלה גדולה ובזבזנית בשעה שהמצב במשק קשה ומספר המובטלים בישראל עשוי להגיע עד פסח למיליון בני אדם
2024-12-31 17:42:15,366 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:42:15,366 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הביקורת     | ✗     |
|     1 | ▁שלום           | ▁מגיעה       | ✗     |
|     2 | ▁הביתה          | ▁על          | ✗     |
|     3 | יות             | ▁כך          | ✗     |
|     4 | ▁               | ▁שמדובר      | ✗     |
|     5 | ▁ב              | ▁ב           | ✓     |
|     6 | ▁-              | ממש          | ✗     |
|     7 | לה              | לה           | ✓     |
|     8 | .               | ▁גדולה       | ✗     |
|     9 | .               | ▁ו           | ✗     |
|    10 | פת              | בזבז         | ✗     |
|    11 | נית             | נית          | ✓     |
|    12 | .               | ▁בשעה        | ✗     |
|    13 | ▁אחת            | ▁שהמצב       | ✗     |
|    14 | ▁הנוכחי         | ▁ב           | ✗     |
|    15 | שפל             | משק          | ✗     |
|    16 | ▁קשה            | ▁קשה         | ✓     |
|    17 | ▁יותר           | ▁ומספר       | ✗     |
|    18 | יים             | ▁המו         | ✗     |
|    19 | כות             | בטל          | ✗     |
|    20 | ים              | ים           | ✓     |
|    21 | .               | ▁בישראל      | ✗     |
|    22 | .               | ▁עשוי        | ✗     |
|    23 | ▁להשתנות        | ▁להגיע       | ✗     |
|    24 | ▁אליו           | ▁עד          | ✗     |
|    25 | ▁היום           | ▁פסח         | ✗     |
|    26 | ▁האחרון         | ▁למיליון     | ✗     |
|    27 | .               | ▁בני         | ✗     |
|    28 | ▁האדם           | ▁אדם         | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 17:42:15,366 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:42:15,371 - TrainingLogger - INFO - Gradient norm: 9.7063
2024-12-31 17:42:22,801 - TrainingLogger - INFO - Step 10210, Batch metrics: Loss: 7.2115, Accuracy: 0.1134, Perplexity: 1354.9091
2024-12-31 17:42:30,215 - TrainingLogger - INFO - Step 10220, Batch metrics: Loss: 7.6831, Accuracy: 0.0591, Perplexity: 2171.3151
2024-12-31 17:42:37,309 - TrainingLogger - INFO - Step 10230, Batch metrics: Loss: 7.3578, Accuracy: 0.0489, Perplexity: 1568.3105
2024-12-31 17:42:44,571 - TrainingLogger - INFO - Step 10240, Batch metrics: Loss: 7.2911, Accuracy: 0.0778, Perplexity: 1467.2068
2024-12-31 17:42:51,232 - TrainingLogger - INFO - Step 10250, Batch metrics: Loss: 7.7915, Accuracy: 0.0619, Perplexity: 2419.8238
2024-12-31 17:42:58,396 - TrainingLogger - INFO - Step 10260, Batch metrics: Loss: 7.4911, Accuracy: 0.0920, Perplexity: 1792.0211
2024-12-31 17:43:05,343 - TrainingLogger - INFO - Step 10270, Batch metrics: Loss: 7.5168, Accuracy: 0.0468, Perplexity: 1838.6836
2024-12-31 17:43:12,588 - TrainingLogger - INFO - Step 10280, Batch metrics: Loss: 7.5463, Accuracy: 0.0915, Perplexity: 1893.7987
2024-12-31 17:43:20,090 - TrainingLogger - INFO - Step 10290, Batch metrics: Loss: 7.5045, Accuracy: 0.1121, Perplexity: 1816.2332
2024-12-31 17:43:27,203 - TrainingLogger - INFO - Step 10300, Batch metrics: Loss: 7.5322, Accuracy: 0.0633, Perplexity: 1867.1961
2024-12-31 17:43:27,204 - TrainingLogger - INFO - Step 10300, Prediction vs Actual:
2024-12-31 17:43:27,204 - TrainingLogger - INFO - Input 1: עוד דרור דיין עורך הדין של האם, דרור דיין, אמר כי פרסום התמונה נועד להשפיל את הילד ולבזותו
2024-12-31 17:43:27,204 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:43:27,204 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הדין           | ▁עוד         | ✗     |
|     1 | ▁זה             | ▁דרור        | ✗     |
|     2 | ▁-              | ▁די          | ✗     |
|     3 | ▁-              | ין           | ✗     |
|     4 | !               | ▁עורך        | ✗     |
|     5 | ▁הדין           | ▁הדין        | ✓     |
|     6 | ▁שלי            | ▁של          | ✗     |
|     7 | ▁ג              | ▁האם         | ✗     |
|     8 | -               | ,            | ✗     |
|     9 | <pad>           | ▁דרור        | ✗     |
|    10 | ו               | ▁די          | ✗     |
|    11 | אז              | ין           | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | <pad>           | ▁אמר         | ✗     |
|    14 | ▁לך             | ▁כי          | ✗     |
|    15 | ▁הוא            | ▁פרסום       | ✗     |
|    16 | ,               | ▁התמונה      | ✗     |
|    17 | ▁היה            | ▁נועד        | ✗     |
|    18 | ה               | ▁להשפיל      | ✗     |
|    19 | ך               | ▁את          | ✗     |
|    20 | ▁עצמו           | ▁הילד        | ✗     |
|    21 | ▁הזה            | ▁ולב         | ✗     |
|    22 | ה               | זות          | ✗     |
|    23 | ו               | ו            | ✓     |
|    24 | ▁של             | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 17:43:27,204 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:43:27,209 - TrainingLogger - INFO - Gradient norm: 9.6981
2024-12-31 17:43:34,187 - TrainingLogger - INFO - Step 10310, Batch metrics: Loss: 7.9612, Accuracy: 0.0387, Perplexity: 2867.5933
2024-12-31 17:43:40,927 - TrainingLogger - INFO - Step 10320, Batch metrics: Loss: 6.9658, Accuracy: 0.1156, Perplexity: 1059.7314
2024-12-31 17:43:48,063 - TrainingLogger - INFO - Step 10330, Batch metrics: Loss: 7.3131, Accuracy: 0.0804, Perplexity: 1499.8521
2024-12-31 17:43:55,318 - TrainingLogger - INFO - Step 10340, Batch metrics: Loss: 6.6649, Accuracy: 0.1250, Perplexity: 784.3875
2024-12-31 17:44:02,325 - TrainingLogger - INFO - Step 10350, Batch metrics: Loss: 7.0265, Accuracy: 0.0788, Perplexity: 1126.1144
2024-12-31 17:44:09,050 - TrainingLogger - INFO - Step 10360, Batch metrics: Loss: 7.3930, Accuracy: 0.0651, Perplexity: 1624.6370
2024-12-31 17:44:16,237 - TrainingLogger - INFO - Step 10370, Batch metrics: Loss: 7.5214, Accuracy: 0.0989, Perplexity: 1847.1744
2024-12-31 17:44:23,009 - TrainingLogger - INFO - Step 10380, Batch metrics: Loss: 7.3114, Accuracy: 0.0718, Perplexity: 1497.3425
2024-12-31 17:44:30,004 - TrainingLogger - INFO - Step 10390, Batch metrics: Loss: 7.4412, Accuracy: 0.0718, Perplexity: 1704.8724
2024-12-31 17:44:37,006 - TrainingLogger - INFO - Step 10400, Batch metrics: Loss: 7.1644, Accuracy: 0.0938, Perplexity: 1292.6359
2024-12-31 17:44:37,007 - TrainingLogger - INFO - Step 10400, Prediction vs Actual:
2024-12-31 17:44:37,007 - TrainingLogger - INFO - Input 1: דר אדהנום גבריזוס הוסיף הקפידו לשמור על מרחק של זרוע זה מזה, מה שישמור עליכם במרחק של כמטר אחד מהשני
2024-12-31 17:44:37,007 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:44:37,007 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁בלבד           | ▁דר          | ✗     |
|     1 | ן               | ▁אד          | ✗     |
|     2 | ▁-              | ה            | ✗     |
|     3 | ▁-              | נו           | ✗     |
|     4 | ▁-              | ם            | ✗     |
|     5 | ▁-              | ▁ג           | ✗     |
|     6 | ▁-              | בריז         | ✗     |
|     7 | י               | וס           | ✗     |
|     8 | ▁-              | ▁הוסיף       | ✗     |
|     9 | ,               | ▁ה           | ✗     |
|    10 | אד              | קפיד         | ✗     |
|    11 | ▁-              | ו            | ✗     |
|    12 | ▁לך             | ▁לשמור       | ✗     |
|    13 | ▁-              | ▁על          | ✗     |
|    14 | ▁זה             | ▁מרחק        | ✗     |
|    15 | ▁גדול           | ▁של          | ✗     |
|    16 | ▁זמן            | ▁זרוע        | ✗     |
|    17 | י               | ▁זה          | ✗     |
|    18 | ▁לא             | ▁מזה         | ✗     |
|    19 | ,               | ,            | ✓     |
|    20 | <pad>           | ▁מה          | ✗     |
|    21 | ▁אתה            | ▁שיש         | ✗     |
|    22 | ▁לנו            | מור          | ✗     |
|    23 | ▁על             | ▁עליכם       | ✗     |
|    24 | ▁לעשות          | ▁במרחק       | ✗     |
|    25 | ▁גדול           | ▁של          | ✗     |
|    26 | ▁זמן            | ▁כ           | ✗     |
|    27 | ות              | מטר          | ✗     |
|    28 | ים              | ▁אחד         | ✗     |
|    29 | .               | ▁מה          | ✗     |
|    30 | אחרים           | שני          | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | <pad>           |              | ✗     |

2024-12-31 17:44:37,007 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:44:37,012 - TrainingLogger - INFO - Gradient norm: 10.4804
2024-12-31 17:44:44,049 - TrainingLogger - INFO - Step 10410, Batch metrics: Loss: 7.6209, Accuracy: 0.0773, Perplexity: 2040.4106
2024-12-31 17:44:51,309 - TrainingLogger - INFO - Step 10420, Batch metrics: Loss: 7.5786, Accuracy: 0.0705, Perplexity: 1955.8187
2024-12-31 17:44:58,692 - TrainingLogger - INFO - Step 10430, Batch metrics: Loss: 7.6185, Accuracy: 0.0516, Perplexity: 2035.4459
2024-12-31 17:45:05,734 - TrainingLogger - INFO - Step 10440, Batch metrics: Loss: 7.0359, Accuracy: 0.0859, Perplexity: 1136.7404
2024-12-31 17:45:12,628 - TrainingLogger - INFO - Step 10450, Batch metrics: Loss: 7.6104, Accuracy: 0.0970, Perplexity: 2018.9849
2024-12-31 17:45:19,737 - TrainingLogger - INFO - Step 10460, Batch metrics: Loss: 7.1180, Accuracy: 0.0601, Perplexity: 1233.9283
2024-12-31 17:45:26,775 - TrainingLogger - INFO - Step 10470, Batch metrics: Loss: 7.5266, Accuracy: 0.0922, Perplexity: 1856.8284
2024-12-31 17:45:33,978 - TrainingLogger - INFO - Step 10480, Batch metrics: Loss: 6.7688, Accuracy: 0.0952, Perplexity: 870.3087
2024-12-31 17:45:41,087 - TrainingLogger - INFO - Step 10490, Batch metrics: Loss: 7.0877, Accuracy: 0.1000, Perplexity: 1197.1379
2024-12-31 17:45:48,803 - TrainingLogger - INFO - Step 10500, Batch metrics: Loss: 7.5980, Accuracy: 0.0784, Perplexity: 1994.1142
2024-12-31 17:45:48,803 - TrainingLogger - INFO - Step 10500, Prediction vs Actual:
2024-12-31 17:45:48,803 - TrainingLogger - INFO - Input 1: אני זוכרת תגובה של סופרת שלא הכרתי, שממש התנפלה עליי בפייסבוק אחרי ששמעה במה הספר עוסק
2024-12-31 17:45:48,804 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:45:48,804 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | .               | ▁זוכרת       | ✗     |
|     2 | ▁את             | ▁תגובה       | ✗     |
|     3 | .               | ▁של          | ✗     |
|     4 | ▁פעם            | ▁סופרת       | ✗     |
|     5 | .               | ▁שלא         | ✗     |
|     6 | ▁הייתה          | ▁הכרתי       | ✗     |
|     7 | ▁מעולם          | ,            | ✗     |
|     8 | </s>            | ▁שממש        | ✗     |
|     9 | י               | ▁התנ         | ✗     |
|    10 | עה              | פלה          | ✗     |
|    11 | ▁על             | ▁עליי        | ✗     |
|    12 | .               | ▁ב           | ✗     |
|    13 | דין             | פייס         | ✗     |
|    14 | בוק             | בוק          | ✓     |
|    15 | .               | ▁אחרי        | ✗     |
|    16 | ▁זה             | ▁ששמע        | ✗     |
|    17 | ה               | ה            | ✓     |
|    18 | ▁את             | ▁במה         | ✗     |
|    19 | ומה             | ▁הספר        | ✗     |
|    20 | ▁שלי            | ▁עוסק        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 17:45:48,804 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:45:48,809 - TrainingLogger - INFO - Gradient norm: 10.2235
2024-12-31 17:45:55,801 - TrainingLogger - INFO - Step 10510, Batch metrics: Loss: 7.7565, Accuracy: 0.0909, Perplexity: 2336.6188
2024-12-31 17:46:02,617 - TrainingLogger - INFO - Step 10520, Batch metrics: Loss: 7.3186, Accuracy: 0.0625, Perplexity: 1508.1180
2024-12-31 17:46:09,415 - TrainingLogger - INFO - Step 10530, Batch metrics: Loss: 7.7417, Accuracy: 0.0495, Perplexity: 2302.2858
2024-12-31 17:46:16,476 - TrainingLogger - INFO - Step 10540, Batch metrics: Loss: 7.2601, Accuracy: 0.0667, Perplexity: 1422.4210
2024-12-31 17:46:23,426 - TrainingLogger - INFO - Step 10550, Batch metrics: Loss: 7.2072, Accuracy: 0.1053, Perplexity: 1349.0941
2024-12-31 17:46:30,616 - TrainingLogger - INFO - Step 10560, Batch metrics: Loss: 8.0280, Accuracy: 0.0949, Perplexity: 3065.7151
2024-12-31 17:46:37,111 - TrainingLogger - INFO - Step 10570, Batch metrics: Loss: 7.6897, Accuracy: 0.0677, Perplexity: 2185.6502
2024-12-31 17:46:44,235 - TrainingLogger - INFO - Step 10580, Batch metrics: Loss: 7.7718, Accuracy: 0.0400, Perplexity: 2372.7668
2024-12-31 17:46:51,376 - TrainingLogger - INFO - Step 10590, Batch metrics: Loss: 7.4594, Accuracy: 0.0710, Perplexity: 1736.0724
2024-12-31 17:46:58,196 - TrainingLogger - INFO - Step 10600, Batch metrics: Loss: 7.8967, Accuracy: 0.0473, Perplexity: 2688.5034
2024-12-31 17:46:58,196 - TrainingLogger - INFO - Step 10600, Prediction vs Actual:
2024-12-31 17:46:58,196 - TrainingLogger - INFO - Input 1: מי שלא עושה, לא נכשל
2024-12-31 17:46:58,197 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:46:58,197 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מי          | ✗     |
|     1 | ▁-              | ▁שלא         | ✗     |
|     2 | .               | ▁עושה        | ✗     |
|     3 | ▁את             | ,            | ✗     |
|     4 | <pad>           | ▁לא          | ✗     |
|     5 | ▁משנה           | ▁נכשל        | ✗     |
|     6 | .               | <pad>        | ✗     |
|     7 | </s>            | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁לא             | <pad>        | ✗     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ▁לא             | <pad>        | ✗     |
|    18 | ▁לא             | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | ▁לא             | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ▁לא             | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ,               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | ▁לא             | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           |              | ✗     |

2024-12-31 17:46:58,197 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:46:58,202 - TrainingLogger - INFO - Gradient norm: 10.7938
2024-12-31 17:47:05,137 - TrainingLogger - INFO - Step 10610, Batch metrics: Loss: 7.1197, Accuracy: 0.0602, Perplexity: 1236.1337
2024-12-31 17:47:12,238 - TrainingLogger - INFO - Step 10620, Batch metrics: Loss: 7.6635, Accuracy: 0.0523, Perplexity: 2129.2287
2024-12-31 17:47:19,901 - TrainingLogger - INFO - Step 10630, Batch metrics: Loss: 7.7756, Accuracy: 0.0819, Perplexity: 2381.6708
2024-12-31 17:47:27,260 - TrainingLogger - INFO - Step 10640, Batch metrics: Loss: 7.4410, Accuracy: 0.0680, Perplexity: 1704.4148
2024-12-31 17:47:34,784 - TrainingLogger - INFO - Step 10650, Batch metrics: Loss: 7.4278, Accuracy: 0.0594, Perplexity: 1682.1529
2024-12-31 17:47:41,972 - TrainingLogger - INFO - Step 10660, Batch metrics: Loss: 6.5220, Accuracy: 0.0995, Perplexity: 679.9530
2024-12-31 17:47:46,362 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 308224
2024-12-31 17:47:46,362 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 308224

2024-12-31 17:47:46,362 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 49]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 49]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 51]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 51]), device: cuda:0
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 17:47:46,364 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 17:47:49,592 - TrainingLogger - INFO - Step 10670, Batch metrics: Loss: 7.1317, Accuracy: 0.1377, Perplexity: 1251.0192
2024-12-31 17:47:56,607 - TrainingLogger - INFO - Step 10680, Batch metrics: Loss: 7.8741, Accuracy: 0.0410, Perplexity: 2628.2964
2024-12-31 17:48:03,990 - TrainingLogger - INFO - Step 10690, Batch metrics: Loss: 7.3363, Accuracy: 0.0735, Perplexity: 1535.0087
2024-12-31 17:48:10,746 - TrainingLogger - INFO - Step 10700, Batch metrics: Loss: 7.5158, Accuracy: 0.0667, Perplexity: 1836.9047
2024-12-31 17:48:10,747 - TrainingLogger - INFO - Step 10700, Prediction vs Actual:
2024-12-31 17:48:10,747 - TrainingLogger - INFO - Input 1: גורם מדיני בכיר אמר כי יש מבוי סתום ומנסים לצאת ממנו
2024-12-31 17:48:10,747 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:48:10,747 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | י               | ▁גורם        | ✗     |
|     1 | ▁ל              | ▁מדי         | ✗     |
|     2 | .               | ני           | ✗     |
|     3 | .               | ▁בכיר        | ✗     |
|     4 | ה               | ▁אמר         | ✗     |
|     5 | ▁שהוא           | ▁כי          | ✗     |
|     6 | ▁הוא            | ▁יש          | ✗     |
|     7 | ▁לו             | ▁מבוי        | ✗     |
|     8 | ים              | ▁סתום        | ✗     |
|     9 | .               | ▁ו           | ✗     |
|    10 | פס              | מנסים        | ✗     |
|    11 | ▁לה             | ▁לצאת        | ✗     |
|    12 | ▁החוצה          | ▁ממנו        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | .               |              | ✗     |

2024-12-31 17:48:10,747 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:48:10,752 - TrainingLogger - INFO - Gradient norm: 8.1788
2024-12-31 17:48:18,242 - TrainingLogger - INFO - Step 10710, Batch metrics: Loss: 7.7796, Accuracy: 0.0914, Perplexity: 2391.2694
2024-12-31 17:48:25,360 - TrainingLogger - INFO - Step 10720, Batch metrics: Loss: 7.6089, Accuracy: 0.0895, Perplexity: 2015.9815
2024-12-31 17:48:32,606 - TrainingLogger - INFO - Step 10730, Batch metrics: Loss: 6.7085, Accuracy: 0.1111, Perplexity: 819.3156
2024-12-31 17:48:39,911 - TrainingLogger - INFO - Step 10740, Batch metrics: Loss: 7.7087, Accuracy: 0.0361, Perplexity: 2227.7394
2024-12-31 17:48:46,703 - TrainingLogger - INFO - Step 10750, Batch metrics: Loss: 7.4136, Accuracy: 0.1073, Perplexity: 1658.4332
2024-12-31 17:48:53,366 - TrainingLogger - INFO - Step 10760, Batch metrics: Loss: 7.5313, Accuracy: 0.0943, Perplexity: 1865.4705
2024-12-31 17:49:00,604 - TrainingLogger - INFO - Step 10770, Batch metrics: Loss: 7.6905, Accuracy: 0.0578, Perplexity: 2187.3977
2024-12-31 17:49:07,838 - TrainingLogger - INFO - Step 10780, Batch metrics: Loss: 7.4206, Accuracy: 0.0769, Perplexity: 1670.0901
2024-12-31 17:49:14,805 - TrainingLogger - INFO - Step 10790, Batch metrics: Loss: 7.4915, Accuracy: 0.0753, Perplexity: 1792.7031
2024-12-31 17:49:22,227 - TrainingLogger - INFO - Step 10800, Batch metrics: Loss: 7.2082, Accuracy: 0.0932, Perplexity: 1350.4322
2024-12-31 17:49:22,227 - TrainingLogger - INFO - Step 10800, Prediction vs Actual:
2024-12-31 17:49:22,227 - TrainingLogger - INFO - Input 1: יהיה צורך לקצץ בתקציב הישיבות, לשנות את חוק הגיוס, לבטל את חוק המרכולים ולעצור חקיקה דתית כדי להחזיר את ישראל להיות נורמלית
2024-12-31 17:49:22,227 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:49:22,227 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁יהיה        | ✗     |
|     1 | ▁בקרוב          | ▁צורך        | ✗     |
|     2 | .               | ▁ל           | ✗     |
|     3 | H               | קצץ          | ✗     |
|     4 | .               | ▁ב           | ✗     |
|     5 | .               | תקציב        | ✗     |
|     6 | .               | ▁הישיבות     | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | <pad>           | ▁לשנות       | ✗     |
|     9 | ▁את             | ▁את          | ✓     |
|    10 | ▁המצב           | ▁חוק         | ✗     |
|    11 | .               | ▁הגיוס       | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁לבטל        | ✗     |
|    14 | ה               | ▁את          | ✗     |
|    15 | ▁ה              | ▁חוק         | ✗     |
|    16 | ות              | ▁המר         | ✗     |
|    17 | טש              | כול          | ✗     |
|    18 | ,               | ים           | ✗     |
|    19 | .               | ▁ו           | ✗     |
|    20 | ההת             | לעצור        | ✗     |
|    21 | ▁את             | ▁חק          | ✗     |
|    22 | יקה             | יקה          | ✓     |
|    23 | .               | ▁דתית        | ✗     |
|    24 | .               | ▁כדי         | ✗     |
|    25 | ▁לקבל           | ▁להחזיר      | ✗     |
|    26 | ▁את             | ▁את          | ✓     |
|    27 | ▁עצמו           | ▁ישראל       | ✗     |
|    28 | .               | ▁להיות       | ✗     |
|    29 | ▁מאושרים        | ▁נורמלית     | ✗     |
|    30 | .               |              | ✗     |

2024-12-31 17:49:22,228 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:49:22,232 - TrainingLogger - INFO - Gradient norm: 9.7805
2024-12-31 17:49:29,183 - TrainingLogger - INFO - Step 10810, Batch metrics: Loss: 7.3449, Accuracy: 0.0734, Perplexity: 1548.2198
2024-12-31 17:49:35,816 - TrainingLogger - INFO - Step 10820, Batch metrics: Loss: 7.9387, Accuracy: 0.0342, Perplexity: 2803.6270
2024-12-31 17:49:43,152 - TrainingLogger - INFO - Step 10830, Batch metrics: Loss: 7.0418, Accuracy: 0.0951, Perplexity: 1143.4303
2024-12-31 17:49:50,317 - TrainingLogger - INFO - Step 10840, Batch metrics: Loss: 7.2626, Accuracy: 0.0865, Perplexity: 1426.0258
2024-12-31 17:49:56,851 - TrainingLogger - INFO - Step 10850, Batch metrics: Loss: 7.4354, Accuracy: 0.0794, Perplexity: 1695.0180
2024-12-31 17:50:03,184 - TrainingLogger - INFO - Step 10860, Batch metrics: Loss: 8.1712, Accuracy: 0.0583, Perplexity: 3537.4745
2024-12-31 17:50:10,356 - TrainingLogger - INFO - Step 10870, Batch metrics: Loss: 7.2490, Accuracy: 0.0747, Perplexity: 1406.6640
2024-12-31 17:50:16,964 - TrainingLogger - INFO - Step 10880, Batch metrics: Loss: 7.6373, Accuracy: 0.0812, Perplexity: 2074.1707
2024-12-31 17:50:24,383 - TrainingLogger - INFO - Step 10890, Batch metrics: Loss: 6.8281, Accuracy: 0.0863, Perplexity: 923.4084
2024-12-31 17:50:32,233 - TrainingLogger - INFO - Step 10900, Batch metrics: Loss: 7.2938, Accuracy: 0.0879, Perplexity: 1471.1741
2024-12-31 17:50:32,234 - TrainingLogger - INFO - Step 10900, Prediction vs Actual:
2024-12-31 17:50:32,267 - TrainingLogger - INFO - Input 1: כולם נותנים יד ומשתדלים לתת הקלות על מנת שנצליח למצב את ירוחם כמוקד לפעילות מעניינת זו
2024-12-31 17:50:32,268 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:50:32,268 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ב               | ▁כולם        | ✗     |
|     1 | .               | ▁נותנים      | ✗     |
|     2 | ▁את             | ▁יד          | ✗     |
|     3 | .               | ▁ומ          | ✗     |
|     4 | שחרר            | שתדל         | ✗     |
|     5 | ים              | ים           | ✓     |
|     6 | .               | ▁לתת         | ✗     |
|     7 | ▁את             | ▁הקל         | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | .               | ▁על          | ✗     |
|    10 | ▁פני            | ▁מנת         | ✗     |
|    11 | ▁לקבל           | ▁שנצליח      | ✗     |
|    12 | .               | ▁למצב        | ✗     |
|    13 | ▁את             | ▁את          | ✓     |
|    14 | ▁זה             | ▁ירו         | ✗     |
|    15 | ד               | חם           | ✗     |
|    16 | .               | ▁כ           | ✗     |
|    17 | צוות            | מוקד         | ✗     |
|    18 | </s>            | ▁לפעילות     | ✗     |
|    19 | ▁זו             | ▁מעניינת     | ✗     |
|    20 | .               | ▁זו          | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ▁היא            | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | .               | <pad>        | ✗     |
|    49 | <pad>           | <pad>        | ✓     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | </s>            |              | ✗     |

2024-12-31 17:50:32,268 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:50:32,273 - TrainingLogger - INFO - Gradient norm: 10.2902
2024-12-31 17:50:40,040 - TrainingLogger - INFO - Step 10910, Batch metrics: Loss: 7.6610, Accuracy: 0.0631, Perplexity: 2123.9740
2024-12-31 17:50:47,406 - TrainingLogger - INFO - Step 10920, Batch metrics: Loss: 7.4864, Accuracy: 0.0680, Perplexity: 1783.6827
2024-12-31 17:50:54,374 - TrainingLogger - INFO - Step 10930, Batch metrics: Loss: 7.2879, Accuracy: 0.0862, Perplexity: 1462.5450
2024-12-31 17:51:01,435 - TrainingLogger - INFO - Step 10940, Batch metrics: Loss: 7.0603, Accuracy: 0.1301, Perplexity: 1164.7627
2024-12-31 17:51:08,660 - TrainingLogger - INFO - Step 10950, Batch metrics: Loss: 7.5995, Accuracy: 0.0925, Perplexity: 1997.1069
2024-12-31 17:51:16,162 - TrainingLogger - INFO - Step 10960, Batch metrics: Loss: 7.4578, Accuracy: 0.0578, Perplexity: 1733.3229
2024-12-31 17:51:23,729 - TrainingLogger - INFO - Step 10970, Batch metrics: Loss: 7.2847, Accuracy: 0.1011, Perplexity: 1457.8889
2024-12-31 17:51:30,666 - TrainingLogger - INFO - Step 10980, Batch metrics: Loss: 7.0698, Accuracy: 0.0966, Perplexity: 1175.8998
2024-12-31 17:51:37,312 - TrainingLogger - INFO - Step 10990, Batch metrics: Loss: 7.4118, Accuracy: 0.0455, Perplexity: 1655.4577
2024-12-31 17:51:44,316 - TrainingLogger - INFO - Step 11000, Batch metrics: Loss: 7.6247, Accuracy: 0.0974, Perplexity: 2048.1485
2024-12-31 17:51:44,316 - TrainingLogger - INFO - Step 11000, Prediction vs Actual:
2024-12-31 17:51:44,316 - TrainingLogger - INFO - Input 1: -אתם הובלת למערכת בחירות נוספת
2024-12-31 17:51:44,317 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:51:44,317 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁-           | ✗     |
|     1 | ▁דם             | אתם          | ✗     |
|     2 | !               | ▁הובלת       | ✗     |
|     3 | ם               | ▁למערכת      | ✗     |
|     4 | ▁יחסים          | ▁בחירות      | ✗     |
|     5 | .               | ▁נוספת       | ✗     |
|     6 | .               | <pad>        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | ▁את             | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ...             | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ▁את             | <pad>        | ✗     |
|    35 | ▁את             | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ▁זה             | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | .               |              | ✗     |

2024-12-31 17:51:44,317 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:51:44,322 - TrainingLogger - INFO - Gradient norm: 9.7618
2024-12-31 17:51:51,139 - TrainingLogger - INFO - Step 11010, Batch metrics: Loss: 7.5358, Accuracy: 0.0497, Perplexity: 1873.9313
2024-12-31 17:51:57,882 - TrainingLogger - INFO - Step 11020, Batch metrics: Loss: 7.2392, Accuracy: 0.0930, Perplexity: 1393.0178
2024-12-31 17:52:04,886 - TrainingLogger - INFO - Step 11030, Batch metrics: Loss: 7.5833, Accuracy: 0.0612, Perplexity: 1965.0293
2024-12-31 17:52:11,940 - TrainingLogger - INFO - Step 11040, Batch metrics: Loss: 7.0049, Accuracy: 0.0764, Perplexity: 1102.0198
2024-12-31 17:52:19,529 - TrainingLogger - INFO - Step 11050, Batch metrics: Loss: 7.1549, Accuracy: 0.0851, Perplexity: 1280.4127
2024-12-31 17:52:26,675 - TrainingLogger - INFO - Step 11060, Batch metrics: Loss: 7.1581, Accuracy: 0.1031, Perplexity: 1284.4824
2024-12-31 17:52:33,748 - TrainingLogger - INFO - Step 11070, Batch metrics: Loss: 7.4923, Accuracy: 0.0814, Perplexity: 1794.1903
2024-12-31 17:52:41,364 - TrainingLogger - INFO - Step 11080, Batch metrics: Loss: 7.4697, Accuracy: 0.0783, Perplexity: 1754.1604
2024-12-31 17:52:48,911 - TrainingLogger - INFO - Step 11090, Batch metrics: Loss: 8.0362, Accuracy: 0.0491, Perplexity: 3090.9858
2024-12-31 17:52:55,527 - TrainingLogger - INFO - Step 11100, Batch metrics: Loss: 7.5684, Accuracy: 0.0691, Perplexity: 1936.1286
2024-12-31 17:52:55,528 - TrainingLogger - INFO - Step 11100, Prediction vs Actual:
2024-12-31 17:52:55,528 - TrainingLogger - INFO - Input 1: כל מה שצריך לדעת על בחירות 2019 במקום אחד -מתחם הבחירות של ynet כאמור, לפני תחילת הנאום נתניהו ורעייתו שרה לחצו יד לגדעון סער
2024-12-31 17:52:55,528 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:52:55,528 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כל          | ✗     |
|     1 | ▁-              | ▁מה          | ✗     |
|     2 | ▁זה             | ▁שצריך       | ✗     |
|     3 | ▁-              | ▁לדעת        | ✗     |
|     4 | ▁זה             | ▁על          | ✗     |
|     5 | ▁מה             | ▁בחירות      | ✗     |
|     6 | ▁חדשה           | ▁20          | ✗     |
|     7 | 10              | 19           | ✗     |
|     8 | 00              | ▁במקום       | ✗     |
|     9 | ▁זה             | ▁אחד         | ✗     |
|    10 | ▁מהם            | ▁-           | ✗     |
|    11 | <pad>           | מתח          | ✗     |
|    12 | ים              | ם            | ✗     |
|    13 | .               | ▁הבחירות     | ✗     |
|    14 | ▁שלהם           | ▁של          | ✗     |
|    15 | ▁הממשלה         | ▁y           | ✗     |
|    16 | ים              | net          | ✗     |
|    17 | ים              | ▁כאמור       | ✗     |
|    18 | ,               | ,            | ✓     |
|    19 | <pad>           | ▁לפני        | ✗     |
|    20 | ▁כן             | ▁תחילת       | ✗     |
|    21 | ▁המלחמה         | ▁הנאום       | ✗     |
|    22 | ,               | ▁נתנ         | ✗     |
|    23 | אל              | יהו          | ✗     |
|    24 | .               | ▁ורע         | ✗     |
|    25 | ה               | ייתו         | ✗     |
|    26 | ▁של             | ▁שרה         | ✗     |
|    27 | .               | ▁ל           | ✗     |
|    28 | פרלמנט          | חצו          | ✗     |
|    29 | ני              | ▁יד          | ✗     |
|    30 | ▁שנייה          | ▁לג          | ✗     |
|    31 | '               | דע           | ✗     |
|    32 | ם               | ון           | ✗     |
|    33 | .               | ▁סע          | ✗     |
|    34 | ר               | ר            | ✓     |
|    35 | .               |              | ✗     |

2024-12-31 17:52:55,528 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:52:55,533 - TrainingLogger - INFO - Gradient norm: 7.8448
2024-12-31 17:53:02,295 - TrainingLogger - INFO - Step 11110, Batch metrics: Loss: 7.5303, Accuracy: 0.0693, Perplexity: 1863.6372
2024-12-31 17:53:09,678 - TrainingLogger - INFO - Step 11120, Batch metrics: Loss: 7.3410, Accuracy: 0.0744, Perplexity: 1542.2206
2024-12-31 17:53:17,308 - TrainingLogger - INFO - Step 11130, Batch metrics: Loss: 7.7447, Accuracy: 0.0761, Perplexity: 2309.2179
2024-12-31 17:53:24,055 - TrainingLogger - INFO - Step 11140, Batch metrics: Loss: 7.0492, Accuracy: 0.0988, Perplexity: 1151.9902
2024-12-31 17:53:31,280 - TrainingLogger - INFO - Step 11150, Batch metrics: Loss: 7.2456, Accuracy: 0.0932, Perplexity: 1401.9686
2024-12-31 17:53:38,633 - TrainingLogger - INFO - Step 11160, Batch metrics: Loss: 7.3849, Accuracy: 0.0802, Perplexity: 1611.4822
2024-12-31 17:53:45,479 - TrainingLogger - INFO - Step 11170, Batch metrics: Loss: 7.4327, Accuracy: 0.0720, Perplexity: 1690.3504
2024-12-31 17:53:52,652 - TrainingLogger - INFO - Step 11180, Batch metrics: Loss: 7.4101, Accuracy: 0.0714, Perplexity: 1652.5616
2024-12-31 17:53:59,632 - TrainingLogger - INFO - Step 11190, Batch metrics: Loss: 7.5978, Accuracy: 0.0838, Perplexity: 1993.7063
2024-12-31 17:54:06,738 - TrainingLogger - INFO - Step 11200, Batch metrics: Loss: 7.0915, Accuracy: 0.0787, Perplexity: 1201.7569
2024-12-31 17:54:06,738 - TrainingLogger - INFO - Step 11200, Prediction vs Actual:
2024-12-31 17:54:06,738 - TrainingLogger - INFO - Input 1: לא נאפשר לרפורמה לעבור כפי שהוגשה
2024-12-31 17:54:06,738 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:54:06,738 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לא          | ✗     |
|     1 | ▁אני            | ▁נ           | ✗     |
|     2 | נה              | אפשר         | ✗     |
|     3 | ▁לא             | ▁לר          | ✗     |
|     4 | ▁לא             | פור          | ✗     |
|     5 | ▁-              | מה           | ✗     |
|     6 | .               | ▁לעבור       | ✗     |
|     7 | ▁את             | ▁כפי         | ✗     |
|     8 | לה              | ▁שהו         | ✗     |
|     9 | ה               | גש           | ✗     |
|    10 | ה               | ה            | ✓     |
|    11 | ▁לנו            | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ▁היום           | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁באופן          | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ▁זה             | <pad>        | ✗     |
|    31 | ▁לא             | <pad>        | ✗     |
|    32 | ▁לא             | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | .               | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | ה               |              | ✗     |

2024-12-31 17:54:06,739 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:54:06,743 - TrainingLogger - INFO - Gradient norm: 10.2873
2024-12-31 17:54:13,954 - TrainingLogger - INFO - Step 11210, Batch metrics: Loss: 7.6912, Accuracy: 0.0619, Perplexity: 2188.9137
2024-12-31 17:54:20,641 - TrainingLogger - INFO - Step 11220, Batch metrics: Loss: 7.2718, Accuracy: 0.0788, Perplexity: 1439.1126
2024-12-31 17:54:28,099 - TrainingLogger - INFO - Step 11230, Batch metrics: Loss: 7.2985, Accuracy: 0.0730, Perplexity: 1478.0108
2024-12-31 17:54:35,233 - TrainingLogger - INFO - Step 11240, Batch metrics: Loss: 7.6161, Accuracy: 0.0837, Perplexity: 2030.6182
2024-12-31 17:54:42,864 - TrainingLogger - INFO - Step 11250, Batch metrics: Loss: 7.3649, Accuracy: 0.0723, Perplexity: 1579.5426
2024-12-31 17:54:49,936 - TrainingLogger - INFO - Step 11260, Batch metrics: Loss: 7.2620, Accuracy: 0.0677, Perplexity: 1425.1577
2024-12-31 17:54:57,183 - TrainingLogger - INFO - Step 11270, Batch metrics: Loss: 7.3876, Accuracy: 0.0902, Perplexity: 1615.8026
2024-12-31 17:55:04,616 - TrainingLogger - INFO - Step 11280, Batch metrics: Loss: 7.2770, Accuracy: 0.0952, Perplexity: 1446.6870
2024-12-31 17:55:11,732 - TrainingLogger - INFO - Step 11290, Batch metrics: Loss: 7.4772, Accuracy: 0.0839, Perplexity: 1767.3656
2024-12-31 17:55:19,079 - TrainingLogger - INFO - Step 11300, Batch metrics: Loss: 7.2356, Accuracy: 0.0778, Perplexity: 1387.9767
2024-12-31 17:55:19,079 - TrainingLogger - INFO - Step 11300, Prediction vs Actual:
2024-12-31 17:55:19,079 - TrainingLogger - INFO - Input 1: -דוד ביטן? זאב אלקין? יריב לוין? לזכותי אני יכול לומר שאף אחד לא מעז להתקשר אליי ישירות כי הם יודעים את התשובה
2024-12-31 17:55:19,080 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:55:19,080 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁מצידי          | ▁-           | ✗     |
|     1 | </s>            | דוד          | ✗     |
|     2 | '               | ▁ב           | ✗     |
|     3 | '               | יטן          | ✗     |
|     4 | ,               | ?            | ✗     |
|     5 | </s>            | ▁זאב         | ✗     |
|     6 | ,               | ▁אל          | ✗     |
|     7 | "               | קין          | ✗     |
|     8 | ,               | ?            | ✗     |
|     9 | </s>            | ▁יריב        | ✗     |
|    10 | ה               | ▁לו          | ✗     |
|    11 | ב               | ין           | ✗     |
|    12 | .               | ?            | ✗     |
|    13 | ו               | ▁לזכות       | ✗     |
|    14 | ו               | י            | ✗     |
|    15 | .               | ▁אני         | ✗     |
|    16 | ▁לא             | ▁יכול        | ✗     |
|    17 | ▁לעשות          | ▁לומר        | ✗     |
|    18 | ▁לך             | ▁שאף         | ✗     |
|    19 | ▁אחד            | ▁אחד         | ✓     |
|    20 | ▁לא             | ▁לא          | ✓     |
|    21 | ▁ידע            | ▁מעז         | ✗     |
|    22 | ה               | ▁להתקשר      | ✗     |
|    23 | ▁למשטרה         | ▁אליי        | ✗     |
|    24 | ▁שוב            | ▁ישירות      | ✗     |
|    25 | ▁אליו           | ▁כי          | ✗     |
|    26 | ▁הוא            | ▁הם          | ✗     |
|    27 | ▁לא             | ▁יודעים      | ✗     |
|    28 | ▁שאני           | ▁את          | ✗     |
|    29 | ▁זה             | ▁התשובה      | ✗     |
|    30 | ▁שלי            | <pad>        | ✗     |
|    31 | ▁שלי            | <pad>        | ✗     |
|    32 | ▁שלי            | <pad>        | ✗     |
|    33 | ▁שלי            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁לשאלה          |              | ✗     |

2024-12-31 17:55:19,080 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:55:19,085 - TrainingLogger - INFO - Gradient norm: 11.3316
2024-12-31 17:55:26,479 - TrainingLogger - INFO - Step 11310, Batch metrics: Loss: 6.7913, Accuracy: 0.0636, Perplexity: 890.0290
2024-12-31 17:55:34,158 - TrainingLogger - INFO - Step 11320, Batch metrics: Loss: 7.4356, Accuracy: 0.0711, Perplexity: 1695.2136
2024-12-31 17:55:41,556 - TrainingLogger - INFO - Step 11330, Batch metrics: Loss: 7.4067, Accuracy: 0.0543, Perplexity: 1647.0038
2024-12-31 17:55:48,942 - TrainingLogger - INFO - Step 11340, Batch metrics: Loss: 7.3556, Accuracy: 0.0806, Perplexity: 1564.8825
2024-12-31 17:55:56,124 - TrainingLogger - INFO - Step 11350, Batch metrics: Loss: 7.6157, Accuracy: 0.0734, Perplexity: 2029.9047
2024-12-31 17:56:02,904 - TrainingLogger - INFO - Step 11360, Batch metrics: Loss: 7.3614, Accuracy: 0.0805, Perplexity: 1574.0509
2024-12-31 17:56:09,885 - TrainingLogger - INFO - Step 11370, Batch metrics: Loss: 7.6579, Accuracy: 0.0956, Perplexity: 2117.3192
2024-12-31 17:56:17,331 - TrainingLogger - INFO - Step 11380, Batch metrics: Loss: 7.1019, Accuracy: 0.0761, Perplexity: 1214.2866
2024-12-31 17:56:24,671 - TrainingLogger - INFO - Step 11390, Batch metrics: Loss: 7.6082, Accuracy: 0.0536, Perplexity: 2014.6400
2024-12-31 17:56:31,871 - TrainingLogger - INFO - Step 11400, Batch metrics: Loss: 7.8476, Accuracy: 0.0707, Perplexity: 2559.5448
2024-12-31 17:56:31,872 - TrainingLogger - INFO - Step 11400, Prediction vs Actual:
2024-12-31 17:56:31,872 - TrainingLogger - INFO - Input 1: חברי המשלחת הישראלית שהיו בדיון אמרו שהתפתלו לנוכח הדברים של נציגי המדינות אי-אפשר לשמוע את הצביעות של מדינות
2024-12-31 17:56:31,872 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:56:31,872 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | רה              | ▁חברי        | ✗     |
|     1 | ▁-              | ▁המשלחת      | ✗     |
|     2 | ▁-              | ▁הישראלי     | ✗     |
|     3 | ת               | ת            | ✓     |
|     4 | ▁של             | ▁שהיו        | ✗     |
|     5 | ▁לי             | ▁בדיון       | ✗     |
|     6 | ▁הזה            | ▁אמרו        | ✗     |
|     7 | ▁לי             | ▁שהת         | ✗     |
|     8 | ערב             | פת           | ✗     |
|     9 | ל               | לו           | ✗     |
|    10 | ▁ב              | ▁לנוכח       | ✗     |
|    11 | ות              | ▁הדברים      | ✗     |
|    12 | ▁האחרונים       | ▁של          | ✗     |
|    13 | ▁המדינה         | ▁נציג        | ✗     |
|    14 | ות              | י            | ✗     |
|    15 | ▁המדינה         | ▁המדינות     | ✗     |
|    16 | ▁שלנו           | ▁אי          | ✗     |
|    17 | ס               | -            | ✗     |
|    18 | ה               | אפשר         | ✗     |
|    19 | יים             | ▁לשמוע       | ✗     |
|    20 | .               | ▁את          | ✗     |
|    21 | ▁החדשות         | ▁הצביע       | ✗     |
|    22 | ות              | ות           | ✓     |
|    23 | ▁שלהם           | ▁של          | ✗     |
|    24 | ▁המדינה         | ▁מדינות      | ✗     |
|    25 | ▁אחרות          | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ה               |              | ✗     |

2024-12-31 17:56:31,872 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:56:31,877 - TrainingLogger - INFO - Gradient norm: 14.1017
2024-12-31 17:56:38,613 - TrainingLogger - INFO - Step 11410, Batch metrics: Loss: 7.6000, Accuracy: 0.0616, Perplexity: 1998.1519
2024-12-31 17:56:45,288 - TrainingLogger - INFO - Step 11420, Batch metrics: Loss: 7.3337, Accuracy: 0.0800, Perplexity: 1530.9678
2024-12-31 17:56:52,263 - TrainingLogger - INFO - Step 11430, Batch metrics: Loss: 7.3988, Accuracy: 0.0460, Perplexity: 1634.0487
2024-12-31 17:56:59,503 - TrainingLogger - INFO - Step 11440, Batch metrics: Loss: 7.2506, Accuracy: 0.0571, Perplexity: 1408.9746
2024-12-31 17:57:06,378 - TrainingLogger - INFO - Step 11450, Batch metrics: Loss: 7.5516, Accuracy: 0.1024, Perplexity: 1903.7173
2024-12-31 17:57:13,481 - TrainingLogger - INFO - Step 11460, Batch metrics: Loss: 7.5977, Accuracy: 0.0385, Perplexity: 1993.6683
2024-12-31 17:57:20,975 - TrainingLogger - INFO - Step 11470, Batch metrics: Loss: 7.1641, Accuracy: 0.0854, Perplexity: 1292.2279
2024-12-31 17:57:28,105 - TrainingLogger - INFO - Step 11480, Batch metrics: Loss: 7.8500, Accuracy: 0.0936, Perplexity: 2565.6276
2024-12-31 17:57:35,137 - TrainingLogger - INFO - Step 11490, Batch metrics: Loss: 7.5887, Accuracy: 0.0760, Perplexity: 1975.7327
2024-12-31 17:57:42,391 - TrainingLogger - INFO - Step 11500, Batch metrics: Loss: 7.2072, Accuracy: 0.0542, Perplexity: 1349.1327
2024-12-31 17:57:42,391 - TrainingLogger - INFO - Step 11500, Prediction vs Actual:
2024-12-31 17:57:42,391 - TrainingLogger - INFO - Input 1: מחר בערב הוא ייפגש בארבע עיניים עם בנט, בניסיון למנוע ממנו להקים ממשלה עם גוש השינוי
2024-12-31 17:57:42,392 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:57:42,392 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מחר         | ✗     |
|     1 | ▁בבוקר          | ▁בערב        | ✗     |
|     2 | ▁בבוקר          | ▁הוא         | ✗     |
|     3 | ▁אמר            | ▁יי          | ✗     |
|     4 | בחר             | פגש          | ✗     |
|     5 | ▁איתי           | ▁בארבע       | ✗     |
|     6 | ה               | ▁עיניים      | ✗     |
|     7 | .               | ▁עם          | ✗     |
|     8 | ▁כולם           | ▁בנט         | ✗     |
|     9 | .               | ,            | ✗     |
|    10 | </s>            | ▁בניסיון     | ✗     |
|    11 | ▁להרוג          | ▁למנוע       | ✗     |
|    12 | ▁את             | ▁ממנו        | ✗     |
|    13 | ▁לצאת           | ▁להקים       | ✗     |
|    14 | ▁את             | ▁ממשלה       | ✗     |
|    15 | ▁חדשה           | ▁עם          | ✗     |
|    16 | ▁אנשים          | ▁גוש         | ✗     |
|    17 | ים              | ▁השינוי      | ✗     |
|    18 | ▁שלו            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ה               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ים              | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2024-12-31 17:57:42,392 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:57:42,397 - TrainingLogger - INFO - Gradient norm: 9.1904
2024-12-31 17:57:49,937 - TrainingLogger - INFO - Step 11510, Batch metrics: Loss: 7.9541, Accuracy: 0.0402, Perplexity: 2847.3337
2024-12-31 17:57:57,313 - TrainingLogger - INFO - Step 11520, Batch metrics: Loss: 7.7761, Accuracy: 0.0764, Perplexity: 2382.9351
2024-12-31 17:58:04,277 - TrainingLogger - INFO - Step 11530, Batch metrics: Loss: 7.3559, Accuracy: 0.0705, Perplexity: 1565.3415
2024-12-31 17:58:11,496 - TrainingLogger - INFO - Step 11540, Batch metrics: Loss: 7.3790, Accuracy: 0.0909, Perplexity: 1602.0026
2024-12-31 17:58:19,117 - TrainingLogger - INFO - Step 11550, Batch metrics: Loss: 6.6783, Accuracy: 0.1000, Perplexity: 794.9869
2024-12-31 17:58:25,812 - TrainingLogger - INFO - Step 11560, Batch metrics: Loss: 7.4693, Accuracy: 0.0385, Perplexity: 1753.3217
2024-12-31 17:58:33,019 - TrainingLogger - INFO - Step 11570, Batch metrics: Loss: 7.4395, Accuracy: 0.0769, Perplexity: 1701.8404
2024-12-31 17:58:40,542 - TrainingLogger - INFO - Step 11580, Batch metrics: Loss: 7.5151, Accuracy: 0.0643, Perplexity: 1835.5834
2024-12-31 17:58:47,260 - TrainingLogger - INFO - Step 11590, Batch metrics: Loss: 7.2369, Accuracy: 0.0927, Perplexity: 1389.7569
2024-12-31 17:58:54,262 - TrainingLogger - INFO - Step 11600, Batch metrics: Loss: 7.5967, Accuracy: 0.0826, Perplexity: 1991.5694
2024-12-31 17:58:54,263 - TrainingLogger - INFO - Step 11600, Prediction vs Actual:
2024-12-31 17:58:54,263 - TrainingLogger - INFO - Input 1: אבי עבר ניתוח מעקפים בגיל 38, ואמי עברה ניתוח מעקפים בגיל 45
2024-12-31 17:58:54,263 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 17:58:54,263 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אבי         | ✗     |
|     1 | ▁אני            | ▁עבר         | ✗     |
|     2 | ▁קשה            | ▁ניתוח       | ✗     |
|     3 | ▁רפואי          | ▁מע          | ✗     |
|     4 | קפים            | קפים         | ✓     |
|     5 | .               | ▁בגיל        | ✗     |
|     6 | ▁שנתיים         | ▁38          | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | </s>            | ▁ואמי        | ✗     |
|     9 | ן               | ▁עברה        | ✗     |
|    10 | ▁את             | ▁ניתוח       | ✗     |
|    11 | ▁רפואי          | ▁מע          | ✗     |
|    12 | קפים            | קפים         | ✓     |
|    13 | .               | ▁בגיל        | ✗     |
|    14 | ו               | ▁45          | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               |              | ✗     |

2024-12-31 17:58:54,263 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 17:58:54,268 - TrainingLogger - INFO - Gradient norm: 9.5117
2024-12-31 17:59:01,450 - TrainingLogger - INFO - Step 11610, Batch metrics: Loss: 7.4380, Accuracy: 0.0974, Perplexity: 1699.4109
2024-12-31 17:59:08,386 - TrainingLogger - INFO - Step 11620, Batch metrics: Loss: 7.2369, Accuracy: 0.0549, Perplexity: 1389.7430
2024-12-31 17:59:15,490 - TrainingLogger - INFO - Step 11630, Batch metrics: Loss: 7.5215, Accuracy: 0.0659, Perplexity: 1847.3065
2024-12-31 17:59:22,740 - TrainingLogger - INFO - Step 11640, Batch metrics: Loss: 7.5856, Accuracy: 0.0634, Perplexity: 1969.6851
2024-12-31 17:59:29,645 - TrainingLogger - INFO - Step 11650, Batch metrics: Loss: 7.9797, Accuracy: 0.0675, Perplexity: 2920.9992
2024-12-31 17:59:36,750 - TrainingLogger - INFO - Step 11660, Batch metrics: Loss: 7.2085, Accuracy: 0.0598, Perplexity: 1350.8302
2024-12-31 17:59:44,206 - TrainingLogger - INFO - Step 11670, Batch metrics: Loss: 8.0122, Accuracy: 0.0449, Perplexity: 3017.5178
2024-12-31 17:59:51,240 - TrainingLogger - INFO - Step 11680, Batch metrics: Loss: 7.1727, Accuracy: 0.0995, Perplexity: 1303.3626
2024-12-31 17:59:58,773 - TrainingLogger - INFO - Step 11690, Batch metrics: Loss: 7.7750, Accuracy: 0.0515, Perplexity: 2380.3606
2024-12-31 18:00:05,865 - TrainingLogger - INFO - Step 11700, Batch metrics: Loss: 7.2238, Accuracy: 0.1000, Perplexity: 1371.6474
2024-12-31 18:00:05,866 - TrainingLogger - INFO - Step 11700, Prediction vs Actual:
2024-12-31 18:00:05,866 - TrainingLogger - INFO - Input 1: אנחנו נערכים עם דלקים ופחם, עם מוניות שנמצאות וערוכות, גנרטורים, עם תחנות משנה על מנת לתת מענה לאזרחים ולמתקנים האסטרטגיים
2024-12-31 18:00:05,866 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:00:05,866 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | </s>            | ▁נער         | ✗     |
|     2 | ▁את             | כים          | ✗     |
|     3 | </s>            | ▁עם          | ✗     |
|     4 | </s>            | ▁דלק         | ✗     |
|     5 | </s>            | ים           | ✗     |
|     6 | </s>            | ▁ופ          | ✗     |
|     7 | זור             | חם           | ✗     |
|     8 | </s>            | ,            | ✗     |
|     9 | </s>            | ▁עם          | ✗     |
|    10 | ▁זאת            | ▁מ           | ✗     |
|    11 | יש              | וניות        | ✗     |
|    12 | </s>            | ▁שנמצא       | ✗     |
|    13 | ות              | ות           | ✓     |
|    14 | ▁תחת            | ▁וע          | ✗     |
|    15 | כים             | רוכות        | ✗     |
|    16 | </s>            | ,            | ✗     |
|    17 | </s>            | ▁גנרטור      | ✗     |
|    18 | ים              | ים           | ✓     |
|    19 | </s>            | ,            | ✗     |
|    20 | </s>            | ▁עם          | ✗     |
|    21 | ▁זאת            | ▁תחנות       | ✗     |
|    22 | ▁חשמלי          | ▁משנה        | ✗     |
|    23 | </s>            | ▁על          | ✗     |
|    24 | ים              | ▁מנת         | ✗     |
|    25 | ▁להציל          | ▁לתת         | ✗     |
|    26 | ▁את             | ▁מענה        | ✗     |
|    27 | ▁ל              | ▁ל           | ✓     |
|    28 | סכנה            | אזרחים       | ✗     |
|    29 | ▁אחרים          | ▁ול          | ✗     |
|    30 | נו              | מתקנים       | ✗     |
|    31 | ▁אחרים          | ▁ה           | ✗     |
|    32 | פש              | אסטרטג       | ✗     |
|    33 | יים             | יים          | ✓     |
|    34 | ▁שלנו           | <pad>        | ✗     |
|    35 | י               | <pad>        | ✗     |
|    36 | ▁שלהם           | <pad>        | ✗     |
|    37 | י               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | י               | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ים              |              | ✗     |

2024-12-31 18:00:05,866 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:00:05,871 - TrainingLogger - INFO - Gradient norm: 9.1838
2024-12-31 18:00:12,989 - TrainingLogger - INFO - Step 11710, Batch metrics: Loss: 7.6528, Accuracy: 0.0517, Perplexity: 2106.5238
2024-12-31 18:00:20,287 - TrainingLogger - INFO - Step 11720, Batch metrics: Loss: 7.1218, Accuracy: 0.0958, Perplexity: 1238.6225
2024-12-31 18:00:27,760 - TrainingLogger - INFO - Step 11730, Batch metrics: Loss: 6.9295, Accuracy: 0.0931, Perplexity: 1022.0161
2024-12-31 18:00:34,765 - TrainingLogger - INFO - Step 11740, Batch metrics: Loss: 7.0886, Accuracy: 0.0815, Perplexity: 1198.1842
2024-12-31 18:00:41,788 - TrainingLogger - INFO - Step 11750, Batch metrics: Loss: 7.2578, Accuracy: 0.1268, Perplexity: 1419.1460
2024-12-31 18:00:49,284 - TrainingLogger - INFO - Step 11760, Batch metrics: Loss: 7.6547, Accuracy: 0.0308, Perplexity: 2110.4821
2024-12-31 18:00:56,123 - TrainingLogger - INFO - Step 11770, Batch metrics: Loss: 7.1082, Accuracy: 0.0647, Perplexity: 1221.9514
2024-12-31 18:01:03,036 - TrainingLogger - INFO - Step 11780, Batch metrics: Loss: 7.6694, Accuracy: 0.0446, Perplexity: 2141.8863
2024-12-31 18:01:09,697 - TrainingLogger - INFO - Step 11790, Batch metrics: Loss: 7.6205, Accuracy: 0.0894, Perplexity: 2039.5711
2024-12-31 18:01:16,874 - TrainingLogger - INFO - Step 11800, Batch metrics: Loss: 7.1544, Accuracy: 0.0974, Perplexity: 1279.6736
2024-12-31 18:01:16,874 - TrainingLogger - INFO - Step 11800, Prediction vs Actual:
2024-12-31 18:01:16,907 - TrainingLogger - INFO - Input 1: מה חמאס רצה בתמורה להם? כמה מאות של מקרים הומניטריים, קצת נשים, קצת קטינים, אסירים בלי דם על הידיים
2024-12-31 18:01:16,908 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:01:16,908 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלהם           | ▁מה          | ✗     |
|     1 | ים              | ▁ח           | ✗     |
|     2 | ▁ע              | מ            | ✗     |
|     3 | ▁ה              | אס           | ✗     |
|     4 | ן               | ▁רצה         | ✗     |
|     5 | ן               | ▁בתמורה      | ✗     |
|     6 | ▁ל              | ▁להם         | ✗     |
|     7 | .               | ?            | ✗     |
|     8 | </s>            | ▁כמה         | ✗     |
|     9 | ▁זמן            | ▁מאות        | ✗     |
|    10 | ד               | ▁של          | ✗     |
|    11 | ▁אנשים          | ▁מקרים       | ✗     |
|    12 | ▁הם             | ▁ה           | ✗     |
|    13 | יצירת           | ומני         | ✗     |
|    14 | סטי             | טרי          | ✗     |
|    15 | ים              | ים           | ✓     |
|    16 | </s>            | ,            | ✗     |
|    17 | </s>            | ▁קצת         | ✗     |
|    18 | ▁מוזרים         | ▁נשים        | ✗     |
|    19 | ,               | ,            | ✓     |
|    20 | </s>            | ▁קצת         | ✗     |
|    21 | ▁יותר           | ▁קטי         | ✗     |
|    22 | נים             | נים          | ✓     |
|    23 | ,               | ,            | ✓     |
|    24 | </s>            | ▁אסירים      | ✗     |
|    25 | ,               | ▁בלי         | ✗     |
|    26 | ▁ביצים          | ▁דם          | ✗     |
|    27 | ,               | ▁על          | ✗     |
|    28 | ▁הראש           | ▁הידיים      | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 18:01:16,908 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:01:16,914 - TrainingLogger - INFO - Gradient norm: 8.7895
2024-12-31 18:01:24,125 - TrainingLogger - INFO - Step 11810, Batch metrics: Loss: 7.1317, Accuracy: 0.0800, Perplexity: 1251.0544
2024-12-31 18:01:30,961 - TrainingLogger - INFO - Step 11820, Batch metrics: Loss: 7.0574, Accuracy: 0.1241, Perplexity: 1161.4545
2024-12-31 18:01:37,806 - TrainingLogger - INFO - Step 11830, Batch metrics: Loss: 7.6442, Accuracy: 0.0674, Perplexity: 2088.5655
2024-12-31 18:01:44,823 - TrainingLogger - INFO - Step 11840, Batch metrics: Loss: 7.2361, Accuracy: 0.0738, Perplexity: 1388.7149
2024-12-31 18:01:51,435 - TrainingLogger - INFO - Step 11850, Batch metrics: Loss: 7.0344, Accuracy: 0.1033, Perplexity: 1135.0640
2024-12-31 18:01:58,688 - TrainingLogger - INFO - Step 11860, Batch metrics: Loss: 7.2137, Accuracy: 0.0460, Perplexity: 1357.9387
2024-12-31 18:02:06,178 - TrainingLogger - INFO - Step 11870, Batch metrics: Loss: 7.7022, Accuracy: 0.0570, Perplexity: 2213.2422
2024-12-31 18:02:13,311 - TrainingLogger - INFO - Step 11880, Batch metrics: Loss: 7.3978, Accuracy: 0.0473, Perplexity: 1632.4063
2024-12-31 18:02:20,981 - TrainingLogger - INFO - Step 11890, Batch metrics: Loss: 7.2947, Accuracy: 0.0714, Perplexity: 1472.5329
2024-12-31 18:02:28,535 - TrainingLogger - INFO - Step 11900, Batch metrics: Loss: 7.1937, Accuracy: 0.0643, Perplexity: 1331.0199
2024-12-31 18:02:28,536 - TrainingLogger - INFO - Step 11900, Prediction vs Actual:
2024-12-31 18:02:28,536 - TrainingLogger - INFO - Input 1: הכול שם מכור, אמר הנשיא האוקראיניבטהרן זועמים על ההדלפה
2024-12-31 18:02:28,536 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:02:28,536 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הכול        | ✗     |
|     1 | ▁טוב            | ▁שם          | ✗     |
|     2 | ▁טוב            | ▁מכור        | ✗     |
|     3 | ▁-              | ,            | ✗     |
|     4 | <pad>           | ▁אמר         | ✗     |
|     5 | סון             | ▁הנשיא       | ✗     |
|     6 | ות              | ▁האו         | ✗     |
|     7 | "               | קרא          | ✗     |
|     8 | דים             | יני          | ✗     |
|     9 | .               | ב            | ✗     |
|    10 | ,               | טהר          | ✗     |
|    11 | ה               | ן            | ✗     |
|    12 | ,               | ▁זו          | ✗     |
|    13 | ה               | עמים         | ✗     |
|    14 | .               | ▁על          | ✗     |
|    15 | ▁החוק           | ▁ההד         | ✗     |
|    16 | יות             | ל            | ✗     |
|    17 | פות             | פה           | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | -               | <pad>        | ✗     |
|    20 | ▁שלנו           | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | בית             | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ית              | <pad>        | ✗     |
|    25 | ית              | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | ית              | <pad>        | ✗     |
|    28 | ית              |              | ✗     |

2024-12-31 18:02:28,536 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:02:28,541 - TrainingLogger - INFO - Gradient norm: 8.8857
2024-12-31 18:02:36,127 - TrainingLogger - INFO - Step 11910, Batch metrics: Loss: 7.3766, Accuracy: 0.0783, Perplexity: 1598.1632
2024-12-31 18:02:43,204 - TrainingLogger - INFO - Step 11920, Batch metrics: Loss: 7.5174, Accuracy: 0.1022, Perplexity: 1839.7071
2024-12-31 18:02:50,827 - TrainingLogger - INFO - Step 11930, Batch metrics: Loss: 7.5632, Accuracy: 0.0925, Perplexity: 1925.9575
2024-12-31 18:02:58,499 - TrainingLogger - INFO - Step 11940, Batch metrics: Loss: 6.8512, Accuracy: 0.1234, Perplexity: 945.0130
2024-12-31 18:03:05,897 - TrainingLogger - INFO - Step 11950, Batch metrics: Loss: 8.1930, Accuracy: 0.0335, Perplexity: 3615.4073
2024-12-31 18:03:12,756 - TrainingLogger - INFO - Step 11960, Batch metrics: Loss: 7.7034, Accuracy: 0.0824, Perplexity: 2215.9149
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 39, 32), but is torch.Size([8, 1, 39, 28])
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 39, 32), but is torch.Size([8, 1, 39, 28])

2024-12-31 18:03:18,724 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 18:03:18,724 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 39]), device: cuda:0
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 39]), device: cuda:0
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 30]), device: cuda:0
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 18:03:18,725 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 18:03:21,287 - TrainingLogger - INFO - Step 11970, Batch metrics: Loss: 7.5663, Accuracy: 0.0803, Perplexity: 1932.0559
2024-12-31 18:03:27,969 - TrainingLogger - INFO - Step 11980, Batch metrics: Loss: 8.0914, Accuracy: 0.0529, Perplexity: 3266.1361
2024-12-31 18:03:35,195 - TrainingLogger - INFO - Step 11990, Batch metrics: Loss: 7.3178, Accuracy: 0.0745, Perplexity: 1506.8896
2024-12-31 18:03:41,612 - TrainingLogger - INFO - Step 12000, Batch metrics: Loss: 7.8533, Accuracy: 0.0876, Perplexity: 2574.3235
2024-12-31 18:03:41,612 - TrainingLogger - INFO - Step 12000, Prediction vs Actual:
2024-12-31 18:03:41,612 - TrainingLogger - INFO - Input 1: הרמטכל קבע לתחקירים חמישה ערכים אמת, ענייניות, שקיפות, אחריות ורעות
2024-12-31 18:03:41,613 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:03:41,613 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הר          | ✗     |
|     1 | ...             | מט           | ✗     |
|     2 | אס              | כל           | ✗     |
|     3 | ן               | ▁קבע         | ✗     |
|     4 | ה               | ▁ל           | ✗     |
|     5 | -19             | תחקיר        | ✗     |
|     6 | ים              | ים           | ✓     |
|     7 | ▁רשמי           | ▁חמישה       | ✗     |
|     8 | ▁ימים           | ▁ערכים       | ✗     |
|     9 | ▁חדשים          | ▁אמת         | ✗     |
|    10 | יים             | ,            | ✗     |
|    11 | </s>            | ▁ענייני      | ✗     |
|    12 | ים              | ות           | ✗     |
|    13 | ,               | ,            | ✓     |
|    14 | </s>            | ▁שק          | ✗     |
|    15 | מה              | יפות         | ✗     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁אחריות      | ✗     |
|    18 | ▁רבה            | ▁ורע         | ✗     |
|    19 | ות              | ות           | ✓     |
|    20 | ,               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | יות             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ,               |              | ✗     |

2024-12-31 18:03:41,613 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:03:41,618 - TrainingLogger - INFO - Gradient norm: 9.1438
2024-12-31 18:03:48,728 - TrainingLogger - INFO - Step 12010, Batch metrics: Loss: 7.2271, Accuracy: 0.0567, Perplexity: 1376.1704
2024-12-31 18:03:56,127 - TrainingLogger - INFO - Step 12020, Batch metrics: Loss: 7.5085, Accuracy: 0.0688, Perplexity: 1823.5208
2024-12-31 18:04:03,497 - TrainingLogger - INFO - Step 12030, Batch metrics: Loss: 7.4942, Accuracy: 0.0940, Perplexity: 1797.6757
2024-12-31 18:04:10,034 - TrainingLogger - INFO - Step 12040, Batch metrics: Loss: 7.3995, Accuracy: 0.1371, Perplexity: 1635.1478
2024-12-31 18:04:17,362 - TrainingLogger - INFO - Step 12050, Batch metrics: Loss: 7.6475, Accuracy: 0.0327, Perplexity: 2095.3317
2024-12-31 18:04:24,608 - TrainingLogger - INFO - Step 12060, Batch metrics: Loss: 7.7188, Accuracy: 0.0584, Perplexity: 2250.3415
2024-12-31 18:04:31,628 - TrainingLogger - INFO - Step 12070, Batch metrics: Loss: 7.4758, Accuracy: 0.0658, Perplexity: 1764.8602
2024-12-31 18:04:38,770 - TrainingLogger - INFO - Step 12080, Batch metrics: Loss: 7.0981, Accuracy: 0.1006, Perplexity: 1209.6864
2024-12-31 18:04:46,091 - TrainingLogger - INFO - Step 12090, Batch metrics: Loss: 7.2363, Accuracy: 0.0718, Perplexity: 1388.9281
2024-12-31 18:04:53,310 - TrainingLogger - INFO - Step 12100, Batch metrics: Loss: 7.5294, Accuracy: 0.0897, Perplexity: 1862.0073
2024-12-31 18:04:53,311 - TrainingLogger - INFO - Step 12100, Prediction vs Actual:
2024-12-31 18:04:53,311 - TrainingLogger - INFO - Input 1: כל יהדות העולם התגייסה, אנשים התייצבו והלב שלהם ופורים זו הזדמנות להגיד להם תודה
2024-12-31 18:04:53,311 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:04:53,311 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כל          | ✗     |
|     1 | ▁-              | ▁יה          | ✗     |
|     2 | ה               | דות          | ✗     |
|     3 | .               | ▁העולם       | ✗     |
|     4 | .               | ▁ה           | ✗     |
|     5 | מקסים           | תגייס        | ✗     |
|     6 | ות              | ה            | ✗     |
|     7 | ▁אלינו          | ,            | ✗     |
|     8 | <pad>           | ▁אנשים       | ✗     |
|     9 | .               | ▁התייצב      | ✗     |
|    10 | ו               | ו            | ✓     |
|    11 | ▁בראש           | ▁והלב        | ✗     |
|    12 | ה               | ▁שלהם        | ✗     |
|    13 | .               | ▁ו           | ✗     |
|    14 | הצליח           | פור          | ✗     |
|    15 | ה               | ים           | ✗     |
|    16 | .               | ▁זו          | ✗     |
|    17 | טרים            | ▁הזדמנות     | ✗     |
|    18 | ▁גדולה          | ▁להגיד       | ✗     |
|    19 | ▁לי             | ▁להם         | ✗     |
|    20 | ▁מה             | ▁תודה        | ✗     |
|    21 | ▁רבה            | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | א               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 18:04:53,312 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:04:53,317 - TrainingLogger - INFO - Gradient norm: 9.6983
2024-12-31 18:05:00,196 - TrainingLogger - INFO - Step 12110, Batch metrics: Loss: 7.4456, Accuracy: 0.0811, Perplexity: 1712.3475
2024-12-31 18:05:07,505 - TrainingLogger - INFO - Step 12120, Batch metrics: Loss: 7.3862, Accuracy: 0.0691, Perplexity: 1613.5359
2024-12-31 18:05:14,411 - TrainingLogger - INFO - Step 12130, Batch metrics: Loss: 7.6992, Accuracy: 0.0759, Perplexity: 2206.5276
2024-12-31 18:05:21,753 - TrainingLogger - INFO - Step 12140, Batch metrics: Loss: 7.1893, Accuracy: 0.0629, Perplexity: 1325.2366
2024-12-31 18:05:29,130 - TrainingLogger - INFO - Step 12150, Batch metrics: Loss: 7.2893, Accuracy: 0.1160, Perplexity: 1464.5856
2024-12-31 18:05:36,460 - TrainingLogger - INFO - Step 12160, Batch metrics: Loss: 7.9963, Accuracy: 0.0538, Perplexity: 2969.8305
2024-12-31 18:05:44,408 - TrainingLogger - INFO - Step 12170, Batch metrics: Loss: 7.5711, Accuracy: 0.0674, Perplexity: 1941.1917
2024-12-31 18:05:51,496 - TrainingLogger - INFO - Step 12180, Batch metrics: Loss: 7.4057, Accuracy: 0.0690, Perplexity: 1645.3122
2024-12-31 18:05:58,936 - TrainingLogger - INFO - Step 12190, Batch metrics: Loss: 7.6936, Accuracy: 0.0513, Perplexity: 2194.3030
2024-12-31 18:06:06,133 - TrainingLogger - INFO - Step 12200, Batch metrics: Loss: 7.1962, Accuracy: 0.1150, Perplexity: 1334.3791
2024-12-31 18:06:06,133 - TrainingLogger - INFO - Step 12200, Prediction vs Actual:
2024-12-31 18:06:06,133 - TrainingLogger - INFO - Input 1: ממה חששנו? שהם יתחילו עם עניין ההתנחלויות
2024-12-31 18:06:06,133 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:06:06,133 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ממה         | ✗     |
|     1 | .               | ▁חשש         | ✗     |
|     2 | י               | נו           | ✗     |
|     3 | ▁ש              | ?            | ✗     |
|     4 | </s>            | ▁שהם         | ✗     |
|     5 | ▁יהיו           | ▁יתחילו      | ✗     |
|     6 | ▁לפעול          | ▁עם          | ✗     |
|     7 | ▁אנשים          | ▁עניין       | ✗     |
|     8 | ▁זה             | ▁ההת         | ✗     |
|     9 | מודד            | נחל          | ✗     |
|    10 | ות              | ויות         | ✗     |
|    11 | ▁שלהם           | <pad>        | ✗     |
|    12 | ות              | <pad>        | ✗     |
|    13 | יות             | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | יות             | <pad>        | ✗     |
|    16 | גו              | <pad>        | ✗     |
|    17 | ח               | <pad>        | ✗     |
|    18 | ו               | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | יות             | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | ות              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | יות             | <pad>        | ✗     |
|    30 | יות             |              | ✗     |

2024-12-31 18:06:06,134 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:06:06,138 - TrainingLogger - INFO - Gradient norm: 8.8585
2024-12-31 18:06:12,823 - TrainingLogger - INFO - Step 12210, Batch metrics: Loss: 7.7131, Accuracy: 0.0426, Perplexity: 2237.3673
2024-12-31 18:06:19,718 - TrainingLogger - INFO - Step 12220, Batch metrics: Loss: 7.4277, Accuracy: 0.1071, Perplexity: 1681.9829
2024-12-31 18:06:27,211 - TrainingLogger - INFO - Step 12230, Batch metrics: Loss: 7.6807, Accuracy: 0.0563, Perplexity: 2166.0804
2024-12-31 18:06:34,564 - TrainingLogger - INFO - Step 12240, Batch metrics: Loss: 7.1047, Accuracy: 0.0684, Perplexity: 1217.6420
2024-12-31 18:06:41,931 - TrainingLogger - INFO - Step 12250, Batch metrics: Loss: 8.0064, Accuracy: 0.0517, Perplexity: 3000.1835
2024-12-31 18:06:48,887 - TrainingLogger - INFO - Step 12260, Batch metrics: Loss: 7.1417, Accuracy: 0.0773, Perplexity: 1263.6190
2024-12-31 18:06:55,966 - TrainingLogger - INFO - Step 12270, Batch metrics: Loss: 7.2690, Accuracy: 0.0902, Perplexity: 1435.1674
2024-12-31 18:07:03,316 - TrainingLogger - INFO - Step 12280, Batch metrics: Loss: 7.1045, Accuracy: 0.0875, Perplexity: 1217.3941
2024-12-31 18:07:10,938 - TrainingLogger - INFO - Step 12290, Batch metrics: Loss: 7.0887, Accuracy: 0.0969, Perplexity: 1198.3910
2024-12-31 18:07:17,882 - TrainingLogger - INFO - Step 12300, Batch metrics: Loss: 7.6379, Accuracy: 0.0592, Perplexity: 2075.4480
2024-12-31 18:07:17,883 - TrainingLogger - INFO - Step 12300, Prediction vs Actual:
2024-12-31 18:07:17,883 - TrainingLogger - INFO - Input 1: יש לציין, שככל שהמעסיק החליט, על דעת עצמו, להורות לעובדים שלא להגיע לעבודה למרות שלא הוטלו מגבלות תחול עליו חובה לשלם שכר לעובדים
2024-12-31 18:07:17,883 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:07:17,883 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁יש          | ✗     |
|     1 | ,               | ▁לציין       | ✗     |
|     2 | .               | ,            | ✗     |
|     3 | ▁יש             | ▁שככל        | ✗     |
|     4 | ▁כן             | ▁שה          | ✗     |
|     5 | ,               | מעסיק        | ✗     |
|     6 | ה               | ▁החליט       | ✗     |
|     7 | ,               | ,            | ✓     |
|     8 | </s>            | ▁על          | ✗     |
|     9 | ה               | ▁דעת         | ✗     |
|    10 | ▁עצמו           | ▁עצמו        | ✓     |
|    11 | ,               | ,            | ✓     |
|    12 | </s>            | ▁להורות      | ✗     |
|    13 | ▁לו             | ▁ל           | ✗     |
|    14 | .               | עובדים       | ✗     |
|    15 | ▁שלו            | ▁שלא         | ✗     |
|    16 | ▁יהיה           | ▁להגיע       | ✗     |
|    17 | ▁אליו           | ▁לעבודה      | ✗     |
|    18 | ,               | ▁למרות       | ✗     |
|    19 | ▁זאת            | ▁שלא         | ✗     |
|    20 | ▁היה            | ▁הוטל        | ✗     |
|    21 | ה               | ו            | ✗     |
|    22 | ▁עליו           | ▁מגבלות      | ✗     |
|    23 | ,               | ▁ת           | ✗     |
|    24 | כנות            | חול          | ✗     |
|    25 | יות             | ▁עליו        | ✗     |
|    26 | ,               | ▁חובה        | ✗     |
|    27 | .               | ▁לשלם        | ✗     |
|    28 | ▁הוצאות         | ▁שכר         | ✗     |
|    29 | ות              | ▁ל           | ✗     |
|    30 | ערך             | עובדים       | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁עליהם          | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 18:07:17,883 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:07:17,888 - TrainingLogger - INFO - Gradient norm: 8.9308
2024-12-31 18:07:25,031 - TrainingLogger - INFO - Step 12310, Batch metrics: Loss: 7.7688, Accuracy: 0.0519, Perplexity: 2365.6405
2024-12-31 18:07:32,115 - TrainingLogger - INFO - Step 12320, Batch metrics: Loss: 7.2543, Accuracy: 0.0859, Perplexity: 1414.1729
2024-12-31 18:07:39,024 - TrainingLogger - INFO - Step 12330, Batch metrics: Loss: 7.4237, Accuracy: 0.0691, Perplexity: 1675.2329
2024-12-31 18:07:45,179 - TrainingLogger - INFO - Step 12340, Batch metrics: Loss: 7.3858, Accuracy: 0.0877, Perplexity: 1612.9290
2024-12-31 18:07:52,347 - TrainingLogger - INFO - Step 12350, Batch metrics: Loss: 7.4783, Accuracy: 0.0806, Perplexity: 1769.1497
2024-12-31 18:07:59,085 - TrainingLogger - INFO - Step 12360, Batch metrics: Loss: 7.2282, Accuracy: 0.0939, Perplexity: 1377.7928
2024-12-31 18:08:06,563 - TrainingLogger - INFO - Step 12370, Batch metrics: Loss: 7.3672, Accuracy: 0.0821, Perplexity: 1583.1665
2024-12-31 18:08:13,231 - TrainingLogger - INFO - Step 12380, Batch metrics: Loss: 7.5757, Accuracy: 0.0909, Perplexity: 1950.3055
2024-12-31 18:08:19,959 - TrainingLogger - INFO - Step 12390, Batch metrics: Loss: 7.9952, Accuracy: 0.0268, Perplexity: 2966.6318
2024-12-31 18:08:27,557 - TrainingLogger - INFO - Step 12400, Batch metrics: Loss: 7.4773, Accuracy: 0.0632, Perplexity: 1767.3740
2024-12-31 18:08:27,558 - TrainingLogger - INFO - Step 12400, Prediction vs Actual:
2024-12-31 18:08:27,558 - TrainingLogger - INFO - Input 1: לאחר מכן נשמע מישהו אומר כי המצלמות הללו מכוונות למסדרון
2024-12-31 18:08:27,558 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:08:27,558 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לאחר        | ✗     |
|     1 | ▁כן             | ▁מכן         | ✗     |
|     2 | .               | ▁נשמע        | ✗     |
|     3 | ה               | ▁מישהו       | ✗     |
|     4 | ▁אחר            | ▁אומר        | ✗     |
|     5 | ▁לי             | ▁כי          | ✗     |
|     6 | ▁הוא            | ▁המצלמות     | ✗     |
|     7 | <pad>           | ▁הללו        | ✗     |
|     8 | ▁לא             | ▁מ           | ✗     |
|     9 | נוהל            | כוונו        | ✗     |
|    10 | ת               | ת            | ✓     |
|    11 | ▁אליו           | ▁למסדרון     | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ות              | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | <pad>           |              | ✗     |

2024-12-31 18:08:27,558 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:08:27,563 - TrainingLogger - INFO - Gradient norm: 9.8990
2024-12-31 18:08:35,074 - TrainingLogger - INFO - Step 12410, Batch metrics: Loss: 7.8049, Accuracy: 0.0534, Perplexity: 2452.4925
2024-12-31 18:08:42,742 - TrainingLogger - INFO - Step 12420, Batch metrics: Loss: 7.5211, Accuracy: 0.0519, Perplexity: 1846.5368
2024-12-31 18:08:49,775 - TrainingLogger - INFO - Step 12430, Batch metrics: Loss: 7.0572, Accuracy: 0.0345, Perplexity: 1161.1361
2024-12-31 18:08:57,332 - TrainingLogger - INFO - Step 12440, Batch metrics: Loss: 7.1900, Accuracy: 0.0870, Perplexity: 1326.0837
2024-12-31 18:09:04,621 - TrainingLogger - INFO - Step 12450, Batch metrics: Loss: 7.6189, Accuracy: 0.0656, Perplexity: 2036.2497
2024-12-31 18:09:11,795 - TrainingLogger - INFO - Step 12460, Batch metrics: Loss: 7.5275, Accuracy: 0.0748, Perplexity: 1858.3617
2024-12-31 18:09:19,160 - TrainingLogger - INFO - Step 12470, Batch metrics: Loss: 7.1083, Accuracy: 0.0800, Perplexity: 1222.0108
2024-12-31 18:09:26,472 - TrainingLogger - INFO - Step 12480, Batch metrics: Loss: 7.4832, Accuracy: 0.0886, Perplexity: 1777.8576
2024-12-31 18:09:33,379 - TrainingLogger - INFO - Step 12490, Batch metrics: Loss: 7.3020, Accuracy: 0.0872, Perplexity: 1483.2593
2024-12-31 18:09:40,135 - TrainingLogger - INFO - Step 12500, Batch metrics: Loss: 7.6390, Accuracy: 0.0663, Perplexity: 2077.7631
2024-12-31 18:09:40,136 - TrainingLogger - INFO - Step 12500, Prediction vs Actual:
2024-12-31 18:09:40,136 - TrainingLogger - INFO - Input 1: במטה השבכ ערכו הבוקר טקס זיכרון לחללי הארגון
2024-12-31 18:09:40,136 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:09:40,136 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ב           | ✗     |
|     1 | ▁הם             | מטה          | ✗     |
|     2 | .               | ▁השב         | ✗     |
|     3 | ויות            | כ            | ✗     |
|     4 | ונות            | ▁ערכו        | ✗     |
|     5 | ת               | ▁הבוקר       | ✗     |
|     6 | .               | ▁טקס         | ✗     |
|     7 | ▁האש            | ▁זיכרון      | ✗     |
|     8 | </s>            | ▁לחלל        | ✗     |
|     9 | ▁המדינה         | י            | ✗     |
|    10 | ▁המדינה         | ▁הארגון      | ✗     |
|    11 | ▁המשפט          | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ▁הו             | <pad>        | ✗     |
|    14 | ה               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ▁מלא            | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | י               | <pad>        | ✗     |
|    21 | ▁               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ▁מאובטח         | <pad>        | ✗     |
|    24 | ▁מאובטח         | <pad>        | ✗     |
|    25 | ▁בינלאומי       | <pad>        | ✗     |
|    26 | ▁מאובטח         | <pad>        | ✗     |
|    27 | ▁כלכלי          | <pad>        | ✗     |
|    28 | ▁בינלאומי       | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁גרעיני         | <pad>        | ✗     |
|    31 | ▁מאובטח         | <pad>        | ✗     |
|    32 | ▁פעיל           | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁מאובטח         | <pad>        | ✗     |
|    35 | ▁הפדרלי         | <pad>        | ✗     |
|    36 | </s>            |              | ✗     |

2024-12-31 18:09:40,136 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:09:40,141 - TrainingLogger - INFO - Gradient norm: 9.4653
2024-12-31 18:09:45,597 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 36, 40), but is torch.Size([8, 1, 36, 35])
2024-12-31 18:09:45,597 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 36, 40), but is torch.Size([8, 1, 36, 35])

2024-12-31 18:09:45,597 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 36]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 36]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 18:09:45,598 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 18:09:48,698 - TrainingLogger - INFO - Step 12510, Batch metrics: Loss: 7.3654, Accuracy: 0.0846, Perplexity: 1580.3630
2024-12-31 18:09:55,845 - TrainingLogger - INFO - Step 12520, Batch metrics: Loss: 7.0273, Accuracy: 0.0855, Perplexity: 1126.9679
2024-12-31 18:10:03,096 - TrainingLogger - INFO - Step 12530, Batch metrics: Loss: 7.8452, Accuracy: 0.0584, Perplexity: 2553.4314
2024-12-31 18:10:10,611 - TrainingLogger - INFO - Step 12540, Batch metrics: Loss: 7.3203, Accuracy: 0.0877, Perplexity: 1510.6781
2024-12-31 18:10:17,244 - TrainingLogger - INFO - Step 12550, Batch metrics: Loss: 7.5510, Accuracy: 0.0357, Perplexity: 1902.6991
2024-12-31 18:10:24,332 - TrainingLogger - INFO - Step 12560, Batch metrics: Loss: 7.1880, Accuracy: 0.0802, Perplexity: 1323.4205
2024-12-31 18:10:31,061 - TrainingLogger - INFO - Step 12570, Batch metrics: Loss: 7.9246, Accuracy: 0.0667, Perplexity: 2764.5628
2024-12-31 18:10:38,150 - TrainingLogger - INFO - Step 12580, Batch metrics: Loss: 7.1440, Accuracy: 0.1149, Perplexity: 1266.5272
2024-12-31 18:10:45,376 - TrainingLogger - INFO - Step 12590, Batch metrics: Loss: 7.3587, Accuracy: 0.0635, Perplexity: 1569.8653
2024-12-31 18:10:52,831 - TrainingLogger - INFO - Step 12600, Batch metrics: Loss: 7.3365, Accuracy: 0.0833, Perplexity: 1535.4047
2024-12-31 18:10:52,832 - TrainingLogger - INFO - Step 12600, Prediction vs Actual:
2024-12-31 18:10:52,832 - TrainingLogger - INFO - Input 1: לא כדי להיות עובד מדינה
2024-12-31 18:10:52,832 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:10:52,832 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁לא          | ✗     |
|     1 | ▁-              | ▁כדי         | ✗     |
|     2 | ▁זה             | ▁להיות       | ✗     |
|     3 | ▁אחראי          | ▁עובד        | ✗     |
|     4 | .               | ▁מדינה       | ✗     |
|     5 | .               | <pad>        | ✗     |
|     6 | ▁לא             | <pad>        | ✗     |
|     7 | <pad>           | <pad>        | ✓     |
|     8 | ▁לא             | <pad>        | ✗     |
|     9 | ▁קשה            | <pad>        | ✗     |
|    10 | ▁זה             | <pad>        | ✗     |
|    11 | <pad>           | <pad>        | ✓     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | ▁זה             | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ▁גם             | <pad>        | ✗     |
|    18 | ▁קשה            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ▁קשה            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ▁הוא            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | ▁זה             | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 18:10:52,832 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:10:52,837 - TrainingLogger - INFO - Gradient norm: 7.8753
2024-12-31 18:10:59,965 - TrainingLogger - INFO - Step 12610, Batch metrics: Loss: 7.0517, Accuracy: 0.0730, Perplexity: 1154.8656
2024-12-31 18:11:06,873 - TrainingLogger - INFO - Step 12620, Batch metrics: Loss: 7.3377, Accuracy: 0.1000, Perplexity: 1537.2017
2024-12-31 18:11:14,131 - TrainingLogger - INFO - Step 12630, Batch metrics: Loss: 6.5988, Accuracy: 0.1066, Perplexity: 734.1878
2024-12-31 18:11:21,520 - TrainingLogger - INFO - Step 12640, Batch metrics: Loss: 7.4507, Accuracy: 0.0734, Perplexity: 1721.1402
2024-12-31 18:11:28,862 - TrainingLogger - INFO - Step 12650, Batch metrics: Loss: 7.4180, Accuracy: 0.0657, Perplexity: 1665.6817
2024-12-31 18:11:35,981 - TrainingLogger - INFO - Step 12660, Batch metrics: Loss: 7.5588, Accuracy: 0.0621, Perplexity: 1917.6185
2024-12-31 18:11:42,817 - TrainingLogger - INFO - Step 12670, Batch metrics: Loss: 7.1633, Accuracy: 0.1119, Perplexity: 1291.1075
2024-12-31 18:11:50,132 - TrainingLogger - INFO - Step 12680, Batch metrics: Loss: 8.1385, Accuracy: 0.0493, Perplexity: 3423.8117
2024-12-31 18:11:57,494 - TrainingLogger - INFO - Step 12690, Batch metrics: Loss: 7.6354, Accuracy: 0.0512, Perplexity: 2070.2667
2024-12-31 18:12:04,344 - TrainingLogger - INFO - Step 12700, Batch metrics: Loss: 7.6041, Accuracy: 0.0829, Perplexity: 2006.4995
2024-12-31 18:12:04,344 - TrainingLogger - INFO - Step 12700, Prediction vs Actual:
2024-12-31 18:12:04,344 - TrainingLogger - INFO - Input 1: להזכיר לך, גנץ ולפיד היו בעד ההסכם עם איראן, ראש הממשלה התנגד
2024-12-31 18:12:04,345 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:12:04,345 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁להזכיר      | ✗     |
|     1 | ▁יש             | ▁לך          | ✗     |
|     2 | ,               | ,            | ✓     |
|     3 | </s>            | ▁ג           | ✗     |
|     4 | '               | נץ           | ✗     |
|     5 | '               | ▁ו           | ✗     |
|     6 | מצליח           | לפיד         | ✗     |
|     7 | ,               | ▁היו         | ✗     |
|     8 | ▁רבים           | ▁בעד         | ✗     |
|     9 | ,               | ▁ההסכם       | ✗     |
|    10 | ,               | ▁עם          | ✗     |
|    11 | ▁כל             | ▁אי          | ✗     |
|    12 | נטל             | ראן          | ✗     |
|    13 | ,               | ,            | ✓     |
|    14 | </s>            | ▁ראש         | ✗     |
|    15 | ▁העיר           | ▁הממשלה      | ✗     |
|    16 | ,               | ▁התנגד       | ✗     |
|    17 | ו               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | ,               |              | ✗     |

2024-12-31 18:12:04,345 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:12:04,350 - TrainingLogger - INFO - Gradient norm: 10.1899
2024-12-31 18:12:12,066 - TrainingLogger - INFO - Step 12710, Batch metrics: Loss: 7.7656, Accuracy: 0.0888, Perplexity: 2358.0621
2024-12-31 18:12:19,192 - TrainingLogger - INFO - Step 12720, Batch metrics: Loss: 7.2573, Accuracy: 0.1080, Perplexity: 1418.4506
2024-12-31 18:12:26,226 - TrainingLogger - INFO - Step 12730, Batch metrics: Loss: 6.4238, Accuracy: 0.1243, Perplexity: 616.3352
2024-12-31 18:12:33,499 - TrainingLogger - INFO - Step 12740, Batch metrics: Loss: 7.2514, Accuracy: 0.0773, Perplexity: 1410.0177
2024-12-31 18:12:40,736 - TrainingLogger - INFO - Step 12750, Batch metrics: Loss: 6.9678, Accuracy: 0.0787, Perplexity: 1061.8715
2024-12-31 18:12:48,070 - TrainingLogger - INFO - Step 12760, Batch metrics: Loss: 7.4260, Accuracy: 0.0451, Perplexity: 1679.0284
2024-12-31 18:12:55,581 - TrainingLogger - INFO - Step 12770, Batch metrics: Loss: 7.2704, Accuracy: 0.0859, Perplexity: 1437.1719
2024-12-31 18:13:02,789 - TrainingLogger - INFO - Step 12780, Batch metrics: Loss: 7.6030, Accuracy: 0.0754, Perplexity: 2004.2428
2024-12-31 18:13:10,068 - TrainingLogger - INFO - Step 12790, Batch metrics: Loss: 7.6517, Accuracy: 0.0610, Perplexity: 2104.2669
2024-12-31 18:13:16,864 - TrainingLogger - INFO - Step 12800, Batch metrics: Loss: 7.5655, Accuracy: 0.1032, Perplexity: 1930.3523
2024-12-31 18:13:16,864 - TrainingLogger - INFO - Step 12800, Prediction vs Actual:
2024-12-31 18:13:16,864 - TrainingLogger - INFO - Input 1: לשמחתנו לא נפצעו ולא נזקקו לפינוי לבית חולים
2024-12-31 18:13:16,865 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:13:16,865 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ו               | ▁לשמח        | ✗     |
|     1 | ▁ול             | תנו          | ✗     |
|     2 | .               | ▁לא          | ✗     |
|     3 | ▁היה            | ▁נפצע        | ✗     |
|     4 | .               | ו            | ✗     |
|     5 | .               | ▁ולא         | ✗     |
|     6 | ה               | ▁נזקק        | ✗     |
|     7 | ו               | ו            | ✓     |
|     8 | ▁לו             | ▁לפי         | ✗     |
|     9 | ו               | נו           | ✗     |
|    10 | י               | י            | ✓     |
|    11 | .               | ▁לבית        | ✗     |
|    12 | ▁המשפט          | ▁חולים       | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               |              | ✗     |

2024-12-31 18:13:16,865 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:13:16,870 - TrainingLogger - INFO - Gradient norm: 8.7076
2024-12-31 18:13:23,758 - TrainingLogger - INFO - Step 12810, Batch metrics: Loss: 7.7813, Accuracy: 0.0536, Perplexity: 2395.4738
2024-12-31 18:13:30,188 - TrainingLogger - INFO - Step 12820, Batch metrics: Loss: 7.3760, Accuracy: 0.0818, Perplexity: 1597.2452
2024-12-31 18:13:36,937 - TrainingLogger - INFO - Step 12830, Batch metrics: Loss: 7.3728, Accuracy: 0.0645, Perplexity: 1592.0996
2024-12-31 18:13:44,659 - TrainingLogger - INFO - Step 12840, Batch metrics: Loss: 6.9437, Accuracy: 0.0701, Perplexity: 1036.5667
2024-12-31 18:13:51,854 - TrainingLogger - INFO - Step 12850, Batch metrics: Loss: 7.6449, Accuracy: 0.1250, Perplexity: 2089.9413
2024-12-31 18:13:59,310 - TrainingLogger - INFO - Step 12860, Batch metrics: Loss: 7.4001, Accuracy: 0.0743, Perplexity: 1636.2186
2024-12-31 18:14:06,040 - TrainingLogger - INFO - Step 12870, Batch metrics: Loss: 7.9032, Accuracy: 0.0645, Perplexity: 2705.9988
2024-12-31 18:14:13,360 - TrainingLogger - INFO - Step 12880, Batch metrics: Loss: 7.7759, Accuracy: 0.0355, Perplexity: 2382.4011
2024-12-31 18:14:20,232 - TrainingLogger - INFO - Step 12890, Batch metrics: Loss: 7.3412, Accuracy: 0.1026, Perplexity: 1542.5288
2024-12-31 18:14:27,543 - TrainingLogger - INFO - Step 12900, Batch metrics: Loss: 7.5487, Accuracy: 0.0474, Perplexity: 1898.3346
2024-12-31 18:14:27,543 - TrainingLogger - INFO - Step 12900, Prediction vs Actual:
2024-12-31 18:14:27,543 - TrainingLogger - INFO - Input 1: גם אחרי אזהרתו של ראש השבכ נדב ארגמן מפני הסיכונים שנשקפים מהמשך השיח המסית , נשמעו אמש שבת קריאות גנאי בהפגנה מול ביתו של חכ ניר אורבך בפתח תקווה
2024-12-31 18:14:27,544 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:14:27,544 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁גם          | ✗     |
|     1 | .               | ▁אחרי        | ✗     |
|     2 | ▁-              | ▁אז          | ✗     |
|     3 | .               | ה            | ✗     |
|     4 | מה              | רתו          | ✗     |
|     5 | .               | ▁של          | ✗     |
|     6 | ▁היום           | ▁ראש         | ✗     |
|     7 | ▁השנה           | ▁השב         | ✗     |
|     8 | ה               | כ            | ✗     |
|     9 | ון              | ▁נדב         | ✗     |
|    10 | ה               | ▁א           | ✗     |
|    11 | פגניסטן         | רג           | ✗     |
|    12 | '               | מן           | ✗     |
|    13 | </s>            | ▁מפני        | ✗     |
|    14 | ם               | ▁הסיכונים    | ✗     |
|    15 | .               | ▁ש           | ✗     |
|    16 | בוצע            | נשק          | ✗     |
|    17 | ה               | פים          | ✗     |
|    18 | ▁את             | ▁מה          | ✗     |
|    19 | ו               | משך          | ✗     |
|    20 | ▁המלחמה         | ▁ה           | ✗     |
|    21 | אקלים           | שיח          | ✗     |
|    22 | ▁הזה            | ▁המס         | ✗     |
|    23 | ה               | ית           | ✗     |
|    24 | </s>            | ▁,           | ✗     |
|    25 | </s>            | ▁נשמע        | ✗     |
|    26 | ▁כמו            | ו            | ✗     |
|    27 | ▁יריות          | ▁אמש         | ✗     |
|    28 | ,               | ▁שבת         | ✗     |
|    29 | ון              | ▁קריאות      | ✗     |
|    30 | ו               | ▁ג           | ✗     |
|    31 | '               | נאי          | ✗     |
|    32 | </s>            | ▁בה          | ✗     |
|    33 | לם              | פג           | ✗     |
|    34 | ה               | נה           | ✗     |
|    35 | ,               | ▁מול         | ✗     |
|    36 | ה               | ▁ביתו        | ✗     |
|    37 | ▁של             | ▁של          | ✓     |
|    38 | ▁הנשיא          | ▁ח           | ✗     |
|    39 | זיון            | כ            | ✗     |
|    40 | מן              | ▁ניר         | ✗     |
|    41 | אל              | ▁אורב        | ✗     |
|    42 | ה               | ך            | ✗     |
|    43 | .               | ▁בפתח        | ✗     |
|    44 | ה               | ▁תקווה       | ✗     |
|    45 | .               |              | ✗     |

2024-12-31 18:14:27,544 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:14:27,549 - TrainingLogger - INFO - Gradient norm: 10.3523
2024-12-31 18:14:34,575 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 279552
2024-12-31 18:14:34,575 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 279552

2024-12-31 18:14:34,575 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 37]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - input_ids_2 min: 6, max: 151643
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 37]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 18:14:34,576 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 18:14:35,249 - TrainingLogger - INFO - Step 12910, Batch metrics: Loss: 7.6067, Accuracy: 0.0692, Perplexity: 2011.5816
2024-12-31 18:14:42,318 - TrainingLogger - INFO - Step 12920, Batch metrics: Loss: 7.5151, Accuracy: 0.0765, Perplexity: 1835.5230
2024-12-31 18:14:49,081 - TrainingLogger - INFO - Step 12930, Batch metrics: Loss: 7.2753, Accuracy: 0.0899, Perplexity: 1444.2133
2024-12-31 18:14:56,376 - TrainingLogger - INFO - Step 12940, Batch metrics: Loss: 7.4308, Accuracy: 0.0899, Perplexity: 1687.2042
2024-12-31 18:15:03,504 - TrainingLogger - INFO - Step 12950, Batch metrics: Loss: 7.8070, Accuracy: 0.0735, Perplexity: 2457.7043
2024-12-31 18:15:11,438 - TrainingLogger - INFO - Step 12960, Batch metrics: Loss: 7.4912, Accuracy: 0.0714, Perplexity: 1792.2604
2024-12-31 18:15:18,001 - TrainingLogger - INFO - Step 12970, Batch metrics: Loss: 7.9175, Accuracy: 0.0619, Perplexity: 2744.8937
2024-12-31 18:15:25,163 - TrainingLogger - INFO - Step 12980, Batch metrics: Loss: 7.9423, Accuracy: 0.0562, Perplexity: 2813.7493
2024-12-31 18:15:32,187 - TrainingLogger - INFO - Step 12990, Batch metrics: Loss: 7.9694, Accuracy: 0.0611, Perplexity: 2891.1385
2024-12-31 18:15:40,230 - TrainingLogger - INFO - Step 13000, Batch metrics: Loss: 7.6189, Accuracy: 0.0779, Perplexity: 2036.2555
2024-12-31 18:15:40,230 - TrainingLogger - INFO - Step 13000, Prediction vs Actual:
2024-12-31 18:15:40,230 - TrainingLogger - INFO - Input 1: הוא נפרד משני ילדיו הנוסעים לחופשת קיץ בבית גרושתו, ומתפנה לחופשה רומנטית עם ססיל
2024-12-31 18:15:40,231 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:15:40,231 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁הוא         | ✗     |
|     1 | ▁בעצמו          | ▁נפרד        | ✗     |
|     2 | ▁ממנו           | ▁משני        | ✗     |
|     3 | ים              | ▁ילדיו       | ✗     |
|     4 | </s>            | ▁הנוסעים     | ✗     |
|     5 | </s>            | ▁לחופש       | ✗     |
|     6 | ת               | ת            | ✓     |
|     7 | ▁הקיץ           | ▁קיץ         | ✗     |
|     8 | </s>            | ▁בבית        | ✗     |
|     9 | ▁הספר           | ▁גרוש        | ✗     |
|    10 | ה               | תו           | ✗     |
|    11 | ▁של             | ,            | ✗     |
|    12 | </s>            | ▁ומ          | ✗     |
|    13 | סביב            | תפנה         | ✗     |
|    14 | ם               | ▁לחופשה      | ✗     |
|    15 | </s>            | ▁רומנטית     | ✗     |
|    16 | </s>            | ▁עם          | ✗     |
|    17 | ▁הזמן           | ▁ססיל        | ✗     |
|    18 | יה              | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | יה              | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 18:15:40,231 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:15:40,236 - TrainingLogger - INFO - Gradient norm: 7.9388
2024-12-31 18:15:46,979 - TrainingLogger - INFO - Step 13010, Batch metrics: Loss: 7.9915, Accuracy: 0.0625, Perplexity: 2955.7227
2024-12-31 18:15:54,217 - TrainingLogger - INFO - Step 13020, Batch metrics: Loss: 7.4667, Accuracy: 0.0943, Perplexity: 1748.8287
2024-12-31 18:16:00,963 - TrainingLogger - INFO - Step 13030, Batch metrics: Loss: 7.5545, Accuracy: 0.0701, Perplexity: 1909.4029
2024-12-31 18:16:08,079 - TrainingLogger - INFO - Step 13040, Batch metrics: Loss: 6.9309, Accuracy: 0.1061, Perplexity: 1023.3908
2024-12-31 18:16:15,698 - TrainingLogger - INFO - Step 13050, Batch metrics: Loss: 7.2734, Accuracy: 0.0829, Perplexity: 1441.4208
2024-12-31 18:16:23,081 - TrainingLogger - INFO - Step 13060, Batch metrics: Loss: 8.0945, Accuracy: 0.0424, Perplexity: 3276.4969
2024-12-31 18:16:30,272 - TrainingLogger - INFO - Step 13070, Batch metrics: Loss: 7.1308, Accuracy: 0.0843, Perplexity: 1249.8571
2024-12-31 18:16:37,292 - TrainingLogger - INFO - Step 13080, Batch metrics: Loss: 7.2077, Accuracy: 0.0463, Perplexity: 1349.7993
2024-12-31 18:16:44,438 - TrainingLogger - INFO - Step 13090, Batch metrics: Loss: 7.5377, Accuracy: 0.0574, Perplexity: 1877.5689
2024-12-31 18:16:51,399 - TrainingLogger - INFO - Step 13100, Batch metrics: Loss: 7.3283, Accuracy: 0.0739, Perplexity: 1522.8547
2024-12-31 18:16:51,399 - TrainingLogger - INFO - Step 13100, Prediction vs Actual:
2024-12-31 18:16:51,399 - TrainingLogger - INFO - Input 1: ראש העיר שדרות, אלון דוידי, אמר הבוקר התחושות שלנו לגבי הפסקת האש המדומה קשות מאוד
2024-12-31 18:16:51,400 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:16:51,400 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כירורגי        | ▁ראש         | ✗     |
|     1 | ▁-              | ▁העיר        | ✗     |
|     2 | ▁הראשונה        | ▁שדר         | ✗     |
|     3 | ▁               | ות           | ✗     |
|     4 | ▁ישראל          | ,            | ✗     |
|     5 | <pad>           | ▁אל          | ✗     |
|     6 | מן              | ון           | ✗     |
|     7 | ▁-              | ▁דויד        | ✗     |
|     8 | סון             | י            | ✗     |
|     9 | ,               | ,            | ✓     |
|    10 | ▁צרפת           | ▁אמר         | ✗     |
|    11 | ▁לי             | ▁הבוקר       | ✗     |
|    12 | ,               | ▁ה           | ✗     |
|    13 | -6              | תחושות       | ✗     |
|    14 | ▁האלה           | ▁שלנו        | ✗     |
|    15 | ▁לא             | ▁לגבי        | ✗     |
|    16 | ▁זה             | ▁הפסקת       | ✗     |
|    17 | ▁אש             | ▁האש         | ✗     |
|    18 | ,               | ▁המ          | ✗     |
|    19 | זעזע            | דומה         | ✗     |
|    20 | ▁שלנו           | ▁קשות        | ✗     |
|    21 | ▁שלנו           | ▁מאוד        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           |              | ✗     |

2024-12-31 18:16:51,400 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:16:51,405 - TrainingLogger - INFO - Gradient norm: 8.6036
2024-12-31 18:16:58,855 - TrainingLogger - INFO - Step 13110, Batch metrics: Loss: 7.6598, Accuracy: 0.0559, Perplexity: 2121.3484
2024-12-31 18:17:05,683 - TrainingLogger - INFO - Step 13120, Batch metrics: Loss: 7.4248, Accuracy: 0.0738, Perplexity: 1677.0592
2024-12-31 18:17:13,140 - TrainingLogger - INFO - Step 13130, Batch metrics: Loss: 7.5108, Accuracy: 0.0776, Perplexity: 1827.7063
2024-12-31 18:17:20,448 - TrainingLogger - INFO - Step 13140, Batch metrics: Loss: 7.3833, Accuracy: 0.0847, Perplexity: 1608.8195
2024-12-31 18:17:27,316 - TrainingLogger - INFO - Step 13150, Batch metrics: Loss: 7.2650, Accuracy: 0.0622, Perplexity: 1429.3684
2024-12-31 18:17:34,782 - TrainingLogger - INFO - Step 13160, Batch metrics: Loss: 7.6120, Accuracy: 0.0325, Perplexity: 2022.2570
2024-12-31 18:17:42,219 - TrainingLogger - INFO - Step 13170, Batch metrics: Loss: 7.0125, Accuracy: 0.0917, Perplexity: 1110.4015
2024-12-31 18:17:49,643 - TrainingLogger - INFO - Step 13180, Batch metrics: Loss: 7.4331, Accuracy: 0.0841, Perplexity: 1690.9969
2024-12-31 18:17:56,924 - TrainingLogger - INFO - Step 13190, Batch metrics: Loss: 7.0934, Accuracy: 0.0915, Perplexity: 1204.0358
2024-12-31 18:18:03,363 - TrainingLogger - INFO - Step 13200, Batch metrics: Loss: 7.4146, Accuracy: 0.0620, Perplexity: 1660.0662
2024-12-31 18:18:03,363 - TrainingLogger - INFO - Step 13200, Prediction vs Actual:
2024-12-31 18:18:03,363 - TrainingLogger - INFO - Input 1: וזה טלי בדיוק מה שיוצא לי מהצעה זו ומהצעות אחרות שאני מקדם
2024-12-31 18:18:03,363 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:18:03,364 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ד               | ▁וזה         | ✗     |
|     1 | ...             | ▁טל          | ✗     |
|     2 | ור              | י            | ✗     |
|     3 | ,               | ▁בדיוק       | ✗     |
|     4 | ▁כמו            | ▁מה          | ✗     |
|     5 | ▁שקרה           | ▁שיוצא       | ✗     |
|     6 | ▁לי             | ▁לי          | ✓     |
|     7 | ▁מזה            | ▁מ           | ✗     |
|     8 | מערכת           | הצעה         | ✗     |
|     9 | ▁זו             | ▁זו          | ✓     |
|    10 | .               | ▁ומ          | ✗     |
|    11 | תבצע            | הצעות        | ✗     |
|    12 | יהם             | ▁אחרות       | ✗     |
|    13 | .               | ▁שאני        | ✗     |
|    14 | ▁לא             | ▁מקדם        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ▁אותן           | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               |              | ✗     |

2024-12-31 18:18:03,364 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:18:03,368 - TrainingLogger - INFO - Gradient norm: 9.7232
2024-12-31 18:18:10,516 - TrainingLogger - INFO - Step 13210, Batch metrics: Loss: 7.5218, Accuracy: 0.0444, Perplexity: 1847.9664
2024-12-31 18:18:18,307 - TrainingLogger - INFO - Step 13220, Batch metrics: Loss: 6.9449, Accuracy: 0.1027, Perplexity: 1037.8556
2024-12-31 18:18:27,020 - TrainingLogger - INFO - Step 13230, Batch metrics: Loss: 7.3200, Accuracy: 0.1027, Perplexity: 1510.1855
2024-12-31 18:18:34,500 - TrainingLogger - INFO - Step 13240, Batch metrics: Loss: 7.1465, Accuracy: 0.1049, Perplexity: 1269.6454
2024-12-31 18:18:41,579 - TrainingLogger - INFO - Step 13250, Batch metrics: Loss: 7.3781, Accuracy: 0.0929, Perplexity: 1600.5846
2024-12-31 18:18:48,876 - TrainingLogger - INFO - Step 13260, Batch metrics: Loss: 7.3402, Accuracy: 0.0753, Perplexity: 1541.0702
2024-12-31 18:18:55,304 - TrainingLogger - INFO - Step 13270, Batch metrics: Loss: 7.2437, Accuracy: 0.0634, Perplexity: 1399.2097
2024-12-31 18:19:02,498 - TrainingLogger - INFO - Step 13280, Batch metrics: Loss: 7.4509, Accuracy: 0.0563, Perplexity: 1721.3913
2024-12-31 18:19:09,145 - TrainingLogger - INFO - Step 13290, Batch metrics: Loss: 7.2292, Accuracy: 0.0780, Perplexity: 1379.1765
2024-12-31 18:19:16,087 - TrainingLogger - INFO - Step 13300, Batch metrics: Loss: 7.7710, Accuracy: 0.0621, Perplexity: 2370.8566
2024-12-31 18:19:16,088 - TrainingLogger - INFO - Step 13300, Prediction vs Actual:
2024-12-31 18:19:16,088 - TrainingLogger - INFO - Input 1: על מעסיק ציבורי מוטלות חובות אחרות? מעסיק ציבורי המעסיק 100 עובדים ויותר מחויב לדאוג לביטוי הולם של לפחות 5 עובדים עם מוגבלות
2024-12-31 18:19:16,088 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:19:16,088 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁על          | ✗     |
|     1 | .               | ▁מעסיק       | ✗     |
|     2 | ▁הו             | ▁ציבורי      | ✗     |
|     3 | .               | ▁מוטל        | ✗     |
|     4 | י               | ות           | ✗     |
|     5 | ▁פלילי          | ▁חובות       | ✗     |
|     6 | ין              | ▁אחרות       | ✗     |
|     7 | ,               | ?            | ✗     |
|     8 | </s>            | ▁מעסיק       | ✗     |
|     9 | ים              | ▁ציבורי      | ✗     |
|    10 | .               | ▁המעסיק      | ✗     |
|    11 | ים              | ▁100         | ✗     |
|    12 | -               | ▁עובדים      | ✗     |
|    13 | ▁פלילי          | ▁ויותר       | ✗     |
|    14 | .               | ▁מחויב       | ✗     |
|    15 | ים              | ▁לדאוג       | ✗     |
|    16 | ▁לכך            | ▁ל           | ✗     |
|    17 | איידס           | ביטוי        | ✗     |
|    18 | ים              | ▁הולם        | ✗     |
|    19 | .               | ▁של          | ✗     |
|    20 | ▁"              | ▁לפחות       | ✗     |
|    21 | .               | ▁5           | ✗     |
|    22 | ▁שנים           | ▁עובדים      | ✗     |
|    23 | .               | ▁עם          | ✗     |
|    24 | ▁כל             | ▁מוגבל       | ✗     |
|    25 | יות             | ות           | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ות              |              | ✗     |

2024-12-31 18:19:16,088 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:19:16,093 - TrainingLogger - INFO - Gradient norm: 10.2412
2024-12-31 18:19:24,012 - TrainingLogger - INFO - Step 13310, Batch metrics: Loss: 7.6286, Accuracy: 0.0643, Perplexity: 2056.0794
2024-12-31 18:19:31,349 - TrainingLogger - INFO - Step 13320, Batch metrics: Loss: 7.3248, Accuracy: 0.1023, Perplexity: 1517.5355
2024-12-31 18:19:38,637 - TrainingLogger - INFO - Step 13330, Batch metrics: Loss: 7.3215, Accuracy: 0.0543, Perplexity: 1512.4137
2024-12-31 18:19:45,597 - TrainingLogger - INFO - Step 13340, Batch metrics: Loss: 7.7488, Accuracy: 0.0932, Perplexity: 2318.7933
2024-12-31 18:19:50,956 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 279552
2024-12-31 18:19:50,956 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 279552

2024-12-31 18:19:50,956 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 47]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 47]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 18:19:50,957 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 18:19:52,981 - TrainingLogger - INFO - Step 13350, Batch metrics: Loss: 7.5411, Accuracy: 0.0807, Perplexity: 1883.9021
2024-12-31 18:20:00,254 - TrainingLogger - INFO - Step 13360, Batch metrics: Loss: 7.6815, Accuracy: 0.0739, Perplexity: 2167.9094
2024-12-31 18:20:07,873 - TrainingLogger - INFO - Step 13370, Batch metrics: Loss: 7.3921, Accuracy: 0.0759, Perplexity: 1623.0396
2024-12-31 18:20:15,204 - TrainingLogger - INFO - Step 13380, Batch metrics: Loss: 7.3512, Accuracy: 0.0857, Perplexity: 1558.1113
2024-12-31 18:20:22,546 - TrainingLogger - INFO - Step 13390, Batch metrics: Loss: 7.3703, Accuracy: 0.0979, Perplexity: 1588.1227
2024-12-31 18:20:30,165 - TrainingLogger - INFO - Step 13400, Batch metrics: Loss: 7.2050, Accuracy: 0.0721, Perplexity: 1346.0868
2024-12-31 18:20:30,166 - TrainingLogger - INFO - Step 13400, Prediction vs Actual:
2024-12-31 18:20:30,166 - TrainingLogger - INFO - Input 1: ילנה טרופנוב, אמו של אלכס, התייחסה לסרטון שפרסם הגיהאד האיסלאמי ואמרה הערב כי לראות אותו היום בטלוויזיה זה מאוד משמח, אבל גם שובר את הלב שהוא עדיין בשבי
2024-12-31 18:20:30,166 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:20:30,166 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁י           | ✗     |
|     1 | ב               | לנה          | ✗     |
|     2 | ה               | ▁טרו         | ✗     |
|     3 | ו               | פנו          | ✗     |
|     4 | סה              | ב            | ✗     |
|     5 | אס              | ,            | ✗     |
|     6 | ▁               | ▁אמו         | ✗     |
|     7 | סה              | ▁של          | ✗     |
|     8 | ▁ישראל          | ▁אלכס        | ✗     |
|     9 | ה               | ,            | ✗     |
|    10 | ▁הוא            | ▁התייחס      | ✗     |
|    11 | ה               | ה            | ✓     |
|    12 | ▁אלי            | ▁לסרט        | ✗     |
|    13 | ון              | ון           | ✓     |
|    14 | ▁"              | ▁ש           | ✗     |
|    15 | פור             | פרסם         | ✗     |
|    16 | ▁את             | ▁הג          | ✗     |
|    17 | או              | יה           | ✗     |
|    18 | ה               | אד           | ✗     |
|    19 | ה               | ▁האי         | ✗     |
|    20 | ה               | סל           | ✗     |
|    21 | אס              | אמי          | ✗     |
|    22 | ▁של             | ▁ואמרה       | ✗     |
|    23 | ▁"              | ▁הערב        | ✗     |
|    24 | ה               | ▁כי          | ✗     |
|    25 | ▁הוא            | ▁לראות       | ✗     |
|    26 | ▁את             | ▁אותו        | ✗     |
|    27 | ▁שוב            | ▁היום        | ✗     |
|    28 | .               | ▁בטלוויזיה   | ✗     |
|    29 | .               | ▁זה          | ✗     |
|    30 | ▁אומר           | ▁מאוד        | ✗     |
|    31 | ▁קשה            | ▁משמח        | ✗     |
|    32 | ה               | ,            | ✗     |
|    33 | </s>            | ▁אבל         | ✗     |
|    34 | ▁לא             | ▁גם          | ✗     |
|    35 | ▁לא             | ▁שובר        | ✗     |
|    36 | ▁את             | ▁את          | ✓     |
|    37 | ▁לבי            | ▁הלב         | ✗     |
|    38 | .               | ▁שהוא        | ✗     |
|    39 | ▁לא             | ▁עדיין       | ✗     |
|    40 | ▁בחיים          | ▁בשבי        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ▁לא             | <pad>        | ✗     |
|    43 | ▁את             | <pad>        | ✗     |
|    44 | ▁לא             | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | ▁הוא            | <pad>        | ✗     |
|    47 | ▁לא             | <pad>        | ✗     |
|    48 | ▁לא             | <pad>        | ✗     |
|    49 | ▁לא             | <pad>        | ✗     |
|    50 | .               | <pad>        | ✗     |
|    51 | ▁לא             | <pad>        | ✗     |
|    52 | ▁לא             |              | ✗     |

2024-12-31 18:20:30,166 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:20:30,171 - TrainingLogger - INFO - Gradient norm: 10.5027
2024-12-31 18:20:37,158 - TrainingLogger - INFO - Step 13410, Batch metrics: Loss: 7.4335, Accuracy: 0.0690, Perplexity: 1691.7002
2024-12-31 18:20:44,131 - TrainingLogger - INFO - Step 13420, Batch metrics: Loss: 7.6404, Accuracy: 0.0314, Perplexity: 2080.5182
2024-12-31 18:20:51,025 - TrainingLogger - INFO - Step 13430, Batch metrics: Loss: 7.1648, Accuracy: 0.0733, Perplexity: 1293.1624
2024-12-31 18:20:57,760 - TrainingLogger - INFO - Step 13440, Batch metrics: Loss: 7.3314, Accuracy: 0.1040, Perplexity: 1527.4670
2024-12-31 18:21:05,123 - TrainingLogger - INFO - Step 13450, Batch metrics: Loss: 7.4437, Accuracy: 0.0802, Perplexity: 1708.9925
2024-12-31 18:21:11,966 - TrainingLogger - INFO - Step 13460, Batch metrics: Loss: 6.9891, Accuracy: 0.0700, Perplexity: 1084.7411
2024-12-31 18:21:18,460 - TrainingLogger - INFO - Step 13470, Batch metrics: Loss: 7.7350, Accuracy: 0.0815, Perplexity: 2287.0286
2024-12-31 18:21:25,730 - TrainingLogger - INFO - Step 13480, Batch metrics: Loss: 6.9439, Accuracy: 0.0800, Perplexity: 1036.8396
2024-12-31 18:21:32,847 - TrainingLogger - INFO - Step 13490, Batch metrics: Loss: 7.4386, Accuracy: 0.0640, Perplexity: 1700.4006
2024-12-31 18:21:39,977 - TrainingLogger - INFO - Step 13500, Batch metrics: Loss: 7.5762, Accuracy: 0.1000, Perplexity: 1951.1780
2024-12-31 18:21:39,977 - TrainingLogger - INFO - Step 13500, Prediction vs Actual:
2024-12-31 18:21:39,977 - TrainingLogger - INFO - Input 1: אמרתי שזה תפקיד שלו לדאוג לאנשים
2024-12-31 18:21:39,978 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:21:39,978 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | י               | ▁אמרתי       | ✗     |
|     1 | ▁לא             | ▁שזה         | ✗     |
|     2 | ▁לא             | ▁תפקיד       | ✗     |
|     3 | .               | ▁שלו         | ✗     |
|     4 | .               | ▁לדאוג       | ✗     |
|     5 | ▁לי             | ▁לאנשים      | ✗     |
|     6 | ▁אחרים          | <pad>        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               |              | ✗     |

2024-12-31 18:21:39,978 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:21:39,983 - TrainingLogger - INFO - Gradient norm: 8.8779
2024-12-31 18:21:47,257 - TrainingLogger - INFO - Step 13510, Batch metrics: Loss: 7.4241, Accuracy: 0.0718, Perplexity: 1675.9072
2024-12-31 18:21:54,609 - TrainingLogger - INFO - Step 13520, Batch metrics: Loss: 7.4388, Accuracy: 0.0458, Perplexity: 1700.7793
2024-12-31 18:22:01,250 - TrainingLogger - INFO - Step 13530, Batch metrics: Loss: 7.1480, Accuracy: 0.0769, Perplexity: 1271.6024
2024-12-31 18:22:07,987 - TrainingLogger - INFO - Step 13540, Batch metrics: Loss: 7.0000, Accuracy: 0.1463, Perplexity: 1096.6112
2024-12-31 18:22:15,523 - TrainingLogger - INFO - Step 13550, Batch metrics: Loss: 7.7895, Accuracy: 0.0563, Perplexity: 2415.0976
2024-12-31 18:22:22,914 - TrainingLogger - INFO - Step 13560, Batch metrics: Loss: 7.1799, Accuracy: 0.0706, Perplexity: 1312.7434
2024-12-31 18:22:29,871 - TrainingLogger - INFO - Step 13570, Batch metrics: Loss: 7.6216, Accuracy: 0.1056, Perplexity: 2041.8764
2024-12-31 18:22:36,714 - TrainingLogger - INFO - Step 13580, Batch metrics: Loss: 7.4005, Accuracy: 0.1049, Perplexity: 1636.8429
2024-12-31 18:22:43,993 - TrainingLogger - INFO - Step 13590, Batch metrics: Loss: 7.7000, Accuracy: 0.0486, Perplexity: 2208.3023
2024-12-31 18:22:50,998 - TrainingLogger - INFO - Step 13600, Batch metrics: Loss: 7.0899, Accuracy: 0.0634, Perplexity: 1199.7855
2024-12-31 18:22:50,999 - TrainingLogger - INFO - Step 13600, Prediction vs Actual:
2024-12-31 18:22:50,999 - TrainingLogger - INFO - Input 1: אל תעזבו אותם דקה אחת לבד, תחבקו אותם מכל הכיוונים כי זה מה שחסר להם, היא אמרה כחלק מהחוויה האישית שלה
2024-12-31 18:22:50,999 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:22:50,999 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אל          | ✗     |
|     1 | אס              | ▁תעזבו       | ✗     |
|     2 | ▁אותי           | ▁אותם        | ✗     |
|     3 | .               | ▁דקה         | ✗     |
|     4 | .               | ▁אחת         | ✗     |
|     5 | .               | ▁לבד         | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | <pad>           | ▁תח          | ✗     |
|     8 | מן              | בקו          | ✗     |
|     9 | ▁אותם           | ▁אותם        | ✓     |
|    10 | .               | ▁מכל         | ✗     |
|    11 | ▁אחד            | ▁הכיוונים    | ✗     |
|    12 | .               | ▁כי          | ✗     |
|    13 | ▁הם             | ▁זה          | ✗     |
|    14 | ▁מה             | ▁מה          | ✓     |
|    15 | ▁שהם            | ▁שחסר        | ✗     |
|    16 | ▁להם            | ▁להם         | ✓     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁היא         | ✗     |
|    19 | ▁לא             | ▁אמרה        | ✗     |
|    20 | ▁לי             | ▁כחלק        | ✗     |
|    21 | ▁מה             | ▁מה          | ✓     |
|    22 | חופש            | חוויה        | ✗     |
|    23 | ▁שלהם           | ▁האישית      | ✗     |
|    24 | ▁שלהם           | ▁שלה         | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            |              | ✗     |

2024-12-31 18:22:50,999 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:22:51,004 - TrainingLogger - INFO - Gradient norm: 9.7783
2024-12-31 18:22:57,640 - TrainingLogger - INFO - Step 13610, Batch metrics: Loss: 7.9648, Accuracy: 0.0788, Perplexity: 2877.9479
2024-12-31 18:23:04,758 - TrainingLogger - INFO - Step 13620, Batch metrics: Loss: 7.2576, Accuracy: 0.0491, Perplexity: 1418.8429
2024-12-31 18:23:11,699 - TrainingLogger - INFO - Step 13630, Batch metrics: Loss: 7.3278, Accuracy: 0.1299, Perplexity: 1522.0453
2024-12-31 18:23:19,004 - TrainingLogger - INFO - Step 13640, Batch metrics: Loss: 7.4931, Accuracy: 0.0773, Perplexity: 1795.5271
2024-12-31 18:23:26,804 - TrainingLogger - INFO - Step 13650, Batch metrics: Loss: 7.5120, Accuracy: 0.0692, Perplexity: 1829.7982
2024-12-31 18:23:35,511 - TrainingLogger - INFO - Step 13660, Batch metrics: Loss: 7.4938, Accuracy: 0.0777, Perplexity: 1796.8641
2024-12-31 18:23:42,783 - TrainingLogger - INFO - Step 13670, Batch metrics: Loss: 7.5200, Accuracy: 0.0546, Perplexity: 1844.5857
2024-12-31 18:23:50,119 - TrainingLogger - INFO - Step 13680, Batch metrics: Loss: 7.7973, Accuracy: 0.0735, Perplexity: 2434.0766
2024-12-31 18:23:57,511 - TrainingLogger - INFO - Step 13690, Batch metrics: Loss: 7.3314, Accuracy: 0.0778, Perplexity: 1527.5879
2024-12-31 18:24:04,955 - TrainingLogger - INFO - Step 13700, Batch metrics: Loss: 6.6262, Accuracy: 0.1373, Perplexity: 754.6385
2024-12-31 18:24:04,955 - TrainingLogger - INFO - Step 13700, Prediction vs Actual:
2024-12-31 18:24:04,955 - TrainingLogger - INFO - Input 1: אף אחד אחר לא יעשה את זה
2024-12-31 18:24:04,956 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:24:04,956 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אף          | ✗     |
|     1 | ▁לא             | ▁אחד         | ✗     |
|     2 | ▁לא             | ▁אחר         | ✗     |
|     3 | ▁לא             | ▁לא          | ✓     |
|     4 | ▁היה            | ▁יעשה        | ✗     |
|     5 | ▁את             | ▁את          | ✓     |
|     6 | ▁זה             | ▁זה          | ✓     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               |              | ✗     |

2024-12-31 18:24:04,956 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:24:04,961 - TrainingLogger - INFO - Gradient norm: 8.5184
2024-12-31 18:24:12,142 - TrainingLogger - INFO - Step 13710, Batch metrics: Loss: 7.5252, Accuracy: 0.0785, Perplexity: 1854.2068
2024-12-31 18:24:19,668 - TrainingLogger - INFO - Step 13720, Batch metrics: Loss: 7.4877, Accuracy: 0.0922, Perplexity: 1785.8622
2024-12-31 18:24:27,128 - TrainingLogger - INFO - Step 13730, Batch metrics: Loss: 7.4223, Accuracy: 0.0928, Perplexity: 1672.9060
2024-12-31 18:24:34,272 - TrainingLogger - INFO - Step 13740, Batch metrics: Loss: 7.4833, Accuracy: 0.0747, Perplexity: 1778.1102
2024-12-31 18:24:41,167 - TrainingLogger - INFO - Step 13750, Batch metrics: Loss: 7.2422, Accuracy: 0.1083, Perplexity: 1397.1629
2024-12-31 18:24:48,112 - TrainingLogger - INFO - Step 13760, Batch metrics: Loss: 7.3030, Accuracy: 0.0947, Perplexity: 1484.7029
2024-12-31 18:24:55,394 - TrainingLogger - INFO - Step 13770, Batch metrics: Loss: 7.6067, Accuracy: 0.0429, Perplexity: 2011.6881
2024-12-31 18:25:02,407 - TrainingLogger - INFO - Step 13780, Batch metrics: Loss: 7.2348, Accuracy: 0.0459, Perplexity: 1386.8269
2024-12-31 18:25:09,690 - TrainingLogger - INFO - Step 13790, Batch metrics: Loss: 7.1264, Accuracy: 0.0745, Perplexity: 1244.3808
2024-12-31 18:25:17,050 - TrainingLogger - INFO - Step 13800, Batch metrics: Loss: 7.4862, Accuracy: 0.0909, Perplexity: 1783.1801
2024-12-31 18:25:17,050 - TrainingLogger - INFO - Step 13800, Prediction vs Actual:
2024-12-31 18:25:17,050 - TrainingLogger - INFO - Input 1: הדגל שמחליף את הימין והשמאל ומצליח לחבר ביניהם הוא לא מרכז חסר תוכן אלא החילוניות
2024-12-31 18:25:17,051 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:25:17,051 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הדגל        | ✗     |
|     1 | ני              | ▁ש           | ✗     |
|     2 | ▁לי             | מחליף        | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | נו              | ▁הי          | ✗     |
|     5 | כר              | מין          | ✗     |
|     6 | .               | ▁וה          | ✗     |
|     7 | מש              | שמאל         | ✗     |
|     8 | נים             | ▁ו           | ✗     |
|     9 | העיר            | מצליח        | ✗     |
|    10 | ▁לה             | ▁לחבר        | ✗     |
|    11 | ▁את             | ▁ביניהם      | ✗     |
|    12 | .               | ▁הוא         | ✗     |
|    13 | ▁לא             | ▁לא          | ✓     |
|    14 | ▁רק             | ▁מרכז        | ✗     |
|    15 | ▁העניינים       | ▁חסר         | ✗     |
|    16 | ▁תועלת          | ▁תוכן        | ✗     |
|    17 | .               | ▁אלא         | ✗     |
|    18 | ▁רק             | ▁החילוני     | ✗     |
|    19 | .               | ות           | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ות              | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ת               | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | ות              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 18:25:17,051 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:25:17,056 - TrainingLogger - INFO - Gradient norm: 9.5762
2024-12-31 18:25:23,825 - TrainingLogger - INFO - Step 13810, Batch metrics: Loss: 7.1752, Accuracy: 0.0376, Perplexity: 1306.6039
2024-12-31 18:25:31,017 - TrainingLogger - INFO - Step 13820, Batch metrics: Loss: 7.7211, Accuracy: 0.0898, Perplexity: 2255.4959
2024-12-31 18:25:38,316 - TrainingLogger - INFO - Step 13830, Batch metrics: Loss: 7.3658, Accuracy: 0.0955, Perplexity: 1581.0195
2024-12-31 18:25:45,293 - TrainingLogger - INFO - Step 13840, Batch metrics: Loss: 7.0665, Accuracy: 0.0949, Perplexity: 1172.0160
2024-12-31 18:25:52,718 - TrainingLogger - INFO - Step 13850, Batch metrics: Loss: 7.4604, Accuracy: 0.0609, Perplexity: 1737.7968
2024-12-31 18:25:59,611 - TrainingLogger - INFO - Step 13860, Batch metrics: Loss: 7.3797, Accuracy: 0.0964, Perplexity: 1603.1427
2024-12-31 18:26:06,944 - TrainingLogger - INFO - Step 13870, Batch metrics: Loss: 7.0983, Accuracy: 0.1162, Perplexity: 1209.9044
2024-12-31 18:26:13,921 - TrainingLogger - INFO - Step 13880, Batch metrics: Loss: 7.4601, Accuracy: 0.0976, Perplexity: 1737.3130
2024-12-31 18:26:21,320 - TrainingLogger - INFO - Step 13890, Batch metrics: Loss: 7.3885, Accuracy: 0.0618, Perplexity: 1617.3288
2024-12-31 18:26:28,231 - TrainingLogger - INFO - Step 13900, Batch metrics: Loss: 7.3430, Accuracy: 0.0617, Perplexity: 1545.3566
2024-12-31 18:26:28,232 - TrainingLogger - INFO - Step 13900, Prediction vs Actual:
2024-12-31 18:26:28,232 - TrainingLogger - INFO - Input 1: בחקירת מחבל חמאס, שחשף דובר צהל, תיאר המחבל איך פעילים מטעם ארגון הטרור שמרו על השערים והכניסות של הבניינים בבית החולים
2024-12-31 18:26:28,232 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:26:28,232 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ב           | ✗     |
|     1 | ▁ס              | חקירת        | ✗     |
|     2 | ו               | ▁מחבל        | ✗     |
|     3 | ים              | ▁ח           | ✗     |
|     4 | מין             | מ            | ✗     |
|     5 | אס              | אס           | ✓     |
|     6 | .               | ,            | ✗     |
|     7 | ה               | ▁ש           | ✗     |
|     8 | נטל             | חשף          | ✗     |
|     9 | ▁את             | ▁דובר        | ✗     |
|    10 | ו               | ▁צ           | ✗     |
|    11 | '               | הל           | ✗     |
|    12 | יזם             | ,            | ✗     |
|    13 | </s>            | ▁תיאר        | ✗     |
|    14 | ו               | ▁המ          | ✗     |
|    15 | חוק             | חבל          | ✗     |
|    16 | ,               | ▁איך         | ✗     |
|    17 | ▁הוא            | ▁פעילים      | ✗     |
|    18 | ▁בעיות          | ▁מטעם        | ✗     |
|    19 | ▁המדינה         | ▁ארגון       | ✗     |
|    20 | ▁המשפט          | ▁הטרור       | ✗     |
|    21 | ▁העולמי         | ▁שמרו        | ✗     |
|    22 | ▁על             | ▁על          | ✓     |
|    23 | ▁תנאי           | ▁השערים      | ✗     |
|    24 | ▁שלו            | ▁ו           | ✗     |
|    25 | קבע             | הכניס        | ✗     |
|    26 | ים              | ות           | ✗     |
|    27 | ▁ל              | ▁של          | ✗     |
|    28 | ▁ארצות          | ▁הבניינים    | ✗     |
|    29 | ▁שלו            | ▁בבית        | ✗     |
|    30 | ▁המשפט          | ▁החולים      | ✗     |
|    31 | ▁המשפט          | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               |              | ✗     |

2024-12-31 18:26:28,232 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:26:28,237 - TrainingLogger - INFO - Gradient norm: 10.1722
2024-12-31 18:26:35,184 - TrainingLogger - INFO - Step 13910, Batch metrics: Loss: 7.0413, Accuracy: 0.1073, Perplexity: 1142.8809
2024-12-31 18:26:43,174 - TrainingLogger - INFO - Step 13920, Batch metrics: Loss: 7.0493, Accuracy: 0.0909, Perplexity: 1152.0956
2024-12-31 18:26:50,494 - TrainingLogger - INFO - Step 13930, Batch metrics: Loss: 6.9994, Accuracy: 0.0957, Perplexity: 1095.9337
2024-12-31 18:26:57,236 - TrainingLogger - INFO - Step 13940, Batch metrics: Loss: 7.0783, Accuracy: 0.0690, Perplexity: 1185.9145
2024-12-31 18:27:04,172 - TrainingLogger - INFO - Step 13950, Batch metrics: Loss: 7.0290, Accuracy: 0.0986, Perplexity: 1128.8735
2024-12-31 18:27:10,852 - TrainingLogger - INFO - Step 13960, Batch metrics: Loss: 7.2214, Accuracy: 0.0788, Perplexity: 1368.3745
2024-12-31 18:27:17,845 - TrainingLogger - INFO - Step 13970, Batch metrics: Loss: 7.4800, Accuracy: 0.0711, Perplexity: 1772.3025
2024-12-31 18:27:24,674 - TrainingLogger - INFO - Step 13980, Batch metrics: Loss: 7.2109, Accuracy: 0.0699, Perplexity: 1354.0760
2024-12-31 18:27:31,936 - TrainingLogger - INFO - Step 13990, Batch metrics: Loss: 7.2272, Accuracy: 0.0828, Perplexity: 1376.4231
2024-12-31 18:27:39,442 - TrainingLogger - INFO - Step 14000, Batch metrics: Loss: 7.2285, Accuracy: 0.0913, Perplexity: 1378.0997
2024-12-31 18:27:39,443 - TrainingLogger - INFO - Step 14000, Prediction vs Actual:
2024-12-31 18:27:39,443 - TrainingLogger - INFO - Input 1: כפי שהחליט הדרג המדיני, צהל ייכנס לרפיח וישמיד את גדודי החמאס הנותרים בה, בין אם תהיה הפוגה זמנית לשחרור חטופינו, ובין אם לאו
2024-12-31 18:27:39,444 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:27:39,444 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כפי         | ✗     |
|     1 | ית              | ▁שהחליט      | ✗     |
|     2 | ,               | ▁הדרג        | ✗     |
|     3 | ה               | ▁המד         | ✗     |
|     4 | מה              | יני          | ✗     |
|     5 | ▁הוא            | ,            | ✗     |
|     6 | ▁הוא            | ▁צ           | ✗     |
|     7 | '               | הל           | ✗     |
|     8 | אס              | ▁ייכנס       | ✗     |
|     9 | ▁ל              | ▁לר          | ✗     |
|    10 | יש              | פיח          | ✗     |
|    11 | ה               | ▁ויש         | ✗     |
|    12 | א               | מיד          | ✗     |
|    13 | ו               | ▁את          | ✗     |
|    14 | ▁כל             | ▁גדוד        | ✗     |
|    15 | ו               | י            | ✗     |
|    16 | ▁ישראל          | ▁הח          | ✗     |
|    17 | מה              | מ            | ✗     |
|    18 | "               | אס           | ✗     |
|    19 | .               | ▁הנותרים     | ✗     |
|    20 | .               | ▁בה          | ✗     |
|    21 | ת               | ,            | ✗     |
|    22 | </s>            | ▁בין         | ✗     |
|    23 | ▁אם             | ▁אם          | ✓     |
|    24 | ▁כן             | ▁תהיה        | ✗     |
|    25 | ▁בטוח           | ▁הפו         | ✗     |
|    26 | מה              | גה           | ✗     |
|    27 | ▁אחת            | ▁זמנית       | ✗     |
|    28 | ,               | ▁לשחרור      | ✗     |
|    29 | ם               | ▁ח           | ✗     |
|    30 | מי              | טופ          | ✗     |
|    31 | ה               | ינו          | ✗     |
|    32 | ים              | ,            | ✗     |
|    33 | </s>            | ▁ובין        | ✗     |
|    34 | ▁אם             | ▁אם          | ✓     |
|    35 | ▁לא             | ▁לא          | ✓     |
|    36 | ▁י              | ו            | ✗     |
|    37 | ▁דווקא          | <pad>        | ✗     |
|    38 | "               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | צ               | <pad>        | ✗     |
|    41 | צ               | <pad>        | ✗     |
|    42 | "               | <pad>        | ✗     |
|    43 | ה               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ה               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | "               |              | ✗     |

2024-12-31 18:27:39,444 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:27:39,449 - TrainingLogger - INFO - Gradient norm: 8.8641
2024-12-31 18:27:46,626 - TrainingLogger - INFO - Step 14010, Batch metrics: Loss: 7.6938, Accuracy: 0.0785, Perplexity: 2194.6860
2024-12-31 18:27:53,826 - TrainingLogger - INFO - Step 14020, Batch metrics: Loss: 7.2559, Accuracy: 0.0816, Perplexity: 1416.4857
2024-12-31 18:28:01,176 - TrainingLogger - INFO - Step 14030, Batch metrics: Loss: 7.7141, Accuracy: 0.0724, Perplexity: 2239.7925
2024-12-31 18:28:09,087 - TrainingLogger - INFO - Step 14040, Batch metrics: Loss: 7.2489, Accuracy: 0.0718, Perplexity: 1406.4896
2024-12-31 18:28:16,605 - TrainingLogger - INFO - Step 14050, Batch metrics: Loss: 7.7940, Accuracy: 0.0766, Perplexity: 2425.9933
2024-12-31 18:28:23,954 - TrainingLogger - INFO - Step 14060, Batch metrics: Loss: 7.4728, Accuracy: 0.0340, Perplexity: 1759.5705
2024-12-31 18:28:31,251 - TrainingLogger - INFO - Step 14070, Batch metrics: Loss: 7.7690, Accuracy: 0.0369, Perplexity: 2366.0895
2024-12-31 18:28:38,119 - TrainingLogger - INFO - Step 14080, Batch metrics: Loss: 7.4397, Accuracy: 0.0858, Perplexity: 1702.2015
2024-12-31 18:28:44,724 - TrainingLogger - INFO - Step 14090, Batch metrics: Loss: 7.0961, Accuracy: 0.0896, Perplexity: 1207.1970
2024-12-31 18:28:51,767 - TrainingLogger - INFO - Step 14100, Batch metrics: Loss: 8.1871, Accuracy: 0.0444, Perplexity: 3594.2200
2024-12-31 18:28:51,767 - TrainingLogger - INFO - Step 14100, Prediction vs Actual:
2024-12-31 18:28:51,767 - TrainingLogger - INFO - Input 1: בחודשים האחרונים לפני שעזבתי גיליתי שיש עוד מישהי בדרגה שלי שמרוויחה פחות מהשאר
2024-12-31 18:28:51,767 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:28:51,767 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בחודשים     | ✗     |
|     1 | ▁האחרונים       | ▁האחרונים    | ✓     |
|     2 | ,               | ▁לפני        | ✗     |
|     3 | ▁זמן            | ▁שעזבתי      | ✗     |
|     4 | ▁את             | ▁גיליתי      | ✗     |
|     5 | ▁את             | ▁שיש         | ✗     |
|     6 | ▁לי             | ▁עוד         | ✗     |
|     7 | ▁אנשים          | ▁מישהי       | ✗     |
|     8 | </s>            | ▁בדרגה       | ✗     |
|     9 | ▁כזאת           | ▁שלי         | ✗     |
|    10 | .               | ▁שמרו        | ✗     |
|    11 | שה              | ו            | ✗     |
|    12 | ▁עליה           | יחה          | ✗     |
|    13 | .               | ▁פחות        | ✗     |
|    14 | ה               | ▁מה          | ✗     |
|    15 | .               | שאר          | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               |              | ✗     |

2024-12-31 18:28:51,768 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:28:51,772 - TrainingLogger - INFO - Gradient norm: 9.7634
2024-12-31 18:28:59,313 - TrainingLogger - INFO - Step 14110, Batch metrics: Loss: 7.5421, Accuracy: 0.0828, Perplexity: 1885.8147
2024-12-31 18:29:06,810 - TrainingLogger - INFO - Step 14120, Batch metrics: Loss: 7.2045, Accuracy: 0.1077, Perplexity: 1345.4259
2024-12-31 18:29:13,973 - TrainingLogger - INFO - Step 14130, Batch metrics: Loss: 7.4358, Accuracy: 0.0659, Perplexity: 1695.5629
2024-12-31 18:29:21,108 - TrainingLogger - INFO - Step 14140, Batch metrics: Loss: 7.3658, Accuracy: 0.0880, Perplexity: 1581.0105
2024-12-31 18:29:28,007 - TrainingLogger - INFO - Step 14150, Batch metrics: Loss: 7.2880, Accuracy: 0.0947, Perplexity: 1462.6168
2024-12-31 18:29:35,355 - TrainingLogger - INFO - Step 14160, Batch metrics: Loss: 7.0887, Accuracy: 0.1081, Perplexity: 1198.3047
2024-12-31 18:29:42,706 - TrainingLogger - INFO - Step 14170, Batch metrics: Loss: 7.2835, Accuracy: 0.0818, Perplexity: 1456.1250
2024-12-31 18:29:49,838 - TrainingLogger - INFO - Step 14180, Batch metrics: Loss: 7.5991, Accuracy: 0.0632, Perplexity: 1996.4766
2024-12-31 18:29:57,072 - TrainingLogger - INFO - Step 14190, Batch metrics: Loss: 7.5126, Accuracy: 0.0784, Perplexity: 1830.8796
2024-12-31 18:30:04,328 - TrainingLogger - INFO - Step 14200, Batch metrics: Loss: 7.3521, Accuracy: 0.1225, Perplexity: 1559.4410
2024-12-31 18:30:04,328 - TrainingLogger - INFO - Step 14200, Prediction vs Actual:
2024-12-31 18:30:04,328 - TrainingLogger - INFO - Input 1: עוזר מזכיר המדינה רטני, המשמש גם כשליח מיוחד של הממשל לסוריה, ביקר עם הבכירים במרכז הרפואי זיו ופגש פצועים ממלחמת האזרחים בסוריה המאושפזים ומטופלים במקום
2024-12-31 18:30:04,329 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:30:04,329 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁עוזר        | ✗     |
|     1 | ▁לחקירה         | ▁מזכיר       | ✗     |
|     2 | ▁המדינה         | ▁המדינה      | ✓     |
|     3 | ▁ארצות          | ▁רט          | ✗     |
|     4 | לנד             | ני           | ✗     |
|     5 | סטר             | ,            | ✗     |
|     6 | ▁ארצות          | ▁המשמש       | ✗     |
|     7 | ▁כ              | ▁גם          | ✗     |
|     8 | ▁כ              | ▁כשליח       | ✗     |
|     9 | ה               | ▁מיוחד       | ✗     |
|    10 | .               | ▁של          | ✗     |
|    11 | ▁ארצות          | ▁הממשל       | ✗     |
|    12 | ▁האמריקאי       | ▁לסור        | ✗     |
|    13 | ד               | יה           | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | </s>            | ▁ביקר        | ✗     |
|    16 | ה               | ▁עם          | ✗     |
|    17 | ▁ישראל          | ▁הבכירים     | ✗     |
|    18 | .               | ▁במרכז       | ✗     |
|    19 | ▁המדינה         | ▁הרפואי      | ✗     |
|    20 | ▁של             | ▁זי          | ✗     |
|    21 | ו               | ו            | ✓     |
|    22 | .               | ▁ו           | ✗     |
|    23 | נבחר            | פגש          | ✗     |
|    24 | ▁עם             | ▁פצועים      | ✗     |
|    25 | .               | ▁מ           | ✗     |
|    26 | מדינות          | מלחמת        | ✗     |
|    27 | ▁אזרחים         | ▁האזרחים     | ✗     |
|    28 | .               | ▁בס          | ✗     |
|    29 | צ               | וריה         | ✗     |
|    30 | ▁הדרומית        | ▁המ          | ✗     |
|    31 | אס              | אושפז        | ✗     |
|    32 | ים              | ים           | ✓     |
|    33 | .               | ▁ו           | ✗     |
|    34 | נוס             | מטופל        | ✗     |
|    35 | ים              | ים           | ✓     |
|    36 | .               | ▁במקום       | ✗     |
|    37 | ▁זה             |              | ✗     |

2024-12-31 18:30:04,329 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:30:04,334 - TrainingLogger - INFO - Gradient norm: 10.0272
2024-12-31 18:30:11,457 - TrainingLogger - INFO - Step 14210, Batch metrics: Loss: 7.2409, Accuracy: 0.0940, Perplexity: 1395.3120
2024-12-31 18:30:18,668 - TrainingLogger - INFO - Step 14220, Batch metrics: Loss: 7.1745, Accuracy: 0.1268, Perplexity: 1305.7450
2024-12-31 18:30:25,565 - TrainingLogger - INFO - Step 14230, Batch metrics: Loss: 7.5483, Accuracy: 0.0699, Perplexity: 1897.4532
2024-12-31 18:30:32,932 - TrainingLogger - INFO - Step 14240, Batch metrics: Loss: 6.8517, Accuracy: 0.1016, Perplexity: 945.4606
2024-12-31 18:30:40,507 - TrainingLogger - INFO - Step 14250, Batch metrics: Loss: 6.7685, Accuracy: 0.1214, Perplexity: 870.0390
2024-12-31 18:30:47,564 - TrainingLogger - INFO - Step 14260, Batch metrics: Loss: 7.0596, Accuracy: 0.1224, Perplexity: 1163.9877
2024-12-31 18:30:54,209 - TrainingLogger - INFO - Step 14270, Batch metrics: Loss: 8.0533, Accuracy: 0.0347, Perplexity: 3144.0303
2024-12-31 18:31:01,353 - TrainingLogger - INFO - Step 14280, Batch metrics: Loss: 7.3490, Accuracy: 0.0777, Perplexity: 1554.5907
2024-12-31 18:31:08,735 - TrainingLogger - INFO - Step 14290, Batch metrics: Loss: 6.3558, Accuracy: 0.1600, Perplexity: 575.8237
2024-12-31 18:31:15,702 - TrainingLogger - INFO - Step 14300, Batch metrics: Loss: 7.1336, Accuracy: 0.0865, Perplexity: 1253.3526
2024-12-31 18:31:15,702 - TrainingLogger - INFO - Step 14300, Prediction vs Actual:
2024-12-31 18:31:15,702 - TrainingLogger - INFO - Input 1: בנוסף, למרות שהיועצים המשפטיים סבורים שהסיכוי קלוש, נתניהו לא ויתר על שאיפתו להציב מצלמות בקלפיות במגזר הערבי
2024-12-31 18:31:15,703 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:31:15,703 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בנוסף       | ✗     |
|     1 | ▁אני            | ,            | ✗     |
|     2 | <pad>           | ▁למרות       | ✗     |
|     3 | ▁זאת            | ▁שהיו        | ✗     |
|     4 | ▁לי             | עצים         | ✗     |
|     5 | ▁שלו            | ▁המשפט       | ✗     |
|     6 | יים             | יים          | ✓     |
|     7 | ,               | ▁סבורים      | ✗     |
|     8 | ▁שהם            | ▁שה          | ✗     |
|     9 | ורים            | סיכוי        | ✗     |
|    10 | ים              | ▁קלוש        | ✗     |
|    11 | ה               | ,            | ✗     |
|    12 | </s>            | ▁נתנ         | ✗     |
|    13 | לו              | יהו          | ✗     |
|    14 | ,               | ▁לא          | ✗     |
|    15 | ו               | ▁ויתר        | ✗     |
|    16 | ▁על             | ▁על          | ✓     |
|    17 | ▁עצמו           | ▁שאיפת       | ✗     |
|    18 | ו               | ו            | ✓     |
|    19 | .               | ▁להציב       | ✗     |
|    20 | ▁את             | ▁מצלמות      | ✗     |
|    21 | ▁אחרות          | ▁בקל         | ✗     |
|    22 | או              | פיות         | ✗     |
|    23 | ▁גדולות         | ▁במ          | ✗     |
|    24 | משל             | גזר          | ✗     |
|    25 | ▁הציבורי        | ▁הערב        | ✗     |
|    26 | יות             | י            | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | יות             | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ות              | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | יות             | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | יות             |              | ✗     |

2024-12-31 18:31:15,703 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:31:15,708 - TrainingLogger - INFO - Gradient norm: 10.1860
2024-12-31 18:31:22,484 - TrainingLogger - INFO - Step 14310, Batch metrics: Loss: 7.0106, Accuracy: 0.0891, Perplexity: 1108.3511
2024-12-31 18:31:29,580 - TrainingLogger - INFO - Step 14320, Batch metrics: Loss: 7.3363, Accuracy: 0.0737, Perplexity: 1535.0453
2024-12-31 18:31:36,818 - TrainingLogger - INFO - Step 14330, Batch metrics: Loss: 6.9341, Accuracy: 0.1053, Perplexity: 1026.7116
2024-12-31 18:31:43,921 - TrainingLogger - INFO - Step 14340, Batch metrics: Loss: 6.7466, Accuracy: 0.1000, Perplexity: 851.1300
2024-12-31 18:31:50,714 - TrainingLogger - INFO - Step 14350, Batch metrics: Loss: 7.3166, Accuracy: 0.0844, Perplexity: 1505.1302
2024-12-31 18:31:58,049 - TrainingLogger - INFO - Step 14360, Batch metrics: Loss: 7.3748, Accuracy: 0.0904, Perplexity: 1595.3278
2024-12-31 18:32:05,009 - TrainingLogger - INFO - Step 14370, Batch metrics: Loss: 7.5182, Accuracy: 0.0809, Perplexity: 1841.3307
2024-12-31 18:32:11,870 - TrainingLogger - INFO - Step 14380, Batch metrics: Loss: 7.0775, Accuracy: 0.1006, Perplexity: 1184.9694
2024-12-31 18:32:19,003 - TrainingLogger - INFO - Step 14390, Batch metrics: Loss: 7.3965, Accuracy: 0.0798, Perplexity: 1630.2158
2024-12-31 18:32:26,268 - TrainingLogger - INFO - Step 14400, Batch metrics: Loss: 6.9083, Accuracy: 0.0764, Perplexity: 1000.5920
2024-12-31 18:32:26,268 - TrainingLogger - INFO - Step 14400, Prediction vs Actual:
2024-12-31 18:32:26,268 - TrainingLogger - INFO - Input 1: זה בעצם מרחב שאף אחד לא טיפל בו - לא על-קרקע, ולא תת-קרקע
2024-12-31 18:32:26,269 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:32:26,269 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זה          | ✗     |
|     1 | </s>            | ▁בעצם        | ✗     |
|     2 | </s>            | ▁מרחב        | ✗     |
|     3 | </s>            | ▁שאף         | ✗     |
|     4 | ▁אחד            | ▁אחד         | ✓     |
|     5 | ▁לא             | ▁לא          | ✓     |
|     6 | ▁יכול           | ▁טיפל        | ✗     |
|     7 | ▁בו             | ▁בו          | ✓     |
|     8 | .               | ▁-           | ✗     |
|     9 | <pad>           | ▁לא          | ✗     |
|    10 | </s>            | ▁על          | ✗     |
|    11 | ה               | -            | ✗     |
|    12 | ידי             | קרקע         | ✗     |
|    13 | י               | ,            | ✗     |
|    14 | <pad>           | ▁ולא         | ✗     |
|    15 | ▁על             | ▁תת          | ✗     |
|    16 | קוף             | -            | ✗     |
|    17 | מ               | קרקע         | ✗     |
|    18 | י               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           |              | ✗     |

2024-12-31 18:32:26,269 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:32:26,274 - TrainingLogger - INFO - Gradient norm: 9.0005
2024-12-31 18:32:33,806 - TrainingLogger - INFO - Step 14410, Batch metrics: Loss: 7.7820, Accuracy: 0.0781, Perplexity: 2397.1775
2024-12-31 18:32:40,518 - TrainingLogger - INFO - Step 14420, Batch metrics: Loss: 7.7375, Accuracy: 0.0710, Perplexity: 2292.6529
2024-12-31 18:32:47,700 - TrainingLogger - INFO - Step 14430, Batch metrics: Loss: 7.1112, Accuracy: 0.0886, Perplexity: 1225.5956
2024-12-31 18:32:54,910 - TrainingLogger - INFO - Step 14440, Batch metrics: Loss: 7.2444, Accuracy: 0.0828, Perplexity: 1400.2649
2024-12-31 18:33:02,232 - TrainingLogger - INFO - Step 14450, Batch metrics: Loss: 7.5355, Accuracy: 0.0645, Perplexity: 1873.3077
2024-12-31 18:33:08,986 - TrainingLogger - INFO - Step 14460, Batch metrics: Loss: 7.5646, Accuracy: 0.0909, Perplexity: 1928.6833
2024-12-31 18:33:15,909 - TrainingLogger - INFO - Step 14470, Batch metrics: Loss: 7.1569, Accuracy: 0.0864, Perplexity: 1282.9435
2024-12-31 18:33:23,005 - TrainingLogger - INFO - Step 14480, Batch metrics: Loss: 6.9647, Accuracy: 0.0909, Perplexity: 1058.5879
2024-12-31 18:33:30,006 - TrainingLogger - INFO - Step 14490, Batch metrics: Loss: 7.5804, Accuracy: 0.0753, Perplexity: 1959.3864
2024-12-31 18:33:37,320 - TrainingLogger - INFO - Step 14500, Batch metrics: Loss: 7.3959, Accuracy: 0.0818, Perplexity: 1629.2273
2024-12-31 18:33:37,320 - TrainingLogger - INFO - Step 14500, Prediction vs Actual:
2024-12-31 18:33:37,320 - TrainingLogger - INFO - Input 1: ביום חמישי טוענת קונסולית שנגחאי המיועדת בנחרצות שהקואליציה מתנכלת בצורה מחפירה לחברה שבאתי ממנה, ולכן היא פורשת
2024-12-31 18:33:37,321 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:33:37,321 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁ביום        | ✗     |
|     1 | ▁-              | ▁חמישי       | ✗     |
|     2 | ▁בערב           | ▁טוענת       | ✗     |
|     3 | .               | ▁            | ✗     |
|     4 | ▁ובכן           | קונסול       | ✗     |
|     5 | ה               | ית           | ✗     |
|     6 | <pad>           | ▁ש           | ✗     |
|     7 | ביע             | נגח          | ✗     |
|     8 | "               | אי           | ✗     |
|     9 | ה               | ▁המיועד      | ✗     |
|    10 | ת               | ת            | ✓     |
|    11 | ▁לו             | ▁בנ          | ✗     |
|    12 | "               | חר           | ✗     |
|    13 | ים              | צות          | ✗     |
|    14 | ה               | ▁שה          | ✗     |
|    15 | ייה             | קו           | ✗     |
|    16 | ה               | אלי          | ✗     |
|    17 | ציה             | ציה          | ✓     |
|    18 | ▁שלהם           | ▁מת          | ✗     |
|    19 | בה              | נכ           | ✗     |
|    20 | ים              | לת           | ✗     |
|    21 | ▁על             | ▁בצורה       | ✗     |
|    22 | ▁זו             | ▁מחפיר       | ✗     |
|    23 | ה               | ה            | ✓     |
|    24 | </s>            | ▁לחברה       | ✗     |
|    25 | .               | ▁שבאתי       | ✗     |
|    26 | ▁אליה           | ▁ממנה        | ✗     |
|    27 | </s>            | ,            | ✗     |
|    28 | </s>            | ▁ולכן        | ✗     |
|    29 | ▁היא            | ▁היא         | ✓     |
|    30 | ▁לא             | ▁פורש        | ✗     |
|    31 | ת               | ת            | ✓     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 18:33:37,321 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:33:37,326 - TrainingLogger - INFO - Gradient norm: 11.0267
2024-12-31 18:33:44,691 - TrainingLogger - INFO - Step 14510, Batch metrics: Loss: 7.0895, Accuracy: 0.0837, Perplexity: 1199.2650
2024-12-31 18:33:51,783 - TrainingLogger - INFO - Step 14520, Batch metrics: Loss: 7.4677, Accuracy: 0.0651, Perplexity: 1750.5966
2024-12-31 18:33:58,929 - TrainingLogger - INFO - Step 14530, Batch metrics: Loss: 7.4084, Accuracy: 0.0599, Perplexity: 1649.7029
2024-12-31 18:34:06,343 - TrainingLogger - INFO - Step 14540, Batch metrics: Loss: 7.3506, Accuracy: 0.0922, Perplexity: 1557.1613
2024-12-31 18:34:13,332 - TrainingLogger - INFO - Step 14550, Batch metrics: Loss: 7.5499, Accuracy: 0.0582, Perplexity: 1900.4921
2024-12-31 18:34:20,059 - TrainingLogger - INFO - Step 14560, Batch metrics: Loss: 7.7377, Accuracy: 0.0738, Perplexity: 2293.2696
2024-12-31 18:34:27,399 - TrainingLogger - INFO - Step 14570, Batch metrics: Loss: 7.6784, Accuracy: 0.0591, Perplexity: 2161.1891
2024-12-31 18:34:35,192 - TrainingLogger - INFO - Step 14580, Batch metrics: Loss: 7.1170, Accuracy: 0.0973, Perplexity: 1232.7468
2024-12-31 18:34:42,071 - TrainingLogger - INFO - Step 14590, Batch metrics: Loss: 7.4447, Accuracy: 0.0663, Perplexity: 1710.8083
2024-12-31 18:34:48,914 - TrainingLogger - INFO - Step 14600, Batch metrics: Loss: 7.4063, Accuracy: 0.0676, Perplexity: 1646.3183
2024-12-31 18:34:48,915 - TrainingLogger - INFO - Step 14600, Prediction vs Actual:
2024-12-31 18:34:48,915 - TrainingLogger - INFO - Input 1: נכון להיום, זוהי הדרך המוצלחת ביותר לשחזור קווי המתאר של העפעפיים העליונים והתחתונים
2024-12-31 18:34:48,915 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:34:48,915 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁נכון        | ✗     |
|     1 | ▁שכן            | ▁להיום       | ✗     |
|     2 | ▁הוא            | ,            | ✗     |
|     3 | ▁הוא            | ▁זוהי        | ✗     |
|     4 | ▁סיבה           | ▁הדרך        | ✗     |
|     5 | ▁היחידה         | ▁המו         | ✗     |
|     6 | של              | צלחת         | ✗     |
|     7 | ▁ביותר          | ▁ביותר       | ✓     |
|     8 | .               | ▁ל           | ✗     |
|     9 | מדינות          | שחזור        | ✗     |
|    10 | .               | ▁קווי        | ✗     |
|    11 | ▁הזמן           | ▁המתאר       | ✗     |
|    12 | .               | ▁של          | ✗     |
|    13 | ▁ה              | ▁הע          | ✗     |
|    14 | מות             | פע           | ✗     |
|    15 | מות             | פי           | ✗     |
|    16 | פים             | ים           | ✗     |
|    17 | .               | ▁העל         | ✗     |
|    18 | יות             | י            | ✗     |
|    19 | ונים            | ונים         | ✓     |
|    20 | .               | ▁וה          | ✗     |
|    21 | טל              | תחתונים      | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | יים             | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | יים             | <pad>        | ✗     |
|    26 | יים             | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | יים             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | בית             | <pad>        | ✗     |
|    34 | פי              | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ▁שלנו           | <pad>        | ✗     |
|    37 | יים             | <pad>        | ✗     |
|    38 | יים             | <pad>        | ✗     |
|    39 | יים             | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | ים              | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | בית             | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | ▁שלנו           | <pad>        | ✗     |
|    48 | .               | <pad>        | ✗     |
|    49 | בית             | <pad>        | ✗     |
|    50 | בית             | <pad>        | ✗     |
|    51 | סי              | <pad>        | ✗     |
|    52 | פי              | <pad>        | ✗     |
|    53 | בי              | <pad>        | ✗     |
|    54 | .               | <pad>        | ✗     |
|    55 | ים              | <pad>        | ✗     |
|    56 | ים              | <pad>        | ✗     |
|    57 | בית             | <pad>        | ✗     |
|    58 | בית             |              | ✗     |

2024-12-31 18:34:48,915 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:34:48,921 - TrainingLogger - INFO - Gradient norm: 9.9225
2024-12-31 18:34:55,759 - TrainingLogger - INFO - Step 14610, Batch metrics: Loss: 8.2789, Accuracy: 0.0331, Perplexity: 3939.7160
2024-12-31 18:35:02,978 - TrainingLogger - INFO - Step 14620, Batch metrics: Loss: 7.6617, Accuracy: 0.0516, Perplexity: 2125.4694
2024-12-31 18:35:10,535 - TrainingLogger - INFO - Step 14630, Batch metrics: Loss: 7.4621, Accuracy: 0.0773, Perplexity: 1740.8182
2024-12-31 18:35:17,884 - TrainingLogger - INFO - Step 14640, Batch metrics: Loss: 7.3895, Accuracy: 0.0829, Perplexity: 1618.8596
2024-12-31 18:35:24,998 - TrainingLogger - INFO - Step 14650, Batch metrics: Loss: 7.3726, Accuracy: 0.0793, Perplexity: 1591.7588
2024-12-31 18:35:32,522 - TrainingLogger - INFO - Step 14660, Batch metrics: Loss: 8.0650, Accuracy: 0.0297, Perplexity: 3181.2975
2024-12-31 18:35:39,590 - TrainingLogger - INFO - Step 14670, Batch metrics: Loss: 7.3425, Accuracy: 0.0759, Perplexity: 1544.5256
2024-12-31 18:35:46,528 - TrainingLogger - INFO - Step 14680, Batch metrics: Loss: 7.7660, Accuracy: 0.0805, Perplexity: 2359.0980
2024-12-31 18:35:53,562 - TrainingLogger - INFO - Step 14690, Batch metrics: Loss: 7.7889, Accuracy: 0.0552, Perplexity: 2413.6252
2024-12-31 18:36:00,464 - TrainingLogger - INFO - Step 14700, Batch metrics: Loss: 7.6180, Accuracy: 0.0688, Perplexity: 2034.5881
2024-12-31 18:36:00,465 - TrainingLogger - INFO - Step 14700, Prediction vs Actual:
2024-12-31 18:36:00,465 - TrainingLogger - INFO - Input 1: בית הדין אמר את דברו וכעת מוטלת על ממשלת ישראל וצהל החובה ליטול אחריות ולחון את החייל, אותו שלחנו לקו החזית להגן על אזרחי ישראל מול מתקפת הטרור הפלסטיני
2024-12-31 18:36:00,466 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:36:00,466 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁בית         | ✗     |
|     1 | ▁-              | ▁הדין        | ✗     |
|     2 | ▁-              | ▁אמר         | ✗     |
|     3 | ▁לא             | ▁את          | ✗     |
|     4 | ▁זה             | ▁דברו        | ✗     |
|     5 | .               | ▁וכעת        | ✗     |
|     6 | ▁הוא            | ▁מוטלת       | ✗     |
|     7 | א               | ▁על          | ✗     |
|     8 | ▁עצמו           | ▁ממשלת       | ✗     |
|     9 | ו               | ▁ישראל       | ✗     |
|    10 | .               | ▁וצ          | ✗     |
|    11 | '               | הל           | ✗     |
|    12 | ▁הוא            | ▁החובה       | ✗     |
|    13 | ▁שלו            | ▁לי          | ✗     |
|    14 | טול             | טול          | ✓     |
|    15 | ▁את             | ▁אחריות      | ✗     |
|    16 | ▁על             | ▁ולח         | ✗     |
|    17 | ה               | ון           | ✗     |
|    18 | ▁על             | ▁את          | ✗     |
|    19 | ▁האחריות        | ▁החייל       | ✗     |
|    20 | ת               | ,            | ✗     |
|    21 | </s>            | ▁אותו        | ✗     |
|    22 | ▁דבר            | ▁שלחנו       | ✗     |
|    23 | ה               | ▁לקו         | ✗     |
|    24 | בה              | ▁החזית       | ✗     |
|    25 | .               | ▁להגן        | ✗     |
|    26 | ▁על             | ▁על          | ✓     |
|    27 | ▁המדינה         | ▁אזרחי       | ✗     |
|    28 | ▁המדינה         | ▁ישראל       | ✗     |
|    29 | .               | ▁מול         | ✗     |
|    30 | נו              | ▁מתקפת       | ✗     |
|    31 | ו               | ▁הטרור       | ✗     |
|    32 | .               | ▁הפלסטי      | ✗     |
|    33 | ת               | ני           | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ה               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | .               |              | ✗     |

2024-12-31 18:36:00,466 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:36:00,471 - TrainingLogger - INFO - Gradient norm: 9.5680
2024-12-31 18:36:07,424 - TrainingLogger - INFO - Step 14710, Batch metrics: Loss: 7.1187, Accuracy: 0.0667, Perplexity: 1234.9018
2024-12-31 18:36:14,697 - TrainingLogger - INFO - Step 14720, Batch metrics: Loss: 7.1771, Accuracy: 0.0648, Perplexity: 1309.1378
2024-12-31 18:36:22,354 - TrainingLogger - INFO - Step 14730, Batch metrics: Loss: 6.9769, Accuracy: 0.1294, Perplexity: 1071.5689
2024-12-31 18:36:29,671 - TrainingLogger - INFO - Step 14740, Batch metrics: Loss: 7.7611, Accuracy: 0.0403, Perplexity: 2347.5376
2024-12-31 18:36:36,379 - TrainingLogger - INFO - Step 14750, Batch metrics: Loss: 7.2026, Accuracy: 0.1071, Perplexity: 1342.9364
2024-12-31 18:36:43,213 - TrainingLogger - INFO - Step 14760, Batch metrics: Loss: 7.0858, Accuracy: 0.0865, Perplexity: 1194.8886
2024-12-31 18:36:50,295 - TrainingLogger - INFO - Step 14770, Batch metrics: Loss: 7.6078, Accuracy: 0.0545, Perplexity: 2013.9138
2024-12-31 18:36:57,491 - TrainingLogger - INFO - Step 14780, Batch metrics: Loss: 7.6413, Accuracy: 0.0593, Perplexity: 2082.4109
2024-12-31 18:37:04,011 - TrainingLogger - INFO - Step 14790, Batch metrics: Loss: 7.5389, Accuracy: 0.0611, Perplexity: 1879.7977
2024-12-31 18:37:11,283 - TrainingLogger - INFO - Step 14800, Batch metrics: Loss: 7.7007, Accuracy: 0.0500, Perplexity: 2209.9646
2024-12-31 18:37:11,283 - TrainingLogger - INFO - Step 14800, Prediction vs Actual:
2024-12-31 18:37:11,284 - TrainingLogger - INFO - Input 1: בכל השטח המשוחרר תוחל מיד ריבונות ישראלית מלאה, נכתב במצע - כולל במזרח ירושלים וברמת הגולן
2024-12-31 18:37:11,284 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:37:11,284 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בכל         | ✗     |
|     1 | .               | ▁השטח        | ✗     |
|     2 | ▁-              | ▁ה           | ✗     |
|     3 | מוקדם           | משוחרר       | ✗     |
|     4 | ים              | ▁תו          | ✗     |
|     5 | ה               | חל           | ✗     |
|     6 | ה               | ▁מיד         | ✗     |
|     7 | ▁-              | ▁ריבונות     | ✗     |
|     8 | .               | ▁ישראל       | ✗     |
|     9 | .               | ית           | ✗     |
|    10 | .               | ▁מלאה        | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | <pad>           | ▁נכתב        | ✗     |
|    13 | ה               | ▁במ          | ✗     |
|    14 | משל             | צע           | ✗     |
|    15 | ▁צבאי           | ▁-           | ✗     |
|    16 | -               | ▁כולל        | ✗     |
|    17 | ▁כל             | ▁במזרח       | ✗     |
|    18 | ▁התיכון         | ▁ירושלים     | ✗     |
|    19 | .               | ▁וב          | ✗     |
|    20 | צפון            | רמת          | ✗     |
|    21 | ה               | ▁הגו         | ✗     |
|    22 | ון              | לן           | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2024-12-31 18:37:11,284 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:37:11,289 - TrainingLogger - INFO - Gradient norm: 9.6019
2024-12-31 18:37:18,509 - TrainingLogger - INFO - Step 14810, Batch metrics: Loss: 7.3735, Accuracy: 0.0844, Perplexity: 1593.1438
2024-12-31 18:37:25,364 - TrainingLogger - INFO - Step 14820, Batch metrics: Loss: 6.9339, Accuracy: 0.1029, Perplexity: 1026.5236
2024-12-31 18:37:32,452 - TrainingLogger - INFO - Step 14830, Batch metrics: Loss: 7.8080, Accuracy: 0.0476, Perplexity: 2460.2734
2024-12-31 18:37:39,896 - TrainingLogger - INFO - Step 14840, Batch metrics: Loss: 7.3867, Accuracy: 0.0788, Perplexity: 1614.3655
2024-12-31 18:37:47,096 - TrainingLogger - INFO - Step 14850, Batch metrics: Loss: 7.3428, Accuracy: 0.1124, Perplexity: 1545.1060
2024-12-31 18:37:54,323 - TrainingLogger - INFO - Step 14860, Batch metrics: Loss: 6.9621, Accuracy: 0.1414, Perplexity: 1055.8566
2024-12-31 18:38:01,288 - TrainingLogger - INFO - Step 14870, Batch metrics: Loss: 7.4515, Accuracy: 0.0625, Perplexity: 1722.4834
2024-12-31 18:38:08,342 - TrainingLogger - INFO - Step 14880, Batch metrics: Loss: 7.8864, Accuracy: 0.0417, Perplexity: 2660.8139
2024-12-31 18:38:15,460 - TrainingLogger - INFO - Step 14890, Batch metrics: Loss: 7.2333, Accuracy: 0.1000, Perplexity: 1384.7474
2024-12-31 18:38:22,324 - TrainingLogger - INFO - Step 14900, Batch metrics: Loss: 7.6115, Accuracy: 0.0861, Perplexity: 2021.3883
2024-12-31 18:38:22,324 - TrainingLogger - INFO - Step 14900, Prediction vs Actual:
2024-12-31 18:38:22,325 - TrainingLogger - INFO - Input 1: מה אני הצעתי? לבוא למרכז הליכוד ולהציל את המדינה מבחירות שלישיות- כל אותם טוענים לכתר יושבים עכשיו בשקט ונותנים להוביל לבחירותאני לא מחלק ציונים, הציבור שופט את כולנו
2024-12-31 18:38:22,325 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:38:22,325 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מה          | ✗     |
|     1 | י               | ▁אני         | ✗     |
|     2 | ▁לא             | ▁הצעתי       | ✗     |
|     3 | ▁את             | ?            | ✗     |
|     4 | </s>            | ▁לבוא        | ✗     |
|     5 | ▁לכאן           | ▁למרכז       | ✗     |
|     6 | ▁המשפט          | ▁הלי         | ✗     |
|     7 | גה              | כו           | ✗     |
|     8 | ף               | ד            | ✗     |
|     9 | </s>            | ▁ולהציל      | ✗     |
|    10 | ▁את             | ▁את          | ✓     |
|    11 | ▁זה             | ▁המדינה      | ✗     |
|    12 | ▁הזאת           | ▁מ           | ✗     |
|    13 | ועצת            | בחירות       | ✗     |
|    14 | ▁חדשות          | ▁שלישי       | ✗     |
|    15 | ות              | ות           | ✓     |
|    16 | </s>            | -            | ✗     |
|    17 | </s>            | ▁כל          | ✗     |
|    18 | ▁היום           | ▁אותם        | ✗     |
|    19 | ▁ימים           | ▁טוענים      | ✗     |
|    20 | </s>            | ▁ל           | ✗     |
|    21 | סקר             | כתר          | ✗     |
|    22 | ים              | ▁יושבים      | ✗     |
|    23 | ▁בראש           | ▁עכשיו       | ✗     |
|    24 | </s>            | ▁בשקט        | ✗     |
|    25 | .               | ▁ו           | ✗     |
|    26 | שמאל            | נותנים       | ✗     |
|    27 | ▁בראש           | ▁להוביל      | ✗     |
|    28 | ו               | ▁ל           | ✗     |
|    29 | אזרחים          | בחירות       | ✗     |
|    30 | .               | אני          | ✗     |
|    31 | ם               | ▁לא          | ✗     |
|    32 | ת               | ▁מחלק        | ✗     |
|    33 | ים              | ▁ציונים      | ✗     |
|    34 | ▁טובים          | ,            | ✗     |
|    35 | </s>            | ▁הציבור      | ✗     |
|    36 | .               | ▁שופט        | ✗     |
|    37 | ת               | ▁את          | ✗     |
|    38 | ▁המדינה         | ▁כולנו       | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 18:38:22,325 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:38:22,330 - TrainingLogger - INFO - Gradient norm: 8.8752
2024-12-31 18:38:29,252 - TrainingLogger - INFO - Step 14910, Batch metrics: Loss: 7.0434, Accuracy: 0.0802, Perplexity: 1145.3053
2024-12-31 18:38:36,679 - TrainingLogger - INFO - Step 14920, Batch metrics: Loss: 7.1439, Accuracy: 0.0837, Perplexity: 1266.3146
2024-12-31 18:38:43,839 - TrainingLogger - INFO - Step 14930, Batch metrics: Loss: 6.9835, Accuracy: 0.0773, Perplexity: 1078.7319
2024-12-31 18:38:50,877 - TrainingLogger - INFO - Step 14940, Batch metrics: Loss: 7.5644, Accuracy: 0.0867, Perplexity: 1928.2962
2024-12-31 18:38:58,416 - TrainingLogger - INFO - Step 14950, Batch metrics: Loss: 7.3057, Accuracy: 0.0833, Perplexity: 1488.6933
2024-12-31 18:39:05,697 - TrainingLogger - INFO - Step 14960, Batch metrics: Loss: 7.2817, Accuracy: 0.0652, Perplexity: 1453.4036
2024-12-31 18:39:12,362 - TrainingLogger - INFO - Step 14970, Batch metrics: Loss: 7.1997, Accuracy: 0.0946, Perplexity: 1339.0250
2024-12-31 18:39:19,374 - TrainingLogger - INFO - Step 14980, Batch metrics: Loss: 7.6260, Accuracy: 0.0543, Perplexity: 2050.7900
2024-12-31 18:39:26,975 - TrainingLogger - INFO - Step 14990, Batch metrics: Loss: 6.9018, Accuracy: 0.1067, Perplexity: 994.1109
2024-12-31 18:39:33,841 - TrainingLogger - INFO - Step 15000, Batch metrics: Loss: 7.6224, Accuracy: 0.0774, Perplexity: 2043.4806
2024-12-31 18:39:33,842 - TrainingLogger - INFO - Step 15000, Prediction vs Actual:
2024-12-31 18:39:33,842 - TrainingLogger - INFO - Input 1: הם יידעו לבצע במקומנו פעולות בסיסיות כמו כביסה, קיפול וגיהוץ
2024-12-31 18:39:33,842 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:39:33,842 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הם          | ✗     |
|     1 | .               | ▁יידעו       | ✗     |
|     2 | .               | ▁לבצע        | ✗     |
|     3 | ▁את             | ▁במ          | ✗     |
|     4 | טל              | קו           | ✗     |
|     5 | .               | מנו          | ✗     |
|     6 | .               | ▁פעולות      | ✗     |
|     7 | ▁נוספות         | ▁בסיסי       | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | .               | ▁כמו         | ✗     |
|    10 | ▁"              | ▁כביסה       | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | <pad>           | ▁קי          | ✗     |
|    13 | מא              | פול          | ✗     |
|    14 | ,               | ▁וג          | ✗     |
|    15 | ונה             | יה           | ✗     |
|    16 | ות              | וץ           | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ,               |              | ✗     |

2024-12-31 18:39:33,842 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:39:33,847 - TrainingLogger - INFO - Gradient norm: 10.7925
2024-12-31 18:39:41,016 - TrainingLogger - INFO - Step 15010, Batch metrics: Loss: 7.8129, Accuracy: 0.0655, Perplexity: 2472.2026
2024-12-31 18:39:47,408 - TrainingLogger - INFO - Step 15020, Batch metrics: Loss: 7.2564, Accuracy: 0.0839, Perplexity: 1417.0850
2024-12-31 18:39:54,025 - TrainingLogger - INFO - Step 15030, Batch metrics: Loss: 7.6151, Accuracy: 0.0807, Perplexity: 2028.5597
2024-12-31 18:40:01,147 - TrainingLogger - INFO - Step 15040, Batch metrics: Loss: 6.9952, Accuracy: 0.1170, Perplexity: 1091.3930
2024-12-31 18:40:08,034 - TrainingLogger - INFO - Step 15050, Batch metrics: Loss: 7.8044, Accuracy: 0.0491, Perplexity: 2451.4121
2024-12-31 18:40:15,139 - TrainingLogger - INFO - Step 15060, Batch metrics: Loss: 7.7005, Accuracy: 0.0508, Perplexity: 2209.4641
2024-12-31 18:40:22,343 - TrainingLogger - INFO - Step 15070, Batch metrics: Loss: 7.1874, Accuracy: 0.0960, Perplexity: 1322.6041
2024-12-31 18:40:29,389 - TrainingLogger - INFO - Step 15080, Batch metrics: Loss: 7.5334, Accuracy: 0.0915, Perplexity: 1869.4082
2024-12-31 18:40:36,347 - TrainingLogger - INFO - Step 15090, Batch metrics: Loss: 6.9869, Accuracy: 0.1235, Perplexity: 1082.3783
2024-12-31 18:40:43,466 - TrainingLogger - INFO - Step 15100, Batch metrics: Loss: 7.1730, Accuracy: 0.0750, Perplexity: 1303.7175
2024-12-31 18:40:43,466 - TrainingLogger - INFO - Step 15100, Prediction vs Actual:
2024-12-31 18:40:43,466 - TrainingLogger - INFO - Input 1: באחד מנאומיו הראשונים של הרמטכל הקודם, רב אלוף אביב כוכבי , הוא ביקש למתג מחדש, ולא מטעמי יחסי ציבור, את ארגוני הטרור שמאיימים על ישראל
2024-12-31 18:40:43,467 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:40:43,467 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁באחד        | ✗     |
|     1 | .               | ▁מ           | ✗     |
|     2 | .               | נאו          | ✗     |
|     3 | ם               | מי           | ✗     |
|     4 | ▁המפלגה         | ו            | ✗     |
|     5 | ▁האחרים         | ▁הראשונים    | ✗     |
|     6 | ,               | ▁של          | ✗     |
|     7 | ▁ארצות          | ▁הר          | ✗     |
|     8 | לנד             | מט           | ✗     |
|     9 | אס              | כל           | ✗     |
|    10 | ים              | ▁הקודם       | ✗     |
|    11 | ,               | ,            | ✓     |
|    12 | </s>            | ▁רב          | ✗     |
|    13 | ד               | ▁אלוף        | ✗     |
|    14 | ,               | ▁אביב        | ✗     |
|    15 | ה               | ▁כוכבי       | ✗     |
|    16 | ים              | ▁,           | ✗     |
|    17 | ב               | ▁הוא         | ✗     |
|    18 | ו               | ▁ביקש        | ✗     |
|    19 | ▁ממני           | ▁למת         | ✗     |
|    20 | ים              | ג            | ✗     |
|    21 | .               | ▁מחדש        | ✗     |
|    22 | ▁את             | ,            | ✗     |
|    23 | </s>            | ▁ולא         | ✗     |
|    24 | ▁קיבל           | ▁מטע         | ✗     |
|    25 | מו              | מי           | ✗     |
|    26 | .               | ▁יחסי        | ✗     |
|    27 | ו               | ▁ציבור       | ✗     |
|    28 | ▁רבים           | ,            | ✗     |
|    29 | </s>            | ▁את          | ✗     |
|    30 | ▁עצמו           | ▁ארגוני      | ✗     |
|    31 | ם               | ▁הטרור       | ✗     |
|    32 | ▁שלו            | ▁שמא         | ✗     |
|    33 | יים             | י            | ✗     |
|    34 | יש              | ימים         | ✗     |
|    35 | ▁את             | ▁על          | ✗     |
|    36 | ▁ידי            | ▁ישראל       | ✗     |
|    37 | ים              |              | ✗     |

2024-12-31 18:40:43,467 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:40:43,472 - TrainingLogger - INFO - Gradient norm: 9.0947
2024-12-31 18:40:50,505 - TrainingLogger - INFO - Step 15110, Batch metrics: Loss: 7.4325, Accuracy: 0.0562, Perplexity: 1690.0755
2024-12-31 18:40:57,905 - TrainingLogger - INFO - Step 15120, Batch metrics: Loss: 8.0089, Accuracy: 0.0759, Perplexity: 3007.5945
2024-12-31 18:41:05,196 - TrainingLogger - INFO - Step 15130, Batch metrics: Loss: 8.0516, Accuracy: 0.0588, Perplexity: 3138.7097
2024-12-31 18:41:12,538 - TrainingLogger - INFO - Step 15140, Batch metrics: Loss: 7.9713, Accuracy: 0.0699, Perplexity: 2896.5587
2024-12-31 18:41:20,032 - TrainingLogger - INFO - Step 15150, Batch metrics: Loss: 7.2110, Accuracy: 0.0812, Perplexity: 1354.1941
2024-12-31 18:41:27,051 - TrainingLogger - INFO - Step 15160, Batch metrics: Loss: 7.2287, Accuracy: 0.0637, Perplexity: 1378.4467
2024-12-31 18:41:34,554 - TrainingLogger - INFO - Step 15170, Batch metrics: Loss: 7.0437, Accuracy: 0.0944, Perplexity: 1145.5702
2024-12-31 18:41:41,609 - TrainingLogger - INFO - Step 15180, Batch metrics: Loss: 7.0452, Accuracy: 0.1190, Perplexity: 1147.3912
2024-12-31 18:41:48,794 - TrainingLogger - INFO - Step 15190, Batch metrics: Loss: 6.9272, Accuracy: 0.0759, Perplexity: 1019.6280
2024-12-31 18:41:56,331 - TrainingLogger - INFO - Step 15200, Batch metrics: Loss: 7.7101, Accuracy: 0.0798, Perplexity: 2230.6870
2024-12-31 18:41:56,332 - TrainingLogger - INFO - Step 15200, Prediction vs Actual:
2024-12-31 18:41:56,332 - TrainingLogger - INFO - Input 1: שי התייחס גם לכך שחבר הכנסת עמיחי שיקלי מימינה כינה אותו דובר אשף, אחרי שטען בריאיון שהסטטוס-קוו בהר הבית השתנה בעקבות עלייה של יותר יהודים אליו
2024-12-31 18:41:56,332 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:41:56,332 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שי          | ✗     |
|     1 | ב               | ▁התייחס      | ✗     |
|     2 | ▁אליו           | ▁גם          | ✗     |
|     3 | ▁לו             | ▁לכך         | ✗     |
|     4 | ,               | ▁שחבר        | ✗     |
|     5 | ה               | ▁הכנסת       | ✗     |
|     6 | ▁שלך            | ▁עמי         | ✗     |
|     7 | ▁לא             | חי           | ✗     |
|     8 | ,               | ▁שי          | ✗     |
|     9 | ורה             | קלי          | ✗     |
|    10 | ון              | ▁מי          | ✗     |
|    11 | מן              | מינה         | ✗     |
|    12 | ▁אותו           | ▁כינה        | ✗     |
|    13 | ▁אותו           | ▁אותו        | ✓     |
|    14 | ▁"              | ▁דובר        | ✗     |
|    15 | ▁אמת            | ▁אש          | ✗     |
|    16 | </s>            | ף            | ✗     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁אחרי        | ✗     |
|    19 | ▁שהוא           | ▁ש           | ✗     |
|    20 | יבה             | טען          | ✗     |
|    21 | ▁הוא            | ▁בריא        | ✗     |
|    22 | ▁ושלם           | יון          | ✗     |
|    23 | ▁גבוה           | ▁שה          | ✗     |
|    24 | ות              | סט           | ✗     |
|    25 | ת               | טוס          | ✗     |
|    26 | ה               | -            | ✗     |
|    27 | ה               | קו           | ✗     |
|    28 | ▁שלו            | ו            | ✗     |
|    29 | ▁הוא            | ▁בהר         | ✗     |
|    30 | ▁לא             | ▁הבית        | ✗     |
|    31 | ▁שלו            | ▁השתנה       | ✗     |
|    32 | </s>            | ▁בעקבות      | ✗     |
|    33 | ▁זאת            | ▁עלייה       | ✗     |
|    34 | ▁בדרגה          | ▁של          | ✗     |
|    35 | ▁ה              | ▁יותר        | ✗     |
|    36 | ▁מ              | ▁יהודים      | ✗     |
|    37 | ,               | ▁אליו        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            |              | ✗     |

2024-12-31 18:41:56,333 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:41:56,338 - TrainingLogger - INFO - Gradient norm: 12.8476
2024-12-31 18:42:03,462 - TrainingLogger - INFO - Step 15210, Batch metrics: Loss: 7.5962, Accuracy: 0.0681, Perplexity: 1990.5963
2024-12-31 18:42:10,726 - TrainingLogger - INFO - Step 15220, Batch metrics: Loss: 7.1824, Accuracy: 0.1061, Perplexity: 1316.0238
2024-12-31 18:42:18,354 - TrainingLogger - INFO - Step 15230, Batch metrics: Loss: 7.3313, Accuracy: 0.0818, Perplexity: 1527.3592
2024-12-31 18:42:25,636 - TrainingLogger - INFO - Step 15240, Batch metrics: Loss: 7.7055, Accuracy: 0.0893, Perplexity: 2220.5160
2024-12-31 18:42:32,418 - TrainingLogger - INFO - Step 15250, Batch metrics: Loss: 7.2178, Accuracy: 0.0705, Perplexity: 1363.4200
2024-12-31 18:42:39,468 - TrainingLogger - INFO - Step 15260, Batch metrics: Loss: 7.0630, Accuracy: 0.1046, Perplexity: 1167.9150
2024-12-31 18:42:47,023 - TrainingLogger - INFO - Step 15270, Batch metrics: Loss: 7.4511, Accuracy: 0.0647, Perplexity: 1721.7796
2024-12-31 18:42:54,541 - TrainingLogger - INFO - Step 15280, Batch metrics: Loss: 7.2353, Accuracy: 0.0952, Perplexity: 1387.5142
2024-12-31 18:43:01,596 - TrainingLogger - INFO - Step 15290, Batch metrics: Loss: 7.5345, Accuracy: 0.0503, Perplexity: 1871.5443
2024-12-31 18:43:09,339 - TrainingLogger - INFO - Step 15300, Batch metrics: Loss: 6.8485, Accuracy: 0.1031, Perplexity: 942.4412
2024-12-31 18:43:09,339 - TrainingLogger - INFO - Step 15300, Prediction vs Actual:
2024-12-31 18:43:09,339 - TrainingLogger - INFO - Input 1: מי שמחפש את שורשי המאבק הפנים-איסלאמי שאנו עדים לו בשנים האחרונות, ימצא אותם כאן
2024-12-31 18:43:09,340 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:43:09,340 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מי          | ✗     |
|     1 | ▁זה             | ▁שמחפש       | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁זה             | ▁שורש        | ✗     |
|     4 | .               | י            | ✗     |
|     5 | .               | ▁המאבק       | ✗     |
|     6 | ,               | ▁הפנים       | ✗     |
|     7 | ▁שלו            | -            | ✗     |
|     8 | ה               | אי           | ✗     |
|     9 | נטל             | סל           | ✗     |
|    10 | ם               | אמי          | ✗     |
|    11 | ,               | ▁שאנו        | ✗     |
|    12 | ▁עובדים         | ▁עדים        | ✗     |
|    13 | ▁לו             | ▁לו          | ✓     |
|    14 | .               | ▁בשנים       | ✗     |
|    15 | ▁האחרונות       | ▁האחרונות    | ✓     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁ימצא        | ✗     |
|    18 | ▁את             | ▁אותם        | ✗     |
|    19 | .               | ▁כאן         | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            |              | ✗     |

2024-12-31 18:43:09,340 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:43:09,345 - TrainingLogger - INFO - Gradient norm: 11.7040
2024-12-31 18:43:16,090 - TrainingLogger - INFO - Step 15310, Batch metrics: Loss: 6.6213, Accuracy: 0.1143, Perplexity: 750.9423
2024-12-31 18:43:23,554 - TrainingLogger - INFO - Step 15320, Batch metrics: Loss: 7.2918, Accuracy: 0.0431, Perplexity: 1468.2545
2024-12-31 18:43:30,660 - TrainingLogger - INFO - Step 15330, Batch metrics: Loss: 7.1745, Accuracy: 0.0548, Perplexity: 1305.7064
2024-12-31 18:43:38,306 - TrainingLogger - INFO - Step 15340, Batch metrics: Loss: 7.2103, Accuracy: 0.0687, Perplexity: 1353.2407
2024-12-31 18:43:45,005 - TrainingLogger - INFO - Step 15350, Batch metrics: Loss: 7.1344, Accuracy: 0.0604, Perplexity: 1254.4061
2024-12-31 18:43:52,380 - TrainingLogger - INFO - Step 15360, Batch metrics: Loss: 7.6450, Accuracy: 0.0643, Perplexity: 2090.1636
2024-12-31 18:43:59,546 - TrainingLogger - INFO - Step 15370, Batch metrics: Loss: 7.7919, Accuracy: 0.0615, Perplexity: 2420.9480
2024-12-31 18:44:07,317 - TrainingLogger - INFO - Step 15380, Batch metrics: Loss: 7.0803, Accuracy: 0.0918, Perplexity: 1188.3214
2024-12-31 18:44:13,815 - TrainingLogger - INFO - Step 15390, Batch metrics: Loss: 7.3600, Accuracy: 0.0743, Perplexity: 1571.8353
2024-12-31 18:44:21,104 - TrainingLogger - INFO - Step 15400, Batch metrics: Loss: 7.7472, Accuracy: 0.0547, Perplexity: 2315.0083
2024-12-31 18:44:21,104 - TrainingLogger - INFO - Step 15400, Prediction vs Actual:
2024-12-31 18:44:21,104 - TrainingLogger - INFO - Input 1: לאדם השומר על עצמאותו מתאפשרת שמירה על איכות חייו ללא יצירת תלות באחר
2024-12-31 18:44:21,105 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:44:21,105 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לאדם        | ✗     |
|     1 | ▁יש             | ▁השומר       | ✗     |
|     2 | ▁-              | ▁על          | ✗     |
|     3 | ▁זה             | ▁עצמאות      | ✗     |
|     4 | ▁-              | ו            | ✗     |
|     5 | ▁לא             | ▁מתאפשר      | ✗     |
|     6 | .               | ת            | ✗     |
|     7 | .               | ▁שמירה       | ✗     |
|     8 | ▁על             | ▁על          | ✓     |
|     9 | ▁איכות          | ▁איכות       | ✓     |
|    10 | ▁הסביבה         | ▁חייו        | ✗     |
|    11 | .               | ▁ללא         | ✗     |
|    12 | ▁תנאי           | ▁יצירת       | ✗     |
|    13 | ▁יחסים          | ▁תלות        | ✗     |
|    14 | ▁רבה            | ▁ב           | ✗     |
|    15 | רווח            | אחר          | ✗     |
|    16 | ▁כך             | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           |              | ✗     |

2024-12-31 18:44:21,105 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:44:21,110 - TrainingLogger - INFO - Gradient norm: 8.5813
2024-12-31 18:44:28,232 - TrainingLogger - INFO - Step 15410, Batch metrics: Loss: 7.5118, Accuracy: 0.0796, Perplexity: 1829.4589
2024-12-31 18:44:35,413 - TrainingLogger - INFO - Step 15420, Batch metrics: Loss: 7.5102, Accuracy: 0.0462, Perplexity: 1826.6485
2024-12-31 18:44:42,455 - TrainingLogger - INFO - Step 15430, Batch metrics: Loss: 7.4626, Accuracy: 0.0791, Perplexity: 1741.6950
2024-12-31 18:44:49,627 - TrainingLogger - INFO - Step 15440, Batch metrics: Loss: 7.2298, Accuracy: 0.0734, Perplexity: 1380.0126
2024-12-31 18:44:57,130 - TrainingLogger - INFO - Step 15450, Batch metrics: Loss: 7.5405, Accuracy: 0.0591, Perplexity: 1882.8424
2024-12-31 18:45:04,280 - TrainingLogger - INFO - Step 15460, Batch metrics: Loss: 7.2151, Accuracy: 0.0865, Perplexity: 1359.7822
2024-12-31 18:45:11,635 - TrainingLogger - INFO - Step 15470, Batch metrics: Loss: 7.2643, Accuracy: 0.0828, Perplexity: 1428.3920
2024-12-31 18:45:18,606 - TrainingLogger - INFO - Step 15480, Batch metrics: Loss: 7.5881, Accuracy: 0.0847, Perplexity: 1974.6326
2024-12-31 18:45:26,087 - TrainingLogger - INFO - Step 15490, Batch metrics: Loss: 7.4969, Accuracy: 0.0796, Perplexity: 1802.4222
2024-12-31 18:45:33,092 - TrainingLogger - INFO - Step 15500, Batch metrics: Loss: 7.6290, Accuracy: 0.0710, Perplexity: 2057.0149
2024-12-31 18:45:33,092 - TrainingLogger - INFO - Step 15500, Prediction vs Actual:
2024-12-31 18:45:33,092 - TrainingLogger - INFO - Input 1: יור שס, אומרים יודעי דבר, שמע על קיומה של מסיבת העיתונאים כאחד האדם
2024-12-31 18:45:33,093 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:45:33,093 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ו               | ▁י           | ✗     |
|     1 | ▁               | ור           | ✗     |
|     2 | ▁               | ▁שס          | ✗     |
|     3 | ב               | ,            | ✗     |
|     4 | ▁               | ▁אומרים      | ✗     |
|     5 | ▁את             | ▁יודע        | ✗     |
|     6 | ▁מה             | י            | ✗     |
|     7 | ▁האל            | ▁דבר         | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | <pad>           | ▁שמע         | ✗     |
|    10 | ,               | ▁על          | ✗     |
|    11 | ▁מה             | ▁קיו         | ✗     |
|    12 | מי              | מה           | ✗     |
|    13 | ▁של             | ▁של          | ✓     |
|    14 | ▁אישה           | ▁מסיבת       | ✗     |
|    15 | ▁עיתונאים       | ▁העיתונאים   | ✗     |
|    16 | ,               | ▁כאחד        | ✗     |
|    17 | ▁האנשים         | ▁האדם        | ✗     |
|    18 | ▁הזה            | <pad>        | ✗     |
|    19 | ▁הזה            | <pad>        | ✗     |
|    20 | ▁הזה            | <pad>        | ✗     |
|    21 | ▁הזה            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁הזה            | <pad>        | ✗     |
|    24 | ▁היחיד          | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 18:45:33,093 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:45:33,098 - TrainingLogger - INFO - Gradient norm: 8.4935
2024-12-31 18:45:40,679 - TrainingLogger - INFO - Step 15510, Batch metrics: Loss: 7.6074, Accuracy: 0.0929, Perplexity: 2012.9682
2024-12-31 18:45:47,411 - TrainingLogger - INFO - Step 15520, Batch metrics: Loss: 7.3913, Accuracy: 0.0719, Perplexity: 1621.7949
2024-12-31 18:45:54,305 - TrainingLogger - INFO - Step 15530, Batch metrics: Loss: 7.3065, Accuracy: 0.0640, Perplexity: 1490.0093
2024-12-31 18:46:01,034 - TrainingLogger - INFO - Step 15540, Batch metrics: Loss: 6.8011, Accuracy: 0.0559, Perplexity: 898.8353
2024-12-31 18:46:07,994 - TrainingLogger - INFO - Step 15550, Batch metrics: Loss: 7.5670, Accuracy: 0.0674, Perplexity: 1933.3729
2024-12-31 18:46:15,350 - TrainingLogger - INFO - Step 15560, Batch metrics: Loss: 7.3564, Accuracy: 0.0604, Perplexity: 1566.1896
2024-12-31 18:46:22,686 - TrainingLogger - INFO - Step 15570, Batch metrics: Loss: 7.6057, Accuracy: 0.0491, Perplexity: 2009.5808
2024-12-31 18:46:30,239 - TrainingLogger - INFO - Step 15580, Batch metrics: Loss: 7.3839, Accuracy: 0.0655, Perplexity: 1609.8701
2024-12-31 18:46:36,873 - TrainingLogger - INFO - Step 15590, Batch metrics: Loss: 7.6132, Accuracy: 0.0616, Perplexity: 2024.6459
2024-12-31 18:46:44,535 - TrainingLogger - INFO - Step 15600, Batch metrics: Loss: 7.5327, Accuracy: 0.0755, Perplexity: 1868.1357
2024-12-31 18:46:44,535 - TrainingLogger - INFO - Step 15600, Prediction vs Actual:
2024-12-31 18:46:44,535 - TrainingLogger - INFO - Input 1: הוא סיפר שהכין לה תבשיל צילי והיא אכלה, ושהוא שתה כוס יין - וגם אימו
2024-12-31 18:46:44,536 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:46:44,536 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הוא         | ✗     |
|     1 | </s>            | ▁סיפר        | ✗     |
|     2 | ▁לי             | ▁שה          | ✗     |
|     3 | רס              | כין          | ✗     |
|     4 | ▁את             | ▁לה          | ✗     |
|     5 | ▁את             | ▁תבשיל       | ✗     |
|     6 | ים              | ▁צ           | ✗     |
|     7 | '               | ילי          | ✗     |
|     8 | </s>            | ▁והיא        | ✗     |
|     9 | ▁לא             | ▁אכלה        | ✗     |
|    10 | ▁את             | ,            | ✗     |
|    11 | <pad>           | ▁ושהוא       | ✗     |
|    12 | ה               | ▁שתה         | ✗     |
|    13 | </s>            | ▁כוס         | ✗     |
|    14 | ה               | ▁יין         | ✗     |
|    15 | </s>            | ▁-           | ✗     |
|    16 | </s>            | ▁וגם         | ✗     |
|    17 | ▁הוא            | ▁אימו        | ✗     |
|    18 | ת               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            |              | ✗     |

2024-12-31 18:46:44,536 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:46:44,541 - TrainingLogger - INFO - Gradient norm: 8.0839
2024-12-31 18:46:51,691 - TrainingLogger - INFO - Step 15610, Batch metrics: Loss: 7.2208, Accuracy: 0.0956, Perplexity: 1367.5637
2024-12-31 18:46:58,442 - TrainingLogger - INFO - Step 15620, Batch metrics: Loss: 7.9933, Accuracy: 0.0305, Perplexity: 2960.9915
2024-12-31 18:47:05,714 - TrainingLogger - INFO - Step 15630, Batch metrics: Loss: 6.7324, Accuracy: 0.0960, Perplexity: 839.1196
2024-12-31 18:47:13,091 - TrainingLogger - INFO - Step 15640, Batch metrics: Loss: 7.4308, Accuracy: 0.0556, Perplexity: 1687.1116
2024-12-31 18:47:19,867 - TrainingLogger - INFO - Step 15650, Batch metrics: Loss: 7.3669, Accuracy: 0.1013, Perplexity: 1582.7355
2024-12-31 18:47:27,049 - TrainingLogger - INFO - Step 15660, Batch metrics: Loss: 7.1785, Accuracy: 0.0788, Perplexity: 1310.9193
2024-12-31 18:47:34,710 - TrainingLogger - INFO - Step 15670, Batch metrics: Loss: 7.8043, Accuracy: 0.0749, Perplexity: 2451.1012
2024-12-31 18:47:41,869 - TrainingLogger - INFO - Step 15680, Batch metrics: Loss: 7.0709, Accuracy: 0.0582, Perplexity: 1177.2278
2024-12-31 18:47:48,664 - TrainingLogger - INFO - Step 15690, Batch metrics: Loss: 7.4943, Accuracy: 0.0800, Perplexity: 1797.7160
2024-12-31 18:47:55,626 - TrainingLogger - INFO - Step 15700, Batch metrics: Loss: 7.4943, Accuracy: 0.0746, Perplexity: 1797.7597
2024-12-31 18:47:55,627 - TrainingLogger - INFO - Step 15700, Prediction vs Actual:
2024-12-31 18:47:55,627 - TrainingLogger - INFO - Input 1: הבעיה שמי שמגדיל את השכר זו המדינה
2024-12-31 18:47:55,627 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:47:55,627 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הבעיה       | ✗     |
|     1 | ▁-              | ▁שמי         | ✗     |
|     2 | ▁הוא            | ▁שמג         | ✗     |
|     3 | ▁-              | דיל          | ✗     |
|     4 | ▁את             | ▁את          | ✓     |
|     5 | ▁עצמו           | ▁השכר        | ✗     |
|     6 | ▁שלו            | ▁זו          | ✗     |
|     7 | ▁לא             | ▁המדינה      | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ▁היא            | <pad>        | ✗     |
|    10 | ▁לא             | <pad>        | ✗     |
|    11 | ▁לא             | <pad>        | ✗     |
|    12 | ▁את             | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | ▁היא            | <pad>        | ✗     |
|    15 | ה               | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | ▁את             | <pad>        | ✗     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | ▁היא            |              | ✗     |

2024-12-31 18:47:55,627 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:47:55,632 - TrainingLogger - INFO - Gradient norm: 13.2986
2024-12-31 18:48:02,470 - TrainingLogger - INFO - Step 15710, Batch metrics: Loss: 7.4070, Accuracy: 0.0899, Perplexity: 1647.4570
2024-12-31 18:48:09,543 - TrainingLogger - INFO - Step 15720, Batch metrics: Loss: 7.1645, Accuracy: 0.1044, Perplexity: 1292.6994
2024-12-31 18:48:16,495 - TrainingLogger - INFO - Step 15730, Batch metrics: Loss: 7.2644, Accuracy: 0.0833, Perplexity: 1428.4840
2024-12-31 18:48:23,465 - TrainingLogger - INFO - Step 15740, Batch metrics: Loss: 7.5385, Accuracy: 0.0769, Perplexity: 1879.0001
2024-12-31 18:48:30,167 - TrainingLogger - INFO - Step 15750, Batch metrics: Loss: 7.3528, Accuracy: 0.0690, Perplexity: 1560.5122
2024-12-31 18:48:37,208 - TrainingLogger - INFO - Step 15760, Batch metrics: Loss: 7.4582, Accuracy: 0.0574, Perplexity: 1733.9768
2024-12-31 18:48:44,230 - TrainingLogger - INFO - Step 15770, Batch metrics: Loss: 7.3091, Accuracy: 0.0714, Perplexity: 1493.8288
2024-12-31 18:48:51,650 - TrainingLogger - INFO - Step 15780, Batch metrics: Loss: 7.7087, Accuracy: 0.0457, Perplexity: 2227.6661
2024-12-31 18:48:58,145 - TrainingLogger - INFO - Step 15790, Batch metrics: Loss: 7.5146, Accuracy: 0.0628, Perplexity: 1834.6970
2024-12-31 18:49:05,212 - TrainingLogger - INFO - Step 15800, Batch metrics: Loss: 7.3758, Accuracy: 0.0567, Perplexity: 1596.8028
2024-12-31 18:49:05,213 - TrainingLogger - INFO - Step 15800, Prediction vs Actual:
2024-12-31 18:49:05,213 - TrainingLogger - INFO - Input 1: שב עם נתניהו ותבנו ממשלה רחבה ויציבה, שתמנע בחירות, ותיטיב להתמודד עם האתגרים בפניהם ניצבת כעת מדינת ישראל בתחומי הביטחון, הכלכלה והשמירה על יציבות המערכת הדמוקרטית
2024-12-31 18:49:05,214 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:49:05,214 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁שב          | ✗     |
|     1 | ▁-              | ▁עם          | ✗     |
|     2 | <pad>           | ▁נתנ         | ✗     |
|     3 | יה              | יהו          | ✗     |
|     4 | .               | ▁ות          | ✗     |
|     5 | צל              | בנו          | ✗     |
|     6 | ▁את             | ▁ממשלה       | ✗     |
|     7 | ▁חדשה           | ▁רחבה        | ✗     |
|     8 | .               | ▁ויציב       | ✗     |
|     9 | ה               | ה            | ✓     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁שת          | ✗     |
|    12 | דה              | מנע          | ✗     |
|    13 | ו               | ▁בחירות      | ✗     |
|    14 | ▁רבות           | ,            | ✗     |
|    15 | </s>            | ▁ותי         | ✗     |
|    16 | מן              | טיב          | ✗     |
|    17 | ▁איתן           | ▁להתמודד     | ✗     |
|    18 | ▁עם             | ▁עם          | ✓     |
|    19 | ▁זה             | ▁האתגר       | ✗     |
|    20 | ים              | ים           | ✓     |
|    21 | .               | ▁בפניהם      | ✗     |
|    22 | .               | ▁ניצב        | ✗     |
|    23 | ת               | ת            | ✓     |
|    24 | ▁בפני           | ▁כעת         | ✗     |
|    25 | .               | ▁מדינת       | ✗     |
|    26 | ▁ישראל          | ▁ישראל       | ✓     |
|    27 | .               | ▁בתחומ       | ✗     |
|    28 | ה               | י            | ✗     |
|    29 | .               | ▁הביטחון     | ✗     |
|    30 | .               | ,            | ✗     |
|    31 | </s>            | ▁הכלכלה      | ✗     |
|    32 | .               | ▁והש         | ✗     |
|    33 | ורה             | מירה         | ✗     |
|    34 | ▁על             | ▁על          | ✓     |
|    35 | ▁המדינה         | ▁יציבות      | ✗     |
|    36 | ,               | ▁המערכת      | ✗     |
|    37 | ▁הכלכלי         | ▁הדמוקרטי    | ✗     |
|    38 | ה               | ת            | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 18:49:05,214 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:49:05,219 - TrainingLogger - INFO - Gradient norm: 9.9314
2024-12-31 18:49:12,222 - TrainingLogger - INFO - Step 15810, Batch metrics: Loss: 7.6941, Accuracy: 0.0803, Perplexity: 2195.3642
2024-12-31 18:49:19,597 - TrainingLogger - INFO - Step 15820, Batch metrics: Loss: 8.0703, Accuracy: 0.0419, Perplexity: 3198.0858
2024-12-31 18:49:26,791 - TrainingLogger - INFO - Step 15830, Batch metrics: Loss: 7.7650, Accuracy: 0.0694, Perplexity: 2356.6672
2024-12-31 18:49:34,420 - TrainingLogger - INFO - Step 15840, Batch metrics: Loss: 6.8889, Accuracy: 0.0863, Perplexity: 981.2964
2024-12-31 18:49:41,767 - TrainingLogger - INFO - Step 15850, Batch metrics: Loss: 7.6781, Accuracy: 0.0708, Perplexity: 2160.6100
2024-12-31 18:49:49,102 - TrainingLogger - INFO - Step 15860, Batch metrics: Loss: 7.2511, Accuracy: 0.0905, Perplexity: 1409.5855
2024-12-31 18:49:56,592 - TrainingLogger - INFO - Step 15870, Batch metrics: Loss: 7.1496, Accuracy: 0.1013, Perplexity: 1273.5722
2024-12-31 18:50:03,390 - TrainingLogger - INFO - Step 15880, Batch metrics: Loss: 7.3587, Accuracy: 0.0785, Perplexity: 1569.8406
2024-12-31 18:50:10,420 - TrainingLogger - INFO - Step 15890, Batch metrics: Loss: 7.2137, Accuracy: 0.0994, Perplexity: 1357.8558
2024-12-31 18:50:17,432 - TrainingLogger - INFO - Step 15900, Batch metrics: Loss: 7.2851, Accuracy: 0.0795, Perplexity: 1458.3437
2024-12-31 18:50:17,433 - TrainingLogger - INFO - Step 15900, Prediction vs Actual:
2024-12-31 18:50:17,433 - TrainingLogger - INFO - Input 1: מנהלת תחום יוזמות חינוכיות בעמותת יוזמות אברהם, מאי ערו, אמרה הבוקר באולפן ynet כי זוהי השפעה ישירה של חוק הלאום
2024-12-31 18:50:17,433 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:50:17,433 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מנהלת       | ✗     |
|     1 | ▁-              | ▁תחום        | ✗     |
|     2 | ▁-              | ▁יוז         | ✗     |
|     3 | מה              | מות          | ✗     |
|     4 | :               | ▁חינוכי      | ✗     |
|     5 | ות              | ות           | ✓     |
|     6 | :               | ▁בע          | ✗     |
|     7 | "               | מות          | ✗     |
|     8 | ה               | ת            | ✗     |
|     9 | ות              | ▁יוז         | ✗     |
|    10 | מה              | מות          | ✗     |
|    11 | ▁חדשות          | ▁אברהם       | ✗     |
|    12 | ן               | ,            | ✗     |
|    13 | ▁               | ▁מאי         | ✗     |
|    14 | ה               | ▁ער          | ✗     |
|    15 | כא              | ו            | ✗     |
|    16 | ▁של             | ,            | ✗     |
|    17 | <pad>           | ▁אמרה        | ✗     |
|    18 | ד               | ▁הבוקר       | ✗     |
|    19 | .               | ▁באולפן      | ✗     |
|    20 | :               | ▁y           | ✗     |
|    21 | ונה             | net          | ✗     |
|    22 | s               | ▁כי          | ✗     |
|    23 | ▁יש             | ▁זוהי        | ✗     |
|    24 | ▁בעיה           | ▁השפעה       | ✗     |
|    25 | ▁גדולה          | ▁ישירה       | ✗     |
|    26 | ▁על             | ▁של          | ✗     |
|    27 | ▁המדינה         | ▁חוק         | ✗     |
|    28 | ה               | ▁הלא         | ✗     |
|    29 | -               | ום           | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | י               | <pad>        | ✗     |
|    32 | ני              | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 18:50:17,433 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:50:17,438 - TrainingLogger - INFO - Gradient norm: 10.3879
2024-12-31 18:50:24,638 - TrainingLogger - INFO - Step 15910, Batch metrics: Loss: 7.4545, Accuracy: 0.0890, Perplexity: 1727.6277
2024-12-31 18:50:31,718 - TrainingLogger - INFO - Step 15920, Batch metrics: Loss: 7.4407, Accuracy: 0.0508, Perplexity: 1703.9922
2024-12-31 18:50:38,962 - TrainingLogger - INFO - Step 15930, Batch metrics: Loss: 6.8148, Accuracy: 0.0730, Perplexity: 911.2506
2024-12-31 18:50:46,414 - TrainingLogger - INFO - Step 15940, Batch metrics: Loss: 7.6817, Accuracy: 0.0673, Perplexity: 2168.3053
2024-12-31 18:50:53,509 - TrainingLogger - INFO - Step 15950, Batch metrics: Loss: 7.0748, Accuracy: 0.1257, Perplexity: 1181.8054
2024-12-31 18:51:00,572 - TrainingLogger - INFO - Step 15960, Batch metrics: Loss: 6.8125, Accuracy: 0.1066, Perplexity: 909.1504
2024-12-31 18:51:07,994 - TrainingLogger - INFO - Step 15970, Batch metrics: Loss: 7.4616, Accuracy: 0.1007, Perplexity: 1740.0082
2024-12-31 18:51:14,986 - TrainingLogger - INFO - Step 15980, Batch metrics: Loss: 6.9798, Accuracy: 0.0847, Perplexity: 1074.7441
2024-12-31 18:51:22,348 - TrainingLogger - INFO - Step 15990, Batch metrics: Loss: 7.0225, Accuracy: 0.0899, Perplexity: 1121.5556
2024-12-31 18:51:30,237 - TrainingLogger - INFO - Step 16000, Batch metrics: Loss: 7.4595, Accuracy: 0.0819, Perplexity: 1736.3481
2024-12-31 18:51:30,238 - TrainingLogger - INFO - Step 16000, Prediction vs Actual:
2024-12-31 18:51:30,238 - TrainingLogger - INFO - Input 1: מתיחות בין הגננות להורים אילוסטרציהצילום shutterstock סוגיית השבתת מערכת החינוך ובכללה גני הילדים ברקע התפשטות הנגיף קורונה, העמיקה את משבר האמון בין עובדי ההוראה לציבור ההורים
2024-12-31 18:51:30,238 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:51:30,238 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מתי         | ✗     |
|     1 | ן               | חות          | ✗     |
|     2 | ▁אחרונות        | ▁בין         | ✗     |
|     3 | ▁השאר           | ▁הג          | ✗     |
|     4 | ות              | ננות         | ✗     |
|     5 | ▁וה             | ▁להורים      | ✗     |
|     6 | ▁חדשים          | ▁אילו        | ✗     |
|     7 | פים             | סטר          | ✗     |
|     8 | יות             | ציה          | ✗     |
|     9 | ▁חדשה           | צילום        | ✗     |
|    10 | פלי             | ▁sh          | ✗     |
|    11 | ירים            | ut           | ✗     |
|    12 | ין              | ter          | ✗     |
|    13 | </s>            | st           | ✗     |
|    14 | one             | ock          | ✗     |
|    15 | ה               | ▁סוגי        | ✗     |
|    16 | ה               | ית           | ✗     |
|    17 | <pad>           | ▁השבת        | ✗     |
|    18 | ה               | ת            | ✗     |
|    19 | ▁את             | ▁מערכת       | ✗     |
|    20 | ית              | ▁החינוך      | ✗     |
|    21 | ▁הכלכלי         | ▁ובכלל       | ✗     |
|    22 | ה               | ה            | ✓     |
|    23 | .               | ▁ג           | ✗     |
|    24 | '               | ני           | ✗     |
|    25 | מה              | ▁הילדים      | ✗     |
|    26 | </s>            | ▁ברקע        | ✗     |
|    27 | .               | ▁התפשטות     | ✗     |
|    28 | ית              | ▁הנגיף       | ✗     |
|    29 | .               | ▁קור         | ✗     |
|    30 | ח               | ונה          | ✗     |
|    31 | מה              | ,            | ✗     |
|    32 | </s>            | ▁הע          | ✗     |
|    33 | פיל             | מיק          | ✗     |
|    34 | ה               | ה            | ✓     |
|    35 | ▁של             | ▁את          | ✗     |
|    36 | ר               | ▁משבר        | ✗     |
|    37 | ים              | ▁האמון       | ✗     |
|    38 | .               | ▁בין         | ✗     |
|    39 | ▁המדינות        | ▁עובדי       | ✗     |
|    40 | ה               | ▁ההוראה      | ✗     |
|    41 | .               | ▁לציבור      | ✗     |
|    42 | .               | ▁ההורים      | ✗     |
|    43 | .               |              | ✗     |

2024-12-31 18:51:30,238 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:51:30,243 - TrainingLogger - INFO - Gradient norm: 8.1218
2024-12-31 18:51:37,734 - TrainingLogger - INFO - Step 16010, Batch metrics: Loss: 8.0977, Accuracy: 0.0352, Perplexity: 3286.9406
2024-12-31 18:51:45,188 - TrainingLogger - INFO - Step 16020, Batch metrics: Loss: 7.5262, Accuracy: 0.0658, Perplexity: 1856.0848
2024-12-31 18:51:51,888 - TrainingLogger - INFO - Step 16030, Batch metrics: Loss: 7.1165, Accuracy: 0.0730, Perplexity: 1232.1326
2024-12-31 18:51:58,893 - TrainingLogger - INFO - Step 16040, Batch metrics: Loss: 7.5428, Accuracy: 0.0521, Perplexity: 1887.1091
2024-12-31 18:52:06,225 - TrainingLogger - INFO - Step 16050, Batch metrics: Loss: 7.8284, Accuracy: 0.0395, Perplexity: 2510.7929
2024-12-31 18:52:13,978 - TrainingLogger - INFO - Step 16060, Batch metrics: Loss: 7.0080, Accuracy: 0.0798, Perplexity: 1105.4223
2024-12-31 18:52:20,765 - TrainingLogger - INFO - Step 16070, Batch metrics: Loss: 7.1704, Accuracy: 0.0688, Perplexity: 1300.3748
2024-12-31 18:52:27,526 - TrainingLogger - INFO - Step 16080, Batch metrics: Loss: 7.2089, Accuracy: 0.0640, Perplexity: 1351.4313
2024-12-31 18:52:35,139 - TrainingLogger - INFO - Step 16090, Batch metrics: Loss: 6.9317, Accuracy: 0.0861, Perplexity: 1024.2134
2024-12-31 18:52:42,355 - TrainingLogger - INFO - Step 16100, Batch metrics: Loss: 7.3851, Accuracy: 0.0699, Perplexity: 1611.8088
2024-12-31 18:52:42,355 - TrainingLogger - INFO - Step 16100, Prediction vs Actual:
2024-12-31 18:52:42,355 - TrainingLogger - INFO - Input 1: אנחנו נייצג את המאחד ולא את המפריד
2024-12-31 18:52:42,355 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:52:42,355 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הזה            | ▁אנחנו       | ✗     |
|     1 | </s>            | ▁נ           | ✗     |
|     2 | ▁נ              | ייצג         | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | ▁זה             | ▁המ          | ✗     |
|     5 | יל              | אחד          | ✗     |
|     6 | </s>            | ▁ולא         | ✗     |
|     7 | ▁נ              | ▁את          | ✗     |
|     8 | ▁זה             | ▁המ          | ✗     |
|     9 | נס              | פריד         | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁אנחנו          | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 18:52:42,356 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:52:42,361 - TrainingLogger - INFO - Gradient norm: 8.1436
2024-12-31 18:52:50,460 - TrainingLogger - INFO - Step 16110, Batch metrics: Loss: 7.3792, Accuracy: 0.0821, Perplexity: 1602.3181
2024-12-31 18:52:57,620 - TrainingLogger - INFO - Step 16120, Batch metrics: Loss: 7.6787, Accuracy: 0.0466, Perplexity: 2161.7178
2024-12-31 18:53:04,030 - TrainingLogger - INFO - Step 16130, Batch metrics: Loss: 7.5878, Accuracy: 0.0534, Perplexity: 1973.9002
2024-12-31 18:53:10,489 - TrainingLogger - INFO - Step 16140, Batch metrics: Loss: 7.1541, Accuracy: 0.0970, Perplexity: 1279.4039
2024-12-31 18:53:17,538 - TrainingLogger - INFO - Step 16150, Batch metrics: Loss: 7.3472, Accuracy: 0.1014, Perplexity: 1551.7867
2024-12-31 18:53:24,250 - TrainingLogger - INFO - Step 16160, Batch metrics: Loss: 6.3754, Accuracy: 0.1439, Perplexity: 587.1932
2024-12-31 18:53:31,210 - TrainingLogger - INFO - Step 16170, Batch metrics: Loss: 6.9839, Accuracy: 0.0915, Perplexity: 1079.1389
2024-12-31 18:53:38,995 - TrainingLogger - ERROR - Error during forward pass: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 21.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.80 GiB is allocated by PyTorch, and 623.78 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2024-12-31 18:53:38,995 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 175, in forward
    x = self.custom_encoder2(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 769, in forward
    layer_outputs = encoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 303, in forward
    hidden_states, attn_weights, _ = self.self_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 187, in forward
    value_states = self._shape(self.v_proj(hidden_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 21.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.80 GiB is allocated by PyTorch, and 623.78 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-12-31 18:53:38,995 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([8, 510]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([8, 510]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 18:53:38,996 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 18:53:41,621 - TrainingLogger - INFO - Step 16180, Batch metrics: Loss: 7.1835, Accuracy: 0.1017, Perplexity: 1317.5295
2024-12-31 18:53:48,786 - TrainingLogger - INFO - Step 16190, Batch metrics: Loss: 7.1194, Accuracy: 0.0684, Perplexity: 1235.7418
2024-12-31 18:53:56,349 - TrainingLogger - INFO - Step 16200, Batch metrics: Loss: 7.8291, Accuracy: 0.0496, Perplexity: 2512.6337
2024-12-31 18:53:56,349 - TrainingLogger - INFO - Step 16200, Prediction vs Actual:
2024-12-31 18:53:56,349 - TrainingLogger - INFO - Input 1: הייתי במצב כל כך פגיע, שהדברים שלו הצליחו לחדור אליי
2024-12-31 18:53:56,350 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:53:56,350 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הייתי       | ✗     |
|     1 | ▁-              | ▁במצב        | ✗     |
|     2 | ▁אני            | ▁כל          | ✗     |
|     3 | ▁היום           | ▁כך          | ✗     |
|     4 | ▁רע             | ▁פגיע        | ✗     |
|     5 | .               | ,            | ✗     |
|     6 | ▁אבל            | ▁שהדברים     | ✗     |
|     7 | ▁האלה           | ▁שלו         | ✗     |
|     8 | ...             | ▁הצליחו      | ✗     |
|     9 | .               | ▁לחדור       | ✗     |
|    10 | ▁אליי           | ▁אליי        | ✓     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁לא             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 18:53:56,350 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:53:56,355 - TrainingLogger - INFO - Gradient norm: 8.2314
2024-12-31 18:54:03,751 - TrainingLogger - INFO - Step 16210, Batch metrics: Loss: 7.1036, Accuracy: 0.0878, Perplexity: 1216.3769
2024-12-31 18:54:10,735 - TrainingLogger - INFO - Step 16220, Batch metrics: Loss: 7.5121, Accuracy: 0.0892, Perplexity: 1830.0905
2024-12-31 18:54:18,021 - TrainingLogger - INFO - Step 16230, Batch metrics: Loss: 7.0557, Accuracy: 0.0970, Perplexity: 1159.4956
2024-12-31 18:54:25,494 - TrainingLogger - INFO - Step 16240, Batch metrics: Loss: 6.9899, Accuracy: 0.0714, Perplexity: 1085.6394
2024-12-31 18:54:32,502 - TrainingLogger - INFO - Step 16250, Batch metrics: Loss: 7.4960, Accuracy: 0.0925, Perplexity: 1800.8982
2024-12-31 18:54:39,956 - TrainingLogger - INFO - Step 16260, Batch metrics: Loss: 6.9030, Accuracy: 0.0926, Perplexity: 995.2777
2024-12-31 18:54:47,316 - TrainingLogger - INFO - Step 16270, Batch metrics: Loss: 7.2571, Accuracy: 0.0629, Perplexity: 1418.1625
2024-12-31 18:54:54,751 - TrainingLogger - INFO - Step 16280, Batch metrics: Loss: 7.2307, Accuracy: 0.1027, Perplexity: 1381.1594
2024-12-31 18:55:01,741 - TrainingLogger - INFO - Step 16290, Batch metrics: Loss: 7.4808, Accuracy: 0.0733, Perplexity: 1773.7186
2024-12-31 18:55:09,224 - TrainingLogger - INFO - Step 16300, Batch metrics: Loss: 6.6665, Accuracy: 0.1000, Perplexity: 785.6632
2024-12-31 18:55:09,224 - TrainingLogger - INFO - Step 16300, Prediction vs Actual:
2024-12-31 18:55:09,224 - TrainingLogger - INFO - Input 1: שחיתות אחת שמרסקת את מוסדות השלטון, שמונעת מהציבור לבחור
2024-12-31 18:55:09,225 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:55:09,225 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁שחיתות      | ✗     |
|     1 | ▁ראשונה         | ▁אחת         | ✗     |
|     2 | ▁חשובה          | ▁שמ          | ✗     |
|     3 | </s>            | רסק          | ✗     |
|     4 | ים              | ת            | ✗     |
|     5 | ▁את             | ▁את          | ✓     |
|     6 | ▁העולם          | ▁מוסד        | ✗     |
|     7 | ות              | ות           | ✓     |
|     8 | ▁אחרים          | ▁השלטון      | ✗     |
|     9 | </s>            | ,            | ✗     |
|    10 | </s>            | ▁שמו         | ✗     |
|    11 | מ               | נע           | ✗     |
|    12 | ת               | ת            | ✓     |
|    13 | ▁על             | ▁מה          | ✗     |
|    14 | נשים            | ציבור        | ✗     |
|    15 | </s>            | ▁לבחור       | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | ▁את             | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 18:55:09,225 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:55:09,230 - TrainingLogger - INFO - Gradient norm: 10.1301
2024-12-31 18:55:16,713 - TrainingLogger - INFO - Step 16310, Batch metrics: Loss: 7.5608, Accuracy: 0.0635, Perplexity: 1921.3180
2024-12-31 18:55:23,971 - TrainingLogger - INFO - Step 16320, Batch metrics: Loss: 7.6469, Accuracy: 0.0876, Perplexity: 2094.1261
2024-12-31 18:55:31,260 - TrainingLogger - INFO - Step 16330, Batch metrics: Loss: 7.0043, Accuracy: 0.1058, Perplexity: 1101.3684
2024-12-31 18:55:38,502 - TrainingLogger - INFO - Step 16340, Batch metrics: Loss: 6.9544, Accuracy: 0.0749, Perplexity: 1047.7353
2024-12-31 18:55:45,783 - TrainingLogger - INFO - Step 16350, Batch metrics: Loss: 7.3619, Accuracy: 0.0881, Perplexity: 1574.7814
2024-12-31 18:55:52,900 - TrainingLogger - INFO - Step 16360, Batch metrics: Loss: 7.3946, Accuracy: 0.0479, Perplexity: 1627.1932
2024-12-31 18:56:00,221 - TrainingLogger - INFO - Step 16370, Batch metrics: Loss: 7.2345, Accuracy: 0.0645, Perplexity: 1386.4772
2024-12-31 18:56:07,578 - TrainingLogger - INFO - Step 16380, Batch metrics: Loss: 7.2845, Accuracy: 0.1064, Perplexity: 1457.5942
2024-12-31 18:56:14,657 - TrainingLogger - INFO - Step 16390, Batch metrics: Loss: 7.5332, Accuracy: 0.0523, Perplexity: 1869.1015
2024-12-31 18:56:22,301 - TrainingLogger - INFO - Step 16400, Batch metrics: Loss: 7.1657, Accuracy: 0.0942, Perplexity: 1294.3228
2024-12-31 18:56:22,301 - TrainingLogger - INFO - Step 16400, Prediction vs Actual:
2024-12-31 18:56:22,302 - TrainingLogger - INFO - Input 1: שר הביטחון הציג את ארבע החלופות הרעות לשלטון בעתיד ברצועה
2024-12-31 18:56:22,302 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:56:22,302 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שר          | ✗     |
|     1 | ▁את             | ▁הביטחון     | ✗     |
|     2 | ▁-              | ▁הציג        | ✗     |
|     3 | ה               | ▁את          | ✗     |
|     4 | ▁זה             | ▁ארבע        | ✗     |
|     5 | נו              | ▁החלו        | ✗     |
|     6 | פות             | פות          | ✓     |
|     7 | ▁הראשונות       | ▁הרעות       | ✗     |
|     8 | .               | ▁לשלטון      | ✗     |
|     9 | .               | ▁בעתיד       | ✗     |
|    10 | .               | ▁ב           | ✗     |
|    11 | "               | רצועה        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | .               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | <pad>           |              | ✗     |

2024-12-31 18:56:22,302 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:56:22,307 - TrainingLogger - INFO - Gradient norm: 12.4506
2024-12-31 18:56:29,623 - TrainingLogger - INFO - Step 16410, Batch metrics: Loss: 6.9291, Accuracy: 0.1111, Perplexity: 1021.6010
2024-12-31 18:56:36,597 - TrainingLogger - INFO - Step 16420, Batch metrics: Loss: 7.3442, Accuracy: 0.0655, Perplexity: 1547.2382
2024-12-31 18:56:43,589 - TrainingLogger - INFO - Step 16430, Batch metrics: Loss: 7.3517, Accuracy: 0.0765, Perplexity: 1558.9132
2024-12-31 18:56:50,940 - TrainingLogger - INFO - Step 16440, Batch metrics: Loss: 7.9059, Accuracy: 0.0714, Perplexity: 2713.1618
2024-12-31 18:56:58,119 - TrainingLogger - INFO - Step 16450, Batch metrics: Loss: 7.2359, Accuracy: 0.1152, Perplexity: 1388.3851
2024-12-31 18:57:04,695 - TrainingLogger - INFO - Step 16460, Batch metrics: Loss: 7.0837, Accuracy: 0.1111, Perplexity: 1192.4275
2024-12-31 18:57:11,750 - TrainingLogger - INFO - Step 16470, Batch metrics: Loss: 7.2724, Accuracy: 0.0781, Perplexity: 1440.0729
2024-12-31 18:57:18,821 - TrainingLogger - INFO - Step 16480, Batch metrics: Loss: 7.5654, Accuracy: 0.0547, Perplexity: 1930.2667
2024-12-31 18:57:25,819 - TrainingLogger - INFO - Step 16490, Batch metrics: Loss: 7.7552, Accuracy: 0.0688, Perplexity: 2333.7303
2024-12-31 18:57:33,261 - TrainingLogger - INFO - Step 16500, Batch metrics: Loss: 7.5244, Accuracy: 0.0546, Perplexity: 1852.6787
2024-12-31 18:57:33,261 - TrainingLogger - INFO - Step 16500, Prediction vs Actual:
2024-12-31 18:57:33,261 - TrainingLogger - INFO - Input 1: כבר שנה קודם לכן, כשהתחלתי את הערוץ מול אבו מאזן, יידעתי עליהם את עוז והתקרבנו
2024-12-31 18:57:33,262 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:57:33,262 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כבר         | ✗     |
|     1 | ▁-              | ▁שנה         | ✗     |
|     2 | ▁-              | ▁קודם        | ✗     |
|     3 | ▁לכן            | ▁לכן         | ✓     |
|     4 | ▁אני            | ,            | ✗     |
|     5 | ▁אני            | ▁כשהתחלתי    | ✗     |
|     6 | ▁לעבוד          | ▁את          | ✗     |
|     7 | ▁זה             | ▁הערוץ       | ✗     |
|     8 | .               | ▁מול         | ✗     |
|     9 | נו              | ▁אבו         | ✗     |
|    10 | .               | ▁מאז         | ✗     |
|    11 | .               | ן            | ✗     |
|    12 | ▁חדש            | ,            | ✗     |
|    13 | ▁אני            | ▁י           | ✗     |
|    14 | רוד             | ידעתי        | ✗     |
|    15 | ▁אותך           | ▁עליהם       | ✗     |
|    16 | ▁את             | ▁את          | ✓     |
|    17 | ▁כל             | ▁עוז         | ✗     |
|    18 | י               | ▁ו           | ✗     |
|    19 | ...             | התקרב        | ✗     |
|    20 | ▁אלי            | נו           | ✗     |
|    21 | ▁אליהם          | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁אליו           | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ▁שוב            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 18:57:33,262 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:57:33,267 - TrainingLogger - INFO - Gradient norm: 10.6138
2024-12-31 18:57:40,726 - TrainingLogger - INFO - Step 16510, Batch metrics: Loss: 7.4005, Accuracy: 0.0755, Perplexity: 1636.7883
2024-12-31 18:57:48,099 - TrainingLogger - INFO - Step 16520, Batch metrics: Loss: 7.1251, Accuracy: 0.0821, Perplexity: 1242.7323
2024-12-31 18:57:55,366 - TrainingLogger - INFO - Step 16530, Batch metrics: Loss: 7.0123, Accuracy: 0.0970, Perplexity: 1110.2569
2024-12-31 18:58:02,469 - TrainingLogger - INFO - Step 16540, Batch metrics: Loss: 7.0770, Accuracy: 0.0581, Perplexity: 1184.4175
2024-12-31 18:58:09,484 - TrainingLogger - INFO - Step 16550, Batch metrics: Loss: 7.5130, Accuracy: 0.0993, Perplexity: 1831.7511
2024-12-31 18:58:15,881 - TrainingLogger - INFO - Step 16560, Batch metrics: Loss: 7.1728, Accuracy: 0.0899, Perplexity: 1303.5285
2024-12-31 18:58:22,998 - TrainingLogger - INFO - Step 16570, Batch metrics: Loss: 7.2959, Accuracy: 0.0508, Perplexity: 1474.1747
2024-12-31 18:58:30,184 - TrainingLogger - INFO - Step 16580, Batch metrics: Loss: 7.1135, Accuracy: 0.0632, Perplexity: 1228.3864
2024-12-31 18:58:37,281 - TrainingLogger - INFO - Step 16590, Batch metrics: Loss: 7.0268, Accuracy: 0.0496, Perplexity: 1126.4473
2024-12-31 18:58:44,094 - TrainingLogger - INFO - Step 16600, Batch metrics: Loss: 8.0264, Accuracy: 0.0400, Perplexity: 3060.6058
2024-12-31 18:58:44,094 - TrainingLogger - INFO - Step 16600, Prediction vs Actual:
2024-12-31 18:58:44,094 - TrainingLogger - INFO - Input 1: אין באמת סוריה, זה מחוז באיראן
2024-12-31 18:58:44,095 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:58:44,095 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אין         | ✗     |
|     1 | ,               | ▁באמת        | ✗     |
|     2 | ,               | ▁סור         | ✗     |
|     3 | ,               | יה           | ✗     |
|     4 | </s>            | ,            | ✗     |
|     5 | <pad>           | ▁זה          | ✗     |
|     6 | ▁לא             | ▁מחוז        | ✗     |
|     7 | </s>            | ▁באי         | ✗     |
|     8 | ,               | ראן          | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 18:58:44,095 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:58:44,100 - TrainingLogger - INFO - Gradient norm: 10.7465
2024-12-31 18:58:51,328 - TrainingLogger - INFO - Step 16610, Batch metrics: Loss: 6.5736, Accuracy: 0.0823, Perplexity: 715.9104
2024-12-31 18:58:58,249 - TrainingLogger - INFO - Step 16620, Batch metrics: Loss: 7.4169, Accuracy: 0.0724, Perplexity: 1663.9289
2024-12-31 18:59:05,380 - TrainingLogger - INFO - Step 16630, Batch metrics: Loss: 7.4120, Accuracy: 0.0860, Perplexity: 1655.7940
2024-12-31 18:59:12,308 - TrainingLogger - INFO - Step 16640, Batch metrics: Loss: 7.0966, Accuracy: 0.1102, Perplexity: 1207.8028
2024-12-31 18:59:19,195 - TrainingLogger - INFO - Step 16650, Batch metrics: Loss: 7.3786, Accuracy: 0.0375, Perplexity: 1601.3984
2024-12-31 18:59:26,385 - TrainingLogger - INFO - Step 16660, Batch metrics: Loss: 7.3785, Accuracy: 0.0706, Perplexity: 1601.1396
2024-12-31 18:59:33,401 - TrainingLogger - INFO - Step 16670, Batch metrics: Loss: 7.6138, Accuracy: 0.0503, Perplexity: 2026.0434
2024-12-31 18:59:40,595 - TrainingLogger - INFO - Step 16680, Batch metrics: Loss: 7.5952, Accuracy: 0.0977, Perplexity: 1988.5480
2024-12-31 18:59:48,021 - TrainingLogger - INFO - Step 16690, Batch metrics: Loss: 7.6574, Accuracy: 0.1006, Perplexity: 2116.3270
2024-12-31 18:59:55,211 - TrainingLogger - INFO - Step 16700, Batch metrics: Loss: 7.2441, Accuracy: 0.0546, Perplexity: 1399.7769
2024-12-31 18:59:55,211 - TrainingLogger - INFO - Step 16700, Prediction vs Actual:
2024-12-31 18:59:55,211 - TrainingLogger - INFO - Input 1: השאלה החשובה אינה אם נתניהו שוב ינצח, או יפסיד, ולא למי הוא יפסיד
2024-12-31 18:59:55,212 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 18:59:55,212 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁השאלה       | ✗     |
|     1 | ▁מה             | ▁החשובה      | ✗     |
|     2 | ▁יותר           | ▁אינה        | ✗     |
|     3 | ▁טועה           | ▁אם          | ✗     |
|     4 | ▁היא            | ▁נתנ         | ✗     |
|     5 | ל               | יהו          | ✗     |
|     6 | ▁לא             | ▁שוב         | ✗     |
|     7 | ?               | ▁ינצח        | ✗     |
|     8 | ▁את             | ,            | ✗     |
|     9 | <pad>           | ▁או          | ✗     |
|    10 | ▁לא             | ▁יפסיד       | ✗     |
|    11 | ו               | ,            | ✗     |
|    12 | <pad>           | ▁ולא         | ✗     |
|    13 | ▁לא             | ▁למי         | ✗     |
|    14 | ▁לא             | ▁הוא         | ✗     |
|    15 | ▁לא             | ▁יפסיד       | ✗     |
|    16 | ?               | <pad>        | ✗     |
|    17 | ?               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ?               | <pad>        | ✗     |
|    20 | ?               | <pad>        | ✗     |
|    21 | ?               | <pad>        | ✗     |
|    22 | ?               | <pad>        | ✗     |
|    23 | ?               | <pad>        | ✗     |
|    24 | ?               | <pad>        | ✗     |
|    25 | ?               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ?               | <pad>        | ✗     |
|    31 | ?               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ?               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ?               | <pad>        | ✗     |
|    38 | ?               | <pad>        | ✗     |
|    39 | ?               |              | ✗     |

2024-12-31 18:59:55,212 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 18:59:55,217 - TrainingLogger - INFO - Gradient norm: 8.0912
2024-12-31 19:00:02,607 - TrainingLogger - INFO - Step 16710, Batch metrics: Loss: 7.8597, Accuracy: 0.0621, Perplexity: 2590.6559
2024-12-31 19:00:10,253 - TrainingLogger - INFO - Step 16720, Batch metrics: Loss: 7.0143, Accuracy: 0.1383, Perplexity: 1112.4572
2024-12-31 19:00:17,527 - TrainingLogger - INFO - Step 16730, Batch metrics: Loss: 7.2835, Accuracy: 0.0732, Perplexity: 1456.0618
2024-12-31 19:00:24,675 - TrainingLogger - INFO - Step 16740, Batch metrics: Loss: 7.0995, Accuracy: 0.0863, Perplexity: 1211.3153
2024-12-31 19:00:32,084 - TrainingLogger - INFO - Step 16750, Batch metrics: Loss: 6.7563, Accuracy: 0.1667, Perplexity: 859.4768
2024-12-31 19:00:39,211 - TrainingLogger - INFO - Step 16760, Batch metrics: Loss: 7.6575, Accuracy: 0.0523, Perplexity: 2116.3896
2024-12-31 19:00:46,625 - TrainingLogger - INFO - Step 16770, Batch metrics: Loss: 7.5013, Accuracy: 0.0914, Perplexity: 1810.4235
2024-12-31 19:00:53,619 - TrainingLogger - INFO - Step 16780, Batch metrics: Loss: 7.4005, Accuracy: 0.0660, Perplexity: 1636.8156
2024-12-31 19:01:00,564 - TrainingLogger - INFO - Step 16790, Batch metrics: Loss: 7.0343, Accuracy: 0.0839, Perplexity: 1134.8838
2024-12-31 19:01:07,371 - TrainingLogger - INFO - Step 16800, Batch metrics: Loss: 7.4925, Accuracy: 0.0963, Perplexity: 1794.5813
2024-12-31 19:01:07,371 - TrainingLogger - INFO - Step 16800, Prediction vs Actual:
2024-12-31 19:01:07,371 - TrainingLogger - INFO - Input 1: מספר משרות השכיר באוגוסט היה 3625 מיליון
2024-12-31 19:01:07,372 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:01:07,372 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הנוכחי         | ▁מספר        | ✗     |
|     1 | ▁-              | ▁משרות       | ✗     |
|     2 | ▁-              | ▁ה           | ✗     |
|     3 | -               | שכיר         | ✗     |
|     4 | ▁-              | ▁באוגוסט     | ✗     |
|     5 | .               | ▁היה         | ✗     |
|     6 | ▁לי             | ▁36          | ✗     |
|     7 | ▁שנים           | 25           | ✗     |
|     8 | ה               | ▁מיליון      | ✗     |
|     9 | ▁שנים           | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | ▁מה             | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ים              | <pad>        | ✗     |
|    14 | ים              | <pad>        | ✗     |
|    15 | ים              | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | ות              | <pad>        | ✗     |
|    18 | ▁הזה            | <pad>        | ✗     |
|    19 | ▁הזה            | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ▁הזה            | <pad>        | ✗     |
|    22 | ▁הזה            | <pad>        | ✗     |
|    23 | ▁הזה            | <pad>        | ✗     |
|    24 | ▁הזה            | <pad>        | ✗     |
|    25 | ▁הזה            | <pad>        | ✗     |
|    26 | ▁הזה            | <pad>        | ✗     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | ▁הזה            | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | ▁הזה            |              | ✗     |

2024-12-31 19:01:07,372 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:01:07,377 - TrainingLogger - INFO - Gradient norm: 9.1439
2024-12-31 19:01:14,502 - TrainingLogger - INFO - Step 16810, Batch metrics: Loss: 7.5923, Accuracy: 0.0703, Perplexity: 1982.9104
2024-12-31 19:01:21,474 - TrainingLogger - INFO - Step 16820, Batch metrics: Loss: 7.5731, Accuracy: 0.0674, Perplexity: 1945.2520
2024-12-31 19:01:28,423 - TrainingLogger - INFO - Step 16830, Batch metrics: Loss: 7.3259, Accuracy: 0.0497, Perplexity: 1519.0740
2024-12-31 19:01:35,377 - TrainingLogger - INFO - Step 16840, Batch metrics: Loss: 7.2684, Accuracy: 0.1029, Perplexity: 1434.3061
2024-12-31 19:01:42,179 - TrainingLogger - INFO - Step 16850, Batch metrics: Loss: 7.7972, Accuracy: 0.0131, Perplexity: 2433.6704
2024-12-31 19:01:48,845 - TrainingLogger - INFO - Step 16860, Batch metrics: Loss: 7.7213, Accuracy: 0.0938, Perplexity: 2255.9229
2024-12-31 19:01:55,954 - TrainingLogger - INFO - Step 16870, Batch metrics: Loss: 7.4569, Accuracy: 0.0971, Perplexity: 1731.8127
2024-12-31 19:02:02,930 - TrainingLogger - INFO - Step 16880, Batch metrics: Loss: 7.2412, Accuracy: 0.0804, Perplexity: 1395.7585
2024-12-31 19:02:10,628 - TrainingLogger - INFO - Step 16890, Batch metrics: Loss: 7.8624, Accuracy: 0.0795, Perplexity: 2597.8690
2024-12-31 19:02:18,050 - TrainingLogger - INFO - Step 16900, Batch metrics: Loss: 7.7012, Accuracy: 0.0329, Perplexity: 2211.0386
2024-12-31 19:02:18,051 - TrainingLogger - INFO - Step 16900, Prediction vs Actual:
2024-12-31 19:02:18,051 - TrainingLogger - INFO - Input 1: מכשול מרכזי נוסף לדבריהם הוא שאלת הרוטציה, כלומר מי יכהן ראשון בממשלת אחדות - נתניהו או גנץ
2024-12-31 19:02:18,051 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:02:18,051 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁מכשול       | ✗     |
|     1 | ▁-              | ▁מרכזי       | ✗     |
|     2 | ,               | ▁נוסף        | ✗     |
|     3 | ,               | ▁לדבר        | ✗     |
|     4 | ▁הוא            | יהם          | ✗     |
|     5 | ▁של             | ▁הוא         | ✗     |
|     6 | ▁לא             | ▁שאלת        | ✗     |
|     7 | ו               | ▁ה           | ✗     |
|     8 | ערעור           | רוט          | ✗     |
|     9 | ציה             | ציה          | ✓     |
|    10 | ▁הגדולה         | ,            | ✗     |
|    11 | <pad>           | ▁כלומר       | ✗     |
|    12 | ,               | ▁מי          | ✗     |
|    13 | ▁זה             | ▁יכה         | ✗     |
|    14 | ▁את             | ן            | ✗     |
|    15 | ▁את             | ▁ראשון       | ✗     |
|    16 | .               | ▁ב           | ✗     |
|    17 | שלטון           | ממשלת        | ✗     |
|    18 | י               | ▁אחדות       | ✗     |
|    19 | .               | ▁-           | ✗     |
|    20 | <pad>           | ▁נתנ         | ✗     |
|    21 | ת               | יהו          | ✗     |
|    22 | שה              | ▁או          | ✗     |
|    23 | סטר             | ▁ג           | ✗     |
|    24 | '               | נץ           | ✗     |
|    25 | '               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            |              | ✗     |

2024-12-31 19:02:18,052 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:02:18,057 - TrainingLogger - INFO - Gradient norm: 9.0512
2024-12-31 19:02:25,279 - TrainingLogger - INFO - Step 16910, Batch metrics: Loss: 7.7188, Accuracy: 0.0598, Perplexity: 2250.3286
2024-12-31 19:02:32,444 - TrainingLogger - INFO - Step 16920, Batch metrics: Loss: 7.1408, Accuracy: 0.1119, Perplexity: 1262.4933
2024-12-31 19:02:39,398 - TrainingLogger - INFO - Step 16930, Batch metrics: Loss: 7.7126, Accuracy: 0.0848, Perplexity: 2236.4414
2024-12-31 19:02:46,751 - TrainingLogger - INFO - Step 16940, Batch metrics: Loss: 7.6943, Accuracy: 0.0769, Perplexity: 2195.8762
2024-12-31 19:02:53,961 - TrainingLogger - INFO - Step 16950, Batch metrics: Loss: 7.4776, Accuracy: 0.0503, Perplexity: 1767.9800
2024-12-31 19:03:01,029 - TrainingLogger - INFO - Step 16960, Batch metrics: Loss: 7.1092, Accuracy: 0.1049, Perplexity: 1223.2071
2024-12-31 19:03:08,482 - TrainingLogger - INFO - Step 16970, Batch metrics: Loss: 7.2561, Accuracy: 0.0902, Perplexity: 1416.6647
2024-12-31 19:03:15,685 - TrainingLogger - INFO - Step 16980, Batch metrics: Loss: 7.1852, Accuracy: 0.0662, Perplexity: 1319.7094
2024-12-31 19:03:23,574 - TrainingLogger - INFO - Step 16990, Batch metrics: Loss: 7.6791, Accuracy: 0.0491, Perplexity: 2162.5983
2024-12-31 19:03:30,669 - TrainingLogger - INFO - Step 17000, Batch metrics: Loss: 7.2312, Accuracy: 0.0890, Perplexity: 1381.8807
2024-12-31 19:03:30,670 - TrainingLogger - INFO - Step 17000, Prediction vs Actual:
2024-12-31 19:03:30,670 - TrainingLogger - INFO - Input 1: מדובר על נורמות לפיהן יבחן המעסיק, במודע ובתת מודע, לא רק את התשובות הטכניות לשאלות, אלא גם את אופן התגובה בהיבטים דוגמת שפת גוף, אינטונציה, קשר עין ועוד
2024-12-31 19:03:30,670 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:03:30,670 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מדובר       | ✗     |
|     1 | ▁ב              | ▁על          | ✗     |
|     2 | ו               | ▁נו          | ✗     |
|     3 | ד               | רמות         | ✗     |
|     4 | ▁שונות          | ▁לפי         | ✗     |
|     5 | ו               | הן           | ✗     |
|     6 | ▁יש             | ▁י           | ✗     |
|     7 | ָ               | בחן          | ✗     |
|     8 | ▁את             | ▁המעסיק      | ✗     |
|     9 | ים              | ,            | ✗     |
|    10 | </s>            | ▁ב           | ✗     |
|    11 | .               | מודע         | ✗     |
|    12 | ,               | ▁ובת         | ✗     |
|    13 | מורה            | ת            | ✗     |
|    14 | ▁הדין           | ▁מודע        | ✗     |
|    15 | ▁לכך            | ,            | ✗     |
|    16 | </s>            | ▁לא          | ✗     |
|    17 | ▁י              | ▁רק          | ✗     |
|    18 | ▁את             | ▁את          | ✓     |
|    19 | ▁עצמו           | ▁התשובות     | ✗     |
|    20 | ▁שלו            | ▁הטכני       | ✗     |
|    21 | ות              | ות           | ✓     |
|    22 | ▁שלו            | ▁לשאלות      | ✗     |
|    23 | ▁אלו            | ,            | ✗     |
|    24 | </s>            | ▁אלא         | ✗     |
|    25 | ▁גם             | ▁גם          | ✓     |
|    26 | ▁את             | ▁את          | ✓     |
|    27 | ▁מה             | ▁אופן        | ✗     |
|    28 | ▁הפעולה         | ▁התגובה      | ✗     |
|    29 | ▁שלהן           | ▁ב           | ✗     |
|    30 | בדיקה           | היבט         | ✗     |
|    31 | ים              | ים           | ✓     |
|    32 | ▁אלה            | ▁דוגמת       | ✗     |
|    33 | ו               | ▁שפת         | ✗     |
|    34 | ו               | ▁גוף         | ✗     |
|    35 | ▁זה             | ,            | ✗     |
|    36 | </s>            | ▁אי          | ✗     |
|    37 | -               | נט           | ✗     |
|    38 | ואי             | ונציה        | ✗     |
|    39 | ,               | ,            | ✓     |
|    40 | </s>            | ▁קשר         | ✗     |
|    41 | ▁זה             | ▁עין         | ✗     |
|    42 | ▁חדש            | ▁ועוד        | ✗     |
|    43 | ▁יותר           |              | ✗     |

2024-12-31 19:03:30,671 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:03:30,675 - TrainingLogger - INFO - Gradient norm: 9.7737
2024-12-31 19:03:38,392 - TrainingLogger - INFO - Step 17010, Batch metrics: Loss: 7.5799, Accuracy: 0.0933, Perplexity: 1958.3636
2024-12-31 19:03:45,524 - TrainingLogger - INFO - Step 17020, Batch metrics: Loss: 7.1780, Accuracy: 0.0746, Perplexity: 1310.2982
2024-12-31 19:03:52,543 - TrainingLogger - INFO - Step 17030, Batch metrics: Loss: 6.9609, Accuracy: 0.0969, Perplexity: 1054.6138
2024-12-31 19:03:59,670 - TrainingLogger - INFO - Step 17040, Batch metrics: Loss: 7.4110, Accuracy: 0.1011, Perplexity: 1654.0248
2024-12-31 19:04:07,173 - TrainingLogger - INFO - Step 17050, Batch metrics: Loss: 7.5875, Accuracy: 0.0909, Perplexity: 1973.4466
2024-12-31 19:04:14,213 - TrainingLogger - INFO - Step 17060, Batch metrics: Loss: 7.3292, Accuracy: 0.0732, Perplexity: 1524.1834
2024-12-31 19:04:21,574 - TrainingLogger - INFO - Step 17070, Batch metrics: Loss: 7.3097, Accuracy: 0.0727, Perplexity: 1494.7259
2024-12-31 19:04:29,069 - TrainingLogger - INFO - Step 17080, Batch metrics: Loss: 7.3832, Accuracy: 0.0647, Perplexity: 1608.7236
2024-12-31 19:04:36,212 - TrainingLogger - INFO - Step 17090, Batch metrics: Loss: 7.3686, Accuracy: 0.0892, Perplexity: 1585.3951
2024-12-31 19:04:43,858 - TrainingLogger - INFO - Step 17100, Batch metrics: Loss: 7.4125, Accuracy: 0.0541, Perplexity: 1656.6311
2024-12-31 19:04:43,858 - TrainingLogger - INFO - Step 17100, Prediction vs Actual:
2024-12-31 19:04:43,858 - TrainingLogger - INFO - Input 1: מצער במיוחד לדעת כי דווקא בענף שכל כך צמא להגדרה בין מעסיקים לעובדים הגענו לפגיעה בהתארגנות במקום להסכם
2024-12-31 19:04:43,859 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:04:43,859 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מצער        | ✗     |
|     1 | ▁-              | ▁במיוחד      | ✗     |
|     2 | .               | ▁לדעת        | ✗     |
|     3 | ▁את             | ▁כי          | ✗     |
|     4 | ▁הוא            | ▁דווקא       | ✗     |
|     5 | ▁אני            | ▁ב           | ✗     |
|     6 | -19             | ענף          | ✗     |
|     7 | ▁הזה            | ▁שכל         | ✗     |
|     8 | ל               | ▁כך          | ✗     |
|     9 | ▁קשה            | ▁צמא         | ✗     |
|    10 | .               | ▁לה          | ✗     |
|    11 | ,               | גדר          | ✗     |
|    12 | ה               | ה            | ✓     |
|    13 | ,               | ▁בין         | ✗     |
|    14 | ▁ישראל          | ▁מעסיק       | ✗     |
|    15 | ים              | ים           | ✓     |
|    16 | ▁אחרים          | ▁ל           | ✗     |
|    17 | מולדת           | עובדים       | ✗     |
|    18 | .               | ▁הגענו       | ✗     |
|    19 | ▁ל              | ▁לפגיעה      | ✗     |
|    20 | .               | ▁בה          | ✗     |
|    21 | .               | תארגנו       | ✗     |
|    22 | ת               | ת            | ✓     |
|    23 | ▁קשה            | ▁במקום       | ✗     |
|    24 | ▁הראשון         | ▁ל           | ✗     |
|    25 | נבחר            | הסכם         | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ▁קשה            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 19:04:43,859 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:04:43,864 - TrainingLogger - INFO - Gradient norm: 7.9953
2024-12-31 19:04:51,626 - TrainingLogger - INFO - Step 17110, Batch metrics: Loss: 7.3587, Accuracy: 0.0980, Perplexity: 1569.8047
2024-12-31 19:04:58,327 - TrainingLogger - INFO - Step 17120, Batch metrics: Loss: 7.3793, Accuracy: 0.0662, Perplexity: 1602.5144
2024-12-31 19:05:05,367 - TrainingLogger - INFO - Step 17130, Batch metrics: Loss: 7.6002, Accuracy: 0.0959, Perplexity: 1998.5664
2024-12-31 19:05:12,473 - TrainingLogger - INFO - Step 17140, Batch metrics: Loss: 7.4593, Accuracy: 0.1105, Perplexity: 1735.9748
2024-12-31 19:05:19,251 - TrainingLogger - INFO - Step 17150, Batch metrics: Loss: 7.4832, Accuracy: 0.0897, Perplexity: 1777.8499
2024-12-31 19:05:26,556 - TrainingLogger - INFO - Step 17160, Batch metrics: Loss: 7.9845, Accuracy: 0.0934, Perplexity: 2935.0868
2024-12-31 19:05:33,958 - TrainingLogger - INFO - Step 17170, Batch metrics: Loss: 7.3765, Accuracy: 0.0769, Perplexity: 1597.9125
2024-12-31 19:05:41,502 - TrainingLogger - INFO - Step 17180, Batch metrics: Loss: 6.4670, Accuracy: 0.0962, Perplexity: 643.5195
2024-12-31 19:05:48,184 - TrainingLogger - INFO - Step 17190, Batch metrics: Loss: 6.8937, Accuracy: 0.0962, Perplexity: 985.9975
2024-12-31 19:05:55,140 - TrainingLogger - INFO - Step 17200, Batch metrics: Loss: 7.2019, Accuracy: 0.1042, Perplexity: 1342.0146
2024-12-31 19:05:55,140 - TrainingLogger - INFO - Step 17200, Prediction vs Actual:
2024-12-31 19:05:55,140 - TrainingLogger - INFO - Input 1: אמילי הנד כתבה לכפיר ואחיו אריאל יום הולדת שמח
2024-12-31 19:05:55,141 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:05:55,141 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אמילי       | ✗     |
|     1 | ה               | ▁הנד         | ✗     |
|     2 | תה              | ▁כתבה        | ✗     |
|     3 | ▁חדשה           | ▁לכ          | ✗     |
|     4 | רה              | פיר          | ✗     |
|     5 | ית              | ▁ואחיו       | ✗     |
|     6 | .               | ▁אריאל       | ✗     |
|     7 | יה              | ▁יום         | ✗     |
|     8 | ▁אחד            | ▁הולדת       | ✗     |
|     9 | ה               | ▁שמח         | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁ישראל          | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 19:05:55,141 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:05:55,146 - TrainingLogger - INFO - Gradient norm: 9.1838
2024-12-31 19:06:02,554 - TrainingLogger - INFO - Step 17210, Batch metrics: Loss: 7.4104, Accuracy: 0.0812, Perplexity: 1653.1496
2024-12-31 19:06:09,619 - TrainingLogger - INFO - Step 17220, Batch metrics: Loss: 7.4089, Accuracy: 0.0659, Perplexity: 1650.5534
2024-12-31 19:06:16,804 - TrainingLogger - INFO - Step 17230, Batch metrics: Loss: 6.7748, Accuracy: 0.0825, Perplexity: 875.4991
2024-12-31 19:06:24,050 - TrainingLogger - INFO - Step 17240, Batch metrics: Loss: 6.9875, Accuracy: 0.1361, Perplexity: 1082.9757
2024-12-31 19:06:31,334 - TrainingLogger - INFO - Step 17250, Batch metrics: Loss: 7.0596, Accuracy: 0.0841, Perplexity: 1163.9938
2024-12-31 19:06:38,116 - TrainingLogger - INFO - Step 17260, Batch metrics: Loss: 7.3673, Accuracy: 0.0930, Perplexity: 1583.3221
2024-12-31 19:06:45,478 - TrainingLogger - INFO - Step 17270, Batch metrics: Loss: 7.3269, Accuracy: 0.0598, Perplexity: 1520.6503
2024-12-31 19:06:52,823 - TrainingLogger - INFO - Step 17280, Batch metrics: Loss: 8.0145, Accuracy: 0.0521, Perplexity: 3024.3688
2024-12-31 19:06:59,739 - TrainingLogger - INFO - Step 17290, Batch metrics: Loss: 9.5830, Accuracy: 0.0088, Perplexity: 14516.3197
2024-12-31 19:07:07,205 - TrainingLogger - INFO - Step 17300, Batch metrics: Loss: 10.0841, Accuracy: 0.0000, Perplexity: 23959.6735
2024-12-31 19:07:07,205 - TrainingLogger - INFO - Step 17300, Prediction vs Actual:
2024-12-31 19:07:07,205 - TrainingLogger - INFO - Input 1: הסיבה לכך היא שהבנקים נשענים על הנחיות בנק ישראל בעניין, בוודאי בכל הקשור לפעילות הסניפים ולקבלת קהל, ועד כה לא פרסם הפיקוח על הבנקים שום הנחיות בעניין
2024-12-31 19:07:07,206 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:07:07,206 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁?              | ▁הסיבה       | ✗     |
|     1 | ה               | ▁לכך         | ✗     |
|     2 | </s>            | ▁היא         | ✗     |
|     3 | </s>            | ▁שה          | ✗     |
|     4 | </s>            | בנק          | ✗     |
|     5 | </s>            | ים           | ✗     |
|     6 | </s>            | ▁נש          | ✗     |
|     7 | ▁?              | ענים         | ✗     |
|     8 | </s>            | ▁על          | ✗     |
|     9 | </s>            | ▁הנחיות      | ✗     |
|    10 | </s>            | ▁בנק         | ✗     |
|    11 | ▁?              | ▁ישראל       | ✗     |
|    12 | </s>            | ▁בעניין      | ✗     |
|    13 | ה               | ,            | ✗     |
|    14 | </s>            | ▁בוודאי      | ✗     |
|    15 | </s>            | ▁בכל         | ✗     |
|    16 | </s>            | ▁הקשור       | ✗     |
|    17 | </s>            | ▁לפעילות     | ✗     |
|    18 | </s>            | ▁הסנ         | ✗     |
|    19 | </s>            | יפים         | ✗     |
|    20 | </s>            | ▁ולקבל       | ✗     |
|    21 | </s>            | ת            | ✗     |
|    22 | </s>            | ▁קהל         | ✗     |
|    23 | ▁?              | ,            | ✗     |
|    24 | </s>            | ▁ועד         | ✗     |
|    25 | </s>            | ▁כה          | ✗     |
|    26 | ▁?              | ▁לא          | ✗     |
|    27 | ▁של             | ▁פרס         | ✗     |
|    28 | ,               | ם            | ✗     |
|    29 | ▁של             | ▁הפיקוח      | ✗     |
|    30 | </s>            | ▁על          | ✗     |
|    31 | ▁?              | ▁הבנק        | ✗     |
|    32 | </s>            | ים           | ✗     |
|    33 | ▁אני            | ▁שום         | ✗     |
|    34 | ▁של             | ▁הנחיות      | ✗     |
|    35 | ▁אני            | ▁בעניין      | ✗     |
|    36 | </s>            |              | ✗     |

2024-12-31 19:07:07,206 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:07:07,211 - TrainingLogger - INFO - Gradient norm: 6.5669
2024-12-31 19:07:14,062 - TrainingLogger - INFO - Step 17310, Batch metrics: Loss: 9.7412, Accuracy: 0.0000, Perplexity: 17003.8604
2024-12-31 19:07:20,988 - TrainingLogger - INFO - Step 17320, Batch metrics: Loss: 9.7433, Accuracy: 0.0043, Perplexity: 17040.2071
2024-12-31 19:07:27,879 - TrainingLogger - INFO - Step 17330, Batch metrics: Loss: 9.3411, Accuracy: 0.0240, Perplexity: 11397.0220
2024-12-31 19:07:34,989 - TrainingLogger - INFO - Step 17340, Batch metrics: Loss: 9.3580, Accuracy: 0.0229, Perplexity: 11590.9707
2024-12-31 19:07:42,516 - TrainingLogger - INFO - Step 17350, Batch metrics: Loss: 8.6966, Accuracy: 0.0382, Perplexity: 5982.7079
2024-12-31 19:07:49,381 - TrainingLogger - INFO - Step 17360, Batch metrics: Loss: 8.7775, Accuracy: 0.0398, Perplexity: 6486.6475
2024-12-31 19:07:56,369 - TrainingLogger - INFO - Step 17370, Batch metrics: Loss: 10.0157, Accuracy: 0.0000, Perplexity: 22373.9083
2024-12-31 19:08:03,208 - TrainingLogger - INFO - Step 17380, Batch metrics: Loss: 8.9684, Accuracy: 0.0522, Perplexity: 7851.2770
2024-12-31 19:08:10,276 - TrainingLogger - INFO - Step 17390, Batch metrics: Loss: 8.8065, Accuracy: 0.0209, Perplexity: 6677.4081
2024-12-31 19:08:16,958 - TrainingLogger - INFO - Step 17400, Batch metrics: Loss: 9.1162, Accuracy: 0.0514, Perplexity: 9101.4498
2024-12-31 19:08:16,959 - TrainingLogger - INFO - Step 17400, Prediction vs Actual:
2024-12-31 19:08:16,959 - TrainingLogger - INFO - Input 1: היהדות הפכה לדת של חוקים ופחות נותנים את הדעת לערך המוסף שלה ולדברים שעוברים מדור לדור
2024-12-31 19:08:16,959 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:08:16,959 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁היה         | ✗     |
|     1 | ,               | דות          | ✗     |
|     2 | ם               | ▁הפכה        | ✗     |
|     3 | ▁אותה           | ▁לדת         | ✗     |
|     4 | ה               | ▁של          | ✗     |
|     5 | ▁ה              | ▁חוקים       | ✗     |
|     6 | ,               | ▁ופחות       | ✗     |
|     7 | ▁את             | ▁נותנים      | ✗     |
|     8 | ▁לו             | ▁את          | ✗     |
|     9 | י               | ▁הדעת        | ✗     |
|    10 | ות              | ▁ל           | ✗     |
|    11 | ▁זה             | ערך          | ✗     |
|    12 | ,               | ▁המ          | ✗     |
|    13 | ,               | וסף          | ✗     |
|    14 | ,               | ▁שלה         | ✗     |
|    15 | ים              | ▁ולדבר       | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ,               | ▁שעובר       | ✗     |
|    18 | ים              | ים           | ✓     |
|    19 | ,               | ▁מדור        | ✗     |
|    20 | ים              | ▁לדור        | ✗     |
|    21 | י               | <pad>        | ✗     |
|    22 | י               | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | יים             | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | י               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ם               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | ית              | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | י               | <pad>        | ✗     |
|    43 | ות              | <pad>        | ✗     |
|    44 | ▁ממש            | <pad>        | ✗     |
|    45 | ,               | <pad>        | ✗     |
|    46 | ,               |              | ✗     |

2024-12-31 19:08:16,959 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:08:16,964 - TrainingLogger - INFO - Gradient norm: 7.9871
2024-12-31 19:08:23,472 - TrainingLogger - INFO - Step 17410, Batch metrics: Loss: 8.7380, Accuracy: 0.0197, Perplexity: 6235.1205
2024-12-31 19:08:31,088 - TrainingLogger - INFO - Step 17420, Batch metrics: Loss: 8.7044, Accuracy: 0.0474, Perplexity: 6029.5331
2024-12-31 19:08:38,239 - TrainingLogger - INFO - Step 17430, Batch metrics: Loss: 9.0708, Accuracy: 0.0379, Perplexity: 8697.9260
2024-12-31 19:08:44,784 - TrainingLogger - INFO - Step 17440, Batch metrics: Loss: 8.8609, Accuracy: 0.0366, Perplexity: 7050.9529
2024-12-31 19:08:51,501 - TrainingLogger - INFO - Step 17450, Batch metrics: Loss: 8.5727, Accuracy: 0.0336, Perplexity: 5285.4089
2024-12-31 19:08:59,055 - TrainingLogger - INFO - Step 17460, Batch metrics: Loss: 8.5982, Accuracy: 0.0523, Perplexity: 5422.1543
2024-12-31 19:09:06,349 - TrainingLogger - INFO - Step 17470, Batch metrics: Loss: 8.5115, Accuracy: 0.0658, Perplexity: 4971.6025
2024-12-31 19:09:13,045 - TrainingLogger - INFO - Step 17480, Batch metrics: Loss: 9.0670, Accuracy: 0.0299, Perplexity: 8664.1977
2024-12-31 19:09:20,462 - TrainingLogger - INFO - Step 17490, Batch metrics: Loss: 8.1645, Accuracy: 0.0615, Perplexity: 3513.9916
2024-12-31 19:09:27,307 - TrainingLogger - INFO - Step 17500, Batch metrics: Loss: 8.5398, Accuracy: 0.0397, Perplexity: 5114.5588
2024-12-31 19:09:27,307 - TrainingLogger - INFO - Step 17500, Prediction vs Actual:
2024-12-31 19:09:27,307 - TrainingLogger - INFO - Input 1: אני רואה שילוב מטריד בין ביקורת על פעולות ממשלת ישראל לגינויים של כל הישראלים ושל העם היהודי
2024-12-31 19:09:27,308 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:09:27,308 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁אני         | ✗     |
|     1 | ,               | ▁רואה        | ✗     |
|     2 | ון              | ▁שילוב       | ✗     |
|     3 | ▁שלך            | ▁מטריד       | ✗     |
|     4 | ▁שלי            | ▁בין         | ✗     |
|     5 | ▁ה              | ▁ביקורת      | ✗     |
|     6 | ▁של             | ▁על          | ✗     |
|     7 | -               | ▁פעולות      | ✗     |
|     8 | ,               | ▁ממשלת       | ✗     |
|     9 | י               | ▁ישראל       | ✗     |
|    10 | י               | ▁לג          | ✗     |
|    11 | ות              | ינו          | ✗     |
|    12 | ,               | יים          | ✗     |
|    13 | ▁שלי            | ▁של          | ✗     |
|    14 | ▁ה              | ▁כל          | ✗     |
|    15 | ▁ה              | ▁הישראלי     | ✗     |
|    16 | ות              | ם            | ✗     |
|    17 | ▁של             | ▁ושל         | ✗     |
|    18 | ים              | ▁העם         | ✗     |
|    19 | ▁שלי            | ▁היהודי      | ✗     |
|    20 | ות              | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ▁שלי            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ות              | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ▁שלי            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 19:09:27,308 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:09:27,313 - TrainingLogger - INFO - Gradient norm: 14.6577
2024-12-31 19:09:35,837 - TrainingLogger - INFO - Step 17510, Batch metrics: Loss: 8.3178, Accuracy: 0.0462, Perplexity: 4095.9376
2024-12-31 19:09:43,227 - TrainingLogger - INFO - Step 17520, Batch metrics: Loss: 8.1521, Accuracy: 0.0584, Perplexity: 3470.4863
2024-12-31 19:09:50,256 - TrainingLogger - INFO - Step 17530, Batch metrics: Loss: 8.1732, Accuracy: 0.0333, Perplexity: 3544.6675
2024-12-31 19:09:57,657 - TrainingLogger - INFO - Step 17540, Batch metrics: Loss: 8.7832, Accuracy: 0.0196, Perplexity: 6523.9019
2024-12-31 19:10:04,330 - TrainingLogger - INFO - Step 17550, Batch metrics: Loss: 7.6236, Accuracy: 0.1039, Perplexity: 2045.9308
2024-12-31 19:10:11,983 - TrainingLogger - INFO - Step 17560, Batch metrics: Loss: 8.5252, Accuracy: 0.0200, Perplexity: 5040.2615
2024-12-31 19:10:18,176 - TrainingLogger - INFO - Step 17570, Batch metrics: Loss: 8.1017, Accuracy: 0.0650, Perplexity: 3299.9250
2024-12-31 19:10:25,667 - TrainingLogger - INFO - Step 17580, Batch metrics: Loss: 8.3998, Accuracy: 0.0458, Perplexity: 4446.2975
2024-12-31 19:10:33,602 - TrainingLogger - INFO - Step 17590, Batch metrics: Loss: 8.4177, Accuracy: 0.0406, Perplexity: 4526.2984
2024-12-31 19:10:40,184 - TrainingLogger - INFO - Step 17600, Batch metrics: Loss: 7.9254, Accuracy: 0.1034, Perplexity: 2766.7177
2024-12-31 19:10:40,185 - TrainingLogger - INFO - Step 17600, Prediction vs Actual:
2024-12-31 19:10:40,185 - TrainingLogger - INFO - Input 1: כל השתהות בנושא תביא לכך כי עובדים ייפגעו במיידית וייוותרו ללא כל הגנה כלשהי באם עליהם להיכנס לבידוד
2024-12-31 19:10:40,185 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:10:40,185 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כל          | ✗     |
|     1 | ▁כי             | ▁השת         | ✗     |
|     2 | ים              | ה            | ✗     |
|     3 | ים              | ות           | ✗     |
|     4 | ▁שלו            | ▁בנושא       | ✗     |
|     5 | ים              | ▁תביא        | ✗     |
|     6 | ▁לו             | ▁לכך         | ✗     |
|     7 | ▁את             | ▁כי          | ✗     |
|     8 | ▁היא            | ▁עובדים      | ✗     |
|     9 | ▁הוא            | ▁ייפגע       | ✗     |
|    10 | ים              | ו            | ✗     |
|    11 | ▁עוד            | ▁במי         | ✗     |
|    12 | ון              | ידית         | ✗     |
|    13 | ▁אחת            | ▁וי          | ✗     |
|    14 | ה               | יוותר        | ✗     |
|    15 | ים              | ו            | ✗     |
|    16 | .               | ▁ללא         | ✗     |
|    17 | ▁כל             | ▁כל          | ✓     |
|    18 | ▁כל             | ▁הגנה        | ✗     |
|    19 | ,               | ▁כלשהי       | ✗     |
|    20 | .               | ▁בא          | ✗     |
|    21 | ות              | ם            | ✗     |
|    22 | ▁הוא            | ▁עליהם       | ✗     |
|    23 | .               | ▁להיכנס      | ✗     |
|    24 | ים              | ▁לבי         | ✗     |
|    25 | ים              | דוד          | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | י               | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | ▁זה             | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | י               | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ▁זה             | <pad>        | ✗     |
|    39 | ים              |              | ✗     |

2024-12-31 19:10:40,185 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:10:40,190 - TrainingLogger - INFO - Gradient norm: 14.4256
2024-12-31 19:10:47,489 - TrainingLogger - INFO - Step 17610, Batch metrics: Loss: 8.1993, Accuracy: 0.0606, Perplexity: 3638.2978
2024-12-31 19:10:54,853 - TrainingLogger - INFO - Step 17620, Batch metrics: Loss: 8.0804, Accuracy: 0.0755, Perplexity: 3230.3911
2024-12-31 19:11:01,998 - TrainingLogger - INFO - Step 17630, Batch metrics: Loss: 8.2603, Accuracy: 0.0497, Perplexity: 3867.2381
2024-12-31 19:11:09,291 - TrainingLogger - INFO - Step 17640, Batch metrics: Loss: 7.6966, Accuracy: 0.0681, Perplexity: 2200.8586
2024-12-31 19:11:16,745 - TrainingLogger - INFO - Step 17650, Batch metrics: Loss: 7.6416, Accuracy: 0.0632, Perplexity: 2083.0624
2024-12-31 19:11:23,920 - TrainingLogger - INFO - Step 17660, Batch metrics: Loss: 8.1030, Accuracy: 0.0786, Perplexity: 3304.4063
2024-12-31 19:11:31,025 - TrainingLogger - INFO - Step 17670, Batch metrics: Loss: 7.8154, Accuracy: 0.0632, Perplexity: 2478.5695
2024-12-31 19:11:37,698 - TrainingLogger - INFO - Step 17680, Batch metrics: Loss: 8.2239, Accuracy: 0.0485, Perplexity: 3728.8708
2024-12-31 19:11:44,392 - TrainingLogger - INFO - Step 17690, Batch metrics: Loss: 7.8544, Accuracy: 0.0741, Perplexity: 2576.9898
2024-12-31 19:11:51,532 - TrainingLogger - INFO - Step 17700, Batch metrics: Loss: 7.5446, Accuracy: 0.0939, Perplexity: 1890.4388
2024-12-31 19:11:51,533 - TrainingLogger - INFO - Step 17700, Prediction vs Actual:
2024-12-31 19:11:51,533 - TrainingLogger - INFO - Input 1: שופטי בגץ קבעו כי על המדינה להסביר מדוע לא תבוטל החלטת הממשלה שמונעת אכיפה של שירות תלמידי ישיבות, ומדוע לא מגייסים אותם נוכח פקיעת חוק הגיוס
2024-12-31 19:11:51,533 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:11:51,533 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שופט        | ✗     |
|     1 | </s>            | י            | ✗     |
|     2 | "               | ▁בג          | ✗     |
|     3 | '               | ץ            | ✗     |
|     4 | '               | ▁קבע         | ✗     |
|     5 | :               | ו            | ✗     |
|     6 | ▁את             | ▁כי          | ✗     |
|     7 | ון              | ▁על          | ✗     |
|     8 | ▁זה             | ▁המדינה      | ✗     |
|     9 | ▁הזו            | ▁להסביר      | ✗     |
|    10 | ו               | ▁מדוע        | ✗     |
|    11 | ,               | ▁לא          | ✗     |
|    12 | ▁נראה           | ▁ת           | ✗     |
|    13 | מש              | בוט          | ✗     |
|    14 | ם               | ל            | ✗     |
|    15 | .               | ▁החלטת       | ✗     |
|    16 | ה               | ▁הממשלה      | ✗     |
|    17 | .               | ▁שמו         | ✗     |
|    18 | ,               | נע           | ✗     |
|    19 | ה               | ת            | ✗     |
|    20 | ▁מכך            | ▁אכ          | ✗     |
|    21 | פ               | יפה          | ✗     |
|    22 | .               | ▁של          | ✗     |
|    23 | ▁ג              | ▁שירות       | ✗     |
|    24 | ה               | ▁תלמידי      | ✗     |
|    25 | -               | ▁ישיב        | ✗     |
|    26 | ה               | ות           | ✗     |
|    27 | ,               | ,            | ✓     |
|    28 | "               | ▁ומדוע       | ✗     |
|    29 | ה               | ▁לא          | ✗     |
|    30 | ה               | ▁מגייס       | ✗     |
|    31 | ה               | ים           | ✗     |
|    32 | ▁אותה           | ▁אותם        | ✗     |
|    33 | ת               | ▁נוכח        | ✗     |
|    34 | י               | ▁פק          | ✗     |
|    35 | ה               | י            | ✗     |
|    36 | זה              | עת           | ✗     |
|    37 | ה               | ▁חוק         | ✗     |
|    38 | ה               | ▁הגיוס       | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | ות              | <pad>        | ✗     |
|    41 | ▁זה             | <pad>        | ✗     |
|    42 | ▁זה             |              | ✗     |

2024-12-31 19:11:51,533 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:11:51,538 - TrainingLogger - INFO - Gradient norm: 11.0308
2024-12-31 19:11:59,155 - TrainingLogger - INFO - Step 17710, Batch metrics: Loss: 8.1505, Accuracy: 0.0584, Perplexity: 3465.1387
2024-12-31 19:12:06,766 - TrainingLogger - INFO - Step 17720, Batch metrics: Loss: 8.4068, Accuracy: 0.0823, Perplexity: 4477.5434
2024-12-31 19:12:13,812 - TrainingLogger - INFO - Step 17730, Batch metrics: Loss: 7.5891, Accuracy: 0.0983, Perplexity: 1976.4799
2024-12-31 19:12:20,850 - TrainingLogger - INFO - Step 17740, Batch metrics: Loss: 8.0897, Accuracy: 0.0337, Perplexity: 3260.7239
2024-12-31 19:12:28,593 - TrainingLogger - INFO - Step 17750, Batch metrics: Loss: 7.5052, Accuracy: 0.0940, Perplexity: 1817.4790
2024-12-31 19:12:35,297 - TrainingLogger - INFO - Step 17760, Batch metrics: Loss: 8.2705, Accuracy: 0.0280, Perplexity: 3907.0294
2024-12-31 19:12:43,131 - TrainingLogger - INFO - Step 17770, Batch metrics: Loss: 8.2204, Accuracy: 0.0773, Perplexity: 3715.9879
2024-12-31 19:12:50,724 - TrainingLogger - INFO - Step 17780, Batch metrics: Loss: 7.6653, Accuracy: 0.0697, Perplexity: 2133.0405
2024-12-31 19:12:58,191 - TrainingLogger - INFO - Step 17790, Batch metrics: Loss: 8.4337, Accuracy: 0.0308, Perplexity: 4599.5858
2024-12-31 19:13:05,752 - TrainingLogger - INFO - Step 17800, Batch metrics: Loss: 7.9455, Accuracy: 0.0867, Perplexity: 2822.7827
2024-12-31 19:13:05,752 - TrainingLogger - INFO - Step 17800, Prediction vs Actual:
2024-12-31 19:13:05,752 - TrainingLogger - INFO - Input 1: אני אאלץ להמשיך לעבוד כדי לממן את הלימודים, אני עובד בלילות כי אין לי ברירה אחרת
2024-12-31 19:13:05,753 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:13:05,753 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אני         | ✗     |
|     1 | ▁את             | ▁אאלץ        | ✗     |
|     2 | ▁זה             | ▁להמשיך      | ✗     |
|     3 | .               | ▁לעבוד       | ✗     |
|     4 | .               | ▁כדי         | ✗     |
|     5 | ▁לי             | ▁לממן        | ✗     |
|     6 | ▁את             | ▁את          | ✓     |
|     7 | ▁זה             | ▁הלימודים    | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | <pad>           | ▁אני         | ✗     |
|    10 | ▁לא             | ▁עובד        | ✗     |
|    11 | .               | ▁בלילות      | ✗     |
|    12 | .               | ▁כי          | ✗     |
|    13 | נים             | ▁אין         | ✗     |
|    14 | ▁לי             | ▁לי          | ✓     |
|    15 | ▁שום            | ▁ברירה       | ✗     |
|    16 | ▁אחת            | ▁אחרת        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | ▁את             | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | .               | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | ▁אני            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | <pad>           |              | ✗     |

2024-12-31 19:13:05,753 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:13:05,758 - TrainingLogger - INFO - Gradient norm: 10.8077
2024-12-31 19:13:13,140 - TrainingLogger - INFO - Step 17810, Batch metrics: Loss: 8.2040, Accuracy: 0.0286, Perplexity: 3655.6914
2024-12-31 19:13:20,718 - TrainingLogger - INFO - Step 17820, Batch metrics: Loss: 7.7048, Accuracy: 0.0524, Perplexity: 2218.9791
2024-12-31 19:13:27,779 - TrainingLogger - INFO - Step 17830, Batch metrics: Loss: 7.6438, Accuracy: 0.0730, Perplexity: 2087.6306
2024-12-31 19:13:35,304 - TrainingLogger - INFO - Step 17840, Batch metrics: Loss: 7.8243, Accuracy: 0.0433, Perplexity: 2500.5249
2024-12-31 19:13:42,518 - TrainingLogger - INFO - Step 17850, Batch metrics: Loss: 7.7713, Accuracy: 0.0570, Perplexity: 2371.6673
2024-12-31 19:13:49,640 - TrainingLogger - INFO - Step 17860, Batch metrics: Loss: 8.2885, Accuracy: 0.0270, Perplexity: 3977.7333
2024-12-31 19:13:56,880 - TrainingLogger - INFO - Step 17870, Batch metrics: Loss: 7.7671, Accuracy: 0.0606, Perplexity: 2361.6202
2024-12-31 19:14:03,896 - TrainingLogger - INFO - Step 17880, Batch metrics: Loss: 8.0870, Accuracy: 0.0483, Perplexity: 3251.8393
2024-12-31 19:14:10,683 - TrainingLogger - INFO - Step 17890, Batch metrics: Loss: 8.1935, Accuracy: 0.0357, Perplexity: 3617.2696
2024-12-31 19:14:17,970 - TrainingLogger - INFO - Step 17900, Batch metrics: Loss: 7.7512, Accuracy: 0.0806, Perplexity: 2324.3061
2024-12-31 19:14:17,970 - TrainingLogger - INFO - Step 17900, Prediction vs Actual:
2024-12-31 19:14:17,970 - TrainingLogger - INFO - Input 1: פעם לעבוד בשביל הממשלה זה היה סוג של בגידה, היום זה כבר חלום של הרבה אמהות ערביות
2024-12-31 19:14:17,971 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:14:17,971 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁פעם         | ✗     |
|     1 | ה               | ▁לעבוד       | ✗     |
|     2 | ▁יותר           | ▁בשביל       | ✗     |
|     3 | ▁כמה            | ▁הממשלה      | ✗     |
|     4 | ▁שלנו           | ▁זה          | ✗     |
|     5 | ▁יותר           | ▁היה         | ✗     |
|     6 | ▁הרבה           | ▁סוג         | ✗     |
|     7 | ▁של             | ▁של          | ✓     |
|     8 | ▁של             | ▁בגידה       | ✗     |
|     9 | </s>            | ,            | ✗     |
|    10 | </s>            | ▁היום        | ✗     |
|    11 | ,               | ▁זה          | ✗     |
|    12 | ▁כבר            | ▁כבר         | ✓     |
|    13 | ▁ממש            | ▁חלום        | ✗     |
|    14 | </s>            | ▁של          | ✗     |
|    15 | ▁משהו           | ▁הרבה        | ✗     |
|    16 | ▁יותר           | ▁אמהות       | ✗     |
|    17 | </s>            | ▁ערב         | ✗     |
|    18 | ה               | יות          | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 19:14:17,971 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:14:17,976 - TrainingLogger - INFO - Gradient norm: 15.2731
2024-12-31 19:14:25,462 - TrainingLogger - INFO - Step 17910, Batch metrics: Loss: 7.9707, Accuracy: 0.0780, Perplexity: 2894.8618
2024-12-31 19:14:32,259 - TrainingLogger - INFO - Step 17920, Batch metrics: Loss: 7.8496, Accuracy: 0.0404, Perplexity: 2564.7971
2024-12-31 19:14:39,890 - TrainingLogger - INFO - Step 17930, Batch metrics: Loss: 8.0681, Accuracy: 0.0711, Perplexity: 3191.1517
2024-12-31 19:14:46,761 - TrainingLogger - INFO - Step 17940, Batch metrics: Loss: 7.7877, Accuracy: 0.0994, Perplexity: 2410.8738
2024-12-31 19:14:53,719 - TrainingLogger - INFO - Step 17950, Batch metrics: Loss: 8.2602, Accuracy: 0.0660, Perplexity: 3866.8288
2024-12-31 19:15:00,429 - TrainingLogger - INFO - Step 17960, Batch metrics: Loss: 8.2627, Accuracy: 0.0097, Perplexity: 3876.4102
2024-12-31 19:15:07,829 - TrainingLogger - INFO - Step 17970, Batch metrics: Loss: 7.7067, Accuracy: 0.0714, Perplexity: 2223.1371
2024-12-31 19:15:14,765 - TrainingLogger - INFO - Step 17980, Batch metrics: Loss: 7.6768, Accuracy: 0.0508, Perplexity: 2157.6295
2024-12-31 19:15:22,346 - TrainingLogger - INFO - Step 17990, Batch metrics: Loss: 7.4678, Accuracy: 0.0788, Perplexity: 1750.8278
2024-12-31 19:15:29,111 - TrainingLogger - INFO - Step 18000, Batch metrics: Loss: 7.6871, Accuracy: 0.0769, Perplexity: 2180.1232
2024-12-31 19:15:29,112 - TrainingLogger - INFO - Step 18000, Prediction vs Actual:
2024-12-31 19:15:29,112 - TrainingLogger - INFO - Input 1: אני עובדת על זה כבר שבועות רבים
2024-12-31 19:15:29,112 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:15:29,112 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | .               | ▁עובדת       | ✗     |
|     2 | ▁על             | ▁על          | ✓     |
|     3 | ▁זה             | ▁זה          | ✓     |
|     4 | .               | ▁כבר         | ✗     |
|     5 | ▁זמן            | ▁שבועות      | ✗     |
|     6 | ,               | ▁רבים        | ✗     |
|     7 | ▁יותר           | <pad>        | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ▁על             | <pad>        | ✗     |
|    11 | ▁עם             | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ▁זה             | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ▁זה             | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ▁את             | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁לא             | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁זה             | <pad>        | ✗     |
|    28 | ▁כבר            | <pad>        | ✗     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁זה             | <pad>        | ✗     |
|    32 | ▁זה             | <pad>        | ✗     |
|    33 | ▁זה             | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ▁לא             | <pad>        | ✗     |
|    40 | ▁זה             | <pad>        | ✗     |
|    41 | ▁זה             | <pad>        | ✗     |
|    42 | ▁את             |              | ✗     |

2024-12-31 19:15:29,112 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:15:29,117 - TrainingLogger - INFO - Gradient norm: 12.4483
2024-12-31 19:15:36,621 - TrainingLogger - INFO - Step 18010, Batch metrics: Loss: 7.7321, Accuracy: 0.0417, Perplexity: 2280.2729
2024-12-31 19:15:44,075 - TrainingLogger - INFO - Step 18020, Batch metrics: Loss: 8.4984, Accuracy: 0.0214, Perplexity: 4906.8306
2024-12-31 19:15:51,264 - TrainingLogger - INFO - Step 18030, Batch metrics: Loss: 7.7683, Accuracy: 0.0683, Perplexity: 2364.4766
2024-12-31 19:15:58,124 - TrainingLogger - INFO - Step 18040, Batch metrics: Loss: 8.2525, Accuracy: 0.0515, Perplexity: 3837.1321
2024-12-31 19:16:05,103 - TrainingLogger - INFO - Step 18050, Batch metrics: Loss: 7.8897, Accuracy: 0.0460, Perplexity: 2669.6593
2024-12-31 19:16:12,482 - TrainingLogger - INFO - Step 18060, Batch metrics: Loss: 7.4656, Accuracy: 0.0909, Perplexity: 1746.8576
2024-12-31 19:16:19,561 - TrainingLogger - INFO - Step 18070, Batch metrics: Loss: 7.5731, Accuracy: 0.0727, Perplexity: 1945.2390
2024-12-31 19:16:26,339 - TrainingLogger - INFO - Step 18080, Batch metrics: Loss: 8.0093, Accuracy: 0.0714, Perplexity: 3008.7392
2024-12-31 19:16:32,842 - TrainingLogger - INFO - Step 18090, Batch metrics: Loss: 7.8737, Accuracy: 0.0546, Perplexity: 2627.2539
2024-12-31 19:16:37,724 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 19:16:37,724 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 19:16:37,724 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 41]), device: cuda:0
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 41]), device: cuda:0
2024-12-31 19:16:37,725 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:16:37,726 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:16:37,726 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 19:16:37,726 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:16:37,726 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:16:37,726 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:16:40,711 - TrainingLogger - INFO - Step 18100, Batch metrics: Loss: 7.9744, Accuracy: 0.0718, Perplexity: 2905.5130
2024-12-31 19:16:40,711 - TrainingLogger - INFO - Step 18100, Prediction vs Actual:
2024-12-31 19:16:40,711 - TrainingLogger - INFO - Input 1: אמצעי בקרה נוספים שהוועדה תפעיל בבחירות הללו הם בין היתר הצבתו של מזכיר קלפי נוסף בכ-3,500 מהקלפיות
2024-12-31 19:16:40,712 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:16:40,712 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אמצעי       | ✗     |
|     1 | ▁זה             | ▁בקרה        | ✗     |
|     2 | ▁אחת            | ▁נוספים      | ✗     |
|     3 | ▁"              | ▁שהו         | ✗     |
|     4 | פעל             | ועדה         | ✗     |
|     5 | ▁ב              | ▁תפעיל       | ✗     |
|     6 | ו               | ▁בבחירות     | ✗     |
|     7 | ▁אחרות          | ▁הללו        | ✗     |
|     8 | :               | ▁הם          | ✗     |
|     9 | ▁"              | ▁בין         | ✗     |
|    10 | ▁שני            | ▁היתר        | ✗     |
|    11 | ה               | ▁הצבת        | ✗     |
|    12 | ם               | ו            | ✗     |
|    13 | ▁של             | ▁של          | ✓     |
|    14 | ▁המדינה         | ▁מזכיר       | ✗     |
|    15 | ות              | ▁קל          | ✗     |
|    16 | טרי             | פי           | ✗     |
|    17 | ▁ה              | ▁נוסף        | ✗     |
|    18 | ▁של             | ▁בכ          | ✗     |
|    19 | יפות            | -3           | ✗     |
|    20 | ▁אנשים          | ,            | ✗     |
|    21 | 5               | 500          | ✗     |
|    22 | ,               | ▁מה          | ✗     |
|    23 | ו               | קל           | ✗     |
|    24 | ות              | פיות         | ✗     |
|    25 | ▁האחרונות       | <pad>        | ✗     |
|    26 | ▁של             | <pad>        | ✗     |
|    27 | ▁של             | <pad>        | ✗     |
|    28 | ▁אחרות          | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ות              | <pad>        | ✗     |
|    32 | ו               | <pad>        | ✗     |
|    33 | ▁של             | <pad>        | ✗     |
|    34 | ▁שלהם           | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | ▁אחרות          | <pad>        | ✗     |
|    37 | ▁שלהם           | <pad>        | ✗     |
|    38 | ות              |              | ✗     |

2024-12-31 19:16:40,712 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:16:40,717 - TrainingLogger - INFO - Gradient norm: 16.3932
2024-12-31 19:16:48,408 - TrainingLogger - INFO - Step 18110, Batch metrics: Loss: 7.5974, Accuracy: 0.0785, Perplexity: 1993.0581
2024-12-31 19:16:55,868 - TrainingLogger - INFO - Step 18120, Batch metrics: Loss: 8.2576, Accuracy: 0.0552, Perplexity: 3856.9694
2024-12-31 19:17:02,601 - TrainingLogger - INFO - Step 18130, Batch metrics: Loss: 8.1037, Accuracy: 0.0549, Perplexity: 3306.6413
2024-12-31 19:17:09,746 - TrainingLogger - INFO - Step 18140, Batch metrics: Loss: 7.7079, Accuracy: 0.1071, Perplexity: 2225.8769
2024-12-31 19:17:16,791 - TrainingLogger - INFO - Step 18150, Batch metrics: Loss: 7.8800, Accuracy: 0.0824, Perplexity: 2643.8502
2024-12-31 19:17:23,412 - TrainingLogger - INFO - Step 18160, Batch metrics: Loss: 8.4598, Accuracy: 0.0342, Perplexity: 4721.0585
2024-12-31 19:17:30,528 - TrainingLogger - INFO - Step 18170, Batch metrics: Loss: 7.3479, Accuracy: 0.0696, Perplexity: 1552.9822
2024-12-31 19:17:37,866 - TrainingLogger - INFO - Step 18180, Batch metrics: Loss: 7.4890, Accuracy: 0.0995, Perplexity: 1788.3078
2024-12-31 19:17:45,030 - TrainingLogger - INFO - Step 18190, Batch metrics: Loss: 7.9710, Accuracy: 0.0551, Perplexity: 2895.6956
2024-12-31 19:17:52,398 - TrainingLogger - INFO - Step 18200, Batch metrics: Loss: 8.2727, Accuracy: 0.0427, Perplexity: 3915.4033
2024-12-31 19:17:52,399 - TrainingLogger - INFO - Step 18200, Prediction vs Actual:
2024-12-31 19:17:52,399 - TrainingLogger - INFO - Input 1: בתגובה למכתב ששלחה לו שרת התרבות והספורט, מירי רגב בנושא, טען וינשטיין כי ניתן להמשיך במדיניות אי האכיפה בתחום היות שהמשחקים מתקיימים מאז ומתמיד ללא הוצאת היתרים מיוחדים
2024-12-31 19:17:52,399 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:17:52,399 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בתגובה      | ✗     |
|     1 | ,               | ▁למכתב       | ✗     |
|     2 | ▁-              | ▁ששלח        | ✗     |
|     3 | ▁-              | ה            | ✗     |
|     4 | ▁אותנו          | ▁לו          | ✗     |
|     5 | ▁את             | ▁שרת         | ✗     |
|     6 | .               | ▁התרבות      | ✗     |
|     7 | י               | ▁וה          | ✗     |
|     8 | ה               | ספורט        | ✗     |
|     9 | י               | ,            | ✗     |
|    10 | ▁הוא            | ▁מי          | ✗     |
|    11 | ▁אמר            | רי           | ✗     |
|    12 | ,               | ▁רג          | ✗     |
|    13 | י               | ב            | ✗     |
|    14 | ,               | ▁בנושא       | ✗     |
|    15 | ,               | ,            | ✓     |
|    16 | <pad>           | ▁טען         | ✗     |
|    17 | ,               | ▁וי          | ✗     |
|    18 | נט              | נשטיין       | ✗     |
|    19 | ▁אותו           | ▁כי          | ✗     |
|    20 | ון              | ▁ניתן        | ✗     |
|    21 | ▁לו             | ▁להמשיך      | ✗     |
|    22 | ▁הלאה           | ▁ב           | ✗     |
|    23 | ממש             | מדיניות      | ✗     |
|    24 | ו               | ▁אי          | ✗     |
|    25 | -               | ▁הא          | ✗     |
|    26 | ה               | כי           | ✗     |
|    27 | ה               | פה           | ✗     |
|    28 | ▁שלו            | ▁בתחום       | ✗     |
|    29 | ▁זה             | ▁היות        | ✗     |
|    30 | ▁הזה            | ▁שהמשחק      | ✗     |
|    31 | תי              | ים           | ✗     |
|    32 | ▁שלו            | ▁מת          | ✗     |
|    33 | פר              | קיימים       | ✗     |
|    34 | ,               | ▁מאז         | ✗     |
|    35 | ן               | ▁ומתמיד      | ✗     |
|    36 | ים              | ▁ללא         | ✗     |
|    37 | ▁הצלחה          | ▁הוצאת       | ✗     |
|    38 | ו               | ▁היתר        | ✗     |
|    39 | .               | ים           | ✗     |
|    40 | ▁שלהם           | ▁מיוחדים     | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ▁היו            | <pad>        | ✗     |
|    43 | ▁בהם            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ▁לה             | <pad>        | ✗     |
|    46 | ים              |              | ✗     |

2024-12-31 19:17:52,399 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:17:52,404 - TrainingLogger - INFO - Gradient norm: 14.2078
2024-12-31 19:17:59,436 - TrainingLogger - INFO - Step 18210, Batch metrics: Loss: 8.2519, Accuracy: 0.0362, Perplexity: 3834.9700
2024-12-31 19:18:06,364 - TrainingLogger - INFO - Step 18220, Batch metrics: Loss: 8.1861, Accuracy: 0.0612, Perplexity: 3590.6536
2024-12-31 19:18:13,778 - TrainingLogger - INFO - Step 18230, Batch metrics: Loss: 7.7706, Accuracy: 0.0329, Perplexity: 2369.8687
2024-12-31 19:18:21,521 - TrainingLogger - INFO - Step 18240, Batch metrics: Loss: 7.4862, Accuracy: 0.0690, Perplexity: 1783.2277
2024-12-31 19:18:28,523 - TrainingLogger - INFO - Step 18250, Batch metrics: Loss: 7.9649, Accuracy: 0.0667, Perplexity: 2878.2649
2024-12-31 19:18:35,497 - TrainingLogger - INFO - Step 18260, Batch metrics: Loss: 7.6548, Accuracy: 0.0410, Perplexity: 2110.7588
2024-12-31 19:18:42,330 - TrainingLogger - INFO - Step 18270, Batch metrics: Loss: 7.9148, Accuracy: 0.0481, Perplexity: 2737.4120
2024-12-31 19:18:49,717 - TrainingLogger - INFO - Step 18280, Batch metrics: Loss: 7.9618, Accuracy: 0.0588, Perplexity: 2869.1539
2024-12-31 19:18:56,736 - TrainingLogger - INFO - Step 18290, Batch metrics: Loss: 8.0622, Accuracy: 0.0608, Perplexity: 3172.3328
2024-12-31 19:19:03,835 - TrainingLogger - INFO - Step 18300, Batch metrics: Loss: 7.2857, Accuracy: 0.0817, Perplexity: 1459.2605
2024-12-31 19:19:03,836 - TrainingLogger - INFO - Step 18300, Prediction vs Actual:
2024-12-31 19:19:03,836 - TrainingLogger - INFO - Input 1: אבל התגובות כן גרמו לי לחשוב שוב על הנושא, וכך הגעתי למסקנה שאולי לא דייקתי בדברי
2024-12-31 19:19:03,836 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:19:03,836 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אבל         | ✗     |
|     1 | ון              | ▁התג         | ✗     |
|     2 | ו               | ובות         | ✗     |
|     3 | ▁האלה           | ▁כן          | ✗     |
|     4 | ▁היו            | ▁גרמו        | ✗     |
|     5 | ▁לי             | ▁לי          | ✓     |
|     6 | י               | ▁לחשוב       | ✗     |
|     7 | ▁רע             | ▁שוב         | ✗     |
|     8 | .               | ▁על          | ✗     |
|     9 | ▁זה             | ▁הנושא       | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁וכך         | ✗     |
|    12 | ▁גם             | ▁הגעתי       | ✗     |
|    13 | ▁גם             | ▁למסקנה      | ✗     |
|    14 | ▁שהוא           | ▁שאולי       | ✗     |
|    15 | ▁זה             | ▁לא          | ✗     |
|    16 | ▁תהיה           | ▁דייק        | ✗     |
|    17 | ן               | תי           | ✗     |
|    18 | ,               | ▁בדברי       | ✗     |
|    19 | ן               | <pad>        | ✗     |
|    20 | ם               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ם               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 19:19:03,836 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:19:03,841 - TrainingLogger - INFO - Gradient norm: 13.9002
2024-12-31 19:19:10,835 - TrainingLogger - INFO - Step 18310, Batch metrics: Loss: 7.3507, Accuracy: 0.0957, Perplexity: 1557.2289
2024-12-31 19:19:18,049 - TrainingLogger - INFO - Step 18320, Batch metrics: Loss: 7.5176, Accuracy: 0.0905, Perplexity: 1840.1879
2024-12-31 19:19:24,543 - TrainingLogger - INFO - Step 18330, Batch metrics: Loss: 7.3928, Accuracy: 0.0629, Perplexity: 1624.2699
2024-12-31 19:19:32,106 - TrainingLogger - INFO - Step 18340, Batch metrics: Loss: 8.1061, Accuracy: 0.0603, Perplexity: 3314.6892
2024-12-31 19:19:39,465 - TrainingLogger - INFO - Step 18350, Batch metrics: Loss: 8.2277, Accuracy: 0.0234, Perplexity: 3743.3081
2024-12-31 19:19:46,349 - TrainingLogger - INFO - Step 18360, Batch metrics: Loss: 7.4447, Accuracy: 0.0532, Perplexity: 1710.8099
2024-12-31 19:19:53,652 - TrainingLogger - INFO - Step 18370, Batch metrics: Loss: 7.5400, Accuracy: 0.0537, Perplexity: 1881.8183
2024-12-31 19:20:00,843 - TrainingLogger - INFO - Step 18380, Batch metrics: Loss: 7.4378, Accuracy: 0.0805, Perplexity: 1698.9839
2024-12-31 19:20:07,793 - TrainingLogger - INFO - Step 18390, Batch metrics: Loss: 7.2494, Accuracy: 0.0870, Perplexity: 1407.2551
2024-12-31 19:20:15,388 - TrainingLogger - INFO - Step 18400, Batch metrics: Loss: 7.3678, Accuracy: 0.0537, Perplexity: 1584.1142
2024-12-31 19:20:15,388 - TrainingLogger - INFO - Step 18400, Prediction vs Actual:
2024-12-31 19:20:15,388 - TrainingLogger - INFO - Input 1: מדובר פה בדרמה גדולה, בעיקר מאחר שהיא מציבה את ישראל בפתחה של הפסקת אש ארוכה ואת ראש ממשלת ישראל במצב פוליטי לא פשוט
2024-12-31 19:20:15,389 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:20:15,389 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מדובר       | ✗     |
|     1 | ▁בו             | ▁פה          | ✗     |
|     2 | .               | ▁בדר         | ✗     |
|     3 | ,               | מה           | ✗     |
|     4 | .               | ▁גדולה       | ✗     |
|     5 | .               | ,            | ✗     |
|     6 | </s>            | ▁בעיקר       | ✗     |
|     7 | ה               | ▁מאחר        | ✗     |
|     8 | יה              | ▁שהיא        | ✗     |
|     9 | ▁נמצאת          | ▁מציב        | ✗     |
|    10 | ה               | ה            | ✓     |
|    11 | ▁את             | ▁את          | ✓     |
|    12 | ▁עצמה           | ▁ישראל       | ✗     |
|    13 | ,               | ▁בפתח        | ✗     |
|    14 | .               | ה            | ✗     |
|    15 | .               | ▁של          | ✗     |
|    16 | ▁המדינה         | ▁הפסקת       | ✗     |
|    17 | ▁ה              | ▁אש          | ✗     |
|    18 | ,               | ▁ארוכה       | ✗     |
|    19 | .               | ▁ואת         | ✗     |
|    20 | ▁המדינה         | ▁ראש         | ✗     |
|    21 | ▁הממשלה         | ▁ממשלת       | ✗     |
|    22 | ה               | ▁ישראל       | ✗     |
|    23 | ,               | ▁במצב        | ✗     |
|    24 | ▁הזה            | ▁פוליטי      | ✗     |
|    25 | .               | ▁לא          | ✗     |
|    26 | ▁רק             | ▁פשוט        | ✗     |
|    27 | ו               | <pad>        | ✗     |
|    28 | ו               | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 19:20:15,389 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:20:15,394 - TrainingLogger - INFO - Gradient norm: 12.5425
2024-12-31 19:20:22,582 - TrainingLogger - INFO - Step 18410, Batch metrics: Loss: 7.7573, Accuracy: 0.0591, Perplexity: 2338.5772
2024-12-31 19:20:29,989 - TrainingLogger - INFO - Step 18420, Batch metrics: Loss: 7.6725, Accuracy: 0.0895, Perplexity: 2148.4584
2024-12-31 19:20:37,486 - TrainingLogger - INFO - Step 18430, Batch metrics: Loss: 7.7294, Accuracy: 0.0653, Perplexity: 2274.3233
2024-12-31 19:20:44,893 - TrainingLogger - INFO - Step 18440, Batch metrics: Loss: 7.7102, Accuracy: 0.0773, Perplexity: 2231.0051
2024-12-31 19:20:51,997 - TrainingLogger - INFO - Step 18450, Batch metrics: Loss: 7.8069, Accuracy: 0.0357, Perplexity: 2457.4313
2024-12-31 19:20:59,204 - TrainingLogger - INFO - Step 18460, Batch metrics: Loss: 7.5588, Accuracy: 0.0725, Perplexity: 1917.4484
2024-12-31 19:21:05,702 - TrainingLogger - INFO - Step 18470, Batch metrics: Loss: 7.4684, Accuracy: 0.0733, Perplexity: 1751.8316
2024-12-31 19:21:12,579 - TrainingLogger - INFO - Step 18480, Batch metrics: Loss: 8.2562, Accuracy: 0.0552, Perplexity: 3851.5367
2024-12-31 19:21:20,236 - TrainingLogger - INFO - Step 18490, Batch metrics: Loss: 7.5107, Accuracy: 0.0633, Perplexity: 1827.5424
2024-12-31 19:21:27,287 - TrainingLogger - INFO - Step 18500, Batch metrics: Loss: 8.2458, Accuracy: 0.0273, Perplexity: 3811.4673
2024-12-31 19:21:27,287 - TrainingLogger - INFO - Step 18500, Prediction vs Actual:
2024-12-31 19:21:27,287 - TrainingLogger - INFO - Input 1: בשני המקומות הריאליים הנותרים ייתכן שנתניהו ישריין את עידית סילמן, שפרשה מהקואליציה הקודמת והובילה במידה רבה להתמוטטותה
2024-12-31 19:21:27,288 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:21:27,288 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בשני        | ✗     |
|     1 | ▁-              | ▁המקומות     | ✗     |
|     2 | ▁האלה           | ▁הרי         | ✗     |
|     3 | ▁אחד            | אלי          | ✗     |
|     4 | ים              | ים           | ✓     |
|     5 | .               | ▁הנותרים     | ✗     |
|     6 | .               | ▁ייתכן       | ✗     |
|     7 | ▁שזה            | ▁שנת         | ✗     |
|     8 | ים              | ניה          | ✗     |
|     9 | ים              | ו            | ✗     |
|    10 | ▁ב              | ▁ישר         | ✗     |
|    11 | ות              | יין          | ✗     |
|    12 | .               | ▁את          | ✗     |
|    13 | ▁זה             | ▁ע           | ✗     |
|    14 | יד              | ידית         | ✗     |
|    15 | .               | ▁סיל         | ✗     |
|    16 | יה              | מן           | ✗     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁שפר         | ✗     |
|    19 | ה               | שה           | ✗     |
|    20 | ▁אחת            | ▁מה          | ✗     |
|    21 | ים              | קו           | ✗     |
|    22 | ה               | אלי          | ✗     |
|    23 | ה               | ציה          | ✗     |
|    24 | ,               | ▁הקודמת      | ✗     |
|    25 | ,               | ▁וה          | ✗     |
|    26 | ה               | וב           | ✗     |
|    27 | דה              | ילה          | ✗     |
|    28 | ▁שלהם           | ▁במידה       | ✗     |
|    29 | ▁אחת            | ▁רבה         | ✗     |
|    30 | ▁יותר           | ▁ל           | ✗     |
|    31 | להקה            | התמוטטות     | ✗     |
|    32 | .               | ה            | ✗     |
|    33 | ▁של             |              | ✗     |

2024-12-31 19:21:27,288 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:21:27,293 - TrainingLogger - INFO - Gradient norm: 15.6063
2024-12-31 19:21:34,732 - TrainingLogger - INFO - Step 18510, Batch metrics: Loss: 7.7405, Accuracy: 0.0606, Perplexity: 2299.5341
2024-12-31 19:21:41,913 - TrainingLogger - INFO - Step 18520, Batch metrics: Loss: 7.5405, Accuracy: 0.0780, Perplexity: 1882.8532
2024-12-31 19:21:49,319 - TrainingLogger - INFO - Step 18530, Batch metrics: Loss: 7.5321, Accuracy: 0.0621, Perplexity: 1866.9931
2024-12-31 19:21:56,986 - TrainingLogger - INFO - Step 18540, Batch metrics: Loss: 7.6716, Accuracy: 0.0960, Perplexity: 2146.4883
2024-12-31 19:22:03,844 - TrainingLogger - INFO - Step 18550, Batch metrics: Loss: 7.6751, Accuracy: 0.0541, Perplexity: 2153.9689
2024-12-31 19:22:11,048 - TrainingLogger - INFO - Step 18560, Batch metrics: Loss: 8.0716, Accuracy: 0.0786, Perplexity: 3202.1143
2024-12-31 19:22:18,004 - TrainingLogger - INFO - Step 18570, Batch metrics: Loss: 7.9973, Accuracy: 0.0826, Perplexity: 2973.0568
2024-12-31 19:22:25,059 - TrainingLogger - INFO - Step 18580, Batch metrics: Loss: 7.4310, Accuracy: 0.0633, Perplexity: 1687.5493
2024-12-31 19:22:32,198 - TrainingLogger - INFO - Step 18590, Batch metrics: Loss: 7.8091, Accuracy: 0.0521, Perplexity: 2462.8744
2024-12-31 19:22:39,715 - TrainingLogger - INFO - Step 18600, Batch metrics: Loss: 7.5842, Accuracy: 0.0548, Perplexity: 1966.8676
2024-12-31 19:22:39,716 - TrainingLogger - INFO - Step 18600, Prediction vs Actual:
2024-12-31 19:22:39,716 - TrainingLogger - INFO - Input 1: איך חוזרים, ענה נתניהו בקוצר רוח
2024-12-31 19:22:39,716 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:22:39,716 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁איך         | ✗     |
|     1 | ?               | ▁חוזרים      | ✗     |
|     2 | ?               | ,            | ✗     |
|     3 | ▁כל             | ▁ענה         | ✗     |
|     4 | ,               | ▁נתנ         | ✗     |
|     5 | "               | יהו          | ✗     |
|     6 | ,               | ▁בקוצר       | ✗     |
|     7 | י               | ▁רוח         | ✗     |
|     8 | י               | <pad>        | ✗     |
|     9 | י               | <pad>        | ✗     |
|    10 | <pad>           | <pad>        | ✓     |
|    11 | ש               | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ו               | <pad>        | ✗     |
|    17 | ג               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ג               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ג               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | י               | <pad>        | ✗     |
|    33 | ▁הזה            | <pad>        | ✗     |
|    34 | ▁הזה            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | י               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ▁זה             | <pad>        | ✗     |
|    41 | ▁הזה            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 19:22:39,716 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:22:39,721 - TrainingLogger - INFO - Gradient norm: 15.2425
2024-12-31 19:22:47,280 - TrainingLogger - INFO - Step 18610, Batch metrics: Loss: 7.9315, Accuracy: 0.0573, Perplexity: 2783.6494
2024-12-31 19:22:54,165 - TrainingLogger - INFO - Step 18620, Batch metrics: Loss: 7.6213, Accuracy: 0.0960, Perplexity: 2041.3127
2024-12-31 19:23:01,349 - TrainingLogger - INFO - Step 18630, Batch metrics: Loss: 7.7728, Accuracy: 0.0833, Perplexity: 2375.1904
2024-12-31 19:23:08,548 - TrainingLogger - INFO - Step 18640, Batch metrics: Loss: 8.2922, Accuracy: 0.0610, Perplexity: 3992.5287
2024-12-31 19:23:15,248 - TrainingLogger - INFO - Step 18650, Batch metrics: Loss: 7.8485, Accuracy: 0.0340, Perplexity: 2561.7830
2024-12-31 19:23:23,143 - TrainingLogger - INFO - Step 18660, Batch metrics: Loss: 7.6677, Accuracy: 0.0652, Perplexity: 2138.0761
2024-12-31 19:23:30,035 - TrainingLogger - INFO - Step 18670, Batch metrics: Loss: 7.7062, Accuracy: 0.0530, Perplexity: 2222.1578
2024-12-31 19:23:37,097 - TrainingLogger - INFO - Step 18680, Batch metrics: Loss: 7.4497, Accuracy: 0.0602, Perplexity: 1719.3626
2024-12-31 19:23:44,438 - TrainingLogger - INFO - Step 18690, Batch metrics: Loss: 7.6085, Accuracy: 0.0833, Perplexity: 2015.1828
2024-12-31 19:23:51,523 - TrainingLogger - INFO - Step 18700, Batch metrics: Loss: 7.6347, Accuracy: 0.0867, Perplexity: 2068.8457
2024-12-31 19:23:51,524 - TrainingLogger - INFO - Step 18700, Prediction vs Actual:
2024-12-31 19:23:51,524 - TrainingLogger - INFO - Input 1: בחודש אוקטובר נרשמו 24,194 מתייצבים חדשים בלשכות התעסוקה, מתוכם 9,862 שעזבו את עבודתם מרצונם
2024-12-31 19:23:51,524 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:23:51,524 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בחודש       | ✗     |
|     1 | ▁-              | ▁אוקטובר     | ✗     |
|     2 | ,               | ▁נר          | ✗     |
|     3 | ן               | שמו          | ✗     |
|     4 | ▁ב              | ▁24,         | ✗     |
|     5 | ח               | 19           | ✗     |
|     6 | ים              | 4            | ✗     |
|     7 | ▁-              | ▁מתייצב      | ✗     |
|     8 | ים              | ים           | ✓     |
|     9 | ▁אל             | ▁חדשים       | ✗     |
|    10 | .               | ▁בלש         | ✗     |
|    11 | ון              | כות          | ✗     |
|    12 | י               | ▁ה           | ✗     |
|    13 | מוס             | תעסוקה       | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | </s>            | ▁מתוכם       | ✗     |
|    16 | ,               | ▁9,          | ✗     |
|    17 | פות             | 86           | ✗     |
|    18 | ים              | 2            | ✗     |
|    19 | ים              | ▁שעזב        | ✗     |
|    20 | ו               | ו            | ✓     |
|    21 | ▁את             | ▁את          | ✓     |
|    22 | ▁המדינה         | ▁עבודתם      | ✗     |
|    23 | .               | ▁מ           | ✗     |
|    24 | ועצת            | רצונם        | ✗     |
|    25 | ▁של             | <pad>        | ✗     |
|    26 | ▁של             | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁המדינה         | <pad>        | ✗     |
|    32 | ▁עד             | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁רבים           | <pad>        | ✗     |
|    35 | ▁ועד            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ים              |              | ✗     |

2024-12-31 19:23:51,525 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:23:51,529 - TrainingLogger - INFO - Gradient norm: 14.4979
2024-12-31 19:23:58,903 - TrainingLogger - INFO - Step 18710, Batch metrics: Loss: 7.9059, Accuracy: 0.0365, Perplexity: 2713.2136
2024-12-31 19:24:03,050 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 322560
2024-12-31 19:24:03,050 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 322560

2024-12-31 19:24:03,050 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 41]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 41]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:24:03,051 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:24:08,133 - TrainingLogger - INFO - Step 18720, Batch metrics: Loss: 7.4775, Accuracy: 0.0859, Perplexity: 1767.8064
2024-12-31 19:24:17,513 - TrainingLogger - INFO - Step 18730, Batch metrics: Loss: 7.2453, Accuracy: 0.0759, Perplexity: 1401.4646
2024-12-31 19:24:24,003 - TrainingLogger - INFO - Step 18740, Batch metrics: Loss: 7.7568, Accuracy: 0.0516, Perplexity: 2337.4100
2024-12-31 19:24:31,298 - TrainingLogger - INFO - Step 18750, Batch metrics: Loss: 7.5496, Accuracy: 0.0752, Perplexity: 1899.9411
2024-12-31 19:24:38,586 - TrainingLogger - INFO - Step 18760, Batch metrics: Loss: 7.9229, Accuracy: 0.0549, Perplexity: 2759.7936
2024-12-31 19:24:45,975 - TrainingLogger - INFO - Step 18770, Batch metrics: Loss: 7.7616, Accuracy: 0.0619, Perplexity: 2348.6841
2024-12-31 19:24:53,116 - TrainingLogger - INFO - Step 18780, Batch metrics: Loss: 8.0044, Accuracy: 0.0387, Perplexity: 2994.1581
2024-12-31 19:25:00,723 - TrainingLogger - INFO - Step 18790, Batch metrics: Loss: 7.5356, Accuracy: 0.0486, Perplexity: 1873.5935
2024-12-31 19:25:08,000 - TrainingLogger - INFO - Step 18800, Batch metrics: Loss: 7.5919, Accuracy: 0.0667, Perplexity: 1982.0681
2024-12-31 19:25:08,000 - TrainingLogger - INFO - Step 18800, Prediction vs Actual:
2024-12-31 19:25:08,000 - TrainingLogger - INFO - Input 1: כולם מבינים את זה, זה ציד פוליטי
2024-12-31 19:25:08,001 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:25:08,001 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁כולם        | ✗     |
|     1 | ▁כך             | ▁מבינים      | ✗     |
|     2 | ▁רבים           | ▁את          | ✗     |
|     3 | ▁זה             | ▁זה          | ✓     |
|     4 | ות              | ,            | ✗     |
|     5 | <pad>           | ▁זה          | ✗     |
|     6 | ▁לא             | ▁ציד         | ✗     |
|     7 | ה               | ▁פוליטי      | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | ▁נכון           | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | י               | <pad>        | ✗     |
|    17 | ו               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ▁נכון           | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ▁נכון           | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ה               | <pad>        | ✗     |
|    44 | .               |              | ✗     |

2024-12-31 19:25:08,001 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:25:08,006 - TrainingLogger - INFO - Gradient norm: 12.5102
2024-12-31 19:25:15,076 - TrainingLogger - INFO - Step 18810, Batch metrics: Loss: 7.8723, Accuracy: 0.0611, Perplexity: 2623.6196
2024-12-31 19:25:21,932 - TrainingLogger - INFO - Step 18820, Batch metrics: Loss: 7.5142, Accuracy: 0.0833, Perplexity: 1833.8713
2024-12-31 19:25:29,276 - TrainingLogger - INFO - Step 18830, Batch metrics: Loss: 7.4758, Accuracy: 0.0882, Perplexity: 1764.8518
2024-12-31 19:25:36,619 - TrainingLogger - INFO - Step 18840, Batch metrics: Loss: 8.3157, Accuracy: 0.0508, Perplexity: 4087.7155
2024-12-31 19:25:43,870 - TrainingLogger - INFO - Step 18850, Batch metrics: Loss: 7.8522, Accuracy: 0.0575, Perplexity: 2571.3766
2024-12-31 19:25:50,988 - TrainingLogger - INFO - Step 18860, Batch metrics: Loss: 7.7514, Accuracy: 0.0955, Perplexity: 2324.7561
2024-12-31 19:25:58,054 - TrainingLogger - INFO - Step 18870, Batch metrics: Loss: 7.5036, Accuracy: 0.0769, Perplexity: 1814.5382
2024-12-31 19:26:05,232 - TrainingLogger - INFO - Step 18880, Batch metrics: Loss: 7.7176, Accuracy: 0.0796, Perplexity: 2247.4879
2024-12-31 19:26:13,194 - TrainingLogger - INFO - Step 18890, Batch metrics: Loss: 7.3866, Accuracy: 0.0970, Perplexity: 1614.1646
2024-12-31 19:26:20,905 - TrainingLogger - INFO - Step 18900, Batch metrics: Loss: 7.8335, Accuracy: 0.0519, Perplexity: 2523.6674
2024-12-31 19:26:20,905 - TrainingLogger - INFO - Step 18900, Prediction vs Actual:
2024-12-31 19:26:20,905 - TrainingLogger - INFO - Input 1: בתחילת השבוע ערכו בכירי מפלגת כחול לבןמסיבת עיתונאים בעקבות הגילוייםשנחשפו בימים האחרונים בתקשורת על אודות פרשת הצוללות, ומעורבות אפשרות לטענתם בפרשה של נתניהו
2024-12-31 19:26:20,906 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:26:20,906 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁בתחילת      | ✗     |
|     1 | ▁-              | ▁השבוע       | ✗     |
|     2 | יה              | ▁ערכו        | ✗     |
|     3 | ▁את             | ▁בכיר        | ✗     |
|     4 | ▁ב              | י            | ✗     |
|     5 | ▁עסקים          | ▁            | ✗     |
|     6 | טיס             | מפלגת        | ✗     |
|     7 | י               | ▁כחול        | ✗     |
|     8 | י               | ▁לבן         | ✗     |
|     9 | ▁ישראל          | מסיבת        | ✗     |
|    10 | ו               | ▁עיתונאים    | ✗     |
|    11 | .               | ▁בעקבות      | ✗     |
|    12 | יה              | ▁ה           | ✗     |
|    13 | -               | גילוי        | ✗     |
|    14 | ▁שלהם           | ים           | ✗     |
|    15 | ▁שלהם           | ש            | ✗     |
|    16 | ורים            | נחש          | ✗     |
|    17 | ים              | פו           | ✗     |
|    18 | ,               | ▁בימים       | ✗     |
|    19 | ה               | ▁האחרונים    | ✗     |
|    20 | ,               | ▁בתקשורת     | ✗     |
|    21 | ,               | ▁על          | ✗     |
|    22 | -               | ▁אודות       | ✗     |
|    23 | יה              | ▁פרשת        | ✗     |
|    24 | ▁ישראל          | ▁ה           | ✗     |
|    25 | -               | צוללות       | ✗     |
|    26 | ▁שלהם           | ,            | ✗     |
|    27 | ▁הם             | ▁ו           | ✗     |
|    28 | נגד             | מעורב        | ✗     |
|    29 | ים              | ות           | ✗     |
|    30 | ▁בהם            | ▁אפשרות      | ✗     |
|    31 | ▁זו             | ▁לטענת       | ✗     |
|    32 | ם               | ם            | ✓     |
|    33 | ▁לה             | ▁בפר         | ✗     |
|    34 | יט              | שה           | ✗     |
|    35 | ▁זו             | ▁של          | ✗     |
|    36 | ▁המדינה         | ▁נתנ         | ✗     |
|    37 | ים              | יהו          | ✗     |
|    38 | ה               |              | ✗     |

2024-12-31 19:26:20,906 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:26:20,911 - TrainingLogger - INFO - Gradient norm: 13.3912
2024-12-31 19:26:28,049 - TrainingLogger - INFO - Step 18910, Batch metrics: Loss: 7.7343, Accuracy: 0.0833, Perplexity: 2285.4283
2024-12-31 19:26:35,616 - TrainingLogger - INFO - Step 18920, Batch metrics: Loss: 7.3466, Accuracy: 0.1047, Perplexity: 1550.9456
2024-12-31 19:26:43,104 - TrainingLogger - INFO - Step 18930, Batch metrics: Loss: 7.5100, Accuracy: 0.0802, Perplexity: 1826.2662
2024-12-31 19:26:50,049 - TrainingLogger - INFO - Step 18940, Batch metrics: Loss: 7.3641, Accuracy: 0.1141, Perplexity: 1578.3312
2024-12-31 19:26:57,569 - TrainingLogger - INFO - Step 18950, Batch metrics: Loss: 7.3883, Accuracy: 0.0814, Perplexity: 1616.9047
2024-12-31 19:27:04,877 - TrainingLogger - INFO - Step 18960, Batch metrics: Loss: 8.2541, Accuracy: 0.0714, Perplexity: 3843.3470
2024-12-31 19:27:11,959 - TrainingLogger - INFO - Step 18970, Batch metrics: Loss: 7.9939, Accuracy: 0.0710, Perplexity: 2962.9392
2024-12-31 19:27:19,223 - TrainingLogger - INFO - Step 18980, Batch metrics: Loss: 7.6226, Accuracy: 0.0833, Perplexity: 2043.8334
2024-12-31 19:27:26,529 - TrainingLogger - INFO - Step 18990, Batch metrics: Loss: 8.1030, Accuracy: 0.0675, Perplexity: 3304.3432
2024-12-31 19:27:33,587 - TrainingLogger - INFO - Step 19000, Batch metrics: Loss: 7.8957, Accuracy: 0.0485, Perplexity: 2685.7012
2024-12-31 19:27:33,587 - TrainingLogger - INFO - Step 19000, Prediction vs Actual:
2024-12-31 19:27:33,587 - TrainingLogger - INFO - Input 1: מרכזי תעסוקה מרחוק יכולים להביא סוף לפקקיםצילום שלומי כהן תהליך יצירת המשרות דורש מובילים נחושים, הון התחלתי ורעיון טוב
2024-12-31 19:27:33,588 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:27:33,588 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מרכזי       | ✗     |
|     1 | ▁-              | ▁תעסוקה      | ✗     |
|     2 | .               | ▁מרחוק       | ✗     |
|     3 | .               | ▁יכולים      | ✗     |
|     4 | ▁להיות          | ▁להביא       | ✗     |
|     5 | ▁אותנו          | ▁סוף         | ✗     |
|     6 | ▁ל              | ▁ל           | ✓     |
|     7 | סיבה            | פק           | ✗     |
|     8 | ד               | קים          | ✗     |
|     9 | ▁רבים           | צילום        | ✗     |
|    10 | ים              | ▁שלו         | ✗     |
|    11 | .               | מי           | ✗     |
|    12 | ▁זמן            | ▁כהן         | ✗     |
|    13 | .               | ▁תהליך       | ✗     |
|    14 | ▁כזה            | ▁יצירת       | ✗     |
|    15 | ו               | ▁המ          | ✗     |
|    16 | רצה             | שרות         | ✗     |
|    17 | ▁האלה           | ▁דורש        | ✗     |
|    18 | ות              | ▁מובילים     | ✗     |
|    19 | </s>            | ▁נחושים      | ✗     |
|    20 | .               | ,            | ✗     |
|    21 | </s>            | ▁הון         | ✗     |
|    22 | ▁כלכלי          | ▁התחלתי      | ✗     |
|    23 | ים              | ▁ו           | ✗     |
|    24 | ריכוז           | רעיון        | ✗     |
|    25 | ▁זה             | ▁טוב         | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               |              | ✗     |

2024-12-31 19:27:33,588 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:27:33,593 - TrainingLogger - INFO - Gradient norm: 13.6148
2024-12-31 19:27:40,137 - TrainingLogger - INFO - Step 19010, Batch metrics: Loss: 7.7615, Accuracy: 0.0725, Perplexity: 2348.4837
2024-12-31 19:27:46,814 - TrainingLogger - INFO - Step 19020, Batch metrics: Loss: 7.6209, Accuracy: 0.0777, Perplexity: 2040.4904
2024-12-31 19:27:55,664 - TrainingLogger - INFO - Step 19030, Batch metrics: Loss: 7.7369, Accuracy: 0.0546, Perplexity: 2291.3349
2024-12-31 19:28:02,765 - TrainingLogger - INFO - Step 19040, Batch metrics: Loss: 7.9247, Accuracy: 0.0647, Perplexity: 2764.6577
2024-12-31 19:28:09,817 - TrainingLogger - INFO - Step 19050, Batch metrics: Loss: 7.9195, Accuracy: 0.0595, Perplexity: 2750.3138
2024-12-31 19:28:13,261 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 19:28:13,261 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 19:28:13,261 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:28:13,262 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 19:28:13,262 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:28:13,262 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:28:13,262 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 51]), device: cuda:0
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 51]), device: cuda:0
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:28:13,263 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:28:17,465 - TrainingLogger - INFO - Step 19060, Batch metrics: Loss: 7.5216, Accuracy: 0.0769, Perplexity: 1847.5047
2024-12-31 19:28:24,672 - TrainingLogger - INFO - Step 19070, Batch metrics: Loss: 7.7565, Accuracy: 0.0550, Perplexity: 2336.6678
2024-12-31 19:28:31,656 - TrainingLogger - INFO - Step 19080, Batch metrics: Loss: 7.8820, Accuracy: 0.0317, Perplexity: 2649.1087
2024-12-31 19:28:38,726 - TrainingLogger - INFO - Step 19090, Batch metrics: Loss: 7.4698, Accuracy: 0.0808, Perplexity: 1754.2976
2024-12-31 19:28:45,860 - TrainingLogger - INFO - Step 19100, Batch metrics: Loss: 7.4230, Accuracy: 0.0747, Perplexity: 1674.0862
2024-12-31 19:28:45,860 - TrainingLogger - INFO - Step 19100, Prediction vs Actual:
2024-12-31 19:28:45,860 - TrainingLogger - INFO - Input 1: גם על הדבר הזה המפ לא נחקר
2024-12-31 19:28:45,861 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:28:45,861 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁גם          | ✗     |
|     1 | .               | ▁על          | ✗     |
|     2 | ▁החיים          | ▁הדבר        | ✗     |
|     3 | ▁עצמו           | ▁הזה         | ✗     |
|     4 | ,               | ▁המפ         | ✗     |
|     5 | ו               | ▁לא          | ✗     |
|     6 | ▁רע             | ▁נחקר        | ✗     |
|     7 | ים              | <pad>        | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁הוא            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁כבר            | <pad>        | ✗     |
|    28 | ▁עם             | <pad>        | ✗     |
|    29 | ▁היום           | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁עם             | <pad>        | ✗     |
|    36 | </s>            |              | ✗     |

2024-12-31 19:28:45,861 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:28:45,866 - TrainingLogger - INFO - Gradient norm: 12.6955
2024-12-31 19:28:51,899 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 265216
2024-12-31 19:28:51,899 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 265216

2024-12-31 19:28:51,899 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 37]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 37]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 52]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 52]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:28:51,900 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:28:53,795 - TrainingLogger - INFO - Step 19110, Batch metrics: Loss: 7.3443, Accuracy: 0.0847, Perplexity: 1547.2818
2024-12-31 19:29:00,485 - TrainingLogger - INFO - Step 19120, Batch metrics: Loss: 7.7875, Accuracy: 0.0763, Perplexity: 2410.3680
2024-12-31 19:29:06,266 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 34, 40), but is torch.Size([8, 1, 34, 35])
2024-12-31 19:29:06,267 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 34, 40), but is torch.Size([8, 1, 34, 35])

2024-12-31 19:29:06,267 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 35]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 34]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 34]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:29:06,268 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:29:08,209 - TrainingLogger - INFO - Step 19130, Batch metrics: Loss: 7.6973, Accuracy: 0.0476, Perplexity: 2202.4953
2024-12-31 19:29:15,578 - TrainingLogger - INFO - Step 19140, Batch metrics: Loss: 7.1693, Accuracy: 0.0920, Perplexity: 1298.9865
2024-12-31 19:29:22,376 - TrainingLogger - INFO - Step 19150, Batch metrics: Loss: 7.7107, Accuracy: 0.0845, Perplexity: 2232.1160
2024-12-31 19:29:29,388 - TrainingLogger - INFO - Step 19160, Batch metrics: Loss: 7.6688, Accuracy: 0.0415, Perplexity: 2140.6162
2024-12-31 19:29:36,486 - TrainingLogger - INFO - Step 19170, Batch metrics: Loss: 6.9725, Accuracy: 0.1005, Perplexity: 1066.8972
2024-12-31 19:29:43,769 - TrainingLogger - INFO - Step 19180, Batch metrics: Loss: 7.3867, Accuracy: 0.0749, Perplexity: 1614.4209
2024-12-31 19:29:50,707 - TrainingLogger - INFO - Step 19190, Batch metrics: Loss: 7.5958, Accuracy: 0.0885, Perplexity: 1989.7460
2024-12-31 19:29:57,848 - TrainingLogger - INFO - Step 19200, Batch metrics: Loss: 7.5837, Accuracy: 0.0893, Perplexity: 1965.9244
2024-12-31 19:29:57,849 - TrainingLogger - INFO - Step 19200, Prediction vs Actual:
2024-12-31 19:29:57,849 - TrainingLogger - INFO - Input 1: הלילות ללא שינה התחלפו בציפייה לטלפון שיבשר - היא בדרך הביתה
2024-12-31 19:29:57,849 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:29:57,849 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | :               | ▁הלילות      | ✗     |
|     1 | ▁-              | ▁ללא         | ✗     |
|     2 | ▁-              | ▁שינה        | ✗     |
|     3 | ▁-              | ▁התחל        | ✗     |
|     4 | לה              | פו           | ✗     |
|     5 | .               | ▁בציפייה     | ✗     |
|     6 | ▁חדשה           | ▁לטלפון      | ✗     |
|     7 | ▁שלי            | ▁שי          | ✗     |
|     8 | זה              | בשר          | ✗     |
|     9 | ו               | ▁-           | ✗     |
|    10 | <pad>           | ▁היא         | ✗     |
|    11 | ▁לא             | ▁בדרך        | ✗     |
|    12 | ▁הביתה          | ▁הביתה       | ✓     |
|    13 | .               | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁את             | <pad>        | ✗     |
|    36 | </s>            |              | ✗     |

2024-12-31 19:29:57,849 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:29:57,854 - TrainingLogger - INFO - Gradient norm: 12.8493
2024-12-31 19:30:04,774 - TrainingLogger - INFO - Step 19210, Batch metrics: Loss: 7.4326, Accuracy: 0.0928, Perplexity: 1690.1819
2024-12-31 19:30:11,990 - TrainingLogger - INFO - Step 19220, Batch metrics: Loss: 7.5720, Accuracy: 0.0787, Perplexity: 1942.9586
2024-12-31 19:30:18,998 - TrainingLogger - INFO - Step 19230, Batch metrics: Loss: 7.4204, Accuracy: 0.0870, Perplexity: 1669.7302
2024-12-31 19:30:26,356 - TrainingLogger - INFO - Step 19240, Batch metrics: Loss: 7.5965, Accuracy: 0.0732, Perplexity: 1991.1155
2024-12-31 19:30:33,932 - TrainingLogger - INFO - Step 19250, Batch metrics: Loss: 7.9914, Accuracy: 0.0797, Perplexity: 2955.5127
2024-12-31 19:30:40,655 - TrainingLogger - INFO - Step 19260, Batch metrics: Loss: 7.6223, Accuracy: 0.0714, Perplexity: 2043.1786
2024-12-31 19:30:47,079 - TrainingLogger - INFO - Step 19270, Batch metrics: Loss: 7.9697, Accuracy: 0.0288, Perplexity: 2891.9341
2024-12-31 19:30:54,286 - TrainingLogger - INFO - Step 19280, Batch metrics: Loss: 6.8457, Accuracy: 0.1111, Perplexity: 939.8451
2024-12-31 19:31:01,605 - TrainingLogger - INFO - Step 19290, Batch metrics: Loss: 7.6408, Accuracy: 0.0609, Perplexity: 2081.3567
2024-12-31 19:31:08,611 - TrainingLogger - INFO - Step 19300, Batch metrics: Loss: 7.4561, Accuracy: 0.0929, Perplexity: 1730.3245
2024-12-31 19:31:08,611 - TrainingLogger - INFO - Step 19300, Prediction vs Actual:
2024-12-31 19:31:08,611 - TrainingLogger - INFO - Input 1: ברחבי העולם ממשיכים להתפרסם סיפורים על האזרחים הנצורים בסין
2024-12-31 19:31:08,612 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:31:08,612 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁היא            | ▁ברחב        | ✗     |
|     1 | ▁-              | י            | ✗     |
|     2 | ▁הארץ           | ▁העולם       | ✗     |
|     3 | ▁הבא            | ▁ממשיכים     | ✗     |
|     4 | ▁לעבוד          | ▁ל           | ✗     |
|     5 | חול             | התפרסם       | ✗     |
|     6 | .               | ▁סיפורים     | ✗     |
|     7 | .               | ▁על          | ✗     |
|     8 | ▁אנשים          | ▁האזרחים     | ✗     |
|     9 | .               | ▁ה           | ✗     |
|    10 | קיימים          | נצור         | ✗     |
|    11 | ים              | ים           | ✓     |
|    12 | .               | ▁בסין        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            |              | ✗     |

2024-12-31 19:31:08,612 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:31:08,617 - TrainingLogger - INFO - Gradient norm: 13.3748
2024-12-31 19:31:16,571 - TrainingLogger - INFO - Step 19310, Batch metrics: Loss: 7.8834, Accuracy: 0.0464, Perplexity: 2652.7808
2024-12-31 19:31:23,981 - TrainingLogger - INFO - Step 19320, Batch metrics: Loss: 7.6741, Accuracy: 0.0645, Perplexity: 2151.8480
2024-12-31 19:31:30,992 - TrainingLogger - INFO - Step 19330, Batch metrics: Loss: 7.8395, Accuracy: 0.0671, Perplexity: 2539.0269
2024-12-31 19:31:38,139 - TrainingLogger - INFO - Step 19340, Batch metrics: Loss: 8.3272, Accuracy: 0.0400, Perplexity: 4134.8196
2024-12-31 19:31:45,184 - TrainingLogger - INFO - Step 19350, Batch metrics: Loss: 7.8717, Accuracy: 0.0631, Perplexity: 2622.0212
2024-12-31 19:31:51,807 - TrainingLogger - INFO - Step 19360, Batch metrics: Loss: 7.3751, Accuracy: 0.0595, Perplexity: 1595.6847
2024-12-31 19:31:56,047 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 19:31:56,047 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 19:31:56,048 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 50]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 50]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:31:56,049 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:31:59,703 - TrainingLogger - INFO - Step 19370, Batch metrics: Loss: 7.7084, Accuracy: 0.0800, Perplexity: 2227.0023
2024-12-31 19:32:06,504 - TrainingLogger - INFO - Step 19380, Batch metrics: Loss: 7.6376, Accuracy: 0.0651, Perplexity: 2074.8374
2024-12-31 19:32:13,403 - TrainingLogger - INFO - Step 19390, Batch metrics: Loss: 7.9682, Accuracy: 0.0725, Perplexity: 2887.6142
2024-12-31 19:32:20,364 - TrainingLogger - INFO - Step 19400, Batch metrics: Loss: 7.6807, Accuracy: 0.0617, Perplexity: 2166.2312
2024-12-31 19:32:20,364 - TrainingLogger - INFO - Step 19400, Prediction vs Actual:
2024-12-31 19:32:20,365 - TrainingLogger - INFO - Input 1: מפחיד לחשוב מה יקרה כשהרגל שוב תתחמםצילום gettyimages בקלות, זו העונה הטובה בקריירה של ורנר בן ה-23
2024-12-31 19:32:20,365 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:32:20,365 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מפחיד       | ✗     |
|     1 | ▁את             | ▁לחשוב       | ✗     |
|     2 | </s>            | ▁מה          | ✗     |
|     3 | ▁דעת            | ▁יקרה        | ✗     |
|     4 | ▁לו             | ▁כשה         | ✗     |
|     5 | יה              | רגל          | ✗     |
|     6 | נו              | ▁שוב         | ✗     |
|     7 | ▁לארץ           | ▁ת           | ✗     |
|     8 | ▁את             | תחמם         | ✗     |
|     9 | </s>            | צילום        | ✗     |
|    10 | </s>            | ▁get         | ✗     |
|    11 | </s>            | ty           | ✗     |
|    12 | </s>            | im           | ✗     |
|    13 | </s>            | age          | ✗     |
|    14 | </s>            | s            | ✗     |
|    15 | </s>            | ▁בקלות       | ✗     |
|    16 | </s>            | ,            | ✗     |
|    17 | <pad>           | ▁זו          | ✗     |
|    18 | ▁תהיה           | ▁העונה       | ✗     |
|    19 | ▁האחרונה        | ▁הטובה       | ✗     |
|    20 | ▁ביותר          | ▁בקריירה     | ✗     |
|    21 | ▁שלי            | ▁של          | ✗     |
|    22 | ▁אנשים          | ▁ו           | ✗     |
|    23 | '               | רנר          | ✗     |
|    24 | </s>            | ▁בן          | ✗     |
|    25 | ▁ישראל          | ▁ה           | ✗     |
|    26 | -               | -23          | ✗     |
|    27 | </s>            |              | ✗     |

2024-12-31 19:32:20,365 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:32:20,370 - TrainingLogger - INFO - Gradient norm: 14.9070
2024-12-31 19:32:27,317 - TrainingLogger - INFO - Step 19410, Batch metrics: Loss: 7.6510, Accuracy: 0.0725, Perplexity: 2102.8496
2024-12-31 19:32:34,214 - TrainingLogger - INFO - Step 19420, Batch metrics: Loss: 7.3412, Accuracy: 0.0765, Perplexity: 1542.5663
2024-12-31 19:32:41,422 - TrainingLogger - INFO - Step 19430, Batch metrics: Loss: 7.9984, Accuracy: 0.0694, Perplexity: 2976.1915
2024-12-31 19:32:48,613 - TrainingLogger - INFO - Step 19440, Batch metrics: Loss: 7.7541, Accuracy: 0.0682, Perplexity: 2331.0211
2024-12-31 19:32:55,880 - TrainingLogger - INFO - Step 19450, Batch metrics: Loss: 7.5345, Accuracy: 0.0765, Perplexity: 1871.4158
2024-12-31 19:33:02,727 - TrainingLogger - INFO - Step 19460, Batch metrics: Loss: 7.7407, Accuracy: 0.0723, Perplexity: 2300.1866
2024-12-31 19:33:10,078 - TrainingLogger - INFO - Step 19470, Batch metrics: Loss: 7.8531, Accuracy: 0.0588, Perplexity: 2573.7994
2024-12-31 19:33:17,773 - TrainingLogger - INFO - Step 19480, Batch metrics: Loss: 7.2537, Accuracy: 0.1131, Perplexity: 1413.2763
2024-12-31 19:33:24,703 - TrainingLogger - INFO - Step 19490, Batch metrics: Loss: 7.4969, Accuracy: 0.0606, Perplexity: 1802.3569
2024-12-31 19:33:31,200 - TrainingLogger - INFO - Step 19500, Batch metrics: Loss: 7.5396, Accuracy: 0.0621, Perplexity: 1881.0889
2024-12-31 19:33:31,201 - TrainingLogger - INFO - Step 19500, Prediction vs Actual:
2024-12-31 19:33:31,201 - TrainingLogger - INFO - Input 1: לדבריהם, הגדרות גיל הן תמיד שרירותיות, אך ההגדרה הנוכחית לגיל ההתבגרות, 19-10, היא מוגבלת מדי
2024-12-31 19:33:31,201 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:33:31,201 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁לדבר        | ✗     |
|     1 | ▁איתו           | יהם          | ✗     |
|     2 | ?               | ,            | ✗     |
|     3 | ▁הם             | ▁הגדרות      | ✗     |
|     4 | :               | ▁גיל         | ✗     |
|     5 | נו              | ▁הן          | ✗     |
|     6 | :               | ▁תמיד        | ✗     |
|     7 | ו               | ▁שריר        | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | ין              | יות          | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | <pad>           | ▁אך          | ✗     |
|    12 | ▁הם             | ▁ההגדרה      | ✗     |
|    13 | ▁הזו            | ▁הנוכחית     | ✗     |
|    14 | ,               | ▁לגיל        | ✗     |
|    15 | נו              | ▁ההתבגרות    | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | ▁היתה           | ▁19          | ✗     |
|    18 | ת               | -10          | ✗     |
|    19 | .               | ,            | ✗     |
|    20 | ▁היא            | ▁היא         | ✓     |
|    21 | ▁היתה           | ▁מוגבלת      | ✗     |
|    22 | ▁את             | ▁מדי         | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | נו              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ים              |              | ✗     |

2024-12-31 19:33:31,201 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:33:31,206 - TrainingLogger - INFO - Gradient norm: 15.5114
2024-12-31 19:33:39,312 - TrainingLogger - INFO - Step 19510, Batch metrics: Loss: 7.7283, Accuracy: 0.0894, Perplexity: 2271.6451
2024-12-31 19:33:46,988 - TrainingLogger - INFO - Step 19520, Batch metrics: Loss: 8.1755, Accuracy: 0.0510, Perplexity: 3552.8001
2024-12-31 19:33:53,996 - TrainingLogger - INFO - Step 19530, Batch metrics: Loss: 7.5361, Accuracy: 0.1006, Perplexity: 1874.5676
2024-12-31 19:34:01,419 - TrainingLogger - INFO - Step 19540, Batch metrics: Loss: 7.5365, Accuracy: 0.0794, Perplexity: 1875.2336
2024-12-31 19:34:09,304 - TrainingLogger - INFO - Step 19550, Batch metrics: Loss: 7.2509, Accuracy: 0.0810, Perplexity: 1409.4275
2024-12-31 19:34:16,263 - TrainingLogger - INFO - Step 19560, Batch metrics: Loss: 7.6850, Accuracy: 0.0924, Perplexity: 2175.4263
2024-12-31 19:34:24,374 - TrainingLogger - INFO - Step 19570, Batch metrics: Loss: 7.8513, Accuracy: 0.0741, Perplexity: 2569.1889
2024-12-31 19:34:31,718 - TrainingLogger - INFO - Step 19580, Batch metrics: Loss: 7.7650, Accuracy: 0.0479, Perplexity: 2356.6368
2024-12-31 19:34:38,982 - TrainingLogger - INFO - Step 19590, Batch metrics: Loss: 7.2171, Accuracy: 0.0856, Perplexity: 1362.5790
2024-12-31 19:34:45,946 - TrainingLogger - INFO - Step 19600, Batch metrics: Loss: 7.4781, Accuracy: 0.0698, Perplexity: 1768.7988
2024-12-31 19:34:45,946 - TrainingLogger - INFO - Step 19600, Prediction vs Actual:
2024-12-31 19:34:45,946 - TrainingLogger - INFO - Input 1: ארדן הזהיר כי מהשלכות שליליות בעקבות ההחלטה, ואמר כי חמאס עכשיו רואה שהלחץ על ישראל גדל, אז איזה אינטרס יש לו להסכים
2024-12-31 19:34:45,947 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:34:45,947 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ארד         | ✗     |
|     1 | ים              | ן            | ✗     |
|     2 | .               | ▁הזהיר       | ✗     |
|     3 | ו               | ▁כי          | ✗     |
|     4 | ון              | ▁מ           | ✗     |
|     5 | אן              | השלכות       | ✗     |
|     6 | יו              | ▁שליליות     | ✗     |
|     7 | ▁היום           | ▁בעקבות      | ✗     |
|     8 | ▁זאת            | ▁ההחלטה      | ✗     |
|     9 | .               | ,            | ✗     |
|    10 | </s>            | ▁ואמר        | ✗     |
|    11 | ות              | ▁כי          | ✗     |
|    12 | ▁לא             | ▁ח           | ✗     |
|    13 | ח               | מ            | ✗     |
|    14 | ונות            | אס           | ✗     |
|    15 | ן               | ▁עכשיו       | ✗     |
|    16 | ,               | ▁רואה        | ✗     |
|    17 | ▁את             | ▁שה          | ✗     |
|    18 | אזור            | לחץ          | ✗     |
|    19 | ▁שלהם           | ▁על          | ✗     |
|    20 | ▁עצמו           | ▁ישראל       | ✗     |
|    21 | י               | ▁גדל         | ✗     |
|    22 | ,               | ,            | ✓     |
|    23 | </s>            | ▁אז          | ✗     |
|    24 | ▁הוא            | ▁איזה        | ✗     |
|    25 | ▁יום            | ▁א           | ✗     |
|    26 | ץ               | ינטרס        | ✗     |
|    27 | ▁היה            | ▁יש          | ✗     |
|    28 | ▁לו             | ▁לו          | ✓     |
|    29 | ▁היה            | ▁להסכים      | ✗     |
|    30 | ▁על             | <pad>        | ✗     |
|    31 | ▁על             | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁על             | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ,               |              | ✗     |

2024-12-31 19:34:45,947 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:34:45,952 - TrainingLogger - INFO - Gradient norm: 12.8967
2024-12-31 19:34:53,173 - TrainingLogger - INFO - Step 19610, Batch metrics: Loss: 7.2512, Accuracy: 0.0996, Perplexity: 1409.8113
2024-12-31 19:35:00,462 - TrainingLogger - INFO - Step 19620, Batch metrics: Loss: 7.2324, Accuracy: 0.0563, Perplexity: 1383.4802
2024-12-31 19:35:07,529 - TrainingLogger - INFO - Step 19630, Batch metrics: Loss: 6.9323, Accuracy: 0.0971, Perplexity: 1024.8989
2024-12-31 19:35:14,687 - TrainingLogger - INFO - Step 19640, Batch metrics: Loss: 7.8017, Accuracy: 0.0567, Perplexity: 2444.6511
2024-12-31 19:35:21,891 - TrainingLogger - INFO - Step 19650, Batch metrics: Loss: 8.1035, Accuracy: 0.0585, Perplexity: 3305.9728
2024-12-31 19:35:29,353 - TrainingLogger - INFO - Step 19660, Batch metrics: Loss: 7.3929, Accuracy: 0.0888, Perplexity: 1624.4287
2024-12-31 19:35:36,580 - TrainingLogger - INFO - Step 19670, Batch metrics: Loss: 7.1857, Accuracy: 0.0704, Perplexity: 1320.3911
2024-12-31 19:35:43,739 - TrainingLogger - INFO - Step 19680, Batch metrics: Loss: 7.6177, Accuracy: 0.0479, Perplexity: 2033.8616
2024-12-31 19:35:51,804 - TrainingLogger - INFO - Step 19690, Batch metrics: Loss: 7.0696, Accuracy: 0.0808, Perplexity: 1175.6969
2024-12-31 19:35:58,811 - TrainingLogger - INFO - Step 19700, Batch metrics: Loss: 7.5070, Accuracy: 0.0876, Perplexity: 1820.6614
2024-12-31 19:35:58,812 - TrainingLogger - INFO - Step 19700, Prediction vs Actual:
2024-12-31 19:35:58,812 - TrainingLogger - INFO - Input 1: המנדטים הללו הטו את הכף לטובת הליכוד 30 מנדטים מול המחנה הציוני דאז 24 מנדטים
2024-12-31 19:35:58,812 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:35:58,812 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁המ          | ✗     |
|     1 | ▁-              | נדט          | ✗     |
|     2 | ▁-              | ים           | ✗     |
|     3 | ▁-              | ▁הללו        | ✗     |
|     4 | ,               | ▁הטו         | ✗     |
|     5 | ?               | ▁את          | ✗     |
|     6 | ▁זה             | ▁הכף         | ✗     |
|     7 | .               | ▁לטובת       | ✗     |
|     8 | ו               | ▁הלי         | ✗     |
|     9 | גה              | כו           | ✗     |
|    10 | ד               | ד            | ✓     |
|    11 | .               | ▁30          | ✗     |
|    12 | .               | ▁מנד         | ✗     |
|    13 | ים              | טים          | ✗     |
|    14 | .               | ▁מול         | ✗     |
|    15 | יש              | ▁המחנה       | ✗     |
|    16 | .               | ▁הצי         | ✗     |
|    17 | ות              | וני          | ✗     |
|    18 | ▁שלנו           | ▁דאז         | ✗     |
|    19 | ,               | ▁24          | ✗     |
|    20 | ה               | ▁מנד         | ✗     |
|    21 | ים              | טים          | ✗     |
|    22 | ▁נוספים         | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | יים             | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ים              |              | ✗     |

2024-12-31 19:35:58,812 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:35:58,817 - TrainingLogger - INFO - Gradient norm: 16.2505
2024-12-31 19:36:05,692 - TrainingLogger - INFO - Step 19710, Batch metrics: Loss: 7.7077, Accuracy: 0.0569, Perplexity: 2225.4408
2024-12-31 19:36:12,649 - TrainingLogger - INFO - Step 19720, Batch metrics: Loss: 7.8000, Accuracy: 0.0872, Perplexity: 2440.6106
2024-12-31 19:36:19,563 - TrainingLogger - INFO - Step 19730, Batch metrics: Loss: 7.2233, Accuracy: 0.0568, Perplexity: 1371.0085
2024-12-31 19:36:26,829 - TrainingLogger - INFO - Step 19740, Batch metrics: Loss: 7.9310, Accuracy: 0.0576, Perplexity: 2782.2905
2024-12-31 19:36:34,069 - TrainingLogger - INFO - Step 19750, Batch metrics: Loss: 7.2986, Accuracy: 0.0791, Perplexity: 1478.2180
2024-12-31 19:36:41,329 - TrainingLogger - INFO - Step 19760, Batch metrics: Loss: 7.4576, Accuracy: 0.0582, Perplexity: 1733.0585
2024-12-31 19:36:48,454 - TrainingLogger - INFO - Step 19770, Batch metrics: Loss: 7.7643, Accuracy: 0.0833, Perplexity: 2354.8923
2024-12-31 19:36:54,967 - TrainingLogger - INFO - Step 19780, Batch metrics: Loss: 7.4073, Accuracy: 0.1034, Perplexity: 1647.9873
2024-12-31 19:37:02,306 - TrainingLogger - INFO - Step 19790, Batch metrics: Loss: 8.2310, Accuracy: 0.0316, Perplexity: 3755.4512
2024-12-31 19:37:09,847 - TrainingLogger - INFO - Step 19800, Batch metrics: Loss: 7.0325, Accuracy: 0.0789, Perplexity: 1132.9006
2024-12-31 19:37:09,847 - TrainingLogger - INFO - Step 19800, Prediction vs Actual:
2024-12-31 19:37:09,847 - TrainingLogger - INFO - Input 1: הריטלין למשל נחקר במשך 60 שנה והוכח שהוא בין התרופות היעילות לחיזוק קשב וריכוז
2024-12-31 19:37:09,848 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:37:09,848 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הרי         | ✗     |
|     1 | ,               | ט            | ✗     |
|     2 | ,               | לין          | ✗     |
|     3 | </s>            | ▁למשל        | ✗     |
|     4 | ב               | ▁נחקר        | ✗     |
|     5 | ה               | ▁במשך        | ✗     |
|     6 | ▁שנים           | ▁60          | ✗     |
|     7 | ▁שנה            | ▁שנה         | ✓     |
|     8 | </s>            | ▁והו         | ✗     |
|     9 | ות              | כח           | ✗     |
|    10 | ה               | ▁שהוא        | ✗     |
|    11 | ▁לא             | ▁בין         | ✗     |
|    12 | ▁החיים          | ▁התרופות     | ✗     |
|    13 | ,               | ▁ה           | ✗     |
|    14 | נוס             | יעילות       | ✗     |
|    15 | ▁וה             | ▁לחיזוק      | ✗     |
|    16 | ים              | ▁קשב         | ✗     |
|    17 | י               | ▁ו           | ✗     |
|    18 | עסקים           | ריכוז        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | י               | <pad>        | ✗     |
|    23 | י               | <pad>        | ✗     |
|    24 | ▁כבד            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ות              | <pad>        | ✗     |
|    30 | רה              | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | תי              | <pad>        | ✗     |
|    36 | ית              | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | ,               | <pad>        | ✗     |
|    45 | ,               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | ה               | <pad>        | ✗     |
|    48 | .               | <pad>        | ✗     |
|    49 | .               |              | ✗     |

2024-12-31 19:37:09,848 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:37:09,853 - TrainingLogger - INFO - Gradient norm: 19.9875
2024-12-31 19:37:16,850 - TrainingLogger - INFO - Step 19810, Batch metrics: Loss: 7.7812, Accuracy: 0.0769, Perplexity: 2395.1974
2024-12-31 19:37:24,341 - TrainingLogger - INFO - Step 19820, Batch metrics: Loss: 7.6868, Accuracy: 0.0818, Perplexity: 2179.4642
2024-12-31 19:37:31,391 - TrainingLogger - INFO - Step 19830, Batch metrics: Loss: 7.6712, Accuracy: 0.0694, Perplexity: 2145.7484
2024-12-31 19:37:38,771 - TrainingLogger - INFO - Step 19840, Batch metrics: Loss: 7.9263, Accuracy: 0.0444, Perplexity: 2769.2519
2024-12-31 19:37:45,706 - TrainingLogger - INFO - Step 19850, Batch metrics: Loss: 7.3255, Accuracy: 0.0775, Perplexity: 1518.5323
2024-12-31 19:37:52,857 - TrainingLogger - INFO - Step 19860, Batch metrics: Loss: 7.7683, Accuracy: 0.0648, Perplexity: 2364.3368
2024-12-31 19:38:00,332 - TrainingLogger - INFO - Step 19870, Batch metrics: Loss: 7.6206, Accuracy: 0.0710, Perplexity: 2039.7190
2024-12-31 19:38:08,117 - TrainingLogger - INFO - Step 19880, Batch metrics: Loss: 7.7539, Accuracy: 0.0694, Perplexity: 2330.5699
2024-12-31 19:38:15,620 - TrainingLogger - INFO - Step 19890, Batch metrics: Loss: 7.6134, Accuracy: 0.0795, Perplexity: 2025.0630
2024-12-31 19:38:22,790 - TrainingLogger - INFO - Step 19900, Batch metrics: Loss: 7.7482, Accuracy: 0.0604, Perplexity: 2317.4900
2024-12-31 19:38:22,790 - TrainingLogger - INFO - Step 19900, Prediction vs Actual:
2024-12-31 19:38:22,790 - TrainingLogger - INFO - Input 1: להעביר כסף לצנתור עבור דודה שלי לקח לנו חודשים
2024-12-31 19:38:22,791 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:38:22,791 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁להעביר      | ✗     |
|     1 | ▁-              | ▁כסף         | ✗     |
|     2 | ▁טוב            | ▁לצ          | ✗     |
|     3 | ▁-              | נת           | ✗     |
|     4 | ן               | ור           | ✗     |
|     5 | ים              | ▁עבור        | ✗     |
|     6 | ▁המשפחה         | ▁דודה        | ✗     |
|     7 | .               | ▁שלי         | ✗     |
|     8 | .               | ▁לקח         | ✗     |
|     9 | ת               | ▁לנו         | ✗     |
|    10 | ס               | ▁חודשים      | ✗     |
|    11 | ▁טובים          | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ים              | <pad>        | ✗     |
|    16 | ▁זה             | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ים              | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 19:38:22,791 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:38:22,796 - TrainingLogger - INFO - Gradient norm: 11.2593
2024-12-31 19:38:29,733 - TrainingLogger - INFO - Step 19910, Batch metrics: Loss: 7.4576, Accuracy: 0.0958, Perplexity: 1732.9990
2024-12-31 19:38:37,240 - TrainingLogger - INFO - Step 19920, Batch metrics: Loss: 7.8601, Accuracy: 0.0833, Perplexity: 2591.9001
2024-12-31 19:38:44,150 - TrainingLogger - INFO - Step 19930, Batch metrics: Loss: 7.5966, Accuracy: 0.0846, Perplexity: 1991.4612
2024-12-31 19:38:51,397 - TrainingLogger - INFO - Step 19940, Batch metrics: Loss: 7.2692, Accuracy: 0.0882, Perplexity: 1435.4206
2024-12-31 19:38:58,326 - TrainingLogger - INFO - Step 19950, Batch metrics: Loss: 7.5117, Accuracy: 0.0777, Perplexity: 1829.3507
2024-12-31 19:39:05,463 - TrainingLogger - INFO - Step 19960, Batch metrics: Loss: 7.5448, Accuracy: 0.0655, Perplexity: 1890.9229
2024-12-31 19:39:12,806 - TrainingLogger - INFO - Step 19970, Batch metrics: Loss: 7.3374, Accuracy: 0.0774, Perplexity: 1536.6740
2024-12-31 19:39:19,894 - TrainingLogger - INFO - Step 19980, Batch metrics: Loss: 8.0654, Accuracy: 0.0506, Perplexity: 3182.4566
2024-12-31 19:39:26,846 - TrainingLogger - INFO - Step 19990, Batch metrics: Loss: 7.6265, Accuracy: 0.0504, Perplexity: 2051.9286
2024-12-31 19:39:34,125 - TrainingLogger - INFO - Step 20000, Batch metrics: Loss: 7.6683, Accuracy: 0.0798, Perplexity: 2139.5477
2024-12-31 19:39:34,126 - TrainingLogger - INFO - Step 20000, Prediction vs Actual:
2024-12-31 19:39:34,126 - TrainingLogger - INFO - Input 1: מנגד, הניסיון מלמד כי יש קשר בין הערכאה השיפוטית שבפניה מתנהל הדיון ובין סכום התביעה לפסיקת הוצאות המשפט
2024-12-31 19:39:34,126 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:39:34,126 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מנגד        | ✗     |
|     1 | ה               | ,            | ✗     |
|     2 | ה               | ▁הניסיון     | ✗     |
|     3 | ▁-              | ▁מלמד        | ✗     |
|     4 | ים              | ▁כי          | ✗     |
|     5 | ון              | ▁יש          | ✗     |
|     6 | ▁לי             | ▁קשר         | ✗     |
|     7 | ▁זה             | ▁בין         | ✗     |
|     8 | ▁כל             | ▁הער         | ✗     |
|     9 | ונות            | כא           | ✗     |
|    10 | יות             | ה            | ✗     |
|    11 | ,               | ▁השיפוט      | ✗     |
|    12 | ית              | ית           | ✓     |
|    13 | ,               | ▁שב          | ✗     |
|    14 | די              | פני          | ✗     |
|    15 | ה               | ה            | ✓     |
|    16 | ,               | ▁מתנהל       | ✗     |
|    17 | ת               | ▁הדיון       | ✗     |
|    18 | .               | ▁ובין        | ✗     |
|    19 | ▁ה              | ▁סכום        | ✗     |
|    20 | ▁זה             | ▁התביעה      | ✗     |
|    21 | .               | ▁ל           | ✗     |
|    22 | פיתוח           | פסיק         | ✗     |
|    23 | ה               | ת            | ✗     |
|    24 | ▁החברה          | ▁הוצאות      | ✗     |
|    25 | .               | ▁המשפט       | ✗     |
|    26 | יות             | <pad>        | ✗     |
|    27 | יות             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 19:39:34,126 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:39:34,131 - TrainingLogger - INFO - Gradient norm: 11.9285
2024-12-31 19:39:41,602 - TrainingLogger - INFO - Step 20010, Batch metrics: Loss: 7.0051, Accuracy: 0.0721, Perplexity: 1102.2348
2024-12-31 19:39:48,578 - TrainingLogger - INFO - Step 20020, Batch metrics: Loss: 7.2205, Accuracy: 0.0857, Perplexity: 1367.2285
2024-12-31 19:39:56,150 - TrainingLogger - INFO - Step 20030, Batch metrics: Loss: 7.8032, Accuracy: 0.0979, Perplexity: 2448.3491
2024-12-31 19:40:03,569 - TrainingLogger - INFO - Step 20040, Batch metrics: Loss: 7.6967, Accuracy: 0.0625, Perplexity: 2201.0254
2024-12-31 19:40:10,704 - TrainingLogger - INFO - Step 20050, Batch metrics: Loss: 7.2856, Accuracy: 0.0881, Perplexity: 1459.1812
2024-12-31 19:40:17,875 - TrainingLogger - INFO - Step 20060, Batch metrics: Loss: 7.3355, Accuracy: 0.0898, Perplexity: 1533.8300
2024-12-31 19:40:24,883 - TrainingLogger - INFO - Step 20070, Batch metrics: Loss: 6.9699, Accuracy: 0.0844, Perplexity: 1064.1231
2024-12-31 19:40:31,650 - TrainingLogger - INFO - Step 20080, Batch metrics: Loss: 7.5436, Accuracy: 0.0743, Perplexity: 1888.6602
2024-12-31 19:40:40,141 - TrainingLogger - INFO - Step 20090, Batch metrics: Loss: 7.6894, Accuracy: 0.0335, Perplexity: 2185.0813
2024-12-31 19:40:47,198 - TrainingLogger - INFO - Step 20100, Batch metrics: Loss: 7.4011, Accuracy: 0.1088, Perplexity: 1637.7751
2024-12-31 19:40:47,198 - TrainingLogger - INFO - Step 20100, Prediction vs Actual:
2024-12-31 19:40:47,198 - TrainingLogger - INFO - Input 1: גם שני סרטיו הקודמים עסקו בפרשות שנלקחו מכותרות העיתונים, והמבנה העלילתי שלהם הוא כרוניקה של השתלשלותן
2024-12-31 19:40:47,199 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:40:47,199 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁גם          | ✗     |
|     1 | .               | ▁שני         | ✗     |
|     2 | ים              | ▁סרטי        | ✗     |
|     3 | ו               | ו            | ✓     |
|     4 | ▁הראשונים       | ▁הקודמים     | ✗     |
|     5 | ▁של             | ▁עסק         | ✗     |
|     6 | ות              | ו            | ✗     |
|     7 | ▁ב              | ▁בפר         | ✗     |
|     8 | יים             | שות          | ✗     |
|     9 | <pad>           | ▁שנלקח       | ✗     |
|    10 | ה               | ו            | ✗     |
|    11 | ▁לאור           | ▁מכות        | ✗     |
|    12 | רות             | רות          | ✓     |
|    13 | .               | ▁העיתונים    | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | </s>            | ▁וה          | ✗     |
|    16 | שנים            | מבנה         | ✗     |
|    17 | ▁שלהם           | ▁העל         | ✗     |
|    18 | י               | י            | ✓     |
|    19 | ונות            | לתי          | ✗     |
|    20 | ▁שלהם           | ▁שלהם        | ✓     |
|    21 | ▁היה            | ▁הוא         | ✗     |
|    22 | ▁זה             | ▁כרוני       | ✗     |
|    23 | ▁ל              | קה           | ✗     |
|    24 | .               | ▁של          | ✗     |
|    25 | ל               | ▁השתל        | ✗     |
|    26 | ל               | שלו          | ✗     |
|    27 | ת               | תן           | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            |              | ✗     |

2024-12-31 19:40:47,199 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:40:47,204 - TrainingLogger - INFO - Gradient norm: 14.4383
2024-12-31 19:40:54,164 - TrainingLogger - INFO - Step 20110, Batch metrics: Loss: 7.3474, Accuracy: 0.0984, Perplexity: 1552.2137
2024-12-31 19:41:01,187 - TrainingLogger - INFO - Step 20120, Batch metrics: Loss: 7.4532, Accuracy: 0.0807, Perplexity: 1725.3687
2024-12-31 19:41:08,187 - TrainingLogger - INFO - Step 20130, Batch metrics: Loss: 8.1281, Accuracy: 0.0411, Perplexity: 3388.4700
2024-12-31 19:41:15,682 - TrainingLogger - INFO - Step 20140, Batch metrics: Loss: 7.1926, Accuracy: 0.0786, Perplexity: 1329.5534
2024-12-31 19:41:22,634 - TrainingLogger - INFO - Step 20150, Batch metrics: Loss: 8.0705, Accuracy: 0.0800, Perplexity: 3198.6806
2024-12-31 19:41:29,679 - TrainingLogger - INFO - Step 20160, Batch metrics: Loss: 7.4611, Accuracy: 0.0580, Perplexity: 1739.1232
2024-12-31 19:41:36,795 - TrainingLogger - INFO - Step 20170, Batch metrics: Loss: 7.4086, Accuracy: 0.0468, Perplexity: 1650.1190
2024-12-31 19:41:43,713 - TrainingLogger - INFO - Step 20180, Batch metrics: Loss: 7.0684, Accuracy: 0.1053, Perplexity: 1174.2844
2024-12-31 19:41:51,688 - TrainingLogger - INFO - Step 20190, Batch metrics: Loss: 7.6447, Accuracy: 0.0616, Perplexity: 2089.4650
2024-12-31 19:41:58,890 - TrainingLogger - INFO - Step 20200, Batch metrics: Loss: 7.1990, Accuracy: 0.0788, Perplexity: 1338.1442
2024-12-31 19:41:58,890 - TrainingLogger - INFO - Step 20200, Prediction vs Actual:
2024-12-31 19:41:58,890 - TrainingLogger - INFO - Input 1: אנחנו נלחמים על חיים של אנשיםקבוצה של פעילי זכויות אדם סרבים מחתה על המדיניות של ווייציץ, ניצול הכוח שלו וההופעות הדרמטיות בטלוויזיה שרק מעוררות יותר פאניקה במדינה שממילא כבר מודאגת
2024-12-31 19:41:58,891 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:41:58,891 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | ▁נ              | ▁נלחמים      | ✗     |
|     2 | ▁יחד            | ▁על          | ✗     |
|     3 | ▁עצמנו          | ▁חיים        | ✗     |
|     4 | </s>            | ▁של          | ✗     |
|     5 | ▁אנשים          | ▁אנשים       | ✓     |
|     6 | </s>            | קבוצה        | ✗     |
|     7 | ▁שלנו           | ▁של          | ✗     |
|     8 | ▁אנשים          | ▁פעיל        | ✗     |
|     9 | </s>            | י            | ✗     |
|    10 | ▁צבא            | ▁זכויות      | ✗     |
|    11 | -               | ▁אדם         | ✗     |
|    12 | </s>            | ▁סרב         | ✗     |
|    13 | ית              | ים           | ✗     |
|    14 | </s>            | ▁מח          | ✗     |
|    15 | </s>            | תה           | ✗     |
|    16 | </s>            | ▁על          | ✗     |
|    17 | ▁עצמם           | ▁המדיניות    | ✗     |
|    18 | ▁שלנו           | ▁של          | ✗     |
|    19 | ▁המדינה         | ▁ווי         | ✗     |
|    20 | ג               | י            | ✗     |
|    21 | </s>            | ציץ          | ✗     |
|    22 | </s>            | ,            | ✗     |
|    23 | </s>            | ▁ניצול       | ✗     |
|    24 | ת               | ▁הכוח        | ✗     |
|    25 | ▁שלנו           | ▁שלו         | ✗     |
|    26 | </s>            | ▁וה          | ✗     |
|    27 | ה               | הופ          | ✗     |
|    28 | ▁שלו            | עות          | ✗     |
|    29 | ▁שלו            | ▁הדר         | ✗     |
|    30 | סים             | מטי          | ✗     |
|    31 | ▁שלו            | ות           | ✗     |
|    32 | ▁שלו            | ▁בטלוויזיה   | ✗     |
|    33 | </s>            | ▁שרק         | ✗     |
|    34 | ▁הם             | ▁מעורר       | ✗     |
|    35 | ים              | ות           | ✗     |
|    36 | ▁שליטה          | ▁יותר        | ✗     |
|    37 | ▁מ              | ▁פאניקה      | ✗     |
|    38 | </s>            | ▁במדינה      | ✗     |
|    39 | </s>            | ▁שמ          | ✗     |
|    40 | יש              | מי           | ✗     |
|    41 | שים             | לא           | ✗     |
|    42 | ה               | ▁כבר         | ✗     |
|    43 | ▁לא             | ▁מודאגת      | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 19:41:58,891 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:41:58,896 - TrainingLogger - INFO - Gradient norm: 15.9181
2024-12-31 19:42:06,501 - TrainingLogger - INFO - Step 20210, Batch metrics: Loss: 7.3925, Accuracy: 0.0982, Perplexity: 1623.8362
2024-12-31 19:42:13,514 - TrainingLogger - INFO - Step 20220, Batch metrics: Loss: 7.4722, Accuracy: 0.0755, Perplexity: 1758.4701
2024-12-31 19:42:20,961 - TrainingLogger - INFO - Step 20230, Batch metrics: Loss: 7.3347, Accuracy: 0.0576, Perplexity: 1532.5053
2024-12-31 19:42:28,069 - TrainingLogger - INFO - Step 20240, Batch metrics: Loss: 7.4566, Accuracy: 0.0643, Perplexity: 1731.1844
2024-12-31 19:42:36,224 - TrainingLogger - INFO - Step 20250, Batch metrics: Loss: 7.5840, Accuracy: 0.0738, Perplexity: 1966.4325
2024-12-31 19:42:42,687 - TrainingLogger - INFO - Step 20260, Batch metrics: Loss: 7.5944, Accuracy: 0.0890, Perplexity: 1987.0267
2024-12-31 19:42:49,707 - TrainingLogger - INFO - Step 20270, Batch metrics: Loss: 7.4102, Accuracy: 0.0632, Perplexity: 1652.7011
2024-12-31 19:42:57,098 - TrainingLogger - INFO - Step 20280, Batch metrics: Loss: 7.5136, Accuracy: 0.0721, Perplexity: 1832.8581
2024-12-31 19:43:04,680 - TrainingLogger - INFO - Step 20290, Batch metrics: Loss: 7.8244, Accuracy: 0.0580, Perplexity: 2500.9983
2024-12-31 19:43:11,657 - TrainingLogger - INFO - Step 20300, Batch metrics: Loss: 7.5542, Accuracy: 0.0637, Perplexity: 1908.8021
2024-12-31 19:43:11,658 - TrainingLogger - INFO - Step 20300, Prediction vs Actual:
2024-12-31 19:43:11,658 - TrainingLogger - INFO - Input 1: הרבה פעמים יש גם אינטרסים משותפים, בטח בטיפול במשבר הקורונה ובעזרה לאזרחי ישראל
2024-12-31 19:43:11,658 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:43:11,658 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הרבה        | ✗     |
|     1 | ▁כסף            | ▁פעמים       | ✗     |
|     2 | ▁-              | ▁יש          | ✗     |
|     3 | ▁לנו            | ▁גם          | ✗     |
|     4 | ▁את             | ▁            | ✗     |
|     5 | ▁-              | אינטרסים     | ✗     |
|     6 | .               | ▁משותפים     | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | <pad>           | ▁בטח         | ✗     |
|     9 | .               | ▁בטיפול      | ✗     |
|    10 | ▁זה             | ▁במשבר       | ✗     |
|    11 | .               | ▁הקור        | ✗     |
|    12 | רה              | ונה          | ✗     |
|    13 | ▁שלו            | ▁וב          | ✗     |
|    14 | בעיות           | עזרה         | ✗     |
|    15 | ▁שלהם           | ▁לא          | ✗     |
|    16 | ▁משנה           | זרח          | ✗     |
|    17 | י               | י            | ✓     |
|    18 | ▁החוק           | ▁ישראל       | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | יות             | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            |              | ✗     |

2024-12-31 19:43:11,658 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:43:11,663 - TrainingLogger - INFO - Gradient norm: 15.5593
2024-12-31 19:43:18,371 - TrainingLogger - INFO - Step 20310, Batch metrics: Loss: 7.4221, Accuracy: 0.0580, Perplexity: 1672.5893
2024-12-31 19:43:25,462 - TrainingLogger - INFO - Step 20320, Batch metrics: Loss: 7.6102, Accuracy: 0.0549, Perplexity: 2018.7452
2024-12-31 19:43:32,501 - TrainingLogger - INFO - Step 20330, Batch metrics: Loss: 7.4665, Accuracy: 0.0718, Perplexity: 1748.4459
2024-12-31 19:43:39,605 - TrainingLogger - INFO - Step 20340, Batch metrics: Loss: 7.6529, Accuracy: 0.0455, Perplexity: 2106.7217
2024-12-31 19:43:46,919 - TrainingLogger - INFO - Step 20350, Batch metrics: Loss: 7.8334, Accuracy: 0.0435, Perplexity: 2523.4352
2024-12-31 19:43:54,381 - TrainingLogger - INFO - Step 20360, Batch metrics: Loss: 7.1467, Accuracy: 0.0969, Perplexity: 1269.8561
2024-12-31 19:44:01,581 - TrainingLogger - INFO - Step 20370, Batch metrics: Loss: 7.9046, Accuracy: 0.0427, Perplexity: 2709.8467
2024-12-31 19:44:08,544 - TrainingLogger - INFO - Step 20380, Batch metrics: Loss: 7.1971, Accuracy: 0.0613, Perplexity: 1335.5981
2024-12-31 19:44:15,759 - TrainingLogger - INFO - Step 20390, Batch metrics: Loss: 7.9240, Accuracy: 0.0769, Perplexity: 2762.8009
2024-12-31 19:44:22,378 - TrainingLogger - INFO - Step 20400, Batch metrics: Loss: 7.4217, Accuracy: 0.0705, Perplexity: 1671.9434
2024-12-31 19:44:22,378 - TrainingLogger - INFO - Step 20400, Prediction vs Actual:
2024-12-31 19:44:22,378 - TrainingLogger - INFO - Input 1: בסופו של שבוע פרלמנטרי הם חוזרים הביתה, שם מחכים להם המצביעים שלהם
2024-12-31 19:44:22,379 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:44:22,379 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | :               | ▁בסופו       | ✗     |
|     1 | ▁של             | ▁של          | ✓     |
|     2 | ▁דבר            | ▁שבוע        | ✗     |
|     3 | ה               | ▁            | ✗     |
|     4 | עידן            | פרלמנט       | ✗     |
|     5 | ים              | רי           | ✗     |
|     6 | ים              | ▁הם          | ✗     |
|     7 | ▁גם             | ▁חוזרים      | ✗     |
|     8 | ▁להיות          | ▁הביתה       | ✗     |
|     9 | ,               | ,            | ✓     |
|    10 | <pad>           | ▁שם          | ✗     |
|    11 | ▁הם             | ▁מחכים       | ✗     |
|    12 | ▁להם            | ▁להם         | ✓     |
|    13 | .               | ▁המצביע      | ✗     |
|    14 | ים              | ים           | ✓     |
|    15 | .               | ▁שלהם        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁על             | <pad>        | ✗     |
|    22 | ▁על             | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | ▁על             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁על             | <pad>        | ✗     |
|    27 | ▁על             | <pad>        | ✗     |
|    28 | ▁על             | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 19:44:22,379 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:44:22,384 - TrainingLogger - INFO - Gradient norm: 12.4697
2024-12-31 19:44:29,775 - TrainingLogger - INFO - Step 20410, Batch metrics: Loss: 7.3245, Accuracy: 0.0725, Perplexity: 1517.0464
2024-12-31 19:44:36,998 - TrainingLogger - INFO - Step 20420, Batch metrics: Loss: 7.1925, Accuracy: 0.0621, Perplexity: 1329.3778
2024-12-31 19:44:44,685 - TrainingLogger - INFO - Step 20430, Batch metrics: Loss: 7.6278, Accuracy: 0.0549, Perplexity: 2054.4379
2024-12-31 19:44:52,212 - TrainingLogger - INFO - Step 20440, Batch metrics: Loss: 8.0678, Accuracy: 0.0494, Perplexity: 3189.9772
2024-12-31 19:44:59,305 - TrainingLogger - INFO - Step 20450, Batch metrics: Loss: 7.8158, Accuracy: 0.0598, Perplexity: 2479.3721
2024-12-31 19:45:06,929 - TrainingLogger - INFO - Step 20460, Batch metrics: Loss: 7.5762, Accuracy: 0.0708, Perplexity: 1951.1240
2024-12-31 19:45:13,831 - TrainingLogger - INFO - Step 20470, Batch metrics: Loss: 7.5193, Accuracy: 0.0843, Perplexity: 1843.3433
2024-12-31 19:45:21,055 - TrainingLogger - INFO - Step 20480, Batch metrics: Loss: 7.3097, Accuracy: 0.0865, Perplexity: 1494.7808
2024-12-31 19:45:27,723 - TrainingLogger - INFO - Step 20490, Batch metrics: Loss: 7.3856, Accuracy: 0.1223, Perplexity: 1612.6629
2024-12-31 19:45:35,311 - TrainingLogger - INFO - Step 20500, Batch metrics: Loss: 7.1974, Accuracy: 0.0513, Perplexity: 1335.9236
2024-12-31 19:45:35,312 - TrainingLogger - INFO - Step 20500, Prediction vs Actual:
2024-12-31 19:45:35,312 - TrainingLogger - INFO - Input 1: הבהרנו לטראמפ שיש דברים שלא נוכל לקבל תחת הנהגת נתניהו, כמו לדוגמה שלא נעקור אפילו לא אדם אחד ואף יישוב
2024-12-31 19:45:35,312 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:45:35,312 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הבה         | ✗     |
|     1 | לה              | רנו          | ✗     |
|     2 | ,               | ▁לטר         | ✗     |
|     3 | ף               | אמפ          | ✗     |
|     4 | ינו             | ▁שיש         | ✗     |
|     5 | ▁לנו            | ▁דברים       | ✗     |
|     6 | ▁אחרים          | ▁שלא         | ✗     |
|     7 | ▁היו            | ▁נוכל        | ✗     |
|     8 | ▁לעשות          | ▁לקבל        | ✗     |
|     9 | ▁יותר           | ▁תחת         | ✗     |
|    10 | ינו             | ▁הנהג        | ✗     |
|    11 | ים              | ת            | ✗     |
|    12 | ם               | ▁נתנ         | ✗     |
|    13 | לי              | יהו          | ✗     |
|    14 | אל              | ,            | ✗     |
|    15 | ג               | ▁כמו         | ✗     |
|    16 | ▁תמיד           | ▁לדוגמה      | ✗     |
|    17 | ,               | ▁שלא         | ✗     |
|    18 | ▁ראינו          | ▁נע          | ✗     |
|    19 | ה               | קור          | ✗     |
|    20 | ים              | ▁אפילו       | ✗     |
|    21 | ▁יותר           | ▁לא          | ✗     |
|    22 | ▁היה            | ▁אדם         | ✗     |
|    23 | ▁אחר            | ▁אחד         | ✗     |
|    24 | .               | ▁ואף         | ✗     |
|    25 | ▁אחד            | ▁יי          | ✗     |
|    26 | שוב             | שוב          | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 19:45:35,312 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:45:35,317 - TrainingLogger - INFO - Gradient norm: 12.4568
2024-12-31 19:45:42,311 - TrainingLogger - INFO - Step 20510, Batch metrics: Loss: 7.4062, Accuracy: 0.0675, Perplexity: 1646.1024
2024-12-31 19:45:49,941 - TrainingLogger - INFO - Step 20520, Batch metrics: Loss: 7.8131, Accuracy: 0.0518, Perplexity: 2472.7685
2024-12-31 19:45:57,147 - TrainingLogger - INFO - Step 20530, Batch metrics: Loss: 7.5960, Accuracy: 0.0789, Perplexity: 1990.2498
2024-12-31 19:46:04,304 - TrainingLogger - INFO - Step 20540, Batch metrics: Loss: 7.3140, Accuracy: 0.1011, Perplexity: 1501.2388
2024-12-31 19:46:11,593 - TrainingLogger - INFO - Step 20550, Batch metrics: Loss: 7.6646, Accuracy: 0.0695, Perplexity: 2131.6343
2024-12-31 19:46:18,608 - TrainingLogger - INFO - Step 20560, Batch metrics: Loss: 7.0799, Accuracy: 0.0919, Perplexity: 1187.8897
2024-12-31 19:46:25,832 - TrainingLogger - INFO - Step 20570, Batch metrics: Loss: 7.4542, Accuracy: 0.0711, Perplexity: 1727.0174
2024-12-31 19:46:32,837 - TrainingLogger - INFO - Step 20580, Batch metrics: Loss: 7.2371, Accuracy: 0.0735, Perplexity: 1389.9948
2024-12-31 19:46:37,487 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2024-12-31 19:46:37,487 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2024-12-31 19:46:37,520 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 44]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 110]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 110]), device: cuda:0
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:46:37,521 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:46:41,158 - TrainingLogger - INFO - Step 20590, Batch metrics: Loss: 7.6330, Accuracy: 0.0660, Perplexity: 2065.1722
2024-12-31 19:46:48,009 - TrainingLogger - INFO - Step 20600, Batch metrics: Loss: 7.7312, Accuracy: 0.0690, Perplexity: 2278.2949
2024-12-31 19:46:48,009 - TrainingLogger - INFO - Step 20600, Prediction vs Actual:
2024-12-31 19:46:48,009 - TrainingLogger - INFO - Input 1: מצער אותי זה שהיום חלק מהמנהיגים מסרבים או חוששים או לא אומרים את העמדות כפי שהן בקול רם
2024-12-31 19:46:48,010 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:46:48,010 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מצער        | ✗     |
|     1 | ▁על             | ▁אותי        | ✗     |
|     2 | .               | ▁זה          | ✗     |
|     3 | ▁לא             | ▁שהיום       | ✗     |
|     4 | ▁האחרון         | ▁חלק         | ✗     |
|     5 | ▁שלי            | ▁מה          | ✗     |
|     6 | ה               | מנהיג        | ✗     |
|     7 | ים              | ים           | ✓     |
|     8 | </s>            | ▁מסרבים      | ✗     |
|     9 | </s>            | ▁או          | ✗     |
|    10 | ▁לא             | ▁חוששים      | ✗     |
|    11 | </s>            | ▁או          | ✗     |
|    12 | ▁אחרים          | ▁לא          | ✗     |
|    13 | </s>            | ▁אומרים      | ✗     |
|    14 | ▁לי             | ▁את          | ✗     |
|    15 | ▁זה             | ▁העמדות      | ✗     |
|    16 | ▁האלה           | ▁כפי         | ✗     |
|    17 | ם               | ▁שהן         | ✗     |
|    18 | ▁היו            | ▁בקול        | ✗     |
|    19 | י               | ▁רם          | ✗     |
|    20 | ▁יותר           | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            |              | ✗     |

2024-12-31 19:46:48,010 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:46:48,015 - TrainingLogger - INFO - Gradient norm: 12.1733
2024-12-31 19:46:55,339 - TrainingLogger - INFO - Step 20610, Batch metrics: Loss: 7.5611, Accuracy: 0.0780, Perplexity: 1921.9906
2024-12-31 19:47:02,308 - TrainingLogger - INFO - Step 20620, Batch metrics: Loss: 7.6009, Accuracy: 0.0368, Perplexity: 2000.0164
2024-12-31 19:47:09,182 - TrainingLogger - INFO - Step 20630, Batch metrics: Loss: 7.8063, Accuracy: 0.0429, Perplexity: 2456.0384
2024-12-31 19:47:16,287 - TrainingLogger - INFO - Step 20640, Batch metrics: Loss: 7.4428, Accuracy: 0.0649, Perplexity: 1707.5068
2024-12-31 19:47:24,999 - TrainingLogger - INFO - Step 20650, Batch metrics: Loss: 7.6503, Accuracy: 0.0815, Perplexity: 2101.2709
2024-12-31 19:47:31,500 - TrainingLogger - INFO - Step 20660, Batch metrics: Loss: 7.2474, Accuracy: 0.0552, Perplexity: 1404.5092
2024-12-31 19:47:38,766 - TrainingLogger - INFO - Step 20670, Batch metrics: Loss: 7.4549, Accuracy: 0.0864, Perplexity: 1728.3124
2024-12-31 19:47:45,546 - TrainingLogger - INFO - Step 20680, Batch metrics: Loss: 6.9169, Accuracy: 0.1059, Perplexity: 1009.1993
2024-12-31 19:47:52,671 - TrainingLogger - INFO - Step 20690, Batch metrics: Loss: 7.0559, Accuracy: 0.0541, Perplexity: 1159.7289
2024-12-31 19:47:59,496 - TrainingLogger - INFO - Step 20700, Batch metrics: Loss: 7.6271, Accuracy: 0.0802, Perplexity: 2053.1031
2024-12-31 19:47:59,497 - TrainingLogger - INFO - Step 20700, Prediction vs Actual:
2024-12-31 19:47:59,497 - TrainingLogger - INFO - Input 1: הבילוי במסעדות, ההופעות הכנסים יהיו בסכנה
2024-12-31 19:47:59,497 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:47:59,497 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ה           | ✗     |
|     1 | ?               | בילוי        | ✗     |
|     2 | ?               | ▁ב           | ✗     |
|     3 | רס              | מסעדות       | ✗     |
|     4 | ?               | ,            | ✗     |
|     5 | </s>            | ▁ההופעות     | ✗     |
|     6 | ,               | ▁הכנס        | ✗     |
|     7 | ות              | ים           | ✗     |
|     8 | ,               | ▁יהיו        | ✗     |
|     9 | ▁חינם           | ▁בסכנה       | ✗     |
|    10 | ▁אם             | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | יות             | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ות              | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ות              | <pad>        | ✗     |
|    22 | ות              | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ,               |              | ✗     |

2024-12-31 19:47:59,497 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:47:59,502 - TrainingLogger - INFO - Gradient norm: 12.0046
2024-12-31 19:48:06,935 - TrainingLogger - INFO - Step 20710, Batch metrics: Loss: 7.3502, Accuracy: 0.0901, Perplexity: 1556.4992
2024-12-31 19:48:14,447 - TrainingLogger - INFO - Step 20720, Batch metrics: Loss: 7.6396, Accuracy: 0.0909, Perplexity: 2078.9325
2024-12-31 19:48:21,074 - TrainingLogger - INFO - Step 20730, Batch metrics: Loss: 7.5958, Accuracy: 0.0538, Perplexity: 1989.7858
2024-12-31 19:48:28,338 - TrainingLogger - INFO - Step 20740, Batch metrics: Loss: 8.1408, Accuracy: 0.0380, Perplexity: 3431.4968
2024-12-31 19:48:35,627 - TrainingLogger - INFO - Step 20750, Batch metrics: Loss: 7.1222, Accuracy: 0.0942, Perplexity: 1239.1169
2024-12-31 19:48:43,062 - TrainingLogger - INFO - Step 20760, Batch metrics: Loss: 7.1089, Accuracy: 0.0725, Perplexity: 1222.8146
2024-12-31 19:48:50,036 - TrainingLogger - INFO - Step 20770, Batch metrics: Loss: 7.2147, Accuracy: 0.1065, Perplexity: 1359.3186
2024-12-31 19:48:56,434 - TrainingLogger - INFO - Step 20780, Batch metrics: Loss: 7.7880, Accuracy: 0.0733, Perplexity: 2411.5866
2024-12-31 19:49:03,767 - TrainingLogger - INFO - Step 20790, Batch metrics: Loss: 7.7103, Accuracy: 0.0824, Perplexity: 2231.1274
2024-12-31 19:49:10,496 - TrainingLogger - INFO - Step 20800, Batch metrics: Loss: 7.5672, Accuracy: 0.0812, Perplexity: 1933.7564
2024-12-31 19:49:10,497 - TrainingLogger - INFO - Step 20800, Prediction vs Actual:
2024-12-31 19:49:10,497 - TrainingLogger - INFO - Input 1: 1,200 העובדים המקומיים הישראלים עמי בכ-102 נציגויות ישראל בעולם ישבתו היום ד במחאה על תנאי שכרם הקשים, שלטענתם לא השתנו ב-60 השנה האחרונות
2024-12-31 19:49:10,498 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:49:10,498 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ים              | ▁1,200       | ✗     |
|     1 | ▁רק             | ▁העובדים     | ✗     |
|     2 | ▁של             | ▁המקומיים    | ✗     |
|     3 | ,               | ▁הישראלי     | ✗     |
|     4 | ם               | ם            | ✓     |
|     5 | ▁האלה           | ▁עמי         | ✗     |
|     6 | רים             | ▁בכ          | ✗     |
|     7 | זו              | -10          | ✗     |
|     8 | ▁עד             | 2            | ✗     |
|     9 | ▁מהם            | ▁נציג        | ✗     |
|    10 | ים              | ויות         | ✗     |
|    11 | ,               | ▁ישראל       | ✗     |
|    12 | יים             | ▁בעולם       | ✗     |
|    13 | ▁הזה            | ▁יש          | ✗     |
|    14 | ▁לנו            | בתו          | ✗     |
|    15 | </s>            | ▁היום        | ✗     |
|    16 | </s>            | ▁ד           | ✗     |
|    17 | ח               | ▁במח         | ✗     |
|    18 | אה              | אה           | ✓     |
|    19 | ▁זו             | ▁על          | ✗     |
|    20 | ▁ידי            | ▁תנאי        | ✗     |
|    21 | ▁עבודה          | ▁שכר         | ✗     |
|    22 | ות              | ם            | ✗     |
|    23 | ▁של             | ▁הקשים       | ✗     |
|    24 | ,               | ,            | ✓     |
|    25 | </s>            | ▁של          | ✗     |
|    26 | ▁העיר           | טענת         | ✗     |
|    27 | ם               | ם            | ✓     |
|    28 | ▁של             | ▁לא          | ✗     |
|    29 | ▁היה            | ▁השתנו       | ✗     |
|    30 | ת               | ▁ב           | ✗     |
|    31 | פרלמנט          | -60          | ✗     |
|    32 | ▁השנים          | ▁השנה        | ✗     |
|    33 | ▁האחרונה        | ▁האחרונות    | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ▁ה              | <pad>        | ✗     |
|    37 | ▁עד             | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁מ              |              | ✗     |

2024-12-31 19:49:10,498 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:49:10,503 - TrainingLogger - INFO - Gradient norm: 12.9181
2024-12-31 19:49:17,360 - TrainingLogger - INFO - Step 20810, Batch metrics: Loss: 7.2548, Accuracy: 0.0833, Perplexity: 1414.9459
2024-12-31 19:49:23,992 - TrainingLogger - INFO - Step 20820, Batch metrics: Loss: 7.5494, Accuracy: 0.0710, Perplexity: 1899.6866
2024-12-31 19:49:31,315 - TrainingLogger - INFO - Step 20830, Batch metrics: Loss: 8.3989, Accuracy: 0.0250, Perplexity: 4442.2880
2024-12-31 19:49:38,550 - TrainingLogger - INFO - Step 20840, Batch metrics: Loss: 7.3599, Accuracy: 0.0800, Perplexity: 1571.7461
2024-12-31 19:49:45,975 - TrainingLogger - INFO - Step 20850, Batch metrics: Loss: 7.7049, Accuracy: 0.0667, Perplexity: 2219.2870
2024-12-31 19:49:53,316 - TrainingLogger - INFO - Step 20860, Batch metrics: Loss: 7.5560, Accuracy: 0.0730, Perplexity: 1912.2248
2024-12-31 19:50:00,565 - TrainingLogger - INFO - Step 20870, Batch metrics: Loss: 7.5895, Accuracy: 0.0706, Perplexity: 1977.3792
2024-12-31 19:50:07,944 - TrainingLogger - INFO - Step 20880, Batch metrics: Loss: 7.5796, Accuracy: 0.0449, Perplexity: 1957.9061
2024-12-31 19:50:14,900 - TrainingLogger - INFO - Step 20890, Batch metrics: Loss: 7.4478, Accuracy: 0.0909, Perplexity: 1716.0691
2024-12-31 19:50:20,922 - TrainingLogger - INFO - Step 20900, Batch metrics: Loss: 7.2930, Accuracy: 0.0824, Perplexity: 1470.0297
2024-12-31 19:50:20,923 - TrainingLogger - INFO - Step 20900, Prediction vs Actual:
2024-12-31 19:50:20,923 - TrainingLogger - INFO - Input 1: ישראל מתעקשת על קבלת 33 שמות של חטופים שישוחררו
2024-12-31 19:50:20,923 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:50:20,923 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ישראל       | ✗     |
|     1 | ה               | ▁מתעקשת      | ✗     |
|     2 | ▁המדינה         | ▁על          | ✗     |
|     3 | ▁המדינה         | ▁קבלת        | ✗     |
|     4 | ▁החוק           | ▁33          | ✗     |
|     5 | ,               | ▁שמות        | ✗     |
|     6 | ▁חדשים          | ▁של          | ✗     |
|     7 | ל               | ▁ח           | ✗     |
|     8 | ות              | טופ          | ✗     |
|     9 | ים              | ים           | ✓     |
|    10 | ▁נוספים         | ▁שי          | ✗     |
|    11 | צ               | שוחרר        | ✗     |
|    12 | ו               | ו            | ✓     |
|    13 | ▁מה             | <pad>        | ✗     |
|    14 | ו               | <pad>        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | ▁ב              | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ▁ב              | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ם               | <pad>        | ✗     |
|    26 | ▁ב              | <pad>        | ✗     |
|    27 | ם               | <pad>        | ✗     |
|    28 | ▁ב              | <pad>        | ✗     |
|    29 | ▁ב              | <pad>        | ✗     |
|    30 | ▁ב              | <pad>        | ✗     |
|    31 | ▁נוספים         | <pad>        | ✗     |
|    32 | ▁ב              | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ▁ב              | <pad>        | ✗     |
|    37 | ם               | <pad>        | ✗     |
|    38 | ▁ב              |              | ✗     |

2024-12-31 19:50:20,923 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:50:20,928 - TrainingLogger - INFO - Gradient norm: 9.9264
2024-12-31 19:50:28,524 - TrainingLogger - INFO - Step 20910, Batch metrics: Loss: 7.1927, Accuracy: 0.0632, Perplexity: 1329.6256
2024-12-31 19:50:36,158 - TrainingLogger - INFO - Step 20920, Batch metrics: Loss: 7.3864, Accuracy: 0.0564, Perplexity: 1613.8321
2024-12-31 19:50:43,128 - TrainingLogger - INFO - Step 20930, Batch metrics: Loss: 7.6360, Accuracy: 0.0319, Perplexity: 2071.4981
2024-12-31 19:50:50,382 - TrainingLogger - INFO - Step 20940, Batch metrics: Loss: 7.6379, Accuracy: 0.0876, Perplexity: 2075.3817
2024-12-31 19:50:57,789 - TrainingLogger - INFO - Step 20950, Batch metrics: Loss: 7.5973, Accuracy: 0.1070, Perplexity: 1992.8186
2024-12-31 19:51:05,072 - TrainingLogger - INFO - Step 20960, Batch metrics: Loss: 8.1124, Accuracy: 0.0502, Perplexity: 3335.5772
2024-12-31 19:51:12,723 - TrainingLogger - INFO - Step 20970, Batch metrics: Loss: 7.3757, Accuracy: 0.0800, Perplexity: 1596.6452
2024-12-31 19:51:20,240 - TrainingLogger - INFO - Step 20980, Batch metrics: Loss: 7.1670, Accuracy: 0.0764, Perplexity: 1295.9915
2024-12-31 19:51:27,067 - TrainingLogger - INFO - Step 20990, Batch metrics: Loss: 7.4587, Accuracy: 0.0610, Perplexity: 1734.9271
2024-12-31 19:51:34,024 - TrainingLogger - INFO - Step 21000, Batch metrics: Loss: 7.2662, Accuracy: 0.0678, Perplexity: 1431.1327
2024-12-31 19:51:34,024 - TrainingLogger - INFO - Step 21000, Prediction vs Actual:
2024-12-31 19:51:34,024 - TrainingLogger - INFO - Input 1: בין היתר מדובר בחוק יסוד השוויון, חוק הפונדקאות וחוק יסוד מגילת העצמאות
2024-12-31 19:51:34,024 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:51:34,024 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בין         | ✗     |
|     1 | ▁לבין           | ▁היתר        | ✗     |
|     2 | ה               | ▁מדובר       | ✗     |
|     3 | ▁ב              | ▁בחוק        | ✗     |
|     4 | י               | ▁יסוד        | ✗     |
|     5 | ,               | ▁ה           | ✗     |
|     6 | מוס             | שוויון       | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | ▁גם             | ▁חוק         | ✗     |
|     9 | ▁חדש            | ▁ה           | ✗     |
|    10 | פרלמנט          | פונדק        | ✗     |
|    11 | ,               | אות          | ✗     |
|    12 | ,               | ▁ו           | ✗     |
|    13 | המדינה          | חוק          | ✗     |
|    14 | ק               | ▁יסוד        | ✗     |
|    15 | ו               | ▁מגיל        | ✗     |
|    16 | ה               | ת            | ✗     |
|    17 | ▁המוות          | ▁העצמאות     | ✗     |
|    18 | ▁של             | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 19:51:34,024 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:51:34,029 - TrainingLogger - INFO - Gradient norm: 14.0232
2024-12-31 19:51:41,226 - TrainingLogger - INFO - Step 21010, Batch metrics: Loss: 7.6250, Accuracy: 0.0592, Perplexity: 2048.6916
2024-12-31 19:51:48,790 - TrainingLogger - INFO - Step 21020, Batch metrics: Loss: 7.2666, Accuracy: 0.0719, Perplexity: 1431.6078
2024-12-31 19:51:56,029 - TrainingLogger - INFO - Step 21030, Batch metrics: Loss: 7.8507, Accuracy: 0.0757, Perplexity: 2567.5552
2024-12-31 19:52:02,745 - TrainingLogger - INFO - Step 21040, Batch metrics: Loss: 7.3158, Accuracy: 0.0853, Perplexity: 1503.8804
2024-12-31 19:52:09,729 - TrainingLogger - INFO - Step 21050, Batch metrics: Loss: 7.8911, Accuracy: 0.0682, Perplexity: 2673.4657
2024-12-31 19:52:16,438 - TrainingLogger - INFO - Step 21060, Batch metrics: Loss: 7.6130, Accuracy: 0.0718, Perplexity: 2024.2859
2024-12-31 19:52:23,556 - TrainingLogger - INFO - Step 21070, Batch metrics: Loss: 7.1903, Accuracy: 0.0609, Perplexity: 1326.5068
2024-12-31 19:52:30,469 - TrainingLogger - INFO - Step 21080, Batch metrics: Loss: 7.6959, Accuracy: 0.0788, Perplexity: 2199.3898
2024-12-31 19:52:37,588 - TrainingLogger - INFO - Step 21090, Batch metrics: Loss: 7.3987, Accuracy: 0.0924, Perplexity: 1633.8244
2024-12-31 19:52:44,858 - TrainingLogger - INFO - Step 21100, Batch metrics: Loss: 7.6064, Accuracy: 0.0851, Perplexity: 2011.0714
2024-12-31 19:52:44,858 - TrainingLogger - INFO - Step 21100, Prediction vs Actual:
2024-12-31 19:52:44,858 - TrainingLogger - INFO - Input 1: סדרתו האחרונה Murder in the First, שודרה בשנים 2016-2014
2024-12-31 19:52:44,858 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:52:44,858 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁היא            | ▁סדרת        | ✗     |
|     1 | .               | ו            | ✗     |
|     2 | .               | ▁האחרונה     | ✗     |
|     3 | .               | ▁M           | ✗     |
|     4 | .               | ur           | ✗     |
|     5 | ה               | der          | ✗     |
|     6 | .               | ▁in          | ✗     |
|     7 | .               | ▁the         | ✗     |
|     8 | .               | ▁F           | ✗     |
|     9 | S               | ir           | ✗     |
|    10 | .               | st           | ✗     |
|    11 | ,               | ,            | ✓     |
|    12 | <pad>           | ▁שוד         | ✗     |
|    13 | ▁אותה           | רה           | ✗     |
|    14 | ▁ב              | ▁בשנים       | ✗     |
|    15 | ▁עשר            | ▁20          | ✗     |
|    16 | :               | 16           | ✗     |
|    17 | :               | -20          | ✗     |
|    18 | ▁אחרון          | 14           | ✗     |
|    19 | :               | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ת               |              | ✗     |

2024-12-31 19:52:44,858 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:52:44,863 - TrainingLogger - INFO - Gradient norm: 12.4195
2024-12-31 19:52:52,277 - TrainingLogger - INFO - Step 21110, Batch metrics: Loss: 6.9773, Accuracy: 0.0678, Perplexity: 1072.0314
2024-12-31 19:52:58,768 - TrainingLogger - INFO - Step 21120, Batch metrics: Loss: 7.7807, Accuracy: 0.0594, Perplexity: 2393.9688
2024-12-31 19:53:06,039 - TrainingLogger - INFO - Step 21130, Batch metrics: Loss: 7.6564, Accuracy: 0.0428, Perplexity: 2114.1081
2024-12-31 19:53:12,962 - TrainingLogger - INFO - Step 21140, Batch metrics: Loss: 7.9466, Accuracy: 0.0351, Perplexity: 2825.9853
2024-12-31 19:53:20,009 - TrainingLogger - INFO - Step 21150, Batch metrics: Loss: 7.7969, Accuracy: 0.0611, Perplexity: 2433.0531
2024-12-31 19:53:27,034 - TrainingLogger - INFO - Step 21160, Batch metrics: Loss: 7.8805, Accuracy: 0.0377, Perplexity: 2645.1831
2024-12-31 19:53:34,358 - TrainingLogger - INFO - Step 21170, Batch metrics: Loss: 7.7219, Accuracy: 0.0547, Perplexity: 2257.1474
2024-12-31 19:53:41,537 - TrainingLogger - INFO - Step 21180, Batch metrics: Loss: 7.7628, Accuracy: 0.0628, Perplexity: 2351.5171
2024-12-31 19:53:49,014 - TrainingLogger - INFO - Step 21190, Batch metrics: Loss: 7.3776, Accuracy: 0.0486, Perplexity: 1599.7835
2024-12-31 19:53:56,666 - TrainingLogger - INFO - Step 21200, Batch metrics: Loss: 7.6950, Accuracy: 0.0796, Perplexity: 2197.3604
2024-12-31 19:53:56,666 - TrainingLogger - INFO - Step 21200, Prediction vs Actual:
2024-12-31 19:53:56,666 - TrainingLogger - INFO - Input 1: האישה והילדים תועדו בורחים מהמבנה לאחר חיסול המחבלים - והם התקבלו על ידי כוח צהל, שהעביר אותם לקבלת טיפול רפואי
2024-12-31 19:53:56,667 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:53:56,667 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלהם           | ▁האישה       | ✗     |
|     1 | ית              | ▁והילדים     | ✗     |
|     2 | </s>            | ▁ת           | ✗     |
|     3 | זה              | ועד          | ✗     |
|     4 | ו               | ו            | ✓     |
|     5 | ▁כאן            | ▁בורחים      | ✗     |
|     6 | .               | ▁מה          | ✗     |
|     7 | ארץ             | מבנה         | ✗     |
|     8 | ▁שלהם           | ▁לאחר        | ✗     |
|     9 | ▁זמן            | ▁חיסול       | ✗     |
|    10 | ים              | ▁המח         | ✗     |
|    11 | ה               | בלים         | ✗     |
|    12 | .               | ▁-           | ✗     |
|    13 | </s>            | ▁והם         | ✗     |
|    14 | ▁לא             | ▁התקבל       | ✗     |
|    15 | ו               | ו            | ✓     |
|    16 | ▁ל              | ▁על          | ✗     |
|    17 | ▁ידי            | ▁ידי         | ✓     |
|    18 | ▁המדינה         | ▁כוח         | ✗     |
|    19 | ם               | ▁צ           | ✗     |
|    20 | '               | הל           | ✗     |
|    21 | ורים            | ,            | ✗     |
|    22 | </s>            | ▁שה          | ✗     |
|    23 | י               | עביר         | ✗     |
|    24 | ו               | ▁אותם        | ✗     |
|    25 | ▁אליהם          | ▁לקבלת       | ✗     |
|    26 | ם               | ▁טיפול       | ✗     |
|    27 | .               | ▁רפואי       | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ם               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | י               | <pad>        | ✗     |
|    36 | י               | <pad>        | ✗     |
|    37 | ם               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ▁שלהם           | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 19:53:56,667 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:53:56,672 - TrainingLogger - INFO - Gradient norm: 12.6445
2024-12-31 19:54:03,246 - TrainingLogger - INFO - Step 21210, Batch metrics: Loss: 8.0229, Accuracy: 0.0256, Perplexity: 3050.1539
2024-12-31 19:54:10,267 - TrainingLogger - INFO - Step 21220, Batch metrics: Loss: 7.4427, Accuracy: 0.0745, Perplexity: 1707.3708
2024-12-31 19:54:16,560 - TrainingLogger - INFO - Step 21230, Batch metrics: Loss: 7.8494, Accuracy: 0.0643, Perplexity: 2564.2872
2024-12-31 19:54:23,074 - TrainingLogger - INFO - Step 21240, Batch metrics: Loss: 7.4473, Accuracy: 0.0625, Perplexity: 1715.1905
2024-12-31 19:54:30,169 - TrainingLogger - INFO - Step 21250, Batch metrics: Loss: 7.1386, Accuracy: 0.0992, Perplexity: 1259.6328
2024-12-31 19:54:37,544 - TrainingLogger - INFO - Step 21260, Batch metrics: Loss: 7.1405, Accuracy: 0.0984, Perplexity: 1262.0985
2024-12-31 19:54:44,910 - TrainingLogger - INFO - Step 21270, Batch metrics: Loss: 7.7831, Accuracy: 0.0688, Perplexity: 2399.7210
2024-12-31 19:54:51,803 - TrainingLogger - INFO - Step 21280, Batch metrics: Loss: 7.4768, Accuracy: 0.0749, Perplexity: 1766.5567
2024-12-31 19:54:53,364 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 38, 56), but is torch.Size([8, 1, 38, 49])
2024-12-31 19:54:53,364 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 38, 56), but is torch.Size([8, 1, 38, 49])

2024-12-31 19:54:53,364 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 49]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 49]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 38]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 38]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 74]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 74]), device: cuda:0
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 19:54:53,366 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 19:54:59,319 - TrainingLogger - INFO - Step 21290, Batch metrics: Loss: 7.9962, Accuracy: 0.0446, Perplexity: 2969.7356
2024-12-31 19:55:06,540 - TrainingLogger - INFO - Step 21300, Batch metrics: Loss: 7.3324, Accuracy: 0.0833, Perplexity: 1528.9783
2024-12-31 19:55:06,540 - TrainingLogger - INFO - Step 21300, Prediction vs Actual:
2024-12-31 19:55:06,540 - TrainingLogger - INFO - Input 1: תמיד הייתי אומרת לחברות שלי תראי, אני אהיה פעם דוגמנית מפורסמת, אני אהיה מישהו
2024-12-31 19:55:06,541 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:55:06,541 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁תמיד        | ✗     |
|     1 | ▁חופשי          | ▁הייתי       | ✗     |
|     2 | ▁עם             | ▁אומרת       | ✗     |
|     3 | ▁לעצמי          | ▁לחברות      | ✗     |
|     4 | ▁שלי            | ▁שלי         | ✓     |
|     5 | ▁שאני           | ▁תראי        | ✗     |
|     6 | ▁לי             | ,            | ✗     |
|     7 | </s>            | ▁אני         | ✗     |
|     8 | ▁לא             | ▁אהיה        | ✗     |
|     9 | ▁בסדר           | ▁פעם         | ✗     |
|    10 | ▁ראשונה         | ▁דוגמנית     | ✗     |
|    11 | ,               | ▁מפורסמת     | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | </s>            | ▁אני         | ✗     |
|    14 | ▁לא             | ▁אהיה        | ✗     |
|    15 | ▁שם             | ▁מישהו       | ✗     |
|    16 | ▁אחר            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | .               | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | .               | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ▁איתה           | <pad>        | ✗     |
|    42 | <pad>           |              | ✗     |

2024-12-31 19:55:06,541 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:55:06,546 - TrainingLogger - INFO - Gradient norm: 11.6463
2024-12-31 19:55:13,616 - TrainingLogger - INFO - Step 21310, Batch metrics: Loss: 7.7441, Accuracy: 0.0493, Perplexity: 2307.9993
2024-12-31 19:55:21,407 - TrainingLogger - INFO - Step 21320, Batch metrics: Loss: 7.6081, Accuracy: 0.0841, Perplexity: 2014.3556
2024-12-31 19:55:28,627 - TrainingLogger - INFO - Step 21330, Batch metrics: Loss: 7.4637, Accuracy: 0.0915, Perplexity: 1743.6220
2024-12-31 19:55:35,289 - TrainingLogger - INFO - Step 21340, Batch metrics: Loss: 8.0356, Accuracy: 0.0629, Perplexity: 3088.9142
2024-12-31 19:55:42,788 - TrainingLogger - INFO - Step 21350, Batch metrics: Loss: 8.0531, Accuracy: 0.0530, Perplexity: 3143.4907
2024-12-31 19:55:50,527 - TrainingLogger - INFO - Step 21360, Batch metrics: Loss: 7.0799, Accuracy: 0.0833, Perplexity: 1187.8257
2024-12-31 19:55:57,468 - TrainingLogger - INFO - Step 21370, Batch metrics: Loss: 8.0279, Accuracy: 0.0375, Perplexity: 3065.3408
2024-12-31 19:56:04,891 - TrainingLogger - INFO - Step 21380, Batch metrics: Loss: 7.3272, Accuracy: 0.0674, Perplexity: 1521.1557
2024-12-31 19:56:12,389 - TrainingLogger - INFO - Step 21390, Batch metrics: Loss: 7.5360, Accuracy: 0.0544, Perplexity: 1874.2449
2024-12-31 19:56:19,313 - TrainingLogger - INFO - Step 21400, Batch metrics: Loss: 7.3532, Accuracy: 0.0379, Perplexity: 1561.2394
2024-12-31 19:56:19,314 - TrainingLogger - INFO - Step 21400, Prediction vs Actual:
2024-12-31 19:56:19,314 - TrainingLogger - INFO - Input 1: יש אנשים שמוטרדים מזה שהם בסדר
2024-12-31 19:56:19,314 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:56:19,314 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁יש          | ✗     |
|     1 | יה              | ▁אנשים       | ✗     |
|     2 | ▁כאלה           | ▁שמו         | ✗     |
|     3 | חים             | טר           | ✗     |
|     4 | פים             | דים          | ✗     |
|     5 | </s>            | ▁מזה         | ✗     |
|     6 | ים              | ▁שהם         | ✗     |
|     7 | ▁לא             | ▁בסדר        | ✗     |
|     8 | ת               | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ▁הם             | <pad>        | ✗     |
|    18 | ▁אותם           | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ▁אותם           | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | .               |              | ✗     |

2024-12-31 19:56:19,315 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:56:19,320 - TrainingLogger - INFO - Gradient norm: 14.0212
2024-12-31 19:56:27,068 - TrainingLogger - INFO - Step 21410, Batch metrics: Loss: 7.5418, Accuracy: 0.0725, Perplexity: 1885.1404
2024-12-31 19:56:33,738 - TrainingLogger - INFO - Step 21420, Batch metrics: Loss: 7.8561, Accuracy: 0.0738, Perplexity: 2581.4826
2024-12-31 19:56:40,835 - TrainingLogger - INFO - Step 21430, Batch metrics: Loss: 7.6441, Accuracy: 0.0543, Perplexity: 2088.1841
2024-12-31 19:56:47,958 - TrainingLogger - INFO - Step 21440, Batch metrics: Loss: 7.1573, Accuracy: 0.1044, Perplexity: 1283.3871
2024-12-31 19:56:54,550 - TrainingLogger - INFO - Step 21450, Batch metrics: Loss: 7.4883, Accuracy: 0.0672, Perplexity: 1787.0113
2024-12-31 19:57:01,745 - TrainingLogger - INFO - Step 21460, Batch metrics: Loss: 7.3242, Accuracy: 0.0829, Perplexity: 1516.5698
2024-12-31 19:57:08,282 - TrainingLogger - INFO - Step 21470, Batch metrics: Loss: 7.5311, Accuracy: 0.0780, Perplexity: 1865.1201
2024-12-31 19:57:15,686 - TrainingLogger - INFO - Step 21480, Batch metrics: Loss: 7.1353, Accuracy: 0.0526, Perplexity: 1255.5407
2024-12-31 19:57:22,493 - TrainingLogger - INFO - Step 21490, Batch metrics: Loss: 7.4002, Accuracy: 0.0915, Perplexity: 1636.3458
2024-12-31 19:57:30,104 - TrainingLogger - INFO - Step 21500, Batch metrics: Loss: 7.5585, Accuracy: 0.0701, Perplexity: 1916.8825
2024-12-31 19:57:30,104 - TrainingLogger - INFO - Step 21500, Prediction vs Actual:
2024-12-31 19:57:30,104 - TrainingLogger - INFO - Input 1: יכול להיות שתמורת רוטציה על ראשות הממשלה תספק פיתרון?קודם כל אני חוזר ואומר - לא יהיו בחירות רביעיות
2024-12-31 19:57:30,105 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:57:30,105 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁יכול        | ✗     |
|     1 | ▁הוא            | ▁להיות       | ✗     |
|     2 | ▁גם             | ▁שת          | ✗     |
|     3 | ק               | מור          | ✗     |
|     4 | </s>            | ת            | ✗     |
|     5 | ▁חוק            | ▁רוט         | ✗     |
|     6 | נות             | ציה          | ✗     |
|     7 | .               | ▁על          | ✗     |
|     8 | ▁המדינה         | ▁ראש         | ✗     |
|     9 | ▁העיר           | ות           | ✗     |
|    10 | ▁העולם          | ▁הממשלה      | ✗     |
|    11 | .               | ▁תספק        | ✗     |
|    12 | ▁את             | ▁פיתרון      | ✗     |
|    13 | ▁טוב            | ?            | ✗     |
|    14 | ר               | קודם         | ✗     |
|    15 | ,               | ▁כל          | ✗     |
|    16 | ,               | ▁אני         | ✗     |
|    17 | ▁א              | ▁חוזר        | ✗     |
|    18 | ▁על             | ▁ואומר       | ✗     |
|    19 | ,               | ▁-           | ✗     |
|    20 | <pad>           | ▁לא          | ✗     |
|    21 | י               | ▁יהיו        | ✗     |
|    22 | ▁עוד            | ▁בחירות      | ✗     |
|    23 | ,               | ▁רביעי       | ✗     |
|    24 | יה              | ות           | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               |              | ✗     |

2024-12-31 19:57:30,105 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:57:30,110 - TrainingLogger - INFO - Gradient norm: 15.2227
2024-12-31 19:57:37,477 - TrainingLogger - INFO - Step 21510, Batch metrics: Loss: 7.4087, Accuracy: 0.0825, Perplexity: 1650.2237
2024-12-31 19:57:44,730 - TrainingLogger - INFO - Step 21520, Batch metrics: Loss: 7.2536, Accuracy: 0.1000, Perplexity: 1413.2069
2024-12-31 19:57:51,131 - TrainingLogger - INFO - Step 21530, Batch metrics: Loss: 7.1807, Accuracy: 0.0667, Perplexity: 1313.7729
2024-12-31 19:57:58,155 - TrainingLogger - INFO - Step 21540, Batch metrics: Loss: 7.9649, Accuracy: 0.0578, Perplexity: 2878.1661
2024-12-31 19:58:05,121 - TrainingLogger - INFO - Step 21550, Batch metrics: Loss: 7.1463, Accuracy: 0.0769, Perplexity: 1269.4100
2024-12-31 19:58:12,183 - TrainingLogger - INFO - Step 21560, Batch metrics: Loss: 7.7790, Accuracy: 0.0462, Perplexity: 2389.8901
2024-12-31 19:58:19,295 - TrainingLogger - INFO - Step 21570, Batch metrics: Loss: 7.5598, Accuracy: 0.0688, Perplexity: 1919.5378
2024-12-31 19:58:27,098 - TrainingLogger - INFO - Step 21580, Batch metrics: Loss: 7.1769, Accuracy: 0.0817, Perplexity: 1308.9050
2024-12-31 19:58:34,330 - TrainingLogger - INFO - Step 21590, Batch metrics: Loss: 7.0785, Accuracy: 0.0789, Perplexity: 1186.1995
2024-12-31 19:58:41,497 - TrainingLogger - INFO - Step 21600, Batch metrics: Loss: 7.6661, Accuracy: 0.0706, Perplexity: 2134.7774
2024-12-31 19:58:41,498 - TrainingLogger - INFO - Step 21600, Prediction vs Actual:
2024-12-31 19:58:41,498 - TrainingLogger - INFO - Input 1: הם הולכים לעשות את השינוי
2024-12-31 19:58:41,498 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:58:41,498 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הם          | ✗     |
|     1 | ▁לא             | ▁הולכים      | ✗     |
|     2 | ▁לכיוון         | ▁לעשות       | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | ▁זה             | ▁השינוי      | ✗     |
|     5 | ▁שלהם           | <pad>        | ✗     |
|     6 | .               | <pad>        | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | ▁אחד            | <pad>        | ✗     |
|     9 | ▁נפש            | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁זמן            | <pad>        | ✗     |
|    12 | ▁אחד            | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁עם             | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | <pad>           |              | ✗     |

2024-12-31 19:58:41,498 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:58:41,503 - TrainingLogger - INFO - Gradient norm: 12.6545
2024-12-31 19:58:48,662 - TrainingLogger - INFO - Step 21610, Batch metrics: Loss: 7.4059, Accuracy: 0.0861, Perplexity: 1645.6857
2024-12-31 19:58:56,094 - TrainingLogger - INFO - Step 21620, Batch metrics: Loss: 7.4623, Accuracy: 0.0741, Perplexity: 1741.1744
2024-12-31 19:59:03,352 - TrainingLogger - INFO - Step 21630, Batch metrics: Loss: 7.8978, Accuracy: 0.0404, Perplexity: 2691.2752
2024-12-31 19:59:10,814 - TrainingLogger - INFO - Step 21640, Batch metrics: Loss: 7.9309, Accuracy: 0.0870, Perplexity: 2781.8063
2024-12-31 19:59:17,880 - TrainingLogger - INFO - Step 21650, Batch metrics: Loss: 7.3641, Accuracy: 0.0938, Perplexity: 1578.3703
2024-12-31 19:59:24,980 - TrainingLogger - INFO - Step 21660, Batch metrics: Loss: 7.5524, Accuracy: 0.0931, Perplexity: 1905.3257
2024-12-31 19:59:32,001 - TrainingLogger - INFO - Step 21670, Batch metrics: Loss: 7.0392, Accuracy: 0.1163, Perplexity: 1140.4371
2024-12-31 19:59:39,463 - TrainingLogger - INFO - Step 21680, Batch metrics: Loss: 7.7537, Accuracy: 0.0876, Perplexity: 2330.2310
2024-12-31 19:59:46,898 - TrainingLogger - INFO - Step 21690, Batch metrics: Loss: 7.8566, Accuracy: 0.0608, Perplexity: 2582.6658
2024-12-31 19:59:54,425 - TrainingLogger - INFO - Step 21700, Batch metrics: Loss: 7.9264, Accuracy: 0.0680, Perplexity: 2769.3813
2024-12-31 19:59:54,425 - TrainingLogger - INFO - Step 21700, Prediction vs Actual:
2024-12-31 19:59:54,426 - TrainingLogger - INFO - Input 1: היו מספר מקרים באותה משפחה שבה אחד נולד בארץ ולכן נחשב ליהודי והשני נולד בחול ולכן הוא לא נחשב יהודי, היא אומרת
2024-12-31 19:59:54,426 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 19:59:54,426 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היו         | ✗     |
|     1 | ▁-              | ▁מספר        | ✗     |
|     2 | ▁-              | ▁מקרים       | ✗     |
|     3 | ▁-              | ▁באותה       | ✗     |
|     4 | ▁הדרך           | ▁משפחה       | ✗     |
|     5 | ▁-              | ▁שבה         | ✗     |
|     6 | ▁-              | ▁אחד         | ✗     |
|     7 | ▁מהם            | ▁נולד        | ✗     |
|     8 | .               | ▁בארץ        | ✗     |
|     9 | ▁הזאת           | ▁ולכן        | ✗     |
|    10 | ▁הוא            | ▁נחשב        | ✗     |
|    11 | ה               | ▁ל           | ✗     |
|    12 | פרלמנט          | יהודי        | ✗     |
|    13 | ה               | ▁והשני       | ✗     |
|    14 | ,               | ▁נולד        | ✗     |
|    15 | .               | ▁בחול        | ✗     |
|    16 | יה              | ▁ולכן        | ✗     |
|    17 | ▁הוא            | ▁הוא         | ✓     |
|    18 | ▁לא             | ▁לא          | ✓     |
|    19 | ▁היה            | ▁נחשב        | ✗     |
|    20 | ▁ל              | ▁יהודי       | ✗     |
|    21 | ה               | ,            | ✗     |
|    22 | <pad>           | ▁היא         | ✗     |
|    23 | ▁לא             | ▁אומרת       | ✗     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | ▁"              | <pad>        | ✗     |
|    28 | ▁מה             | <pad>        | ✗     |
|    29 | ▁מה             | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | .               |              | ✗     |

2024-12-31 19:59:54,426 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 19:59:54,431 - TrainingLogger - INFO - Gradient norm: 10.4885
2024-12-31 20:00:01,278 - TrainingLogger - INFO - Step 21710, Batch metrics: Loss: 7.1825, Accuracy: 0.0794, Perplexity: 1316.2459
2024-12-31 20:00:08,295 - TrainingLogger - INFO - Step 21720, Batch metrics: Loss: 7.1184, Accuracy: 0.0785, Perplexity: 1234.5127
2024-12-31 20:00:15,050 - TrainingLogger - INFO - Step 21730, Batch metrics: Loss: 7.5621, Accuracy: 0.0737, Perplexity: 1923.9033
2024-12-31 20:00:22,261 - TrainingLogger - INFO - Step 21740, Batch metrics: Loss: 7.5972, Accuracy: 0.0812, Perplexity: 1992.6134
2024-12-31 20:00:29,389 - TrainingLogger - INFO - Step 21750, Batch metrics: Loss: 7.5153, Accuracy: 0.0860, Perplexity: 1835.9519
2024-12-31 20:00:36,532 - TrainingLogger - INFO - Step 21760, Batch metrics: Loss: 7.7414, Accuracy: 0.0697, Perplexity: 2301.7787
2024-12-31 20:00:43,784 - TrainingLogger - INFO - Step 21770, Batch metrics: Loss: 7.1581, Accuracy: 0.1064, Perplexity: 1284.5032
2024-12-31 20:00:51,467 - TrainingLogger - INFO - Step 21780, Batch metrics: Loss: 8.0414, Accuracy: 0.0352, Perplexity: 3107.0486
2024-12-31 20:00:58,603 - TrainingLogger - INFO - Step 21790, Batch metrics: Loss: 7.5091, Accuracy: 0.0867, Perplexity: 1824.5637
2024-12-31 20:01:06,254 - TrainingLogger - INFO - Step 21800, Batch metrics: Loss: 7.5401, Accuracy: 0.0773, Perplexity: 1881.9421
2024-12-31 20:01:06,254 - TrainingLogger - INFO - Step 21800, Prediction vs Actual:
2024-12-31 20:01:06,254 - TrainingLogger - INFO - Input 1: מבדיקה שערך המכון הישראלי לדמוקרטיה עולה שהמשבר הקשה ביותר עמו התמודד המשק הישראלי ב-20 השנים האחרונות היה המשבר ב-2001
2024-12-31 20:01:06,255 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:01:06,255 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מ           | ✗     |
|     1 | ▁הו             | בדיקה        | ✗     |
|     2 | ▁זו             | ▁שערך        | ✗     |
|     3 | ▁-              | ▁המכון       | ✗     |
|     4 | ▁שלנו           | ▁הישראלי     | ✗     |
|     5 | ת               | ▁ל           | ✗     |
|     6 | בטיחות          | דמוקרט       | ✗     |
|     7 | יה              | יה           | ✓     |
|     8 | :               | ▁עולה        | ✗     |
|     9 | ▁לי             | ▁שה          | ✗     |
|    10 | משרד            | משבר         | ✗     |
|    11 | ▁הזה            | ▁הקשה        | ✗     |
|    12 | ▁ביותר          | ▁ביותר       | ✓     |
|    13 | </s>            | ▁עמו         | ✗     |
|    14 | תי              | ▁התמודד      | ✗     |
|    15 | ה               | ▁המשק        | ✗     |
|    16 | ים              | ▁הישראלי     | ✗     |
|    17 | ם               | ▁ב           | ✗     |
|    18 | -               | -20          | ✗     |
|    19 | ה               | ▁השנים       | ✗     |
|    20 | ▁האחרונות       | ▁האחרונות    | ✓     |
|    21 | .               | ▁היה         | ✗     |
|    22 | ▁קשה            | ▁המשבר       | ✗     |
|    23 | ▁האחרון         | ▁ב           | ✗     |
|    24 | "               | -200         | ✗     |
|    25 | 9               | 1            | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ▁של             | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁האחרון         | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ▁של             | <pad>        | ✗     |
|    36 | ▁האחרון         | <pad>        | ✗     |
|    37 | ▁של             | <pad>        | ✗     |
|    38 | ▁מלא            | <pad>        | ✗     |
|    39 | ▁האחרון         | <pad>        | ✗     |
|    40 | ▁הנוכחי         |              | ✗     |

2024-12-31 20:01:06,255 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:01:06,260 - TrainingLogger - INFO - Gradient norm: 17.0520
2024-12-31 20:01:12,863 - TrainingLogger - INFO - Step 21810, Batch metrics: Loss: 7.6678, Accuracy: 0.0522, Perplexity: 2138.3860
2024-12-31 20:01:20,038 - TrainingLogger - INFO - Step 21820, Batch metrics: Loss: 7.3983, Accuracy: 0.0855, Perplexity: 1633.2075
2024-12-31 20:01:27,515 - TrainingLogger - INFO - Step 21830, Batch metrics: Loss: 7.9199, Accuracy: 0.0549, Perplexity: 2751.6256
2024-12-31 20:01:34,298 - TrainingLogger - INFO - Step 21840, Batch metrics: Loss: 7.8234, Accuracy: 0.0596, Perplexity: 2498.3248
2024-12-31 20:01:41,746 - TrainingLogger - INFO - Step 21850, Batch metrics: Loss: 7.8203, Accuracy: 0.0591, Perplexity: 2490.6029
2024-12-31 20:01:48,678 - TrainingLogger - INFO - Step 21860, Batch metrics: Loss: 7.4392, Accuracy: 0.0482, Perplexity: 1701.3041
2024-12-31 20:01:56,246 - TrainingLogger - INFO - Step 21870, Batch metrics: Loss: 7.7141, Accuracy: 0.0730, Perplexity: 2239.6259
2024-12-31 20:02:03,474 - TrainingLogger - INFO - Step 21880, Batch metrics: Loss: 7.4298, Accuracy: 0.0452, Perplexity: 1685.4970
2024-12-31 20:02:10,187 - TrainingLogger - INFO - Step 21890, Batch metrics: Loss: 7.3483, Accuracy: 0.0698, Perplexity: 1553.5806
2024-12-31 20:02:17,662 - TrainingLogger - INFO - Step 21900, Batch metrics: Loss: 7.3673, Accuracy: 0.0732, Perplexity: 1583.3364
2024-12-31 20:02:17,663 - TrainingLogger - INFO - Step 21900, Prediction vs Actual:
2024-12-31 20:02:17,663 - TrainingLogger - INFO - Input 1: לצד זאת, כל אחד מבין שמערכת אכיפת החוק זקוקה לרפורמות והן תעשינה בשיקול דעת ובאחריות
2024-12-31 20:02:17,663 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:02:17,663 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁לצד         | ✗     |
|     1 | ▁-              | ▁זאת         | ✗     |
|     2 | .               | ,            | ✗     |
|     3 | ▁לה             | ▁כל          | ✗     |
|     4 | ▁הזמן           | ▁אחד         | ✗     |
|     5 | ▁מהם            | ▁מבין        | ✗     |
|     6 | ▁הדברים         | ▁ש           | ✗     |
|     7 | כם              | מערכת        | ✗     |
|     8 | ו               | ▁א           | ✗     |
|     9 | רג              | כי           | ✗     |
|    10 | פת              | פת           | ✓     |
|    11 | ▁החוק           | ▁החוק        | ✓     |
|    12 | .               | ▁זקוקה       | ✗     |
|    13 | ▁לו             | ▁ל           | ✗     |
|    14 | "               | רפו          | ✗     |
|    15 | א               | רמות         | ✗     |
|    16 | ▁שונות          | ▁והן         | ✗     |
|    17 | ▁גם             | ▁תעשי        | ✗     |
|    18 | ות              | נה           | ✗     |
|    19 | ▁טובה           | ▁ב           | ✗     |
|    20 | ינ              | שיקול        | ✗     |
|    21 | ▁דעת            | ▁דעת         | ✓     |
|    22 | .               | ▁וב          | ✗     |
|    23 | ריכוז           | אחריות       | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 20:02:17,663 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:02:17,668 - TrainingLogger - INFO - Gradient norm: 12.6680
2024-12-31 20:02:24,744 - TrainingLogger - INFO - Step 21910, Batch metrics: Loss: 7.6143, Accuracy: 0.0727, Perplexity: 2026.9933
2024-12-31 20:02:31,342 - TrainingLogger - INFO - Step 21920, Batch metrics: Loss: 7.7199, Accuracy: 0.0547, Perplexity: 2252.7668
2024-12-31 20:02:38,134 - TrainingLogger - INFO - Step 21930, Batch metrics: Loss: 7.6731, Accuracy: 0.0884, Perplexity: 2149.7261
2024-12-31 20:02:45,594 - TrainingLogger - INFO - Step 21940, Batch metrics: Loss: 7.6995, Accuracy: 0.0530, Perplexity: 2207.3401
2024-12-31 20:02:52,768 - TrainingLogger - INFO - Step 21950, Batch metrics: Loss: 7.8956, Accuracy: 0.0764, Perplexity: 2685.3990
2024-12-31 20:02:59,889 - TrainingLogger - INFO - Step 21960, Batch metrics: Loss: 7.2598, Accuracy: 0.0996, Perplexity: 1422.0256
2024-12-31 20:03:07,582 - TrainingLogger - INFO - Step 21970, Batch metrics: Loss: 7.7122, Accuracy: 0.0314, Perplexity: 2235.5469
2024-12-31 20:03:14,745 - TrainingLogger - INFO - Step 21980, Batch metrics: Loss: 6.9398, Accuracy: 0.0659, Perplexity: 1032.5521
2024-12-31 20:03:22,277 - TrainingLogger - INFO - Step 21990, Batch metrics: Loss: 7.3192, Accuracy: 0.0641, Perplexity: 1508.9733
2024-12-31 20:03:29,721 - TrainingLogger - INFO - Step 22000, Batch metrics: Loss: 7.9362, Accuracy: 0.0559, Perplexity: 2796.5852
2024-12-31 20:03:29,721 - TrainingLogger - INFO - Step 22000, Prediction vs Actual:
2024-12-31 20:03:29,721 - TrainingLogger - INFO - Input 1: אנחנו עדיין ממשיכות, דואגות להיות במיקום אסטרטגי
2024-12-31 20:03:29,722 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:03:29,722 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | ▁אנחנו          | ▁עדיין       | ✗     |
|     2 | ▁אנחנו          | ▁ממשיכות     | ✗     |
|     3 | </s>            | ,            | ✗     |
|     4 | ▁אנחנו          | ▁דואג        | ✗     |
|     5 | ▁לנו            | ות           | ✗     |
|     6 | ▁לנו            | ▁להיות       | ✗     |
|     7 | ▁ביחד           | ▁במיקום      | ✗     |
|     8 | ▁הזה            | ▁אסטרטגי     | ✗     |
|     9 | ת               | <pad>        | ✗     |
|    10 | ▁שלנו           | <pad>        | ✗     |
|    11 | ▁אנחנו          | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁שלנו           | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁אנחנו          | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 20:03:29,722 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:03:29,727 - TrainingLogger - INFO - Gradient norm: 11.4219
2024-12-31 20:03:36,865 - TrainingLogger - INFO - Step 22010, Batch metrics: Loss: 7.3973, Accuracy: 0.0984, Perplexity: 1631.5791
2024-12-31 20:03:43,726 - TrainingLogger - INFO - Step 22020, Batch metrics: Loss: 7.6493, Accuracy: 0.0815, Perplexity: 2099.1148
2024-12-31 20:03:50,476 - TrainingLogger - INFO - Step 22030, Batch metrics: Loss: 7.3826, Accuracy: 0.0843, Perplexity: 1607.8379
2024-12-31 20:03:57,214 - TrainingLogger - INFO - Step 22040, Batch metrics: Loss: 7.1766, Accuracy: 0.0884, Perplexity: 1308.4070
2024-12-31 20:04:05,903 - TrainingLogger - INFO - Step 22050, Batch metrics: Loss: 8.1001, Accuracy: 0.0516, Perplexity: 3294.8872
2024-12-31 20:04:13,096 - TrainingLogger - INFO - Step 22060, Batch metrics: Loss: 7.4242, Accuracy: 0.0409, Perplexity: 1675.9983
2024-12-31 20:04:20,959 - TrainingLogger - INFO - Step 22070, Batch metrics: Loss: 7.4887, Accuracy: 0.0971, Perplexity: 1787.7247
2024-12-31 20:04:28,127 - TrainingLogger - INFO - Step 22080, Batch metrics: Loss: 7.5424, Accuracy: 0.0778, Perplexity: 1886.2887
2024-12-31 20:04:35,258 - TrainingLogger - INFO - Step 22090, Batch metrics: Loss: 6.9524, Accuracy: 0.1105, Perplexity: 1045.6929
2024-12-31 20:04:42,391 - TrainingLogger - INFO - Step 22100, Batch metrics: Loss: 7.2923, Accuracy: 0.0787, Perplexity: 1468.9941
2024-12-31 20:04:42,391 - TrainingLogger - INFO - Step 22100, Prediction vs Actual:
2024-12-31 20:04:42,391 - TrainingLogger - INFO - Input 1: המסיבה הזו, שהותקפה על ידי מעל ל-300 מחבלים, הביאה את המחבלים להתעכב במשך שעות ולעשות מעשים נוראיים כנגד משתתפי המסיבה
2024-12-31 20:04:42,392 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:04:42,392 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁המסיבה      | ✗     |
|     1 | ,               | ▁הזו         | ✗     |
|     2 | ?               | ,            | ✗     |
|     3 | ▁היא            | ▁שהו         | ✗     |
|     4 | חל              | תקפה         | ✗     |
|     5 | ▁קשות           | ▁על          | ✗     |
|     6 | ▁ידי            | ▁ידי         | ✓     |
|     7 | ▁בני            | ▁מעל         | ✗     |
|     8 | ▁ל              | ▁ל           | ✓     |
|     9 | ים              | -300         | ✗     |
|    10 | ,               | ▁מחבל        | ✗     |
|    11 | ים              | ים           | ✓     |
|    12 | ,               | ,            | ✓     |
|    13 | ▁לא             | ▁הביאה       | ✗     |
|    14 | ▁ל              | ▁את          | ✗     |
|    15 | ▁ה              | ▁המח         | ✗     |
|    16 | י               | בלים         | ✗     |
|    17 | ▁שלהם           | ▁לה          | ✗     |
|    18 | מונים           | תעכב         | ✗     |
|    19 | ים              | ▁במשך        | ✗     |
|    20 | ▁שנים           | ▁שעות        | ✗     |
|    21 | ▁רבות           | ▁ולעשות      | ✗     |
|    22 | ה               | ▁מעשים       | ✗     |
|    23 | ▁קשים           | ▁נוראיים     | ✗     |
|    24 | .               | ▁כנגד        | ✗     |
|    25 | ם               | ▁משת         | ✗     |
|    26 | קים             | ת            | ✗     |
|    27 | פים             | פי           | ✗     |
|    28 | ו               | ▁המסיבה      | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ות              | <pad>        | ✗     |
|    32 | ית              | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ים              | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ה               | <pad>        | ✗     |
|    41 | ▁את             | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | ▁את             |              | ✗     |

2024-12-31 20:04:42,392 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:04:42,397 - TrainingLogger - INFO - Gradient norm: 11.6521
2024-12-31 20:04:49,372 - TrainingLogger - INFO - Step 22110, Batch metrics: Loss: 7.3438, Accuracy: 0.0872, Perplexity: 1546.5604
2024-12-31 20:04:56,724 - TrainingLogger - INFO - Step 22120, Batch metrics: Loss: 7.6610, Accuracy: 0.0541, Perplexity: 2123.9152
2024-12-31 20:05:03,886 - TrainingLogger - INFO - Step 22130, Batch metrics: Loss: 7.4776, Accuracy: 0.0482, Perplexity: 1767.9514
2024-12-31 20:05:11,019 - TrainingLogger - INFO - Step 22140, Batch metrics: Loss: 7.2360, Accuracy: 0.0647, Perplexity: 1388.4845
2024-12-31 20:05:18,193 - TrainingLogger - INFO - Step 22150, Batch metrics: Loss: 7.6238, Accuracy: 0.0435, Perplexity: 2046.3718
2024-12-31 20:05:25,084 - TrainingLogger - INFO - Step 22160, Batch metrics: Loss: 7.3468, Accuracy: 0.0468, Perplexity: 1551.1845
2024-12-31 20:05:32,141 - TrainingLogger - INFO - Step 22170, Batch metrics: Loss: 7.5119, Accuracy: 0.0647, Perplexity: 1829.6351
2024-12-31 20:05:39,460 - TrainingLogger - INFO - Step 22180, Batch metrics: Loss: 7.1980, Accuracy: 0.0914, Perplexity: 1336.7481
2024-12-31 20:05:46,271 - TrainingLogger - INFO - Step 22190, Batch metrics: Loss: 7.5952, Accuracy: 0.0667, Perplexity: 1988.6438
2024-12-31 20:05:53,156 - TrainingLogger - INFO - Step 22200, Batch metrics: Loss: 7.6209, Accuracy: 0.0833, Perplexity: 2040.4846
2024-12-31 20:05:53,156 - TrainingLogger - INFO - Step 22200, Prediction vs Actual:
2024-12-31 20:05:53,189 - TrainingLogger - INFO - Input 1: הוא התנגד לתחולה הכמו רטרואקטיבית שתאפשר לעובדים שהתקבלו בתנאי שיעבדו בשבת, לחזור בהם מה שיפגע במעסיקים או בתפקוד מפעלים ועסקים שחייבים לעבוד 7 ימים בשבוע
2024-12-31 20:05:53,190 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:05:53,190 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁הוא         | ✗     |
|     1 | ▁לא             | ▁התנגד       | ✗     |
|     2 | </s>            | ▁לת          | ✗     |
|     3 | יקים            | חולה         | ✗     |
|     4 | ▁שלו            | ▁ה           | ✗     |
|     5 | פס              | כמו          | ✗     |
|     6 | ▁שלו            | ▁ר           | ✗     |
|     7 | ▁הזה            | טרו          | ✗     |
|     8 | א               | אקטיבי       | ✗     |
|     9 | ם               | ת            | ✗     |
|    10 | ▁שלו            | ▁שת          | ✗     |
|    11 | ורה             | אפשר         | ✗     |
|    12 | ▁לו             | ▁ל           | ✗     |
|    13 | "               | עובדים       | ✗     |
|    14 | </s>            | ▁שהתקבל      | ✗     |
|    15 | ה               | ו            | ✗     |
|    16 | ▁אליו           | ▁בתנאי       | ✗     |
|    17 | ▁שהוא           | ▁שי          | ✗     |
|    18 | אן              | עבדו         | ✗     |
|    19 | ▁קשה            | ▁בשבת        | ✗     |
|    20 | ות              | ,            | ✗     |
|    21 | </s>            | ▁לחזור       | ✗     |
|    22 | ▁על             | ▁בהם         | ✗     |
|    23 | </s>            | ▁מה          | ✗     |
|    24 | פך              | ▁שיפגע       | ✗     |
|    25 | ▁בהם            | ▁ב           | ✗     |
|    26 | ם               | מעסיק        | ✗     |
|    27 | ים              | ים           | ✓     |
|    28 | ▁שלהם           | ▁או          | ✗     |
|    29 | ▁ב              | ▁בת          | ✗     |
|    30 | ת               | פקוד         | ✗     |
|    31 | ים              | ▁מפעל        | ✗     |
|    32 | ים              | ים           | ✓     |
|    33 | ▁אחרים          | ▁ו           | ✗     |
|    34 | עבודה           | עסקים        | ✗     |
|    35 | ▁אחרים          | ▁שחייב       | ✗     |
|    36 | ים              | ים           | ✓     |
|    37 | ▁אותם           | ▁לעבוד       | ✗     |
|    38 | ▁קשה            | ▁7           | ✗     |
|    39 | ▁שנים           | ▁ימים        | ✗     |
|    40 | ▁בלבד           | ▁בשבוע       | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | ב               |              | ✗     |

2024-12-31 20:05:53,190 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:05:53,196 - TrainingLogger - INFO - Gradient norm: 10.3972
2024-12-31 20:06:00,292 - TrainingLogger - INFO - Step 22210, Batch metrics: Loss: 7.9131, Accuracy: 0.0541, Perplexity: 2732.8472
2024-12-31 20:06:08,333 - TrainingLogger - INFO - Step 22220, Batch metrics: Loss: 7.6680, Accuracy: 0.0654, Perplexity: 2138.8092
2024-12-31 20:06:15,327 - TrainingLogger - INFO - Step 22230, Batch metrics: Loss: 7.2157, Accuracy: 0.0811, Perplexity: 1360.5812
2024-12-31 20:06:22,143 - TrainingLogger - INFO - Step 22240, Batch metrics: Loss: 7.0915, Accuracy: 0.0778, Perplexity: 1201.7019
2024-12-31 20:06:29,536 - TrainingLogger - INFO - Step 22250, Batch metrics: Loss: 7.6208, Accuracy: 0.0573, Perplexity: 2040.2394
2024-12-31 20:06:36,633 - TrainingLogger - INFO - Step 22260, Batch metrics: Loss: 7.9650, Accuracy: 0.0714, Perplexity: 2878.4118
2024-12-31 20:06:43,696 - TrainingLogger - INFO - Step 22270, Batch metrics: Loss: 7.3982, Accuracy: 0.0670, Perplexity: 1633.0868
2024-12-31 20:06:50,993 - TrainingLogger - INFO - Step 22280, Batch metrics: Loss: 7.6073, Accuracy: 0.0632, Perplexity: 2012.8501
2024-12-31 20:06:57,507 - TrainingLogger - INFO - Step 22290, Batch metrics: Loss: 7.3027, Accuracy: 0.0493, Perplexity: 1484.3036
2024-12-31 20:07:05,232 - TrainingLogger - INFO - Step 22300, Batch metrics: Loss: 7.5461, Accuracy: 0.0442, Perplexity: 1893.3021
2024-12-31 20:07:05,232 - TrainingLogger - INFO - Step 22300, Prediction vs Actual:
2024-12-31 20:07:05,232 - TrainingLogger - INFO - Input 1: זה לא מנקה את האופוזיציה מההתנהגות שלה, אבל אני בהחלט מנסה לעשות כל מאמץ להנמיך את הלהבות
2024-12-31 20:07:05,233 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:07:05,233 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁העולמי         | ▁זה          | ✗     |
|     1 | ▁לא             | ▁לא          | ✓     |
|     2 | ▁טוב            | ▁מנקה        | ✗     |
|     3 | </s>            | ▁את          | ✗     |
|     4 | ▁המוח           | ▁האו         | ✗     |
|     5 | סון             | פוז          | ✗     |
|     6 | ציה             | י            | ✗     |
|     7 | </s>            | ציה          | ✗     |
|     8 | ,               | ▁מה          | ✗     |
|     9 | ות              | התנהגות      | ✗     |
|    10 | ▁שלי            | ▁שלה         | ✗     |
|    11 | </s>            | ,            | ✗     |
|    12 | </s>            | ▁אבל         | ✗     |
|    13 | ▁לא             | ▁אני         | ✗     |
|    14 | ▁לא             | ▁בהחלט       | ✗     |
|    15 | ▁לא             | ▁מנסה        | ✗     |
|    16 | ▁למצוא          | ▁לעשות       | ✗     |
|    17 | ▁את             | ▁כל          | ✗     |
|    18 | ▁כך             | ▁מאמץ        | ✗     |
|    19 | </s>            | ▁להנמיך      | ✗     |
|    20 | ▁את             | ▁את          | ✓     |
|    21 | ▁זה             | ▁הלהב        | ✗     |
|    22 | ה               | ות           | ✗     |
|    23 | ▁האלה           | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | ות              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁האלה           | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁האלה           | <pad>        | ✗     |
|    34 | ▁האלה           | <pad>        | ✗     |
|    35 | ▁האלה           | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ות              | <pad>        | ✗     |
|    40 | ▁האלה           | <pad>        | ✗     |
|    41 | ות              | <pad>        | ✗     |
|    42 | ▁האלה           | <pad>        | ✗     |
|    43 | ות              | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | י               |              | ✗     |

2024-12-31 20:07:05,233 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:07:05,238 - TrainingLogger - INFO - Gradient norm: 12.5739
2024-12-31 20:07:11,845 - TrainingLogger - INFO - Step 22310, Batch metrics: Loss: 7.9315, Accuracy: 0.0640, Perplexity: 2783.6520
2024-12-31 20:07:19,264 - TrainingLogger - INFO - Step 22320, Batch metrics: Loss: 7.2425, Accuracy: 0.0941, Perplexity: 1397.5313
2024-12-31 20:07:25,973 - TrainingLogger - INFO - Step 22330, Batch metrics: Loss: 7.2107, Accuracy: 0.0784, Perplexity: 1353.8674
2024-12-31 20:07:33,190 - TrainingLogger - INFO - Step 22340, Batch metrics: Loss: 7.9830, Accuracy: 0.0707, Perplexity: 2930.6801
2024-12-31 20:07:40,588 - TrainingLogger - INFO - Step 22350, Batch metrics: Loss: 7.3634, Accuracy: 0.0904, Perplexity: 1577.1696
2024-12-31 20:07:48,267 - TrainingLogger - INFO - Step 22360, Batch metrics: Loss: 7.7053, Accuracy: 0.0752, Perplexity: 2220.1857
2024-12-31 20:07:55,308 - TrainingLogger - INFO - Step 22370, Batch metrics: Loss: 7.3923, Accuracy: 0.0714, Perplexity: 1623.4290
2024-12-31 20:08:02,183 - TrainingLogger - INFO - Step 22380, Batch metrics: Loss: 7.5641, Accuracy: 0.0748, Perplexity: 1927.6370
2024-12-31 20:08:09,054 - TrainingLogger - INFO - Step 22390, Batch metrics: Loss: 7.8278, Accuracy: 0.0529, Perplexity: 2509.4739
2024-12-31 20:08:15,451 - TrainingLogger - INFO - Step 22400, Batch metrics: Loss: 8.2896, Accuracy: 0.0657, Perplexity: 3982.3830
2024-12-31 20:08:15,451 - TrainingLogger - INFO - Step 22400, Prediction vs Actual:
2024-12-31 20:08:15,451 - TrainingLogger - INFO - Input 1: אלמנתו של הרב שנרצח סיפרה חבל שהגענו ליום הזה
2024-12-31 20:08:15,452 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:08:15,452 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ב               | ▁אל          | ✗     |
|     1 | בה              | מנת          | ✗     |
|     2 | ה               | ו            | ✗     |
|     3 | ▁של             | ▁של          | ✓     |
|     4 | ר               | ▁הרב         | ✗     |
|     5 | ר               | ▁שנרצח       | ✗     |
|     6 | ה               | ▁סיפרה       | ✗     |
|     7 | ▁לי             | ▁חבל         | ✗     |
|     8 | ▁על             | ▁שהגענו      | ✗     |
|     9 | ▁אליו           | ▁ליום        | ✗     |
|    10 | ▁הזה            | ▁הזה         | ✓     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               |              | ✗     |

2024-12-31 20:08:15,452 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:08:15,457 - TrainingLogger - INFO - Gradient norm: 10.3954
2024-12-31 20:08:22,913 - TrainingLogger - INFO - Step 22410, Batch metrics: Loss: 7.4851, Accuracy: 0.0548, Perplexity: 1781.3826
2024-12-31 20:08:30,309 - TrainingLogger - INFO - Step 22420, Batch metrics: Loss: 7.5325, Accuracy: 0.0576, Perplexity: 1867.6788
2024-12-31 20:08:37,239 - TrainingLogger - INFO - Step 22430, Batch metrics: Loss: 7.5818, Accuracy: 0.0936, Perplexity: 1962.1268
2024-12-31 20:08:44,271 - TrainingLogger - INFO - Step 22440, Batch metrics: Loss: 7.3120, Accuracy: 0.0455, Perplexity: 1498.2452
2024-12-31 20:08:52,784 - TrainingLogger - INFO - Step 22450, Batch metrics: Loss: 7.8443, Accuracy: 0.0667, Perplexity: 2551.0595
2024-12-31 20:08:59,918 - TrainingLogger - INFO - Step 22460, Batch metrics: Loss: 7.5093, Accuracy: 0.0676, Perplexity: 1824.9970
2024-12-31 20:09:06,683 - TrainingLogger - INFO - Step 22470, Batch metrics: Loss: 7.4116, Accuracy: 0.0597, Perplexity: 1655.0149
2024-12-31 20:09:14,271 - TrainingLogger - INFO - Step 22480, Batch metrics: Loss: 7.7379, Accuracy: 0.0659, Perplexity: 2293.6294
2024-12-31 20:09:21,366 - TrainingLogger - INFO - Step 22490, Batch metrics: Loss: 7.5712, Accuracy: 0.0213, Perplexity: 1941.5629
2024-12-31 20:09:28,596 - TrainingLogger - INFO - Step 22500, Batch metrics: Loss: 7.5777, Accuracy: 0.0522, Perplexity: 1954.2022
2024-12-31 20:09:28,596 - TrainingLogger - INFO - Step 22500, Prediction vs Actual:
2024-12-31 20:09:28,596 - TrainingLogger - INFO - Input 1: אם מפשלים, נופלים על הפנים ומחליקים על הקרקע
2024-12-31 20:09:28,596 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:09:28,596 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁חשוב           | ▁אם          | ✗     |
|     1 | ▁-              | ▁מפשל        | ✗     |
|     2 | .               | ים           | ✗     |
|     3 | .               | ,            | ✗     |
|     4 | ▁זה             | ▁נופלים      | ✗     |
|     5 | ▁עליהם          | ▁על          | ✗     |
|     6 | ▁זה             | ▁הפנים       | ✗     |
|     7 | .               | ▁ומח         | ✗     |
|     8 | ירים            | ליק          | ✗     |
|     9 | ים              | ים           | ✓     |
|    10 | .               | ▁על          | ✗     |
|    11 | ▁זה             | ▁הקרקע       | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | .               | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | .               | <pad>        | ✗     |
|    27 | יות             | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁שלהן           |              | ✗     |

2024-12-31 20:09:28,596 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:09:28,601 - TrainingLogger - INFO - Gradient norm: 14.2331
2024-12-31 20:09:35,758 - TrainingLogger - INFO - Step 22510, Batch metrics: Loss: 7.4809, Accuracy: 0.0523, Perplexity: 1773.8319
2024-12-31 20:09:43,131 - TrainingLogger - INFO - Step 22520, Batch metrics: Loss: 7.1397, Accuracy: 0.0779, Perplexity: 1261.0271
2024-12-31 20:09:50,516 - TrainingLogger - INFO - Step 22530, Batch metrics: Loss: 7.8092, Accuracy: 0.0485, Perplexity: 2463.0600
2024-12-31 20:09:58,198 - TrainingLogger - INFO - Step 22540, Batch metrics: Loss: 7.8263, Accuracy: 0.0806, Perplexity: 2505.7086
2024-12-31 20:10:05,259 - TrainingLogger - INFO - Step 22550, Batch metrics: Loss: 7.2400, Accuracy: 0.0634, Perplexity: 1394.0657
2024-12-31 20:10:12,003 - TrainingLogger - INFO - Step 22560, Batch metrics: Loss: 7.6065, Accuracy: 0.0615, Perplexity: 2011.1836
2024-12-31 20:10:19,073 - TrainingLogger - INFO - Step 22570, Batch metrics: Loss: 7.6282, Accuracy: 0.0927, Perplexity: 2055.3697
2024-12-31 20:10:25,638 - TrainingLogger - INFO - Step 22580, Batch metrics: Loss: 7.8031, Accuracy: 0.0616, Perplexity: 2448.2931
2024-12-31 20:10:32,443 - TrainingLogger - INFO - Step 22590, Batch metrics: Loss: 7.5482, Accuracy: 0.0900, Perplexity: 1897.3202
2024-12-31 20:10:40,043 - TrainingLogger - INFO - Step 22600, Batch metrics: Loss: 7.9756, Accuracy: 0.0870, Perplexity: 2909.1715
2024-12-31 20:10:40,044 - TrainingLogger - INFO - Step 22600, Prediction vs Actual:
2024-12-31 20:10:40,044 - TrainingLogger - INFO - Input 1: יכול לדבר על הארץ , על כל סוגי הנופים כל החברה הישראלית
2024-12-31 20:10:40,044 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:10:40,044 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלהם           | ▁יכול        | ✗     |
|     1 | ▁להיות          | ▁לדבר        | ✗     |
|     2 | .               | ▁על          | ✗     |
|     3 | ▁זה             | ▁הארץ        | ✗     |
|     4 | .               | ▁,           | ✗     |
|     5 | <pad>           | ▁על          | ✗     |
|     6 | ▁זה             | ▁כל          | ✗     |
|     7 | ים              | ▁סוגי        | ✗     |
|     8 | ה               | ▁הנ          | ✗     |
|     9 | ונות            | ופים         | ✗     |
|    10 | ▁.              | ▁כל          | ✗     |
|    11 | ים              | ▁החברה       | ✗     |
|    12 | ▁.              | ▁הישראלי     | ✗     |
|    13 | ת               | ת            | ✓     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | "               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 20:10:40,044 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:10:40,049 - TrainingLogger - INFO - Gradient norm: 10.3809
2024-12-31 20:10:47,245 - TrainingLogger - INFO - Step 22610, Batch metrics: Loss: 7.5720, Accuracy: 0.0842, Perplexity: 1943.0401
2024-12-31 20:10:54,665 - TrainingLogger - INFO - Step 22620, Batch metrics: Loss: 7.4039, Accuracy: 0.0728, Perplexity: 1642.3798
2024-12-31 20:11:01,410 - TrainingLogger - INFO - Step 22630, Batch metrics: Loss: 7.1086, Accuracy: 0.0649, Perplexity: 1222.3931
2024-12-31 20:11:08,397 - TrainingLogger - INFO - Step 22640, Batch metrics: Loss: 7.2125, Accuracy: 0.1267, Perplexity: 1356.2200
2024-12-31 20:11:15,697 - TrainingLogger - INFO - Step 22650, Batch metrics: Loss: 7.2156, Accuracy: 0.0765, Perplexity: 1360.4683
2024-12-31 20:11:22,741 - TrainingLogger - INFO - Step 22660, Batch metrics: Loss: 7.3027, Accuracy: 0.0595, Perplexity: 1484.3199
2024-12-31 20:11:29,795 - TrainingLogger - INFO - Step 22670, Batch metrics: Loss: 7.6766, Accuracy: 0.0462, Perplexity: 2157.2777
2024-12-31 20:11:36,687 - TrainingLogger - INFO - Step 22680, Batch metrics: Loss: 7.4287, Accuracy: 0.0357, Perplexity: 1683.5435
2024-12-31 20:11:43,564 - TrainingLogger - INFO - Step 22690, Batch metrics: Loss: 6.9154, Accuracy: 0.0859, Perplexity: 1007.6736
2024-12-31 20:11:50,365 - TrainingLogger - INFO - Step 22700, Batch metrics: Loss: 7.8570, Accuracy: 0.0462, Perplexity: 2583.6573
2024-12-31 20:11:50,366 - TrainingLogger - INFO - Step 22700, Prediction vs Actual:
2024-12-31 20:11:50,366 - TrainingLogger - INFO - Input 1: השכר הממוצע למשרה מלאה עמד על 132 אלף שקל אולם השכר הממוצע בפועל לעובד עמד על 104 אלף שקל
2024-12-31 20:11:50,366 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:11:50,366 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁השכר        | ✗     |
|     1 | י               | ▁הממוצע      | ✗     |
|     2 | י               | ▁למ          | ✗     |
|     3 | ירה             | שרה          | ✗     |
|     4 | ▁על             | ▁מלאה        | ✗     |
|     5 | </s>            | ▁עמד         | ✗     |
|     6 | ית              | ▁על          | ✗     |
|     7 | ▁כן             | ▁13          | ✗     |
|     8 | ה               | 2            | ✗     |
|     9 | ▁עד             | ▁אלף         | ✗     |
|    10 | ▁דולר           | ▁שקל         | ✗     |
|    11 | ים              | ▁אולם        | ✗     |
|    12 | ▁הוא            | ▁השכר        | ✗     |
|    13 | ת               | ▁הממוצע      | ✗     |
|    14 | ת               | ▁בפועל       | ✗     |
|    15 | ▁היה            | ▁ל           | ✗     |
|    16 | להקה            | עובד         | ✗     |
|    17 | י               | ▁עמד         | ✗     |
|    18 | ▁על             | ▁על          | ✓     |
|    19 | ▁עצמו           | ▁10          | ✗     |
|    20 | ▁שקל            | 4            | ✗     |
|    21 | ▁שקל            | ▁אלף         | ✗     |
|    22 | ▁דולר           | ▁שקל         | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ה               | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | ▁את             | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ה               | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ה               | <pad>        | ✗     |
|    40 | ה               | <pad>        | ✗     |
|    41 | ים              | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | ים              | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ים              | <pad>        | ✗     |
|    46 | ה               | <pad>        | ✗     |
|    47 | ▁את             |              | ✗     |

2024-12-31 20:11:50,366 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:11:50,371 - TrainingLogger - INFO - Gradient norm: 15.6160
2024-12-31 20:11:57,198 - TrainingLogger - INFO - Step 22710, Batch metrics: Loss: 7.2961, Accuracy: 0.0476, Perplexity: 1474.4728
2024-12-31 20:12:04,867 - TrainingLogger - INFO - Step 22720, Batch metrics: Loss: 7.5148, Accuracy: 0.0783, Perplexity: 1835.0207
2024-12-31 20:12:11,771 - TrainingLogger - INFO - Step 22730, Batch metrics: Loss: 7.9262, Accuracy: 0.0498, Perplexity: 2768.8174
2024-12-31 20:12:19,368 - TrainingLogger - INFO - Step 22740, Batch metrics: Loss: 7.7140, Accuracy: 0.0821, Perplexity: 2239.4540
2024-12-31 20:12:26,709 - TrainingLogger - INFO - Step 22750, Batch metrics: Loss: 7.5804, Accuracy: 0.0826, Perplexity: 1959.4752
2024-12-31 20:12:33,842 - TrainingLogger - INFO - Step 22760, Batch metrics: Loss: 7.3996, Accuracy: 0.1053, Perplexity: 1635.2608
2024-12-31 20:12:41,276 - TrainingLogger - INFO - Step 22770, Batch metrics: Loss: 7.6226, Accuracy: 0.0449, Perplexity: 2043.9221
2024-12-31 20:12:48,723 - TrainingLogger - INFO - Step 22780, Batch metrics: Loss: 6.8989, Accuracy: 0.0952, Perplexity: 991.1980
2024-12-31 20:12:56,350 - TrainingLogger - INFO - Step 22790, Batch metrics: Loss: 7.6736, Accuracy: 0.0979, Perplexity: 2150.7175
2024-12-31 20:13:03,274 - TrainingLogger - INFO - Step 22800, Batch metrics: Loss: 7.6094, Accuracy: 0.0643, Perplexity: 2016.9680
2024-12-31 20:13:03,275 - TrainingLogger - INFO - Step 22800, Prediction vs Actual:
2024-12-31 20:13:03,275 - TrainingLogger - INFO - Input 1: בדמיון הם עולים כל הזמן, אלה שהיו צריכים להיות פה ואינם
2024-12-31 20:13:03,275 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:13:03,275 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ב           | ✗     |
|     1 | ד               | דמיון        | ✗     |
|     2 | .               | ▁הם          | ✗     |
|     3 | ▁היו            | ▁עולים       | ✗     |
|     4 | ▁על             | ▁כל          | ✗     |
|     5 | ▁היום           | ▁הזמן        | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | <pad>           | ▁אלה         | ✗     |
|     8 | ▁אחרים          | ▁שהיו        | ✗     |
|     9 | ▁לי             | ▁צריכים      | ✗     |
|    10 | ▁את             | ▁להיות       | ✗     |
|    11 | ▁טובים          | ▁פה          | ✗     |
|    12 | .               | ▁ואינם       | ✗     |
|    13 | ▁יודעים         | <pad>        | ✗     |
|    14 | ד               | <pad>        | ✗     |
|    15 | ▁זכר            | <pad>        | ✗     |
|    16 | ▁אנשים          | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁אנשים          | <pad>        | ✗     |
|    28 | .               |              | ✗     |

2024-12-31 20:13:03,275 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:13:03,280 - TrainingLogger - INFO - Gradient norm: 10.0267
2024-12-31 20:13:10,185 - TrainingLogger - INFO - Step 22810, Batch metrics: Loss: 7.9018, Accuracy: 0.0729, Perplexity: 2702.0482
2024-12-31 20:13:17,151 - TrainingLogger - INFO - Step 22820, Batch metrics: Loss: 7.9577, Accuracy: 0.0518, Perplexity: 2857.4775
2024-12-31 20:13:24,423 - TrainingLogger - INFO - Step 22830, Batch metrics: Loss: 7.2024, Accuracy: 0.0863, Perplexity: 1342.6022
2024-12-31 20:13:31,885 - TrainingLogger - INFO - Step 22840, Batch metrics: Loss: 7.7988, Accuracy: 0.0684, Perplexity: 2437.7645
2024-12-31 20:13:38,920 - TrainingLogger - INFO - Step 22850, Batch metrics: Loss: 7.4414, Accuracy: 0.0654, Perplexity: 1705.1529
2024-12-31 20:13:46,376 - TrainingLogger - INFO - Step 22860, Batch metrics: Loss: 7.6739, Accuracy: 0.0458, Perplexity: 2151.5607
2024-12-31 20:13:53,301 - TrainingLogger - INFO - Step 22870, Batch metrics: Loss: 7.4993, Accuracy: 0.0886, Perplexity: 1806.7858
2024-12-31 20:14:00,096 - TrainingLogger - INFO - Step 22880, Batch metrics: Loss: 7.5965, Accuracy: 0.0514, Perplexity: 1991.1184
2024-12-31 20:14:07,411 - TrainingLogger - INFO - Step 22890, Batch metrics: Loss: 7.0904, Accuracy: 0.0526, Perplexity: 1200.4041
2024-12-31 20:14:14,865 - TrainingLogger - INFO - Step 22900, Batch metrics: Loss: 7.8009, Accuracy: 0.0559, Perplexity: 2442.7331
2024-12-31 20:14:14,865 - TrainingLogger - INFO - Step 22900, Prediction vs Actual:
2024-12-31 20:14:14,865 - TrainingLogger - INFO - Input 1: ב-2015, סביב פרשת המרמרה, ישראל הציבה את גירושו מטורקיה כתנאי במשא ומתן
2024-12-31 20:14:14,866 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:14:14,866 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ב           | ✗     |
|     1 | ▁ו              | -20          | ✗     |
|     2 | .               | 15           | ✗     |
|     3 | ב               | ,            | ✗     |
|     4 | ב               | ▁סביב        | ✗     |
|     5 | תו              | ▁פרשת        | ✗     |
|     6 | ▁המדינה         | ▁המר         | ✗     |
|     7 | יש              | מרה          | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | </s>            | ▁ישראל       | ✗     |
|    10 | ה               | ▁הציב        | ✗     |
|    11 | ה               | ה            | ✓     |
|    12 | ▁את             | ▁את          | ✓     |
|    13 | ▁עצמה           | ▁גירוש       | ✗     |
|    14 | ה               | ו            | ✗     |
|    15 | ▁של             | ▁מ           | ✗     |
|    16 | רוסיה           | טורקיה       | ✗     |
|    17 | .               | ▁כ           | ✗     |
|    18 | חוק             | תנאי         | ✗     |
|    19 | ה               | ▁במשא        | ✗     |
|    20 | ור              | ▁ומתן        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ה               | <pad>        | ✗     |
|    27 | ה               | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ה               | <pad>        | ✗     |
|    36 | ה               | <pad>        | ✗     |
|    37 | ה               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ה               | <pad>        | ✗     |
|    41 | ה               | <pad>        | ✗     |
|    42 | .               |              | ✗     |

2024-12-31 20:14:14,866 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:14:14,871 - TrainingLogger - INFO - Gradient norm: 11.1184
2024-12-31 20:14:21,994 - TrainingLogger - INFO - Step 22910, Batch metrics: Loss: 7.5571, Accuracy: 0.0661, Perplexity: 1914.3505
2024-12-31 20:14:28,855 - TrainingLogger - INFO - Step 22920, Batch metrics: Loss: 7.4701, Accuracy: 0.0458, Perplexity: 1754.7301
2024-12-31 20:14:35,716 - TrainingLogger - INFO - Step 22930, Batch metrics: Loss: 7.4505, Accuracy: 0.0927, Perplexity: 1720.6396
2024-12-31 20:14:43,537 - TrainingLogger - INFO - Step 22940, Batch metrics: Loss: 7.3274, Accuracy: 0.0952, Perplexity: 1521.4046
2024-12-31 20:14:50,765 - TrainingLogger - INFO - Step 22950, Batch metrics: Loss: 7.4133, Accuracy: 0.0769, Perplexity: 1657.9691
2024-12-31 20:14:58,050 - TrainingLogger - INFO - Step 22960, Batch metrics: Loss: 7.5429, Accuracy: 0.0583, Perplexity: 1887.2252
2024-12-31 20:15:05,329 - TrainingLogger - INFO - Step 22970, Batch metrics: Loss: 7.0837, Accuracy: 0.0788, Perplexity: 1192.3144
2024-12-31 20:15:12,248 - TrainingLogger - INFO - Step 22980, Batch metrics: Loss: 7.5113, Accuracy: 0.0931, Perplexity: 1828.5998
2024-12-31 20:15:19,710 - TrainingLogger - INFO - Step 22990, Batch metrics: Loss: 7.4703, Accuracy: 0.0566, Perplexity: 1755.1820
2024-12-31 20:15:26,373 - TrainingLogger - INFO - Step 23000, Batch metrics: Loss: 6.6963, Accuracy: 0.0983, Perplexity: 809.4171
2024-12-31 20:15:26,374 - TrainingLogger - INFO - Step 23000, Prediction vs Actual:
2024-12-31 20:15:26,374 - TrainingLogger - INFO - Input 1: אם אהבתי נקיון זה היה גם בשנים לפני אב הבית, וגם אחרי מכן
2024-12-31 20:15:26,374 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:15:26,374 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אם          | ✗     |
|     1 | ▁-              | ▁אהבתי       | ✗     |
|     2 | ▁את             | ▁נקי         | ✗     |
|     3 | ה               | ון           | ✗     |
|     4 | ,               | ▁זה          | ✗     |
|     5 | ▁היה            | ▁היה         | ✓     |
|     6 | ▁טוב            | ▁גם          | ✗     |
|     7 | ▁כן             | ▁בשנים       | ✗     |
|     8 | ▁האחרונות       | ▁לפני        | ✗     |
|     9 | ▁כן             | ▁אב          | ✗     |
|    10 | מו              | ▁הבית        | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | <pad>           | ▁וגם         | ✗     |
|    13 | ▁זה             | ▁אחרי        | ✗     |
|    14 | ▁כן             | ▁מכן         | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁זה             | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁זה             | <pad>        | ✗     |
|    19 | ▁זה             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁זה             | <pad>        | ✗     |
|    22 | ▁זה             | <pad>        | ✗     |
|    23 | ▁זה             | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ▁הוא            | <pad>        | ✗     |
|    26 | ▁זה             | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ▁זה             | <pad>        | ✗     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁זה             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁לא             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | .               |              | ✗     |

2024-12-31 20:15:26,374 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:15:26,380 - TrainingLogger - INFO - Gradient norm: 9.0211
2024-12-31 20:15:33,670 - TrainingLogger - INFO - Step 23010, Batch metrics: Loss: 7.9949, Accuracy: 0.0613, Perplexity: 2965.7139
2024-12-31 20:15:40,677 - TrainingLogger - INFO - Step 23020, Batch metrics: Loss: 7.0581, Accuracy: 0.0688, Perplexity: 1162.2367
2024-12-31 20:15:48,049 - TrainingLogger - INFO - Step 23030, Batch metrics: Loss: 7.3470, Accuracy: 0.0837, Perplexity: 1551.5240
2024-12-31 20:15:55,999 - TrainingLogger - INFO - Step 23040, Batch metrics: Loss: 7.8783, Accuracy: 0.0398, Perplexity: 2639.2791
2024-12-31 20:16:03,214 - TrainingLogger - INFO - Step 23050, Batch metrics: Loss: 7.3975, Accuracy: 0.1154, Perplexity: 1631.8895
2024-12-31 20:16:10,558 - TrainingLogger - INFO - Step 23060, Batch metrics: Loss: 7.5091, Accuracy: 0.0952, Perplexity: 1824.6533
2024-12-31 20:16:17,771 - TrainingLogger - INFO - Step 23070, Batch metrics: Loss: 7.5258, Accuracy: 0.1123, Perplexity: 1855.2460
2024-12-31 20:16:25,429 - TrainingLogger - INFO - Step 23080, Batch metrics: Loss: 7.6449, Accuracy: 0.0581, Perplexity: 2089.8875
2024-12-31 20:16:32,947 - TrainingLogger - INFO - Step 23090, Batch metrics: Loss: 6.8313, Accuracy: 0.1159, Perplexity: 926.4299
2024-12-31 20:16:40,520 - TrainingLogger - INFO - Step 23100, Batch metrics: Loss: 7.7411, Accuracy: 0.0690, Perplexity: 2300.9260
2024-12-31 20:16:40,521 - TrainingLogger - INFO - Step 23100, Prediction vs Actual:
2024-12-31 20:16:40,521 - TrainingLogger - INFO - Input 1: ואני אומר לא, תהיו שמאל
2024-12-31 20:16:40,521 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:16:40,521 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ואני        | ✗     |
|     1 | ,               | ▁אומר        | ✗     |
|     2 | ,               | ▁לא          | ✗     |
|     3 | ,               | ,            | ✓     |
|     4 | </s>            | ▁תהיו        | ✗     |
|     5 | ▁בנות           | ▁שמאל        | ✗     |
|     6 | ,               | <pad>        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | ▁ביחד           | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ▁איתי           | <pad>        | ✗     |
|    11 | ▁ביחד           | <pad>        | ✗     |
|    12 | ▁ת              | <pad>        | ✗     |
|    13 | ▁אחת            | <pad>        | ✗     |
|    14 | ▁ביחד           | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁איתי           | <pad>        | ✗     |
|    17 | ▁אחת            | <pad>        | ✗     |
|    18 | ▁עד             | <pad>        | ✗     |
|    19 | ▁אחת            | <pad>        | ✗     |
|    20 | ▁איתי           | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁שם             | <pad>        | ✗     |
|    26 | ▁אחת            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ▁זה             | <pad>        | ✗     |
|    29 | ▁איתי           | <pad>        | ✗     |
|    30 | ▁גם             | <pad>        | ✗     |
|    31 | ▁בנות           | <pad>        | ✗     |
|    32 | ▁עד             | <pad>        | ✗     |
|    33 | ▁זה             | <pad>        | ✗     |
|    34 | ▁זה             |              | ✗     |

2024-12-31 20:16:40,521 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:16:40,526 - TrainingLogger - INFO - Gradient norm: 11.5687
2024-12-31 20:16:47,120 - TrainingLogger - INFO - Step 23110, Batch metrics: Loss: 7.6413, Accuracy: 0.0446, Perplexity: 2082.4914
2024-12-31 20:16:54,397 - TrainingLogger - INFO - Step 23120, Batch metrics: Loss: 7.6590, Accuracy: 0.0529, Perplexity: 2119.7296
2024-12-31 20:17:01,560 - TrainingLogger - INFO - Step 23130, Batch metrics: Loss: 7.3807, Accuracy: 0.1046, Perplexity: 1604.7725
2024-12-31 20:17:08,666 - TrainingLogger - INFO - Step 23140, Batch metrics: Loss: 6.7669, Accuracy: 0.0781, Perplexity: 868.6109
2024-12-31 20:17:15,734 - TrainingLogger - INFO - Step 23150, Batch metrics: Loss: 7.0901, Accuracy: 0.0976, Perplexity: 1200.0756
2024-12-31 20:17:16,456 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 33, 32), but is torch.Size([8, 1, 33, 28])
2024-12-31 20:17:16,456 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 33, 32), but is torch.Size([8, 1, 33, 28])

2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 33]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 33]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 28]), device: cuda:0
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 20:17:16,457 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 20:17:23,631 - TrainingLogger - INFO - Step 23160, Batch metrics: Loss: 7.8858, Accuracy: 0.0446, Perplexity: 2659.2665
2024-12-31 20:17:30,727 - TrainingLogger - INFO - Step 23170, Batch metrics: Loss: 6.8107, Accuracy: 0.1033, Perplexity: 907.4664
2024-12-31 20:17:38,016 - TrainingLogger - INFO - Step 23180, Batch metrics: Loss: 7.3835, Accuracy: 0.0448, Perplexity: 1609.1671
2024-12-31 20:17:45,205 - TrainingLogger - INFO - Step 23190, Batch metrics: Loss: 7.7568, Accuracy: 0.0552, Perplexity: 2337.3063
2024-12-31 20:17:52,777 - TrainingLogger - INFO - Step 23200, Batch metrics: Loss: 7.5542, Accuracy: 0.0959, Perplexity: 1908.8021
2024-12-31 20:17:52,777 - TrainingLogger - INFO - Step 23200, Prediction vs Actual:
2024-12-31 20:17:52,777 - TrainingLogger - INFO - Input 1: לדוגמא רק באחרונה ראינו את המכירה ההיסטורית של חברת מובילאיי ביותר מ-15 מיליארד דולר
2024-12-31 20:17:52,777 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:17:52,778 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁לדוגמא      | ✗     |
|     1 | </s>            | ▁רק          | ✗     |
|     2 | </s>            | ▁ב           | ✗     |
|     3 | </s>            | אחרונה       | ✗     |
|     4 | </s>            | ▁ראינו       | ✗     |
|     5 | ▁איך            | ▁את          | ✗     |
|     6 | ▁זה             | ▁המכירה      | ✗     |
|     7 | </s>            | ▁ההיסטורי    | ✗     |
|     8 | ת               | ת            | ✓     |
|     9 | </s>            | ▁של          | ✗     |
|    10 | ▁בית            | ▁חברת        | ✗     |
|    11 | ה               | ▁מוביל       | ✗     |
|    12 | ות              | איי          | ✗     |
|    13 | .               | ▁ביותר       | ✗     |
|    14 | </s>            | ▁מ           | ✗     |
|    15 | "               | -15          | ✗     |
|    16 | ▁ל              | ▁מיליארד     | ✗     |
|    17 | ים              | ▁דולר        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            |              | ✗     |

2024-12-31 20:17:52,778 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:17:52,782 - TrainingLogger - INFO - Gradient norm: 12.8745
2024-12-31 20:17:59,739 - TrainingLogger - INFO - Step 23210, Batch metrics: Loss: 7.0923, Accuracy: 0.0896, Perplexity: 1202.6873
2024-12-31 20:18:06,745 - TrainingLogger - INFO - Step 23220, Batch metrics: Loss: 8.0885, Accuracy: 0.0581, Perplexity: 3256.8392
2024-12-31 20:18:13,636 - TrainingLogger - INFO - Step 23230, Batch metrics: Loss: 7.5843, Accuracy: 0.0643, Perplexity: 1967.0862
2024-12-31 20:18:20,956 - TrainingLogger - INFO - Step 23240, Batch metrics: Loss: 7.6004, Accuracy: 0.0942, Perplexity: 1999.0782
2024-12-31 20:18:27,836 - TrainingLogger - INFO - Step 23250, Batch metrics: Loss: 7.6758, Accuracy: 0.0325, Perplexity: 2155.4423
2024-12-31 20:18:34,825 - TrainingLogger - INFO - Step 23260, Batch metrics: Loss: 6.9360, Accuracy: 0.0864, Perplexity: 1028.6379
2024-12-31 20:18:41,735 - TrainingLogger - INFO - Step 23270, Batch metrics: Loss: 7.3155, Accuracy: 0.1026, Perplexity: 1503.4961
2024-12-31 20:18:48,863 - TrainingLogger - INFO - Step 23280, Batch metrics: Loss: 7.8165, Accuracy: 0.0617, Perplexity: 2481.1662
2024-12-31 20:18:56,680 - TrainingLogger - INFO - Step 23290, Batch metrics: Loss: 7.3071, Accuracy: 0.0939, Perplexity: 1490.7733
2024-12-31 20:19:03,848 - TrainingLogger - INFO - Step 23300, Batch metrics: Loss: 8.0241, Accuracy: 0.0747, Perplexity: 3053.7309
2024-12-31 20:19:03,848 - TrainingLogger - INFO - Step 23300, Prediction vs Actual:
2024-12-31 20:19:03,848 - TrainingLogger - INFO - Input 1: מקלב ענה לזנדברג אני באמת חושב ששוחד פוליטי זה הגדרה קצת מרחיקת לכת
2024-12-31 20:19:03,849 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:19:03,849 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁מקל         | ✗     |
|     1 | ה               | ב            | ✗     |
|     2 | ון              | ▁ענה         | ✗     |
|     3 | ק               | ▁לז          | ✗     |
|     4 | ל               | נדבר         | ✗     |
|     5 | ת               | ג            | ✗     |
|     6 | ון              | ▁אני         | ✗     |
|     7 | ב               | ▁באמת        | ✗     |
|     8 | ▁לא             | ▁חושב        | ✗     |
|     9 | ▁שזה            | ▁ש           | ✗     |
|    10 | ...             | שוחד         | ✗     |
|    11 | ה               | ▁פוליטי      | ✗     |
|    12 | ,               | ▁זה          | ✗     |
|    13 | ▁לא             | ▁הגדרה       | ✗     |
|    14 | ▁טובה           | ▁קצת         | ✗     |
|    15 | ▁יותר           | ▁מרחיק       | ✗     |
|    16 | ה               | ת            | ✗     |
|    17 | ▁לכת            | ▁לכת         | ✓     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ית              | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ית              | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2024-12-31 20:19:03,849 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:19:03,854 - TrainingLogger - INFO - Gradient norm: 16.5740
2024-12-31 20:19:11,266 - TrainingLogger - INFO - Step 23310, Batch metrics: Loss: 7.5634, Accuracy: 0.0529, Perplexity: 1926.3589
2024-12-31 20:19:18,812 - TrainingLogger - INFO - Step 23320, Batch metrics: Loss: 7.7173, Accuracy: 0.0754, Perplexity: 2246.9939
2024-12-31 20:19:25,795 - TrainingLogger - INFO - Step 23330, Batch metrics: Loss: 6.9802, Accuracy: 0.0920, Perplexity: 1075.1403
2024-12-31 20:19:32,993 - TrainingLogger - INFO - Step 23340, Batch metrics: Loss: 7.8790, Accuracy: 0.0526, Perplexity: 2641.1675
2024-12-31 20:19:39,749 - TrainingLogger - INFO - Step 23350, Batch metrics: Loss: 7.3253, Accuracy: 0.1186, Perplexity: 1518.2687
2024-12-31 20:19:46,372 - TrainingLogger - INFO - Step 23360, Batch metrics: Loss: 7.7855, Accuracy: 0.0365, Perplexity: 2405.5742
2024-12-31 20:19:53,779 - TrainingLogger - INFO - Step 23370, Batch metrics: Loss: 7.4560, Accuracy: 0.1045, Perplexity: 1730.2288
2024-12-31 20:20:01,052 - TrainingLogger - INFO - Step 23380, Batch metrics: Loss: 7.5966, Accuracy: 0.0686, Perplexity: 1991.4678
2024-12-31 20:20:08,326 - TrainingLogger - INFO - Step 23390, Batch metrics: Loss: 7.9350, Accuracy: 0.0748, Perplexity: 2793.4318
2024-12-31 20:20:15,818 - TrainingLogger - INFO - Step 23400, Batch metrics: Loss: 7.5405, Accuracy: 0.0591, Perplexity: 1882.7374
2024-12-31 20:20:15,818 - TrainingLogger - INFO - Step 23400, Prediction vs Actual:
2024-12-31 20:20:15,852 - TrainingLogger - INFO - Input 1: נתניהו אמר בפירוש שציר פילדלפי חשוב יותר מהחטופים וזאת ההתייחסות שלו לאזרחים ישראלים שנחטפו בעזה
2024-12-31 20:20:15,853 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:20:15,853 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁נתנ         | ✗     |
|     1 | י               | יהו          | ✗     |
|     2 | ם               | ▁אמר         | ✗     |
|     3 | ▁שהוא           | ▁בפירוש      | ✗     |
|     4 | :               | ▁ש           | ✗     |
|     5 | יס              | ציר          | ✗     |
|     6 | ה               | ▁            | ✗     |
|     7 | ם               | פילד         | ✗     |
|     8 | או              | לפי          | ✗     |
|     9 | ה               | ▁חשוב        | ✗     |
|    10 | </s>            | ▁יותר        | ✗     |
|    11 | </s>            | ▁מה          | ✗     |
|    12 | צפון            | ח            | ✗     |
|    13 | ממה             | טופ          | ✗     |
|    14 | ים              | ים           | ✓     |
|    15 | ▁שלו            | ▁וזאת        | ✗     |
|    16 | ▁עם             | ▁הה          | ✗     |
|    17 | ג               | תייחס        | ✗     |
|    18 | ה               | ות           | ✗     |
|    19 | ▁שלו            | ▁שלו         | ✓     |
|    20 | .               | ▁ל           | ✗     |
|    21 | פש              | אזרחים       | ✗     |
|    22 | .               | ▁ישראל       | ✗     |
|    23 | יה              | ים           | ✗     |
|    24 | .               | ▁שנ          | ✗     |
|    25 | ונה             | חטפו         | ✗     |
|    26 | ת               | ▁בע          | ✗     |
|    27 | "               | זה           | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ה               |              | ✗     |

2024-12-31 20:20:15,853 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:20:15,858 - TrainingLogger - INFO - Gradient norm: 11.4483
2024-12-31 20:20:22,733 - TrainingLogger - INFO - Step 23410, Batch metrics: Loss: 7.1681, Accuracy: 0.1092, Perplexity: 1297.3424
2024-12-31 20:20:29,767 - TrainingLogger - INFO - Step 23420, Batch metrics: Loss: 7.6164, Accuracy: 0.0465, Perplexity: 2031.2012
2024-12-31 20:20:38,368 - TrainingLogger - INFO - Step 23430, Batch metrics: Loss: 7.6982, Accuracy: 0.0739, Perplexity: 2204.4065
2024-12-31 20:20:45,189 - TrainingLogger - INFO - Step 23440, Batch metrics: Loss: 7.4078, Accuracy: 0.0795, Perplexity: 1648.8103
2024-12-31 20:20:52,451 - TrainingLogger - INFO - Step 23450, Batch metrics: Loss: 7.4874, Accuracy: 0.0788, Perplexity: 1785.3462
2024-12-31 20:20:59,517 - TrainingLogger - INFO - Step 23460, Batch metrics: Loss: 7.4974, Accuracy: 0.0792, Perplexity: 1803.3894
2024-12-31 20:21:06,683 - TrainingLogger - INFO - Step 23470, Batch metrics: Loss: 7.9449, Accuracy: 0.0534, Perplexity: 2821.2540
2024-12-31 20:21:14,252 - TrainingLogger - INFO - Step 23480, Batch metrics: Loss: 7.6085, Accuracy: 0.0782, Perplexity: 2015.2779
2024-12-31 20:21:21,034 - TrainingLogger - INFO - Step 23490, Batch metrics: Loss: 7.6594, Accuracy: 0.0714, Perplexity: 2120.5778
2024-12-31 20:21:28,142 - TrainingLogger - INFO - Step 23500, Batch metrics: Loss: 7.5114, Accuracy: 0.1026, Perplexity: 1828.6870
2024-12-31 20:21:28,143 - TrainingLogger - INFO - Step 23500, Prediction vs Actual:
2024-12-31 20:21:28,143 - TrainingLogger - INFO - Input 1: השניים גרו יחד לפני היעלמותה, והחוקרים מעריכים כי היא התכוונה לעזוב אותו
2024-12-31 20:21:28,143 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:21:28,143 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁השניים      | ✗     |
|     1 | ▁-              | ▁גרו         | ✗     |
|     2 | ,               | ▁יחד         | ✗     |
|     3 | ▁-              | ▁לפני        | ✗     |
|     4 | ▁כן             | ▁היעלמות     | ✗     |
|     5 | ו               | ה            | ✗     |
|     6 | ▁של             | ,            | ✗     |
|     7 | ▁היא            | ▁וה          | ✗     |
|     8 | מש              | חוקרים       | ✗     |
|     9 | ▁החדשים         | ▁מעריכים     | ✗     |
|    10 | ▁את             | ▁כי          | ✗     |
|    11 | ▁הם             | ▁היא         | ✗     |
|    12 | ▁הייתה          | ▁התכוונה     | ✗     |
|    13 | ▁לה             | ▁לעזוב       | ✗     |
|    14 | ▁את             | ▁אותו        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ▁יחד            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁עם             | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2024-12-31 20:21:28,143 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:21:28,148 - TrainingLogger - INFO - Gradient norm: 10.5610
2024-12-31 20:21:35,052 - TrainingLogger - INFO - Step 23510, Batch metrics: Loss: 7.6574, Accuracy: 0.0504, Perplexity: 2116.3159
2024-12-31 20:21:42,415 - TrainingLogger - INFO - Step 23520, Batch metrics: Loss: 7.5664, Accuracy: 0.0560, Perplexity: 1932.2043
2024-12-31 20:21:49,703 - TrainingLogger - INFO - Step 23530, Batch metrics: Loss: 7.2423, Accuracy: 0.0750, Perplexity: 1397.3181
2024-12-31 20:21:56,760 - TrainingLogger - INFO - Step 23540, Batch metrics: Loss: 7.4765, Accuracy: 0.0750, Perplexity: 1765.9621
2024-12-31 20:22:03,781 - TrainingLogger - INFO - Step 23550, Batch metrics: Loss: 7.7380, Accuracy: 0.0559, Perplexity: 2293.8744
2024-12-31 20:22:10,864 - TrainingLogger - INFO - Step 23560, Batch metrics: Loss: 7.8582, Accuracy: 0.0140, Perplexity: 2586.8230
2024-12-31 20:22:18,087 - TrainingLogger - INFO - Step 23570, Batch metrics: Loss: 7.6524, Accuracy: 0.0556, Perplexity: 2105.6019
2024-12-31 20:22:25,383 - TrainingLogger - INFO - Step 23580, Batch metrics: Loss: 7.5164, Accuracy: 0.0708, Perplexity: 1837.9937
2024-12-31 20:22:33,046 - TrainingLogger - INFO - Step 23590, Batch metrics: Loss: 7.3493, Accuracy: 0.0769, Perplexity: 1555.1252
2024-12-31 20:22:39,888 - TrainingLogger - INFO - Step 23600, Batch metrics: Loss: 8.1512, Accuracy: 0.0930, Perplexity: 3467.7007
2024-12-31 20:22:39,888 - TrainingLogger - INFO - Step 23600, Prediction vs Actual:
2024-12-31 20:22:39,888 - TrainingLogger - INFO - Input 1: סרטון כזה גורם נזק גם אם לפיד ואנשיו לא התכוונו לכך, אמר הגורם במפלגהגם חכ יועז הנדל הביע התנגדות אני לא אוהב את הסרטון
2024-12-31 20:22:39,889 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:22:39,889 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁סרט         | ✗     |
|     1 | ▁-              | ון           | ✗     |
|     2 | ▁-              | ▁כזה         | ✗     |
|     3 | ▁-              | ▁גורם        | ✗     |
|     4 | ▁-              | ▁נזק         | ✗     |
|     5 | ▁-              | ▁גם          | ✗     |
|     6 | ▁כן             | ▁אם          | ✗     |
|     7 | ▁זה             | ▁לפי         | ✗     |
|     8 | ו               | ד            | ✗     |
|     9 | ?               | ▁ואנשיו      | ✗     |
|    10 | .               | ▁לא          | ✗     |
|    11 | ▁היה            | ▁התכוונו     | ✗     |
|    12 | ת               | ▁לכך         | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | ▁זה             | ▁אמר         | ✗     |
|    15 | ▁לי             | ▁הגורם       | ✗     |
|    16 | ▁לי             | ▁במ          | ✗     |
|    17 | אס              | פלג          | ✗     |
|    18 | ה               | ה            | ✓     |
|    19 | ▁של             | גם           | ✗     |
|    20 | שלי             | ▁ח           | ✗     |
|    21 | סון             | כ            | ✗     |
|    22 | כת              | ▁יו          | ✗     |
|    23 | רת              | עז           | ✗     |
|    24 | ה               | ▁הנדל        | ✗     |
|    25 | ים              | ▁הביע        | ✗     |
|    26 | ו               | ▁התנגדות     | ✗     |
|    27 | .               | ▁אני         | ✗     |
|    28 | ▁לא             | ▁לא          | ✓     |
|    29 | ▁בטוח           | ▁אוהב        | ✗     |
|    30 | ▁את             | ▁את          | ✓     |
|    31 | ▁זה             | ▁הסרט        | ✗     |
|    32 | ▁הזה            | ון           | ✗     |
|    33 | ▁הזה            |              | ✗     |

2024-12-31 20:22:39,889 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:22:39,894 - TrainingLogger - INFO - Gradient norm: 16.0001
2024-12-31 20:22:47,175 - TrainingLogger - INFO - Step 23610, Batch metrics: Loss: 7.5581, Accuracy: 0.0644, Perplexity: 1916.1414
2024-12-31 20:22:54,344 - TrainingLogger - INFO - Step 23620, Batch metrics: Loss: 7.7792, Accuracy: 0.0549, Perplexity: 2390.4725
2024-12-31 20:23:01,658 - TrainingLogger - INFO - Step 23630, Batch metrics: Loss: 7.7023, Accuracy: 0.0578, Perplexity: 2213.4205
2024-12-31 20:23:08,547 - TrainingLogger - INFO - Step 23640, Batch metrics: Loss: 6.9533, Accuracy: 0.0588, Perplexity: 1046.5519
2024-12-31 20:23:16,019 - TrainingLogger - INFO - Step 23650, Batch metrics: Loss: 7.9354, Accuracy: 0.0439, Perplexity: 2794.4510
2024-12-31 20:23:23,310 - TrainingLogger - INFO - Step 23660, Batch metrics: Loss: 7.2394, Accuracy: 0.0764, Perplexity: 1393.2762
2024-12-31 20:23:30,288 - TrainingLogger - INFO - Step 23670, Batch metrics: Loss: 7.6017, Accuracy: 0.0866, Perplexity: 2001.5916
2024-12-31 20:23:36,908 - TrainingLogger - INFO - Step 23680, Batch metrics: Loss: 7.8451, Accuracy: 0.0619, Perplexity: 2553.1124
2024-12-31 20:23:43,951 - TrainingLogger - INFO - Step 23690, Batch metrics: Loss: 7.6544, Accuracy: 0.0859, Perplexity: 2109.8069
2024-12-31 20:23:50,976 - TrainingLogger - INFO - Step 23700, Batch metrics: Loss: 7.3667, Accuracy: 0.0753, Perplexity: 1582.4654
2024-12-31 20:23:50,976 - TrainingLogger - INFO - Step 23700, Prediction vs Actual:
2024-12-31 20:23:50,976 - TrainingLogger - INFO - Input 1: כולם אוהבים לשחק משחקים, אמר טראמפ לכתבי הבית הלבן כשנשאל על ביטול הפסגה
2024-12-31 20:23:50,976 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:23:50,976 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כולם        | ✗     |
|     1 | ▁-              | ▁אוהבים      | ✗     |
|     2 | ▁-              | ▁לשחק        | ✗     |
|     3 | ▁את             | ▁משחקים      | ✗     |
|     4 | ▁-              | ,            | ✗     |
|     5 | ▁-              | ▁אמר         | ✗     |
|     6 | סון             | ▁טר          | ✗     |
|     7 | דה              | אמפ          | ✗     |
|     8 | ,               | ▁לכתבי       | ✗     |
|     9 | רס              | ▁הבית        | ✗     |
|    10 | י               | ▁הלבן        | ✗     |
|    11 | .               | ▁כשנ         | ✗     |
|    12 | שב              | שאל          | ✗     |
|    13 | ו               | ▁על          | ✗     |
|    14 | ▁זה             | ▁ביטול       | ✗     |
|    15 | ▁המשימה         | ▁ה           | ✗     |
|    16 | -               | פס           | ✗     |
|    17 | ▁שלו            | גה           | ✗     |
|    18 | ▁שלו            | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ית              | <pad>        | ✗     |
|    22 | ית              | <pad>        | ✗     |
|    23 | ית              | <pad>        | ✗     |
|    24 | ית              | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ▁זה             | <pad>        | ✗     |
|    27 | ▁זה             | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | ▁היא            |              | ✗     |

2024-12-31 20:23:50,977 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:23:50,981 - TrainingLogger - INFO - Gradient norm: 15.5382
2024-12-31 20:23:58,359 - TrainingLogger - INFO - Step 23710, Batch metrics: Loss: 7.5014, Accuracy: 0.0619, Perplexity: 1810.4926
2024-12-31 20:24:06,160 - TrainingLogger - INFO - Step 23720, Batch metrics: Loss: 7.1976, Accuracy: 0.1005, Perplexity: 1336.2542
2024-12-31 20:24:13,291 - TrainingLogger - INFO - Step 23730, Batch metrics: Loss: 7.8892, Accuracy: 0.0569, Perplexity: 2668.2263
2024-12-31 20:24:20,305 - TrainingLogger - INFO - Step 23740, Batch metrics: Loss: 7.6538, Accuracy: 0.0662, Perplexity: 2108.5658
2024-12-31 20:24:27,859 - TrainingLogger - INFO - Step 23750, Batch metrics: Loss: 7.4301, Accuracy: 0.0857, Perplexity: 1686.0123
2024-12-31 20:24:35,121 - TrainingLogger - INFO - Step 23760, Batch metrics: Loss: 7.3865, Accuracy: 0.0909, Perplexity: 1614.0838
2024-12-31 20:24:42,614 - TrainingLogger - INFO - Step 23770, Batch metrics: Loss: 7.6286, Accuracy: 0.0531, Perplexity: 2056.1098
2024-12-31 20:24:49,792 - TrainingLogger - INFO - Step 23780, Batch metrics: Loss: 7.6314, Accuracy: 0.0688, Perplexity: 2061.9762
2024-12-31 20:24:56,903 - TrainingLogger - INFO - Step 23790, Batch metrics: Loss: 7.5502, Accuracy: 0.0584, Perplexity: 1901.0748
2024-12-31 20:25:04,674 - TrainingLogger - INFO - Step 23800, Batch metrics: Loss: 6.9857, Accuracy: 0.0820, Perplexity: 1081.0842
2024-12-31 20:25:04,674 - TrainingLogger - INFO - Step 23800, Prediction vs Actual:
2024-12-31 20:25:04,674 - TrainingLogger - INFO - Input 1: עוד הובטח לתושבים שכיתות הכוננות ביישובים עובו באמצעים נוספים ובחברים שהגדילו את כוחות הכוננות עם נשקייה ומערכת קשר שלמה בכל יישוב
2024-12-31 20:25:04,675 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:25:04,675 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | <pad>           | ▁עוד         | ✗     |
|     1 | ▁-              | ▁הו          | ✗     |
|     2 | ,               | בטח          | ✗     |
|     3 | ה               | ▁ל           | ✗     |
|     4 | "               | תושבים       | ✗     |
|     5 | ▁אחרים          | ▁ש           | ✗     |
|     6 | ...             | כית          | ✗     |
|     7 | ו               | ות           | ✗     |
|     8 | ▁נוספות         | ▁ה           | ✗     |
|     9 | נוס             | כוננות       | ✗     |
|    10 | ▁הראשונות       | ▁ביי         | ✗     |
|    11 | עות             | שוב          | ✗     |
|    12 | .               | ים           | ✗     |
|    13 | .               | ▁עו          | ✗     |
|    14 | ונות            | בו           | ✗     |
|    15 | ות              | ▁באמצע       | ✗     |
|    16 | ▁הדרך           | ים           | ✗     |
|    17 | ▁שונים          | ▁נוספים      | ✗     |
|    18 | .               | ▁וב          | ✗     |
|    19 | ד               | חברים        | ✗     |
|    20 | ▁אחרים          | ▁שה          | ✗     |
|    21 | יז              | גדי          | ✗     |
|    22 | עו              | לו           | ✗     |
|    23 | ▁את             | ▁את          | ✓     |
|    24 | ▁הכסף           | ▁כוחות       | ✗     |
|    25 | יהם             | ▁ה           | ✗     |
|    26 | אוכלוסיה        | כוננות       | ✗     |
|    27 | .               | ▁עם          | ✗     |
|    28 | <pad>           | ▁נשק         | ✗     |
|    29 | ▁גרעיני         | ייה          | ✗     |
|    30 | .               | ▁ו           | ✗     |
|    31 | עסקים           | מערכת        | ✗     |
|    32 | ▁החשמל          | ▁קשר         | ✗     |
|    33 | .               | ▁שלמה        | ✗     |
|    34 | .               | ▁בכל         | ✗     |
|    35 | ▁יום            | ▁יי          | ✗     |
|    36 | שוב             | שוב          | ✓     |
|    37 | ים              | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               |              | ✗     |

2024-12-31 20:25:04,675 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:25:04,680 - TrainingLogger - INFO - Gradient norm: 11.8742
2024-12-31 20:25:12,046 - TrainingLogger - INFO - Step 23810, Batch metrics: Loss: 7.3636, Accuracy: 0.0833, Perplexity: 1577.5020
2024-12-31 20:25:19,016 - TrainingLogger - INFO - Step 23820, Batch metrics: Loss: 7.4682, Accuracy: 0.0738, Perplexity: 1751.5218
2024-12-31 20:25:26,226 - TrainingLogger - INFO - Step 23830, Batch metrics: Loss: 7.4333, Accuracy: 0.0735, Perplexity: 1691.4017
2024-12-31 20:25:33,387 - TrainingLogger - INFO - Step 23840, Batch metrics: Loss: 7.5729, Accuracy: 0.0642, Perplexity: 1944.7039
2024-12-31 20:25:40,524 - TrainingLogger - INFO - Step 23850, Batch metrics: Loss: 7.6032, Accuracy: 0.0664, Perplexity: 2004.6194
2024-12-31 20:25:47,362 - TrainingLogger - INFO - Step 23860, Batch metrics: Loss: 7.3263, Accuracy: 0.1069, Perplexity: 1519.7195
2024-12-31 20:25:54,205 - TrainingLogger - INFO - Step 23870, Batch metrics: Loss: 8.1508, Accuracy: 0.0373, Perplexity: 3466.1632
2024-12-31 20:26:01,249 - TrainingLogger - INFO - Step 23880, Batch metrics: Loss: 8.0624, Accuracy: 0.0671, Perplexity: 3172.9379
2024-12-31 20:26:08,511 - TrainingLogger - INFO - Step 23890, Batch metrics: Loss: 7.4840, Accuracy: 0.0853, Perplexity: 1779.3324
2024-12-31 20:26:14,961 - TrainingLogger - INFO - Step 23900, Batch metrics: Loss: 7.0457, Accuracy: 0.1258, Perplexity: 1147.9625
2024-12-31 20:26:14,961 - TrainingLogger - INFO - Step 23900, Prediction vs Actual:
2024-12-31 20:26:14,961 - TrainingLogger - INFO - Input 1: צריך לשנות את כל הגישהצילום יריב כץ נשים אשר נכנסות למקלטים שוהות בהם בדרך כלל כשישה חודשים עד שנה
2024-12-31 20:26:14,962 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:26:14,962 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁צריך        | ✗     |
|     1 | .               | ▁לשנות       | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁המצב           | ▁כל          | ✗     |
|     4 | ל               | ▁הגישה       | ✗     |
|     5 | .               | צילום        | ✗     |
|     6 | .               | ▁יריב        | ✗     |
|     7 | ה               | ▁כ           | ✗     |
|     8 | חוק             | ץ            | ✗     |
|     9 | ה               | ▁נשים        | ✗     |
|    10 | ▁אחרות          | ▁אשר         | ✗     |
|    11 | ▁לא             | ▁נכנס        | ✗     |
|    12 | ות              | ות           | ✓     |
|    13 | ▁ל              | ▁למקלט       | ✗     |
|    14 | ים              | ים           | ✓     |
|    15 | ▁שלהן           | ▁שו          | ✗     |
|    16 | מקום            | ה            | ✗     |
|    17 | ק               | ות           | ✗     |
|    18 | ▁קשות           | ▁בהם         | ✗     |
|    19 | ,               | ▁בדרך        | ✗     |
|    20 | ▁זו             | ▁כלל         | ✗     |
|    21 | ▁לא             | ▁כשיש        | ✗     |
|    22 | ה               | ה            | ✓     |
|    23 | ן               | ▁חודשים      | ✗     |
|    24 | .               | ▁עד          | ✗     |
|    25 | ▁כה             | ▁שנה         | ✗     |
|    26 | ▁שעברה          | <pad>        | ✗     |
|    27 | ▁ראשונה         | <pad>        | ✗     |
|    28 | ▁ראשונה         | <pad>        | ✗     |
|    29 | ▁האחרונה        |              | ✗     |

2024-12-31 20:26:14,962 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:26:14,967 - TrainingLogger - INFO - Gradient norm: 14.9608
2024-12-31 20:26:21,963 - TrainingLogger - INFO - Step 23910, Batch metrics: Loss: 7.6280, Accuracy: 0.0539, Perplexity: 2054.8425
2024-12-31 20:26:29,061 - TrainingLogger - INFO - Step 23920, Batch metrics: Loss: 6.8870, Accuracy: 0.0791, Perplexity: 979.4704
2024-12-31 20:26:36,218 - TrainingLogger - INFO - Step 23930, Batch metrics: Loss: 7.6469, Accuracy: 0.0595, Perplexity: 2094.1041
2024-12-31 20:26:43,331 - TrainingLogger - INFO - Step 23940, Batch metrics: Loss: 7.6706, Accuracy: 0.0792, Perplexity: 2144.4657
2024-12-31 20:26:50,471 - TrainingLogger - INFO - Step 23950, Batch metrics: Loss: 7.4549, Accuracy: 0.0774, Perplexity: 1728.3883
2024-12-31 20:26:57,377 - TrainingLogger - INFO - Step 23960, Batch metrics: Loss: 7.0014, Accuracy: 0.1145, Perplexity: 1098.2098
2024-12-31 20:27:05,120 - TrainingLogger - INFO - Step 23970, Batch metrics: Loss: 7.8374, Accuracy: 0.0606, Perplexity: 2533.5327
2024-12-31 20:27:11,993 - TrainingLogger - INFO - Step 23980, Batch metrics: Loss: 7.8093, Accuracy: 0.0667, Perplexity: 2463.3900
2024-12-31 20:27:19,501 - TrainingLogger - INFO - Step 23990, Batch metrics: Loss: 7.5761, Accuracy: 0.0523, Perplexity: 1950.9612
2024-12-31 20:27:26,800 - TrainingLogger - INFO - Step 24000, Batch metrics: Loss: 7.9848, Accuracy: 0.0488, Perplexity: 2935.8440
2024-12-31 20:27:26,801 - TrainingLogger - INFO - Step 24000, Prediction vs Actual:
2024-12-31 20:27:26,801 - TrainingLogger - INFO - Input 1: הטיפוס הרגלי מתבצע במשך כחצי שעה דרך שכונת קולוניאקי, אבל מי שמחויב להגדרה של החופשה שלו כבטן גב, יכול לעלות גם ברכבל
2024-12-31 20:27:26,801 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:27:26,801 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הטיפוס      | ✗     |
|     1 | י               | ▁הרגלי       | ✗     |
|     2 | ה               | ▁מתבצע       | ✗     |
|     3 | ים              | ▁במשך        | ✗     |
|     4 | ▁ימים           | ▁כחצי        | ✗     |
|     5 | ▁שנה            | ▁שעה         | ✗     |
|     6 | ,               | ▁דרך         | ✗     |
|     7 | ▁ארוכה          | ▁שכונת       | ✗     |
|     8 | ו               | ▁קול         | ✗     |
|     9 | ר               | וני          | ✗     |
|    10 | ציה             | אקי          | ✗     |
|    11 | ה               | ,            | ✗     |
|    12 | </s>            | ▁אבל         | ✗     |
|    13 | ▁הוא            | ▁מי          | ✗     |
|    14 | ▁מהם            | ▁שמח         | ✗     |
|    15 | ק               | ו            | ✗     |
|    16 | ▁ממנו           | יב           | ✗     |
|    17 | ▁את             | ▁לה          | ✗     |
|    18 | ,               | גדר          | ✗     |
|    19 | ה               | ה            | ✓     |
|    20 | ▁זו             | ▁של          | ✗     |
|    21 | ▁כבוד           | ▁החופשה      | ✗     |
|    22 | ▁שלו            | ▁שלו         | ✓     |
|    23 | ?               | ▁כ           | ✗     |
|    24 | חוק             | בטן          | ✗     |
|    25 | .               | ▁גב          | ✗     |
|    26 | ות              | ,            | ✗     |
|    27 | </s>            | ▁יכול        | ✗     |
|    28 | ▁להיות          | ▁לעלות       | ✗     |
|    29 | ▁לו             | ▁גם          | ✗     |
|    30 | ▁על             | ▁ברכב        | ✗     |
|    31 | .               | ל            | ✗     |
|    32 | .               |              | ✗     |

2024-12-31 20:27:26,801 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:27:26,806 - TrainingLogger - INFO - Gradient norm: 9.8744
2024-12-31 20:27:33,489 - TrainingLogger - INFO - Step 24010, Batch metrics: Loss: 7.7925, Accuracy: 0.0764, Perplexity: 2422.3810
2024-12-31 20:27:40,392 - TrainingLogger - INFO - Step 24020, Batch metrics: Loss: 7.2453, Accuracy: 0.0946, Perplexity: 1401.5087
2024-12-31 20:27:47,514 - TrainingLogger - INFO - Step 24030, Batch metrics: Loss: 6.7159, Accuracy: 0.1067, Perplexity: 825.4641
2024-12-31 20:27:54,969 - TrainingLogger - INFO - Step 24040, Batch metrics: Loss: 7.3088, Accuracy: 0.0523, Perplexity: 1493.4456
2024-12-31 20:28:02,163 - TrainingLogger - INFO - Step 24050, Batch metrics: Loss: 7.0420, Accuracy: 0.1071, Perplexity: 1143.6234
2024-12-31 20:28:09,213 - TrainingLogger - INFO - Step 24060, Batch metrics: Loss: 7.5401, Accuracy: 0.0938, Perplexity: 1882.0480
2024-12-31 20:28:12,242 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 272384
2024-12-31 20:28:12,243 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 272384

2024-12-31 20:28:12,243 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 38]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 29]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 29]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 59]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 59]), device: cuda:0
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 20:28:12,244 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 20:28:17,426 - TrainingLogger - INFO - Step 24070, Batch metrics: Loss: 7.9591, Accuracy: 0.0422, Perplexity: 2861.5340
2024-12-31 20:28:24,066 - TrainingLogger - INFO - Step 24080, Batch metrics: Loss: 7.4275, Accuracy: 0.1120, Perplexity: 1681.6581
2024-12-31 20:28:31,142 - TrainingLogger - INFO - Step 24090, Batch metrics: Loss: 7.2602, Accuracy: 0.0621, Perplexity: 1422.4963
2024-12-31 20:28:38,375 - TrainingLogger - INFO - Step 24100, Batch metrics: Loss: 7.2925, Accuracy: 0.0976, Perplexity: 1469.2876
2024-12-31 20:28:38,376 - TrainingLogger - INFO - Step 24100, Prediction vs Actual:
2024-12-31 20:28:38,409 - TrainingLogger - INFO - Input 1: מנכל United Nations Watch הלל נוייר קרא למועצת זכויות האדם להרחיק את אלבנזה בגלל העבירות הכלכליות שלה, והצהרותיה החוזרות ונשנות המסיתות לאנטישמיות ומצדיקות את הטרור של חמאס
2024-12-31 20:28:38,410 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:28:38,410 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מנ          | ✗     |
|     1 | ן               | כל           | ✗     |
|     2 | י               | ▁Un          | ✗     |
|     3 | י               | it           | ✗     |
|     4 | ות              | ed           | ✗     |
|     5 | <pad>           | ▁N           | ✗     |
|     6 | it              | ation        | ✗     |
|     7 | s               | s            | ✓     |
|     8 | <pad>           | ▁Watch       | ✗     |
|     9 | <pad>           | ▁הלל         | ✗     |
|    10 | ▁את             | ▁נו          | ✗     |
|    11 | י               | ייר          | ✗     |
|    12 | ו               | ▁קרא         | ✗     |
|    13 | סון             | ▁למועצ       | ✗     |
|    14 | ה               | ת            | ✗     |
|    15 | ▁העיר           | ▁זכויות      | ✗     |
|    16 | ▁האזרח          | ▁האדם        | ✗     |
|    17 | ,               | ▁להרחיק      | ✗     |
|    18 | ▁את             | ▁את          | ✓     |
|    19 | ▁כולם           | ▁אל          | ✗     |
|    20 | יל              | ב            | ✗     |
|    21 | ומים            | נזה          | ✗     |
|    22 | ,               | ▁בגלל        | ✗     |
|    23 | ו               | ▁העביר       | ✗     |
|    24 | ות              | ות           | ✓     |
|    25 | .               | ▁הכלכלי      | ✗     |
|    26 | ות              | ות           | ✓     |
|    27 | ▁שלו            | ▁שלה         | ✗     |
|    28 | .               | ,            | ✗     |
|    29 | </s>            | ▁ו           | ✗     |
|    30 | מכאן            | הצהרות       | ✗     |
|    31 | ה               | יה           | ✗     |
|    32 | ▁של             | ▁החוזר       | ✗     |
|    33 | ת               | ות           | ✗     |
|    34 | ▁שלה            | ▁ונ          | ✗     |
|    35 | כות             | שנות         | ✗     |
|    36 | ,               | ▁המס         | ✗     |
|    37 | ות              | ית           | ✗     |
|    38 | ות              | ות           | ✓     |
|    39 | ▁שלה            | ▁לא          | ✗     |
|    40 | ▁טובות          | נטי          | ✗     |
|    41 | מיות            | שמי          | ✗     |
|    42 | ות              | ות           | ✓     |
|    43 | .               | ▁ומ          | ✗     |
|    44 | ם               | צדיק         | ✗     |
|    45 | ות              | ות           | ✓     |
|    46 | יות             | ▁את          | ✗     |
|    47 | ▁האפשרות        | ▁הטרור       | ✗     |
|    48 | ▁שלה            | ▁של          | ✗     |
|    49 | ▁החברה          | ▁ח           | ✗     |
|    50 | ות              | מ            | ✗     |
|    51 | אס              | אס           | ✓     |
|    52 | יה              |              | ✗     |

2024-12-31 20:28:38,410 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:28:38,416 - TrainingLogger - INFO - Gradient norm: 12.4180
2024-12-31 20:28:45,512 - TrainingLogger - INFO - Step 24110, Batch metrics: Loss: 7.7706, Accuracy: 0.0448, Perplexity: 2369.9049
2024-12-31 20:28:52,444 - TrainingLogger - INFO - Step 24120, Batch metrics: Loss: 7.5535, Accuracy: 0.0898, Perplexity: 1907.4637
2024-12-31 20:28:59,803 - TrainingLogger - INFO - Step 24130, Batch metrics: Loss: 7.4713, Accuracy: 0.0616, Perplexity: 1756.8023
2024-12-31 20:29:06,831 - TrainingLogger - INFO - Step 24140, Batch metrics: Loss: 7.3480, Accuracy: 0.0852, Perplexity: 1553.0873
2024-12-31 20:29:13,887 - TrainingLogger - INFO - Step 24150, Batch metrics: Loss: 6.9202, Accuracy: 0.0943, Perplexity: 1012.5339
2024-12-31 20:29:21,581 - TrainingLogger - INFO - Step 24160, Batch metrics: Loss: 7.7401, Accuracy: 0.0756, Perplexity: 2298.8007
2024-12-31 20:29:28,469 - TrainingLogger - INFO - Step 24170, Batch metrics: Loss: 8.0008, Accuracy: 0.0143, Perplexity: 2983.4152
2024-12-31 20:29:35,024 - TrainingLogger - INFO - Step 24180, Batch metrics: Loss: 7.6019, Accuracy: 0.0573, Perplexity: 2001.9571
2024-12-31 20:29:42,205 - TrainingLogger - INFO - Step 24190, Batch metrics: Loss: 7.3693, Accuracy: 0.0854, Perplexity: 1586.5824
2024-12-31 20:29:49,535 - TrainingLogger - INFO - Step 24200, Batch metrics: Loss: 6.7597, Accuracy: 0.0608, Perplexity: 862.4121
2024-12-31 20:29:49,536 - TrainingLogger - INFO - Step 24200, Prediction vs Actual:
2024-12-31 20:29:49,536 - TrainingLogger - INFO - Input 1: או שיורים לעברנו, או שיש העברת נשק מתקדם לחיזבאללה
2024-12-31 20:29:49,536 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:29:49,536 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ב               | ▁או          | ✗     |
|     1 | ,               | ▁שי          | ✗     |
|     2 | </s>            | ורים         | ✗     |
|     3 | ▁לי             | ▁לעבר        | ✗     |
|     4 | ם               | נו           | ✗     |
|     5 | </s>            | ,            | ✗     |
|     6 | </s>            | ▁או          | ✗     |
|     7 | ם               | ▁שיש         | ✗     |
|     8 | ▁לנו            | ▁העברת       | ✗     |
|     9 | ם               | ▁נשק         | ✗     |
|    10 | </s>            | ▁מתקדם       | ✗     |
|    11 | </s>            | ▁לח          | ✗     |
|    12 | מה              | יז           | ✗     |
|    13 | ב               | באל          | ✗     |
|    14 | אס              | לה           | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ר               | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ב               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 20:29:49,536 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:29:49,541 - TrainingLogger - INFO - Gradient norm: 11.1040
2024-12-31 20:29:56,323 - TrainingLogger - INFO - Step 24210, Batch metrics: Loss: 7.6865, Accuracy: 0.0472, Perplexity: 2178.6651
2024-12-31 20:30:04,084 - TrainingLogger - INFO - Step 24220, Batch metrics: Loss: 6.9232, Accuracy: 0.1323, Perplexity: 1015.5255
2024-12-31 20:30:11,390 - TrainingLogger - INFO - Step 24230, Batch metrics: Loss: 8.0770, Accuracy: 0.0654, Perplexity: 3219.5743
2024-12-31 20:30:18,982 - TrainingLogger - INFO - Step 24240, Batch metrics: Loss: 7.4436, Accuracy: 0.0982, Perplexity: 1708.8841
2024-12-31 20:30:25,790 - TrainingLogger - INFO - Step 24250, Batch metrics: Loss: 7.5816, Accuracy: 0.0709, Perplexity: 1961.7516
2024-12-31 20:30:32,974 - TrainingLogger - INFO - Step 24260, Batch metrics: Loss: 7.6959, Accuracy: 0.0382, Perplexity: 2199.2996
2024-12-31 20:30:39,980 - TrainingLogger - INFO - Step 24270, Batch metrics: Loss: 7.7568, Accuracy: 0.0659, Perplexity: 2337.4690
2024-12-31 20:30:46,856 - TrainingLogger - INFO - Step 24280, Batch metrics: Loss: 7.3835, Accuracy: 0.0355, Perplexity: 1609.2446
2024-12-31 20:30:53,747 - TrainingLogger - INFO - Step 24290, Batch metrics: Loss: 7.3973, Accuracy: 0.0828, Perplexity: 1631.5907
2024-12-31 20:31:00,912 - TrainingLogger - INFO - Step 24300, Batch metrics: Loss: 7.4876, Accuracy: 0.0788, Perplexity: 1785.7532
2024-12-31 20:31:00,912 - TrainingLogger - INFO - Step 24300, Prediction vs Actual:
2024-12-31 20:31:00,912 - TrainingLogger - INFO - Input 1: בסוף חני קיבלה את התפקיד, אומר גורם לשעבר בליכוד
2024-12-31 20:31:00,913 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:31:00,913 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בסוף        | ✗     |
|     1 | ▁השנה           | ▁חני         | ✗     |
|     2 | נים             | ▁קיבלה       | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | ▁ההזדמנות       | ▁התפקיד      | ✗     |
|     5 | ▁הזה            | ,            | ✗     |
|     6 | </s>            | ▁אומר        | ✗     |
|     7 | ▁את             | ▁גורם        | ✗     |
|     8 | ▁לו             | ▁לשעבר       | ✗     |
|     9 | ,               | ▁בלי         | ✗     |
|    10 | דה              | כו           | ✗     |
|    11 | ף               | ד            | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁חובה           | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2024-12-31 20:31:00,913 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:31:00,918 - TrainingLogger - INFO - Gradient norm: 13.5079
2024-12-31 20:31:08,598 - TrainingLogger - INFO - Step 24310, Batch metrics: Loss: 7.4299, Accuracy: 0.0682, Perplexity: 1685.6071
2024-12-31 20:31:15,755 - TrainingLogger - INFO - Step 24320, Batch metrics: Loss: 7.4299, Accuracy: 0.0474, Perplexity: 1685.7213
2024-12-31 20:31:22,807 - TrainingLogger - INFO - Step 24330, Batch metrics: Loss: 7.6697, Accuracy: 0.0888, Perplexity: 2142.4001
2024-12-31 20:31:29,569 - TrainingLogger - INFO - Step 24340, Batch metrics: Loss: 7.8260, Accuracy: 0.0864, Perplexity: 2504.8138
2024-12-31 20:31:36,959 - TrainingLogger - INFO - Step 24350, Batch metrics: Loss: 7.3350, Accuracy: 0.0606, Perplexity: 1533.0476
2024-12-31 20:31:44,362 - TrainingLogger - INFO - Step 24360, Batch metrics: Loss: 7.9393, Accuracy: 0.0400, Perplexity: 2805.3106
2024-12-31 20:31:51,495 - TrainingLogger - INFO - Step 24370, Batch metrics: Loss: 7.3836, Accuracy: 0.0670, Perplexity: 1609.3029
2024-12-31 20:31:58,432 - TrainingLogger - INFO - Step 24380, Batch metrics: Loss: 7.4451, Accuracy: 0.0933, Perplexity: 1711.5377
2024-12-31 20:32:05,584 - TrainingLogger - INFO - Step 24390, Batch metrics: Loss: 7.4944, Accuracy: 0.0893, Perplexity: 1797.9594
2024-12-31 20:32:12,074 - TrainingLogger - INFO - Step 24400, Batch metrics: Loss: 6.9473, Accuracy: 0.0966, Perplexity: 1040.2973
2024-12-31 20:32:12,074 - TrainingLogger - INFO - Step 24400, Prediction vs Actual:
2024-12-31 20:32:12,074 - TrainingLogger - INFO - Input 1: לחשוקגי היו גם יחסים קרובים עם איל ההון המיליארדר הנסיך אל-ווליד בן-טלאל
2024-12-31 20:32:12,074 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:32:12,074 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלו            | ▁לח          | ✗     |
|     1 | ▁-              | שוק          | ✗     |
|     2 | יים             | גי           | ✗     |
|     3 | ה               | ▁היו         | ✗     |
|     4 | ▁לי             | ▁גם          | ✗     |
|     5 | ▁כן             | ▁יחסים       | ✗     |
|     6 | ▁טובים          | ▁קרובים      | ✗     |
|     7 | ▁יותר           | ▁עם          | ✗     |
|     8 | ▁אנשים          | ▁איל         | ✗     |
|     9 | ם               | ▁הה          | ✗     |
|    10 | ון              | ון           | ✓     |
|    11 | ▁הזה            | ▁ה           | ✗     |
|    12 | שלילי           | מיליארד      | ✗     |
|    13 | י               | ר            | ✗     |
|    14 | .               | ▁הנסיך       | ✗     |
|    15 | .               | ▁אל          | ✗     |
|    16 | יפות            | -            | ✗     |
|    17 | קרב             | וול          | ✗     |
|    18 | ף               | יד           | ✗     |
|    19 | .               | ▁בן          | ✗     |
|    20 | -               | -            | ✓     |
|    21 | ה               | טל           | ✗     |
|    22 | צ               | אל           | ✗     |
|    23 | -               | <pad>        | ✗     |
|    24 | -               | <pad>        | ✗     |
|    25 | -               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | או              | <pad>        | ✗     |
|    28 | ר               |              | ✗     |

2024-12-31 20:32:12,074 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:32:12,079 - TrainingLogger - INFO - Gradient norm: 11.1978
2024-12-31 20:32:19,534 - TrainingLogger - INFO - Step 24410, Batch metrics: Loss: 7.7331, Accuracy: 0.0560, Perplexity: 2282.7240
2024-12-31 20:32:26,588 - TrainingLogger - INFO - Step 24420, Batch metrics: Loss: 7.6569, Accuracy: 0.0888, Perplexity: 2115.1658
2024-12-31 20:32:33,649 - TrainingLogger - INFO - Step 24430, Batch metrics: Loss: 7.6990, Accuracy: 0.0559, Perplexity: 2206.1573
2024-12-31 20:32:41,299 - TrainingLogger - INFO - Step 24440, Batch metrics: Loss: 7.8128, Accuracy: 0.0468, Perplexity: 2471.9657
2024-12-31 20:32:48,374 - TrainingLogger - INFO - Step 24450, Batch metrics: Loss: 7.3053, Accuracy: 0.0747, Perplexity: 1488.1277
2024-12-31 20:32:55,897 - TrainingLogger - INFO - Step 24460, Batch metrics: Loss: 7.4229, Accuracy: 0.0638, Perplexity: 1673.8747
2024-12-31 20:33:03,339 - TrainingLogger - INFO - Step 24470, Batch metrics: Loss: 7.4848, Accuracy: 0.0492, Perplexity: 1780.7550
2024-12-31 20:33:10,438 - TrainingLogger - INFO - Step 24480, Batch metrics: Loss: 7.9257, Accuracy: 0.0909, Perplexity: 2767.6321
2024-12-31 20:33:17,173 - TrainingLogger - INFO - Step 24490, Batch metrics: Loss: 7.8171, Accuracy: 0.0504, Perplexity: 2482.7059
2024-12-31 20:33:24,365 - TrainingLogger - INFO - Step 24500, Batch metrics: Loss: 7.0164, Accuracy: 0.0914, Perplexity: 1114.7756
2024-12-31 20:33:24,365 - TrainingLogger - INFO - Step 24500, Prediction vs Actual:
2024-12-31 20:33:24,365 - TrainingLogger - INFO - Input 1: אחרי שקיבלתי את ההודעה, צילצלתי למוקד 100 של המשטרה ודיווחתי שאבא שלי נחטף
2024-12-31 20:33:24,366 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:33:24,366 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אחרי        | ✗     |
|     1 | ▁-              | ▁שקיבלתי     | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁זה             | ▁ההודעה      | ✗     |
|     4 | <pad>           | ,            | ✗     |
|     5 | ▁אני            | ▁צילצל       | ✗     |
|     6 | ה               | תי           | ✗     |
|     7 | ▁את             | ▁למוקד       | ✗     |
|     8 | ,               | ▁100         | ✗     |
|     9 | ▁מיליון         | ▁של          | ✗     |
|    10 | ▁אנשים          | ▁המשטרה      | ✗     |
|    11 | ,               | ▁ו           | ✗     |
|    12 | מדי             | דיווח        | ✗     |
|    13 | ו               | תי           | ✗     |
|    14 | ▁על             | ▁שאבא        | ✗     |
|    15 | ת               | ▁שלי         | ✗     |
|    16 | ▁לא             | ▁נחטף        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁עליו           | <pad>        | ✗     |
|    40 | ▁על             | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ,               | <pad>        | ✗     |
|    46 | ▁עליו           | <pad>        | ✗     |
|    47 | ,               | <pad>        | ✗     |
|    48 | ▁עליו           | <pad>        | ✗     |
|    49 | ▁על             |              | ✗     |

2024-12-31 20:33:24,366 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:33:24,371 - TrainingLogger - INFO - Gradient norm: 11.9368
2024-12-31 20:33:31,223 - TrainingLogger - INFO - Step 24510, Batch metrics: Loss: 7.4882, Accuracy: 0.0888, Perplexity: 1786.8784
2024-12-31 20:33:38,411 - TrainingLogger - INFO - Step 24520, Batch metrics: Loss: 7.2815, Accuracy: 0.0755, Perplexity: 1453.1417
2024-12-31 20:33:45,170 - TrainingLogger - INFO - Step 24530, Batch metrics: Loss: 7.5795, Accuracy: 0.1022, Perplexity: 1957.5793
2024-12-31 20:33:52,093 - TrainingLogger - INFO - Step 24540, Batch metrics: Loss: 7.8060, Accuracy: 0.0674, Perplexity: 2455.3862
2024-12-31 20:33:59,225 - TrainingLogger - INFO - Step 24550, Batch metrics: Loss: 7.3645, Accuracy: 0.0658, Perplexity: 1578.9161
2024-12-31 20:34:06,467 - TrainingLogger - INFO - Step 24560, Batch metrics: Loss: 7.2389, Accuracy: 0.0929, Perplexity: 1392.6054
2024-12-31 20:34:13,941 - TrainingLogger - INFO - Step 24570, Batch metrics: Loss: 7.1473, Accuracy: 0.1009, Perplexity: 1270.6072
2024-12-31 20:34:20,915 - TrainingLogger - INFO - Step 24580, Batch metrics: Loss: 7.9899, Accuracy: 0.0377, Perplexity: 2951.0092
2024-12-31 20:34:28,430 - TrainingLogger - INFO - Step 24590, Batch metrics: Loss: 7.4515, Accuracy: 0.0745, Perplexity: 1722.4275
2024-12-31 20:34:35,765 - TrainingLogger - INFO - Step 24600, Batch metrics: Loss: 7.6762, Accuracy: 0.0437, Perplexity: 2156.4076
2024-12-31 20:34:35,766 - TrainingLogger - INFO - Step 24600, Prediction vs Actual:
2024-12-31 20:34:35,766 - TrainingLogger - INFO - Input 1: מה זה שייח גראח? זה שמעון הצדיק
2024-12-31 20:34:35,766 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:34:35,766 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מה          | ✗     |
|     1 | ?               | ▁זה          | ✗     |
|     2 | ▁לא             | ▁שיי         | ✗     |
|     3 | ב               | ח            | ✗     |
|     4 | ים              | ▁גר          | ✗     |
|     5 | ▁פה             | אח           | ✗     |
|     6 | ים              | ?            | ✗     |
|     7 | </s>            | ▁זה          | ✗     |
|     8 | ▁לא             | ▁שמעון       | ✗     |
|     9 | .               | ▁הצדיק       | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁שלי            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ?               | <pad>        | ✗     |
|    38 | ?               | <pad>        | ✗     |
|    39 | ?               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ,               |              | ✗     |

2024-12-31 20:34:35,766 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:34:35,771 - TrainingLogger - INFO - Gradient norm: 10.7697
2024-12-31 20:34:43,224 - TrainingLogger - INFO - Step 24610, Batch metrics: Loss: 7.3198, Accuracy: 0.0963, Perplexity: 1509.8370
2024-12-31 20:34:50,365 - TrainingLogger - INFO - Step 24620, Batch metrics: Loss: 7.8797, Accuracy: 0.0702, Perplexity: 2642.9855
2024-12-31 20:34:57,932 - TrainingLogger - INFO - Step 24630, Batch metrics: Loss: 7.4981, Accuracy: 0.0886, Perplexity: 1804.6660
2024-12-31 20:35:05,580 - TrainingLogger - INFO - Step 24640, Batch metrics: Loss: 7.4360, Accuracy: 0.0538, Perplexity: 1695.9049
2024-12-31 20:35:12,685 - TrainingLogger - INFO - Step 24650, Batch metrics: Loss: 7.7680, Accuracy: 0.0743, Perplexity: 2363.6785
2024-12-31 20:35:20,193 - TrainingLogger - INFO - Step 24660, Batch metrics: Loss: 7.6870, Accuracy: 0.0458, Perplexity: 2179.8321
2024-12-31 20:35:27,392 - TrainingLogger - INFO - Step 24670, Batch metrics: Loss: 7.8097, Accuracy: 0.0374, Perplexity: 2464.4087
2024-12-31 20:35:35,334 - TrainingLogger - INFO - Step 24680, Batch metrics: Loss: 6.8141, Accuracy: 0.1107, Perplexity: 910.5804
2024-12-31 20:35:42,438 - TrainingLogger - INFO - Step 24690, Batch metrics: Loss: 7.8447, Accuracy: 0.0806, Perplexity: 2552.0742
2024-12-31 20:35:49,829 - TrainingLogger - INFO - Step 24700, Batch metrics: Loss: 7.4304, Accuracy: 0.0639, Perplexity: 1686.4971
2024-12-31 20:35:49,830 - TrainingLogger - INFO - Step 24700, Prediction vs Actual:
2024-12-31 20:35:49,830 - TrainingLogger - INFO - Input 1: אפרוני זכור גם מהמסך הגדול, ושיחק בסרטי קולנוע רבים שהשאירו חותם בתרבות הישראלית
2024-12-31 20:35:49,830 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:35:49,831 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | רה              | ▁אפר         | ✗     |
|     1 | ▁גרמניה         | וני          | ✗     |
|     2 | סט              | ▁זכור        | ✗     |
|     3 | ה               | ▁גם          | ✗     |
|     4 | ▁בשל            | ▁מה          | ✗     |
|     5 | פך              | מסך          | ✗     |
|     6 | ▁הזה            | ▁הגדול       | ✗     |
|     7 | ▁ביותר          | ,            | ✗     |
|     8 | ב               | ▁ו           | ✗     |
|     9 | "               | שיח          | ✗     |
|    10 | ק               | ק            | ✓     |
|    11 | תם              | ▁בסרט        | ✗     |
|    12 | ון              | י            | ✗     |
|    13 | ▁"              | ▁קולנוע      | ✗     |
|    14 | ,               | ▁רבים        | ✗     |
|    15 | ,               | ▁שהשאיר      | ✗     |
|    16 | ו               | ו            | ✓     |
|    17 | ▁את             | ▁חותם        | ✗     |
|    18 | ▁על             | ▁בתרבות      | ✗     |
|    19 | ▁ישראל          | ▁הישראלי     | ✗     |
|    20 | ת               | ת            | ✓     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁על             | <pad>        | ✗     |
|    29 | ▁ב              | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ▁עד             | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | -               | <pad>        | ✗     |
|    37 | ה               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ▁עד             | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | ,               | <pad>        | ✗     |
|    43 | ▁עד             | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ▁עד             | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | ,               | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | .               | <pad>        | ✗     |
|    50 | ▁על             | <pad>        | ✗     |
|    51 | ▁עד             | <pad>        | ✗     |
|    52 | ה               | <pad>        | ✗     |
|    53 | ▁על             | <pad>        | ✗     |
|    54 | ,               | <pad>        | ✗     |
|    55 | ,               | <pad>        | ✗     |
|    56 | ▁על             | <pad>        | ✗     |
|    57 | ,               | <pad>        | ✗     |
|    58 | </s>            |              | ✗     |

2024-12-31 20:35:49,831 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:35:49,836 - TrainingLogger - INFO - Gradient norm: 9.1781
2024-12-31 20:35:57,169 - TrainingLogger - INFO - Step 24710, Batch metrics: Loss: 7.6079, Accuracy: 0.0892, Perplexity: 2014.1050
2024-12-31 20:36:03,893 - TrainingLogger - INFO - Step 24720, Batch metrics: Loss: 7.5542, Accuracy: 0.0559, Perplexity: 1908.8231
2024-12-31 20:36:11,150 - TrainingLogger - INFO - Step 24730, Batch metrics: Loss: 7.2033, Accuracy: 0.0894, Perplexity: 1343.8120
2024-12-31 20:36:18,264 - TrainingLogger - INFO - Step 24740, Batch metrics: Loss: 7.6244, Accuracy: 0.0564, Perplexity: 2047.6378
2024-12-31 20:36:25,373 - TrainingLogger - INFO - Step 24750, Batch metrics: Loss: 7.4280, Accuracy: 0.0506, Perplexity: 1682.5011
2024-12-31 20:36:32,499 - TrainingLogger - INFO - Step 24760, Batch metrics: Loss: 7.4925, Accuracy: 0.0670, Perplexity: 1794.5128
2024-12-31 20:36:40,220 - TrainingLogger - INFO - Step 24770, Batch metrics: Loss: 7.2987, Accuracy: 0.0794, Perplexity: 1478.4273
2024-12-31 20:36:47,465 - TrainingLogger - INFO - Step 24780, Batch metrics: Loss: 7.0983, Accuracy: 0.0976, Perplexity: 1209.8681
2024-12-31 20:36:54,231 - TrainingLogger - INFO - Step 24790, Batch metrics: Loss: 7.3638, Accuracy: 0.0920, Perplexity: 1577.8345
2024-12-31 20:37:01,510 - TrainingLogger - INFO - Step 24800, Batch metrics: Loss: 7.7690, Accuracy: 0.0577, Perplexity: 2366.0658
2024-12-31 20:37:01,510 - TrainingLogger - INFO - Step 24800, Prediction vs Actual:
2024-12-31 20:37:01,510 - TrainingLogger - INFO - Input 1: לא הייתה הפתעה גדולה בהחלטה של שר האוצר אביגדור ליברמן להפסיק את הסבסוד של מעונות היום לזוגות שאחד מהם לא עובד
2024-12-31 20:37:01,511 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:37:01,511 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ון              | ▁לא          | ✗     |
|     1 | ▁-              | ▁הייתה       | ✗     |
|     2 | ▁-              | ▁הפתעה       | ✗     |
|     3 | ?               | ▁גדולה       | ✗     |
|     4 | .               | ▁בהחלט       | ✗     |
|     5 | .               | ה            | ✗     |
|     6 | ▁הזאת           | ▁של          | ✗     |
|     7 | ▁יום            | ▁שר          | ✗     |
|     8 | צים             | ▁האוצר       | ✗     |
|     9 | .               | ▁אבי         | ✗     |
|    10 | .               | ג            | ✗     |
|    11 | '               | דור          | ✗     |
|    12 | ת               | ▁לי          | ✗     |
|    13 | .               | ברמן         | ✗     |
|    14 | .               | ▁להפסיק      | ✗     |
|    15 | ▁את             | ▁את          | ✓     |
|    16 | ▁העבודה         | ▁הסב         | ✗     |
|    17 | ה               | סוד          | ✗     |
|    18 | ▁הזה            | ▁של          | ✗     |
|    19 | ▁יום            | ▁מ           | ✗     |
|    20 | ועצת            | עונות        | ✗     |
|    21 | ▁ה              | ▁היום        | ✗     |
|    22 | ▁הראשון         | ▁לזוגות      | ✗     |
|    23 | ▁חדשים          | ▁שאחד        | ✗     |
|    24 | ים              | ▁מהם         | ✗     |
|    25 | .               | ▁לא          | ✗     |
|    26 | ▁היה            | ▁עובד        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁עד             | <pad>        | ✗     |
|    34 | ▁עד             | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ▁עד             | <pad>        | ✗     |
|    38 | ▁עד             | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ▁עד             | <pad>        | ✗     |
|    41 | ▁את             |              | ✗     |

2024-12-31 20:37:01,511 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:37:01,516 - TrainingLogger - INFO - Gradient norm: 13.7937
2024-12-31 20:37:08,608 - TrainingLogger - INFO - Step 24810, Batch metrics: Loss: 7.5975, Accuracy: 0.0657, Perplexity: 1993.2215
2024-12-31 20:37:16,034 - TrainingLogger - INFO - Step 24820, Batch metrics: Loss: 7.3324, Accuracy: 0.0643, Perplexity: 1529.0578
2024-12-31 20:37:23,325 - TrainingLogger - INFO - Step 24830, Batch metrics: Loss: 7.4984, Accuracy: 0.0769, Perplexity: 1805.1307
2024-12-31 20:37:30,266 - TrainingLogger - INFO - Step 24840, Batch metrics: Loss: 7.4840, Accuracy: 0.0560, Perplexity: 1779.4096
2024-12-31 20:37:37,319 - TrainingLogger - INFO - Step 24850, Batch metrics: Loss: 7.3743, Accuracy: 0.0602, Perplexity: 1594.5475
2024-12-31 20:37:44,639 - TrainingLogger - INFO - Step 24860, Batch metrics: Loss: 6.8202, Accuracy: 0.1258, Perplexity: 916.1647
2024-12-31 20:37:51,852 - TrainingLogger - INFO - Step 24870, Batch metrics: Loss: 7.4943, Accuracy: 0.0696, Perplexity: 1797.8446
2024-12-31 20:37:58,889 - TrainingLogger - INFO - Step 24880, Batch metrics: Loss: 7.5080, Accuracy: 0.0776, Perplexity: 1822.6228
2024-12-31 20:38:07,493 - TrainingLogger - INFO - Step 24890, Batch metrics: Loss: 7.5720, Accuracy: 0.0727, Perplexity: 1942.9780
2024-12-31 20:38:14,875 - TrainingLogger - INFO - Step 24900, Batch metrics: Loss: 7.6132, Accuracy: 0.0752, Perplexity: 2024.6807
2024-12-31 20:38:14,876 - TrainingLogger - INFO - Step 24900, Prediction vs Actual:
2024-12-31 20:38:14,876 - TrainingLogger - INFO - Input 1: בסרטון אחר שצולם אתמול נראו מאות מפגינים משחיתים פסל, מרססים עליו כתוביות נגד ישראל וארהב ומשליכים עליו צבע וחפצים, כשקצין אחד עומד ומנסה לשמור על הפסל
2024-12-31 20:38:14,877 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:38:14,877 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בסרט        | ✗     |
|     1 | ▁-              | ון           | ✗     |
|     2 | ,               | ▁אחר         | ✗     |
|     3 | ▁-              | ▁שצ          | ✗     |
|     4 | פר              | ולם          | ✗     |
|     5 | ,               | ▁אתמול       | ✗     |
|     6 | ▁בלילה          | ▁נראו        | ✗     |
|     7 | ▁לי             | ▁מאות        | ✗     |
|     8 | ▁אנשים          | ▁            | ✗     |
|     9 | עונות           | מפגינים      | ✗     |
|    10 | ▁חדשים          | ▁משחית       | ✗     |
|    11 | ים              | ים           | ✓     |
|    12 | ▁חדשים          | ▁פסל         | ✗     |
|    13 | ים              | ,            | ✗     |
|    14 | </s>            | ▁מר          | ✗     |
|    15 | ים              | סס           | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ,               | ▁עליו        | ✗     |
|    18 | נים             | ▁כתוביות     | ✗     |
|    19 | ,               | ▁נגד         | ✗     |
|    20 | ים              | ▁ישראל       | ✗     |
|    21 | ,               | ▁ואר         | ✗     |
|    22 | ם               | ה            | ✗     |
|    23 | ים              | ב            | ✗     |
|    24 | אן              | ▁ו           | ✗     |
|    25 | נוס             | משלי         | ✗     |
|    26 | ,               | כים          | ✗     |
|    27 | ▁רבים           | ▁עליו        | ✗     |
|    28 | .               | ▁צבע         | ✗     |
|    29 | ם               | ▁ו           | ✗     |
|    30 | שחור            | חפצים        | ✗     |
|    31 | ▁חדשים          | ,            | ✗     |
|    32 | </s>            | ▁כש          | ✗     |
|    33 | ב               | קצין         | ✗     |
|    34 | ,               | ▁אחד         | ✗     |
|    35 | ים              | ▁עומד        | ✗     |
|    36 | ▁שם             | ▁ומנסה       | ✗     |
|    37 | ון              | ▁לשמור       | ✗     |
|    38 | ▁על             | ▁על          | ✓     |
|    39 | ▁ראש            | ▁הפסל        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ו               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ים              | <pad>        | ✗     |
|    46 | ים              | <pad>        | ✗     |
|    47 | ,               | <pad>        | ✗     |
|    48 | .               | <pad>        | ✗     |
|    49 | ,               | <pad>        | ✗     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | .               | <pad>        | ✗     |
|    52 | </s>            |              | ✗     |

2024-12-31 20:38:14,877 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:38:14,882 - TrainingLogger - INFO - Gradient norm: 11.2358
2024-12-31 20:38:21,721 - TrainingLogger - INFO - Step 24910, Batch metrics: Loss: 7.5129, Accuracy: 0.0867, Perplexity: 1831.5982
2024-12-31 20:38:28,562 - TrainingLogger - INFO - Step 24920, Batch metrics: Loss: 7.7698, Accuracy: 0.0526, Perplexity: 2368.0613
2024-12-31 20:38:36,271 - TrainingLogger - INFO - Step 24930, Batch metrics: Loss: 7.4445, Accuracy: 0.0717, Perplexity: 1710.3752
2024-12-31 20:38:43,490 - TrainingLogger - INFO - Step 24940, Batch metrics: Loss: 7.4304, Accuracy: 0.0889, Perplexity: 1686.4714
2024-12-31 20:38:50,406 - TrainingLogger - INFO - Step 24950, Batch metrics: Loss: 7.6106, Accuracy: 0.0678, Perplexity: 2019.5000
2024-12-31 20:38:57,893 - TrainingLogger - INFO - Step 24960, Batch metrics: Loss: 7.6700, Accuracy: 0.0769, Perplexity: 2143.1818
2024-12-31 20:39:05,389 - TrainingLogger - INFO - Step 24970, Batch metrics: Loss: 7.3673, Accuracy: 0.0667, Perplexity: 1583.3515
2024-12-31 20:39:12,956 - TrainingLogger - INFO - Step 24980, Batch metrics: Loss: 7.4835, Accuracy: 0.0941, Perplexity: 1778.3841
2024-12-31 20:39:20,310 - TrainingLogger - INFO - Step 24990, Batch metrics: Loss: 7.7453, Accuracy: 0.0732, Perplexity: 2310.7137
2024-12-31 20:39:27,502 - TrainingLogger - INFO - Step 25000, Batch metrics: Loss: 7.3240, Accuracy: 0.0722, Perplexity: 1516.3138
2024-12-31 20:39:27,502 - TrainingLogger - INFO - Step 25000, Prediction vs Actual:
2024-12-31 20:39:27,502 - TrainingLogger - INFO - Input 1: הלכתי אליו, ישבנו שם שעתיים, אחר כך הוא היה אצלי בבית בכוכב יאיר
2024-12-31 20:39:27,503 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:39:27,503 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁עוד            | ▁הלכתי       | ✗     |
|     1 | ▁-              | ▁אליו        | ✗     |
|     2 | .               | ,            | ✗     |
|     3 | ▁הוא            | ▁ישבנו       | ✗     |
|     4 | ▁על             | ▁שם          | ✗     |
|     5 | .               | ▁שעתיים      | ✗     |
|     6 | ,               | ,            | ✓     |
|     7 | ▁זה             | ▁אחר         | ✗     |
|     8 | ▁כך             | ▁כך          | ✓     |
|     9 | .               | ▁הוא         | ✗     |
|    10 | ▁נעלם           | ▁היה         | ✗     |
|    11 | ▁שם             | ▁אצלי        | ✗     |
|    12 | .               | ▁בבית        | ✗     |
|    13 | .               | ▁בכוכב       | ✗     |
|    14 | .               | ▁יאיר        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁והוא           | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ▁הוא            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 20:39:27,503 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:39:27,508 - TrainingLogger - INFO - Gradient norm: 9.8024
2024-12-31 20:39:34,989 - TrainingLogger - INFO - Step 25010, Batch metrics: Loss: 7.2920, Accuracy: 0.0517, Perplexity: 1468.5465
2024-12-31 20:39:42,416 - TrainingLogger - INFO - Step 25020, Batch metrics: Loss: 7.1294, Accuracy: 0.0917, Perplexity: 1248.1419
2024-12-31 20:39:49,764 - TrainingLogger - INFO - Step 25030, Batch metrics: Loss: 7.0209, Accuracy: 0.1082, Perplexity: 1119.7686
2024-12-31 20:39:57,070 - TrainingLogger - INFO - Step 25040, Batch metrics: Loss: 7.9969, Accuracy: 0.0635, Perplexity: 2971.8549
2024-12-31 20:40:04,374 - TrainingLogger - INFO - Step 25050, Batch metrics: Loss: 7.7522, Accuracy: 0.0545, Perplexity: 2326.6880
2024-12-31 20:40:11,557 - TrainingLogger - INFO - Step 25060, Batch metrics: Loss: 7.1846, Accuracy: 0.0563, Perplexity: 1318.9444
2024-12-31 20:40:18,431 - TrainingLogger - INFO - Step 25070, Batch metrics: Loss: 7.3863, Accuracy: 0.0743, Perplexity: 1613.7398
2024-12-31 20:40:25,379 - TrainingLogger - INFO - Step 25080, Batch metrics: Loss: 7.7247, Accuracy: 0.0887, Perplexity: 2263.6478
2024-12-31 20:40:32,126 - TrainingLogger - INFO - Step 25090, Batch metrics: Loss: 7.4399, Accuracy: 0.0882, Perplexity: 1702.6367
2024-12-31 20:40:39,063 - TrainingLogger - INFO - Step 25100, Batch metrics: Loss: 7.8184, Accuracy: 0.0530, Perplexity: 2485.9944
2024-12-31 20:40:39,063 - TrainingLogger - INFO - Step 25100, Prediction vs Actual:
2024-12-31 20:40:39,063 - TrainingLogger - INFO - Input 1: למדנו משהו מהאכזבה של המהפכה המרקסיסטית
2024-12-31 20:40:39,064 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:40:39,064 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁למדנו       | ✗     |
|     1 | ד               | ▁משהו        | ✗     |
|     2 | ▁חדש            | ▁מה          | ✗     |
|     3 | דור             | אכזב         | ✗     |
|     4 | ה               | ה            | ✓     |
|     5 | ▁שלנו           | ▁של          | ✗     |
|     6 | ▁המדינה         | ▁המהפכה      | ✗     |
|     7 | .               | ▁המרק        | ✗     |
|     8 | יבה             | ס            | ✗     |
|     9 | יסטית           | יסטית        | ✓     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁של             | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ה               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ית              | <pad>        | ✗     |
|    20 | ית              | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | בית             | <pad>        | ✗     |
|    23 | ית              | <pad>        | ✗     |
|    24 | ת               | <pad>        | ✗     |
|    25 | ת               | <pad>        | ✗     |
|    26 | ת               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            |              | ✗     |

2024-12-31 20:40:39,064 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:40:39,069 - TrainingLogger - INFO - Gradient norm: 11.1470
2024-12-31 20:40:46,534 - TrainingLogger - INFO - Step 25110, Batch metrics: Loss: 7.4932, Accuracy: 0.0678, Perplexity: 1795.8525
2024-12-31 20:40:53,778 - TrainingLogger - INFO - Step 25120, Batch metrics: Loss: 7.4225, Accuracy: 0.0833, Perplexity: 1673.2091
2024-12-31 20:41:00,791 - TrainingLogger - INFO - Step 25130, Batch metrics: Loss: 7.1720, Accuracy: 0.0726, Perplexity: 1302.4114
2024-12-31 20:41:07,551 - TrainingLogger - INFO - Step 25140, Batch metrics: Loss: 7.6665, Accuracy: 0.0437, Perplexity: 2135.6785
2024-12-31 20:41:14,632 - TrainingLogger - INFO - Step 25150, Batch metrics: Loss: 7.4239, Accuracy: 0.0515, Perplexity: 1675.6340
2024-12-31 20:41:21,942 - TrainingLogger - INFO - Step 25160, Batch metrics: Loss: 7.7706, Accuracy: 0.0833, Perplexity: 2370.0066
2024-12-31 20:41:29,602 - TrainingLogger - INFO - Step 25170, Batch metrics: Loss: 7.4033, Accuracy: 0.0899, Perplexity: 1641.4458
2024-12-31 20:41:36,273 - TrainingLogger - INFO - Step 25180, Batch metrics: Loss: 7.2474, Accuracy: 0.1124, Perplexity: 1404.4442
2024-12-31 20:41:43,234 - TrainingLogger - INFO - Step 25190, Batch metrics: Loss: 7.4741, Accuracy: 0.0866, Perplexity: 1761.8676
2024-12-31 20:41:50,025 - TrainingLogger - INFO - Step 25200, Batch metrics: Loss: 7.2379, Accuracy: 0.0779, Perplexity: 1391.1273
2024-12-31 20:41:50,026 - TrainingLogger - INFO - Step 25200, Prediction vs Actual:
2024-12-31 20:41:50,026 - TrainingLogger - INFO - Input 1: אני רוחש כבוד לאלה שבעבר נודו, הושפלו, נרדפו ונרצחו על ידי גרמניה אחרת של שום היותם יהודים
2024-12-31 20:41:50,026 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:41:50,026 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | .               | ▁רוחש        | ✗     |
|     2 | תי              | ▁כבוד        | ✗     |
|     3 | .               | ▁לאלה        | ✗     |
|     4 | .               | ▁שבעבר       | ✗     |
|     5 | י               | ▁נו          | ✗     |
|     6 | צה              | דו           | ✗     |
|     7 | נו              | ,            | ✗     |
|     8 | </s>            | ▁הו          | ✗     |
|     9 | -               | שפל          | ✗     |
|    10 | תי              | ו            | ✗     |
|    11 | ▁ע              | ,            | ✗     |
|    12 | </s>            | ▁נרד         | ✗     |
|    13 | פתי             | פו           | ✗     |
|    14 | ,               | ▁ו           | ✗     |
|    15 | נו              | נרצח         | ✗     |
|    16 | ו               | ו            | ✓     |
|    17 | ,               | ▁על          | ✗     |
|    18 | ▁ידי            | ▁ידי         | ✓     |
|    19 | ▁בני            | ▁גרמניה      | ✗     |
|    20 | </s>            | ▁אחרת        | ✗     |
|    21 | .               | ▁של          | ✗     |
|    22 | ▁המדינה         | ▁שום         | ✗     |
|    23 | ▁דבר            | ▁היו         | ✗     |
|    24 | ו               | תם           | ✗     |
|    25 | .               | ▁יהודים      | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | יים             | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ים              |              | ✗     |

2024-12-31 20:41:50,026 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:41:50,031 - TrainingLogger - INFO - Gradient norm: 10.3452
2024-12-31 20:41:57,167 - TrainingLogger - INFO - Step 25210, Batch metrics: Loss: 7.4835, Accuracy: 0.0703, Perplexity: 1778.4477
2024-12-31 20:42:04,312 - TrainingLogger - INFO - Step 25220, Batch metrics: Loss: 7.8350, Accuracy: 0.0191, Perplexity: 2527.5332
2024-12-31 20:42:11,759 - TrainingLogger - INFO - Step 25230, Batch metrics: Loss: 7.4411, Accuracy: 0.0864, Perplexity: 1704.6432
2024-12-31 20:42:18,834 - TrainingLogger - INFO - Step 25240, Batch metrics: Loss: 7.6708, Accuracy: 0.0546, Perplexity: 2144.7132
2024-12-31 20:42:26,426 - TrainingLogger - INFO - Step 25250, Batch metrics: Loss: 7.6492, Accuracy: 0.0829, Perplexity: 2099.0007
2024-12-31 20:42:33,193 - TrainingLogger - INFO - Step 25260, Batch metrics: Loss: 8.0643, Accuracy: 0.0655, Perplexity: 3178.9167
2024-12-31 20:42:40,866 - TrainingLogger - INFO - Step 25270, Batch metrics: Loss: 7.6311, Accuracy: 0.0608, Perplexity: 2061.3962
2024-12-31 20:42:48,098 - TrainingLogger - INFO - Step 25280, Batch metrics: Loss: 7.3184, Accuracy: 0.0725, Perplexity: 1507.7945
2024-12-31 20:42:55,445 - TrainingLogger - INFO - Step 25290, Batch metrics: Loss: 7.4923, Accuracy: 0.0791, Perplexity: 1794.1244
2024-12-31 20:43:01,976 - TrainingLogger - INFO - Step 25300, Batch metrics: Loss: 7.6946, Accuracy: 0.0649, Perplexity: 2196.5244
2024-12-31 20:43:01,977 - TrainingLogger - INFO - Step 25300, Prediction vs Actual:
2024-12-31 20:43:01,977 - TrainingLogger - INFO - Input 1: גם למלצרים לא קל בתקופה הזו
2024-12-31 20:43:01,977 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:43:01,977 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁גם          | ✗     |
|     1 | .               | ▁למל         | ✗     |
|     2 | ות              | צרים         | ✗     |
|     3 | ▁לא             | ▁לא          | ✓     |
|     4 | ▁היה            | ▁קל          | ✗     |
|     5 | ו               | ▁בתקופה      | ✗     |
|     6 | ▁זו             | ▁הזו         | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ה               | <pad>        | ✗     |
|    10 | ▁היא            | <pad>        | ✗     |
|    11 | ▁להגיע          | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 20:43:01,977 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:43:01,982 - TrainingLogger - INFO - Gradient norm: 9.5354
2024-12-31 20:43:09,028 - TrainingLogger - INFO - Step 25310, Batch metrics: Loss: 7.2900, Accuracy: 0.0918, Perplexity: 1465.6210
2024-12-31 20:43:16,086 - TrainingLogger - INFO - Step 25320, Batch metrics: Loss: 7.9079, Accuracy: 0.0833, Perplexity: 2718.6839
2024-12-31 20:43:23,001 - TrainingLogger - INFO - Step 25330, Batch metrics: Loss: 7.9307, Accuracy: 0.0577, Perplexity: 2781.4774
2024-12-31 20:43:30,075 - TrainingLogger - INFO - Step 25340, Batch metrics: Loss: 7.5836, Accuracy: 0.0636, Perplexity: 1965.6497
2024-12-31 20:43:37,765 - TrainingLogger - INFO - Step 25350, Batch metrics: Loss: 7.4811, Accuracy: 0.0680, Perplexity: 1774.1551
2024-12-31 20:43:45,125 - TrainingLogger - INFO - Step 25360, Batch metrics: Loss: 7.3357, Accuracy: 0.0729, Perplexity: 1534.1064
2024-12-31 20:43:52,450 - TrainingLogger - INFO - Step 25370, Batch metrics: Loss: 7.2082, Accuracy: 0.0925, Perplexity: 1350.4882
2024-12-31 20:43:59,791 - TrainingLogger - INFO - Step 25380, Batch metrics: Loss: 8.0527, Accuracy: 0.0600, Perplexity: 3142.3847
2024-12-31 20:44:07,018 - TrainingLogger - INFO - Step 25390, Batch metrics: Loss: 7.2281, Accuracy: 0.0582, Perplexity: 1377.5669
2024-12-31 20:44:14,082 - TrainingLogger - INFO - Step 25400, Batch metrics: Loss: 7.7972, Accuracy: 0.0765, Perplexity: 2433.6600
2024-12-31 20:44:14,082 - TrainingLogger - INFO - Step 25400, Prediction vs Actual:
2024-12-31 20:44:14,115 - TrainingLogger - INFO - Input 1: וזה טבעי, כיוון שבעיניים של המועמד הוא משקיע פה מזמנו הפנוי ומהאנרגיה שלו עבור תפקיד שעדיין לא שלו, ועבור ארגון שהוא אפילו לא חלק ממנו
2024-12-31 20:44:14,116 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:44:14,116 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁וזה         | ✗     |
|     1 | ▁-              | ▁טבעי        | ✗     |
|     2 | ,               | ,            | ✓     |
|     3 | ▁אני            | ▁כיוון       | ✗     |
|     4 | ▁שהוא           | ▁שב          | ✗     |
|     5 | ג               | עיניים       | ✗     |
|     6 | ▁אחרות          | ▁של          | ✗     |
|     7 | ▁תקווה          | ▁המועמד      | ✗     |
|     8 | ▁ל              | ▁הוא         | ✗     |
|     9 | ▁לא             | ▁משקיע       | ✗     |
|    10 | ▁את             | ▁פה          | ✗     |
|    11 | ,               | ▁מ           | ✗     |
|    12 | חיה             | זמנו         | ✗     |
|    13 | ,               | ▁הפנוי       | ✗     |
|    14 | ,               | ▁ומה         | ✗     |
|    15 | לך              | אנרגיה       | ✗     |
|    16 | ▁שלו            | ▁שלו         | ✓     |
|    17 | ,               | ▁עבור        | ✗     |
|    18 | ▁כל             | ▁תפקיד       | ✗     |
|    19 | ו               | ▁שעדיין      | ✗     |
|    20 | ▁לא             | ▁לא          | ✓     |
|    21 | ▁היה            | ▁שלו         | ✗     |
|    22 | .               | ,            | ✗     |
|    23 | </s>            | ▁ועבור       | ✗     |
|    24 | ו               | ▁ארגון       | ✗     |
|    25 | ▁המדינה         | ▁שהוא        | ✗     |
|    26 | ▁לא             | ▁אפילו       | ✗     |
|    27 | ▁לא             | ▁לא          | ✓     |
|    28 | ▁יכול           | ▁חלק         | ✗     |
|    29 | ▁מה             | ▁ממנו        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2024-12-31 20:44:14,116 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:44:14,122 - TrainingLogger - INFO - Gradient norm: 11.9979
2024-12-31 20:44:21,031 - TrainingLogger - INFO - Step 25410, Batch metrics: Loss: 7.1089, Accuracy: 0.1044, Perplexity: 1222.7692
2024-12-31 20:44:28,402 - TrainingLogger - INFO - Step 25420, Batch metrics: Loss: 7.2919, Accuracy: 0.0838, Perplexity: 1468.3967
2024-12-31 20:44:35,560 - TrainingLogger - INFO - Step 25430, Batch metrics: Loss: 7.6745, Accuracy: 0.0691, Perplexity: 2152.6865
2024-12-31 20:44:42,616 - TrainingLogger - INFO - Step 25440, Batch metrics: Loss: 7.5277, Accuracy: 0.0825, Perplexity: 1858.8482
2024-12-31 20:44:49,738 - TrainingLogger - INFO - Step 25450, Batch metrics: Loss: 7.5752, Accuracy: 0.0459, Perplexity: 1949.2372
2024-12-31 20:44:56,763 - TrainingLogger - INFO - Step 25460, Batch metrics: Loss: 7.0303, Accuracy: 0.0915, Perplexity: 1130.3143
2024-12-31 20:45:03,846 - TrainingLogger - INFO - Step 25470, Batch metrics: Loss: 7.9670, Accuracy: 0.0585, Perplexity: 2884.1038
2024-12-31 20:45:11,127 - TrainingLogger - INFO - Step 25480, Batch metrics: Loss: 7.8577, Accuracy: 0.0449, Perplexity: 2585.4986
2024-12-31 20:45:18,312 - TrainingLogger - INFO - Step 25490, Batch metrics: Loss: 7.0806, Accuracy: 0.0844, Perplexity: 1188.6682
2024-12-31 20:45:25,321 - TrainingLogger - INFO - Step 25500, Batch metrics: Loss: 7.4239, Accuracy: 0.0515, Perplexity: 1675.4965
2024-12-31 20:45:25,322 - TrainingLogger - INFO - Step 25500, Prediction vs Actual:
2024-12-31 20:45:25,322 - TrainingLogger - INFO - Input 1: נכון, לכן אל תהיה מאוהב ברעיונות ובעקרונות שלא מניבים ערך
2024-12-31 20:45:25,322 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:45:25,322 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁נכון        | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | ▁זה             | ▁לכן         | ✗     |
|     3 | .               | ▁אל          | ✗     |
|     4 | .               | ▁תהיה        | ✗     |
|     5 | ▁לי             | ▁מאוהב       | ✗     |
|     6 | .               | ▁ב           | ✗     |
|     7 | דין             | רעיונות      | ✗     |
|     8 | ▁האלה           | ▁וב          | ✗     |
|     9 | מס              | עקרונות      | ✗     |
|    10 | ▁האלה           | ▁שלא         | ✗     |
|    11 | ▁קיימים         | ▁מניב        | ✗     |
|    12 | ים              | ים           | ✓     |
|    13 | ▁את             | ▁ערך         | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁חדש            | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 20:45:25,322 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:45:25,327 - TrainingLogger - INFO - Gradient norm: 11.1639
2024-12-31 20:45:32,308 - TrainingLogger - INFO - Step 25510, Batch metrics: Loss: 7.0569, Accuracy: 0.0634, Perplexity: 1160.8637
2024-12-31 20:45:39,700 - TrainingLogger - INFO - Step 25520, Batch metrics: Loss: 7.8043, Accuracy: 0.0407, Perplexity: 2451.1176
2024-12-31 20:45:46,936 - TrainingLogger - INFO - Step 25530, Batch metrics: Loss: 7.6752, Accuracy: 0.0714, Perplexity: 2154.2791
2024-12-31 20:45:53,733 - TrainingLogger - INFO - Step 25540, Batch metrics: Loss: 7.9998, Accuracy: 0.0563, Perplexity: 2980.3895
2024-12-31 20:46:01,251 - TrainingLogger - INFO - Step 25550, Batch metrics: Loss: 7.8497, Accuracy: 0.0591, Perplexity: 2565.0478
2024-12-31 20:46:08,581 - TrainingLogger - INFO - Step 25560, Batch metrics: Loss: 7.0940, Accuracy: 0.0839, Perplexity: 1204.7117
2024-12-31 20:46:15,837 - TrainingLogger - INFO - Step 25570, Batch metrics: Loss: 7.6654, Accuracy: 0.1066, Perplexity: 2133.1870
2024-12-31 20:46:22,830 - TrainingLogger - INFO - Step 25580, Batch metrics: Loss: 7.4800, Accuracy: 0.1010, Perplexity: 1772.2839
2024-12-31 20:46:29,635 - TrainingLogger - INFO - Step 25590, Batch metrics: Loss: 7.6824, Accuracy: 0.0494, Perplexity: 2169.8154
2024-12-31 20:46:36,779 - TrainingLogger - INFO - Step 25600, Batch metrics: Loss: 7.2894, Accuracy: 0.1129, Perplexity: 1464.6729
2024-12-31 20:46:36,780 - TrainingLogger - INFO - Step 25600, Prediction vs Actual:
2024-12-31 20:46:36,780 - TrainingLogger - INFO - Input 1: ההאשמות שנשמעו בישראל שוב ושוב בשבועות האחרונים, כאילו המטרה הזו הפכה למשנית או נשכחת, נטולות יסוד עובדתי
2024-12-31 20:46:36,780 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:46:36,780 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ההאשמות     | ✗     |
|     1 | ▁-              | ▁שנשמע       | ✗     |
|     2 | ה               | ו            | ✗     |
|     3 | ▁לי             | ▁בישראל      | ✗     |
|     4 | ▁-              | ▁שוב         | ✗     |
|     5 | ,               | ▁ושוב        | ✗     |
|     6 | .               | ▁בשבועות     | ✗     |
|     7 | ▁האחרונים       | ▁האחרונים    | ✓     |
|     8 | ▁האחרונים       | ,            | ✗     |
|     9 | ▁אני            | ▁כאילו       | ✗     |
|    10 | ,               | ▁המטרה       | ✗     |
|    11 | ▁היחידה         | ▁הזו         | ✗     |
|    12 | ▁לא             | ▁הפכה        | ✗     |
|    13 | ▁להיות          | ▁למש         | ✗     |
|    14 | מרת             | נית          | ✗     |
|    15 | ,               | ▁או          | ✗     |
|    16 | ▁לא             | ▁נשכח        | ✗     |
|    17 | ת               | ת            | ✓     |
|    18 | .               | ,            | ✗     |
|    19 | </s>            | ▁נטול        | ✗     |
|    20 | ת               | ות           | ✗     |
|    21 | ▁כל             | ▁יסוד        | ✗     |
|    22 | ,               | ▁עובדת       | ✗     |
|    23 | .               | י            | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2024-12-31 20:46:36,780 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:46:36,785 - TrainingLogger - INFO - Gradient norm: 13.8561
2024-12-31 20:46:44,172 - TrainingLogger - INFO - Step 25610, Batch metrics: Loss: 7.7155, Accuracy: 0.0877, Perplexity: 2242.9347
2024-12-31 20:46:51,503 - TrainingLogger - INFO - Step 25620, Batch metrics: Loss: 7.2773, Accuracy: 0.1089, Perplexity: 1447.0555
2024-12-31 20:46:58,865 - TrainingLogger - INFO - Step 25630, Batch metrics: Loss: 7.6489, Accuracy: 0.1159, Perplexity: 2098.3953
2024-12-31 20:47:05,818 - TrainingLogger - INFO - Step 25640, Batch metrics: Loss: 7.8293, Accuracy: 0.0312, Perplexity: 2513.0795
2024-12-31 20:47:14,708 - TrainingLogger - INFO - Step 25650, Batch metrics: Loss: 7.4021, Accuracy: 0.0933, Perplexity: 1639.4136
2024-12-31 20:47:21,853 - TrainingLogger - INFO - Step 25660, Batch metrics: Loss: 7.3323, Accuracy: 0.0523, Perplexity: 1528.9674
2024-12-31 20:47:29,071 - TrainingLogger - INFO - Step 25670, Batch metrics: Loss: 7.8295, Accuracy: 0.0874, Perplexity: 2513.6727
2024-12-31 20:47:35,782 - TrainingLogger - INFO - Step 25680, Batch metrics: Loss: 7.1626, Accuracy: 0.0796, Perplexity: 1290.2219
2024-12-31 20:47:42,791 - TrainingLogger - INFO - Step 25690, Batch metrics: Loss: 7.4836, Accuracy: 0.1069, Perplexity: 1778.6623
2024-12-31 20:47:49,773 - TrainingLogger - INFO - Step 25700, Batch metrics: Loss: 7.6407, Accuracy: 0.0222, Perplexity: 2081.1115
2024-12-31 20:47:49,773 - TrainingLogger - INFO - Step 25700, Prediction vs Actual:
2024-12-31 20:47:49,773 - TrainingLogger - INFO - Input 1: גם בהנחה הישראלית האופטימית, שלפיה פינוי רוב האוכלוסייה לאזור ההומניטרי שבין אזור אל-מוואסי לחאן יונס יארך כשבועיים-שלושה, לא ברור כיצד יתממש מבצע צבאי מיידי בעיר
2024-12-31 20:47:49,774 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:47:49,774 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁גם          | ✗     |
|     1 | .               | ▁בהנחה       | ✗     |
|     2 | ▁הגדולה         | ▁הישראלי     | ✗     |
|     3 | ת               | ת            | ✓     |
|     4 | .               | ▁האו         | ✗     |
|     5 | ח               | פטי          | ✗     |
|     6 | ת               | מית          | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | ▁כי             | ▁שלפיה       | ✗     |
|     9 | ▁של             | ▁פינוי       | ✗     |
|    10 | ▁כבד            | ▁רוב         | ✗     |
|    11 | ו               | ▁האוכלוסייה  | ✗     |
|    12 | ▁עצמה           | ▁לאזור       | ✗     |
|    13 | ים              | ▁הה          | ✗     |
|    14 | ון              | ומני         | ✗     |
|    15 | ה               | טרי          | ✗     |
|    16 | ה               | ▁שבין        | ✗     |
|    17 | ▁ארצות          | ▁אזור        | ✗     |
|    18 | ▁זה             | ▁אל          | ✗     |
|    19 | יפות            | -            | ✗     |
|    20 | ה               | מו           | ✗     |
|    21 | קמת             | ו            | ✗     |
|    22 | עה              | אסי          | ✗     |
|    23 | בית             | ▁לח          | ✗     |
|    24 | מה              | אן           | ✗     |
|    25 | .               | ▁י           | ✗     |
|    26 | או              | ונס          | ✗     |
|    27 | ו               | ▁י           | ✗     |
|    28 | או              | ארך          | ✗     |
|    29 | ▁ימים           | ▁כ           | ✗     |
|    30 | ים              | שבועיים      | ✗     |
|    31 | ▁ימים           | -            | ✗     |
|    32 | ל               | שלושה        | ✗     |
|    33 | ▁ימים           | ,            | ✗     |
|    34 | </s>            | ▁לא          | ✗     |
|    35 | -               | ▁ברור        | ✗     |
|    36 | ▁עד             | ▁כיצד        | ✗     |
|    37 | ▁זה             | ▁ית          | ✗     |
|    38 | ג               | ממש          | ✗     |
|    39 | ו               | ▁מבצע        | ✗     |
|    40 | ▁זה             | ▁צבאי        | ✗     |
|    41 | ▁זה             | ▁מיידי       | ✗     |
|    42 | .               | ▁בעיר        | ✗     |
|    43 | ▁הזו            |              | ✗     |

2024-12-31 20:47:49,774 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:47:49,779 - TrainingLogger - INFO - Gradient norm: 10.4809
2024-12-31 20:47:56,509 - TrainingLogger - INFO - Step 25710, Batch metrics: Loss: 7.7210, Accuracy: 0.0723, Perplexity: 2255.2808
2024-12-31 20:48:03,486 - TrainingLogger - INFO - Step 25720, Batch metrics: Loss: 7.6012, Accuracy: 0.0526, Perplexity: 2000.6307
2024-12-31 20:48:11,274 - TrainingLogger - INFO - Step 25730, Batch metrics: Loss: 7.4566, Accuracy: 0.0861, Perplexity: 1731.2934
2024-12-31 20:48:18,191 - TrainingLogger - INFO - Step 25740, Batch metrics: Loss: 7.6485, Accuracy: 0.0566, Perplexity: 2097.5699
2024-12-31 20:48:26,159 - TrainingLogger - INFO - Step 25750, Batch metrics: Loss: 7.3642, Accuracy: 0.0741, Perplexity: 1578.3966
2024-12-31 20:48:33,221 - TrainingLogger - INFO - Step 25760, Batch metrics: Loss: 7.1013, Accuracy: 0.0577, Perplexity: 1213.5833
2024-12-31 20:48:40,432 - TrainingLogger - INFO - Step 25770, Batch metrics: Loss: 7.7707, Accuracy: 0.0635, Perplexity: 2370.1976
2024-12-31 20:48:47,212 - TrainingLogger - INFO - Step 25780, Batch metrics: Loss: 7.5086, Accuracy: 0.0994, Perplexity: 1823.6634
2024-12-31 20:48:54,328 - TrainingLogger - INFO - Step 25790, Batch metrics: Loss: 7.4547, Accuracy: 0.0464, Perplexity: 1727.9581
2024-12-31 20:49:01,287 - TrainingLogger - INFO - Step 25800, Batch metrics: Loss: 7.3565, Accuracy: 0.0671, Perplexity: 1566.4189
2024-12-31 20:49:01,287 - TrainingLogger - INFO - Step 25800, Prediction vs Actual:
2024-12-31 20:49:01,287 - TrainingLogger - INFO - Input 1: כולנו מכבדים אחד את השנייה ואת הצורך של כל עובד ועובדת, אבל בלי להעכיר את האווירה עם פוליטיקה
2024-12-31 20:49:01,288 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:49:01,288 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁כולנו       | ✗     |
|     1 | ▁-              | ▁מכבדים      | ✗     |
|     2 | ▁-              | ▁אחד         | ✗     |
|     3 | ▁מהם            | ▁את          | ✗     |
|     4 | ▁השני           | ▁השנייה      | ✗     |
|     5 | .               | ▁ואת         | ✗     |
|     6 | ▁זה             | ▁הצורך       | ✗     |
|     7 | ▁הזה            | ▁של          | ✗     |
|     8 | ▁זה             | ▁כל          | ✗     |
|     9 | ▁אחד            | ▁עובד        | ✗     |
|    10 | .               | ▁ו           | ✗     |
|    11 | מצליח           | עובדת        | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | ▁זה             | ▁אבל         | ✗     |
|    14 | ▁זה             | ▁בלי         | ✗     |
|    15 | ▁בעיות          | ▁לה          | ✗     |
|    16 | צ               | ע            | ✗     |
|    17 | זה              | כי           | ✗     |
|    18 | ר               | ר            | ✓     |
|    19 | ▁את             | ▁את          | ✓     |
|    20 | ▁זה             | ▁האווירה     | ✗     |
|    21 | .               | ▁עם          | ✗     |
|    22 | ▁זה             | ▁פוליטיקה    | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 20:49:01,288 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:49:01,293 - TrainingLogger - INFO - Gradient norm: 10.0763
2024-12-31 20:49:08,120 - TrainingLogger - INFO - Step 25810, Batch metrics: Loss: 7.5425, Accuracy: 0.0575, Perplexity: 1886.4901
2024-12-31 20:49:15,541 - TrainingLogger - INFO - Step 25820, Batch metrics: Loss: 7.3276, Accuracy: 0.1070, Perplexity: 1521.7557
2024-12-31 20:49:22,679 - TrainingLogger - INFO - Step 25830, Batch metrics: Loss: 7.4583, Accuracy: 0.0676, Perplexity: 1734.1918
2024-12-31 20:49:29,455 - TrainingLogger - INFO - Step 25840, Batch metrics: Loss: 7.6952, Accuracy: 0.0545, Perplexity: 2197.6884
2024-12-31 20:49:36,150 - TrainingLogger - INFO - Step 25850, Batch metrics: Loss: 7.4926, Accuracy: 0.0725, Perplexity: 1794.7310
2024-12-31 20:49:42,917 - TrainingLogger - INFO - Step 25860, Batch metrics: Loss: 7.7763, Accuracy: 0.0732, Perplexity: 2383.4578
2024-12-31 20:49:50,395 - TrainingLogger - INFO - Step 25870, Batch metrics: Loss: 7.3948, Accuracy: 0.0723, Perplexity: 1627.5183
2024-12-31 20:49:57,765 - TrainingLogger - INFO - Step 25880, Batch metrics: Loss: 7.6318, Accuracy: 0.0370, Perplexity: 2062.7826
2024-12-31 20:50:04,062 - TrainingLogger - INFO - Step 25890, Batch metrics: Loss: 6.9877, Accuracy: 0.0833, Perplexity: 1083.1982
2024-12-31 20:50:11,634 - TrainingLogger - INFO - Step 25900, Batch metrics: Loss: 7.6615, Accuracy: 0.0963, Perplexity: 2124.8603
2024-12-31 20:50:11,634 - TrainingLogger - INFO - Step 25900, Prediction vs Actual:
2024-12-31 20:50:11,634 - TrainingLogger - INFO - Input 1: לכלכליסט נודע כי הנושא נבחן בידי מנכל המשרד האלוף במיל אייל זמיר וראש האגף ליצוא ביטחוני תאל במיל יאיר קולס
2024-12-31 20:50:11,635 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:50:11,635 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁לכל         | ✗     |
|     1 | ▁יש             | כל           | ✗     |
|     2 | ▁יש             | יסט          | ✗     |
|     3 | ה               | ▁נודע        | ✗     |
|     4 | :               | ▁כי          | ✗     |
|     5 | ▁הוא            | ▁הנושא       | ✗     |
|     6 | ▁לא             | ▁נבחן        | ✗     |
|     7 | ▁הוא            | ▁בידי        | ✗     |
|     8 | נו              | ▁מנ          | ✗     |
|     9 | "               | כל           | ✗     |
|    10 | ▁את             | ▁המשרד       | ✗     |
|    11 | ים              | ▁האלוף       | ✗     |
|    12 | ▁הזה            | ▁במי         | ✗     |
|    13 | ון              | ל            | ✗     |
|    14 | ואים            | ▁אייל        | ✗     |
|    15 | ה               | ▁            | ✗     |
|    16 | ן               | זמיר         | ✗     |
|    17 | ן               | ▁וראש        | ✗     |
|    18 | ון              | ▁האגף        | ✗     |
|    19 | ▁השני           | ▁ל           | ✗     |
|    20 | מולדת           | יצוא         | ✗     |
|    21 | ▁את             | ▁ביטחוני     | ✗     |
|    22 | </s>            | ▁ת           | ✗     |
|    23 | דיר             | אל           | ✗     |
|    24 | ים              | ▁במי         | ✗     |
|    25 | לא              | ל            | ✗     |
|    26 | כא              | ▁יאיר        | ✗     |
|    27 | ו               | ▁קול         | ✗     |
|    28 | סון             | ס            | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ד               | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 20:50:11,635 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:50:11,640 - TrainingLogger - INFO - Gradient norm: 11.6009
2024-12-31 20:50:18,951 - TrainingLogger - INFO - Step 25910, Batch metrics: Loss: 7.4369, Accuracy: 0.0674, Perplexity: 1697.4056
2024-12-31 20:50:25,868 - TrainingLogger - INFO - Step 25920, Batch metrics: Loss: 7.3096, Accuracy: 0.0802, Perplexity: 1494.6161
2024-12-31 20:50:33,330 - TrainingLogger - INFO - Step 25930, Batch metrics: Loss: 7.1318, Accuracy: 0.0973, Perplexity: 1251.1546
2024-12-31 20:50:40,469 - TrainingLogger - INFO - Step 25940, Batch metrics: Loss: 7.3239, Accuracy: 0.0736, Perplexity: 1516.1114
2024-12-31 20:50:47,824 - TrainingLogger - INFO - Step 25950, Batch metrics: Loss: 7.4156, Accuracy: 0.0897, Perplexity: 1661.7222
2024-12-31 20:50:54,899 - TrainingLogger - INFO - Step 25960, Batch metrics: Loss: 7.5363, Accuracy: 0.0833, Perplexity: 1874.8286
2024-12-31 20:51:02,494 - TrainingLogger - INFO - Step 25970, Batch metrics: Loss: 7.8382, Accuracy: 0.0614, Perplexity: 2535.5195
2024-12-31 20:51:09,032 - TrainingLogger - INFO - Step 25980, Batch metrics: Loss: 7.9074, Accuracy: 0.0950, Perplexity: 2717.1961
2024-12-31 20:51:16,367 - TrainingLogger - INFO - Step 25990, Batch metrics: Loss: 7.6013, Accuracy: 0.0576, Perplexity: 2000.8816
2024-12-31 20:51:24,001 - TrainingLogger - INFO - Step 26000, Batch metrics: Loss: 7.3092, Accuracy: 0.1078, Perplexity: 1494.0389
2024-12-31 20:51:24,001 - TrainingLogger - INFO - Step 26000, Prediction vs Actual:
2024-12-31 20:51:24,001 - TrainingLogger - INFO - Input 1: בקליפורניה, למשל, המדינה שבה הומצאה חברת אובר, הוחלט בחודשים האחרונים כי אובר וליפט לא יחויבו להכיר בשליחים ובנהגים כשכירים
2024-12-31 20:51:24,002 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:51:24,002 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בקליפורניה  | ✗     |
|     1 | ,               | ,            | ✓     |
|     2 | ר               | ▁למשל        | ✗     |
|     3 | ,               | ,            | ✓     |
|     4 | ,               | ▁המדינה      | ✗     |
|     5 | ,               | ▁שבה         | ✗     |
|     6 | ▁היא            | ▁הומצא       | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | ,               | ▁חברת        | ✗     |
|     9 | ה               | ▁או          | ✗     |
|    10 | במה             | בר           | ✗     |
|    11 | יה              | ,            | ✗     |
|    12 | </s>            | ▁הוחלט       | ✗     |
|    13 | ,               | ▁בחודשים     | ✗     |
|    14 | ▁האחרונים       | ▁האחרונים    | ✓     |
|    15 | ,               | ▁כי          | ✗     |
|    16 | ▁הם             | ▁או          | ✗     |
|    17 | ם               | בר           | ✗     |
|    18 | נה              | ▁ולי         | ✗     |
|    19 | ב               | פט           | ✗     |
|    20 | ה               | ▁לא          | ✗     |
|    21 | ▁היה            | ▁יח          | ✗     |
|    22 | ו               | ו            | ✓     |
|    23 | ,               | יבו          | ✗     |
|    24 | ,               | ▁להכיר       | ✗     |
|    25 | ▁את             | ▁בשלי        | ✗     |
|    26 | חות             | חים          | ✗     |
|    27 | ▁אלה            | ▁וב          | ✗     |
|    28 | ערב             | נהג          | ✗     |
|    29 | יו              | ים           | ✗     |
|    30 | ▁אחרים          | ▁כ           | ✗     |
|    31 | "               | שכיר         | ✗     |
|    32 | ים              | ים           | ✓     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ים              | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              |              | ✗     |

2024-12-31 20:51:24,002 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:51:24,007 - TrainingLogger - INFO - Gradient norm: 13.9950
2024-12-31 20:51:31,177 - TrainingLogger - INFO - Step 26010, Batch metrics: Loss: 7.7426, Accuracy: 0.0654, Perplexity: 2304.4803
2024-12-31 20:51:38,645 - TrainingLogger - INFO - Step 26020, Batch metrics: Loss: 7.3751, Accuracy: 0.0996, Perplexity: 1595.7996
2024-12-31 20:51:45,278 - TrainingLogger - INFO - Step 26030, Batch metrics: Loss: 7.5864, Accuracy: 0.0651, Perplexity: 1971.2552
2024-12-31 20:51:52,727 - TrainingLogger - INFO - Step 26040, Batch metrics: Loss: 6.9991, Accuracy: 0.1194, Perplexity: 1095.6714
2024-12-31 20:51:59,750 - TrainingLogger - INFO - Step 26050, Batch metrics: Loss: 7.4912, Accuracy: 0.0686, Perplexity: 1792.1920
2024-12-31 20:52:07,074 - TrainingLogger - INFO - Step 26060, Batch metrics: Loss: 7.5119, Accuracy: 0.1063, Perplexity: 1829.6482
2024-12-31 20:52:14,328 - TrainingLogger - INFO - Step 26070, Batch metrics: Loss: 7.5210, Accuracy: 0.0734, Perplexity: 1846.4487
2024-12-31 20:52:21,596 - TrainingLogger - INFO - Step 26080, Batch metrics: Loss: 7.5370, Accuracy: 0.1093, Perplexity: 1876.2470
2024-12-31 20:52:28,510 - TrainingLogger - INFO - Step 26090, Batch metrics: Loss: 7.4420, Accuracy: 0.0824, Perplexity: 1706.2135
2024-12-31 20:52:35,569 - TrainingLogger - INFO - Step 26100, Batch metrics: Loss: 7.6477, Accuracy: 0.0892, Perplexity: 2095.9083
2024-12-31 20:52:35,569 - TrainingLogger - INFO - Step 26100, Prediction vs Actual:
2024-12-31 20:52:35,569 - TrainingLogger - INFO - Input 1: הוא לא התייחס לתוכנית הפינוי שפורסמה היום בוול סטריט גורנל, אך כן אמר כפי שעשינו גם בחלקים קודמים במלחמה, אנחנו נשאף לבודד אוכלוסייה
2024-12-31 20:52:35,570 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:52:35,570 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הוא         | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ▁-              | ▁התייחס      | ✗     |
|     3 | ▁-              | ▁לתוכנית     | ✗     |
|     4 | ו               | ▁הפינוי      | ✗     |
|     5 | ▁שלו            | ▁ש           | ✗     |
|     6 | צריכה           | פור          | ✗     |
|     7 | צים             | ס            | ✗     |
|     8 | מה              | מה           | ✓     |
|     9 | ▁לו             | ▁היום        | ✗     |
|    10 | .               | ▁בוול        | ✗     |
|    11 | ג               | ▁סטריט       | ✗     |
|    12 | .               | ▁גור         | ✗     |
|    13 | נס              | נל           | ✗     |
|    14 | יה              | ,            | ✗     |
|    15 | <pad>           | ▁אך          | ✗     |
|    16 | ▁הוא            | ▁כן          | ✗     |
|    17 | ,               | ▁אמר         | ✗     |
|    18 | ▁לי             | ▁כפי         | ✗     |
|    19 | ▁שהוא           | ▁שעשינו      | ✗     |
|    20 | ,               | ▁גם          | ✗     |
|    21 | ▁הוא            | ▁בחלק        | ✗     |
|    22 | ו               | ים           | ✗     |
|    23 | ▁שלהם           | ▁קודמים      | ✗     |
|    24 | יה              | ▁במלחמה      | ✗     |
|    25 | ,               | ,            | ✓     |
|    26 | </s>            | ▁אנחנו       | ✗     |
|    27 | ▁לא             | ▁נשא         | ✗     |
|    28 | ים              | ף            | ✗     |
|    29 | ▁את             | ▁לבודד       | ✗     |
|    30 | ▁את             | ▁            | ✗     |
|    31 | es              | אוכלוסייה    | ✗     |
|    32 | ▁זו             | <pad>        | ✗     |
|    33 | ▁של             | <pad>        | ✗     |
|    34 | ▁את             | <pad>        | ✗     |
|    35 | ▁את             | <pad>        | ✗     |
|    36 | ▁את             | <pad>        | ✗     |
|    37 | ית              | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | ▁את             | <pad>        | ✗     |
|    40 | ▁את             | <pad>        | ✗     |
|    41 | ▁את             | <pad>        | ✗     |
|    42 | ▁את             | <pad>        | ✗     |
|    43 | ▁את             | <pad>        | ✗     |
|    44 | ים              |              | ✗     |

2024-12-31 20:52:35,570 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:52:35,575 - TrainingLogger - INFO - Gradient norm: 12.9420
2024-12-31 20:52:42,956 - TrainingLogger - INFO - Step 26110, Batch metrics: Loss: 7.9342, Accuracy: 0.0426, Perplexity: 2791.2628
2024-12-31 20:52:50,145 - TrainingLogger - INFO - Step 26120, Batch metrics: Loss: 7.7913, Accuracy: 0.0651, Perplexity: 2419.4085
2024-12-31 20:52:57,677 - TrainingLogger - INFO - Step 26130, Batch metrics: Loss: 7.8407, Accuracy: 0.1056, Perplexity: 2542.0240
2024-12-31 20:53:06,292 - TrainingLogger - INFO - Step 26140, Batch metrics: Loss: 7.0377, Accuracy: 0.0820, Perplexity: 1138.7227
2024-12-31 20:53:13,018 - TrainingLogger - INFO - Step 26150, Batch metrics: Loss: 6.9288, Accuracy: 0.0844, Perplexity: 1021.2932
2024-12-31 20:53:19,840 - TrainingLogger - INFO - Step 26160, Batch metrics: Loss: 7.3680, Accuracy: 0.0963, Perplexity: 1584.5176
2024-12-31 20:53:27,113 - TrainingLogger - INFO - Step 26170, Batch metrics: Loss: 7.3365, Accuracy: 0.0941, Perplexity: 1535.2912
2024-12-31 20:53:34,375 - TrainingLogger - INFO - Step 26180, Batch metrics: Loss: 7.5737, Accuracy: 0.0773, Perplexity: 1946.3877
2024-12-31 20:53:42,065 - TrainingLogger - INFO - Step 26190, Batch metrics: Loss: 7.6964, Accuracy: 0.0755, Perplexity: 2200.3706
2024-12-31 20:53:49,443 - TrainingLogger - INFO - Step 26200, Batch metrics: Loss: 7.1775, Accuracy: 0.0511, Perplexity: 1309.6698
2024-12-31 20:53:49,444 - TrainingLogger - INFO - Step 26200, Prediction vs Actual:
2024-12-31 20:53:49,444 - TrainingLogger - INFO - Input 1: האם נתניהו יהיה האיש שיוביל את הליכוד גם בבחירות הבאות? אין קשר בין הדברים
2024-12-31 20:53:49,444 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:53:49,444 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁האם         | ✗     |
|     1 | ▁-              | ▁נתנ         | ✗     |
|     2 | ▁לנו            | יהו          | ✗     |
|     3 | ,               | ▁יהיה        | ✗     |
|     4 | ▁לי             | ▁האיש        | ✗     |
|     5 | ▁שי             | ▁שיוביל      | ✗     |
|     6 | ▁אותו           | ▁את          | ✗     |
|     7 | ▁עצמו           | ▁הלי         | ✗     |
|     8 | קר              | כו           | ✗     |
|     9 | ד               | ד            | ✓     |
|    10 | ▁הזה            | ▁גם          | ✗     |
|    11 | ▁הוא            | ▁בבחירות     | ✗     |
|    12 | ▁הבאות          | ▁הבאות       | ✓     |
|    13 | ות              | ?            | ✗     |
|    14 | </s>            | ▁אין         | ✗     |
|    15 | ▁לנו            | ▁קשר         | ✗     |
|    16 | ▁ל              | ▁בין         | ✗     |
|    17 | ▁היתר           | ▁הדברים      | ✗     |
|    18 | ▁האלה           | <pad>        | ✗     |
|    19 | ▁עצמם           | <pad>        | ✗     |
|    20 | ▁עצמם           | <pad>        | ✗     |
|    21 | ▁ל              | <pad>        | ✗     |
|    22 | ▁הס             | <pad>        | ✗     |
|    23 | ▁אלה            | <pad>        | ✗     |
|    24 | ▁אלה            | <pad>        | ✗     |
|    25 | ▁חדשים          | <pad>        | ✗     |
|    26 | ▁אלה            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁לבין           | <pad>        | ✗     |
|    30 | ▁לבין           | <pad>        | ✗     |
|    31 | ▁הימים          | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁לבין           | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁עד             | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ▁לבין           | <pad>        | ✗     |
|    38 | ▁החיים          | <pad>        | ✗     |
|    39 | ▁לבין           |              | ✗     |

2024-12-31 20:53:49,444 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:53:49,449 - TrainingLogger - INFO - Gradient norm: 10.2008
2024-12-31 20:53:56,510 - TrainingLogger - INFO - Step 26210, Batch metrics: Loss: 7.0039, Accuracy: 0.0734, Perplexity: 1100.8733
2024-12-31 20:54:04,421 - TrainingLogger - INFO - Step 26220, Batch metrics: Loss: 7.7197, Accuracy: 0.0601, Perplexity: 2252.3565
2024-12-31 20:54:11,152 - TrainingLogger - INFO - Step 26230, Batch metrics: Loss: 7.2834, Accuracy: 0.0686, Perplexity: 1455.9153
2024-12-31 20:54:18,592 - TrainingLogger - INFO - Step 26240, Batch metrics: Loss: 7.1838, Accuracy: 0.0567, Perplexity: 1317.8581
2024-12-31 20:54:25,843 - TrainingLogger - INFO - Step 26250, Batch metrics: Loss: 7.5394, Accuracy: 0.0857, Perplexity: 1880.6602
2024-12-31 20:54:32,560 - TrainingLogger - INFO - Step 26260, Batch metrics: Loss: 7.3303, Accuracy: 0.0860, Perplexity: 1525.8611
2024-12-31 20:54:40,076 - TrainingLogger - INFO - Step 26270, Batch metrics: Loss: 7.4481, Accuracy: 0.0643, Perplexity: 1716.5299
2024-12-31 20:54:47,365 - TrainingLogger - INFO - Step 26280, Batch metrics: Loss: 7.3921, Accuracy: 0.0927, Perplexity: 1623.1658
2024-12-31 20:54:55,171 - TrainingLogger - INFO - Step 26290, Batch metrics: Loss: 7.0756, Accuracy: 0.0996, Perplexity: 1182.7644
2024-12-31 20:55:02,431 - TrainingLogger - INFO - Step 26300, Batch metrics: Loss: 7.8537, Accuracy: 0.0704, Perplexity: 2575.2811
2024-12-31 20:55:02,431 - TrainingLogger - INFO - Step 26300, Prediction vs Actual:
2024-12-31 20:55:02,431 - TrainingLogger - INFO - Input 1: הקוראים לא יופתעו לשמוע ששני האישים, לפיד ומיכאלי, לא ממש מדברים
2024-12-31 20:55:02,432 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:55:02,432 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ה           | ✗     |
|     1 | ▁-              | קוראים       | ✗     |
|     2 | ?               | ▁לא          | ✗     |
|     3 | ▁היו            | ▁יו          | ✗     |
|     4 | ון              | פתע          | ✗     |
|     5 | ו               | ו            | ✓     |
|     6 | ?               | ▁לשמוע       | ✗     |
|     7 | ▁את             | ▁ששני        | ✗     |
|     8 | ▁הדברים         | ▁האיש        | ✗     |
|     9 | ונים            | ים           | ✗     |
|    10 | ▁האלה           | ,            | ✗     |
|    11 | </s>            | ▁לפי         | ✗     |
|    12 | הם              | ד            | ✗     |
|    13 | מן              | ▁ומי         | ✗     |
|    14 | ון              | כ            | ✗     |
|    15 | נן              | אלי          | ✗     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁לא          | ✗     |
|    18 | ▁היה            | ▁ממש         | ✗     |
|    19 | ▁יודעים         | ▁מדברים      | ✗     |
|    20 | ▁על             | <pad>        | ✗     |
|    21 | ▁כזה            | <pad>        | ✗     |
|    22 | ▁כאלה           | <pad>        | ✗     |
|    23 | ▁כזה            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁פלילי          | <pad>        | ✗     |
|    27 | ▁יותר           | <pad>        | ✗     |
|    28 | ▁יותר           | <pad>        | ✗     |
|    29 | ▁בלבד           | <pad>        | ✗     |
|    30 | ▁על             | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2024-12-31 20:55:02,432 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:55:02,437 - TrainingLogger - INFO - Gradient norm: 14.8962
2024-12-31 20:55:09,616 - TrainingLogger - INFO - Step 26310, Batch metrics: Loss: 7.6192, Accuracy: 0.0916, Perplexity: 2036.9509
2024-12-31 20:55:16,327 - TrainingLogger - INFO - Step 26320, Batch metrics: Loss: 7.8161, Accuracy: 0.0644, Perplexity: 2480.1087
2024-12-31 20:55:23,583 - TrainingLogger - INFO - Step 26330, Batch metrics: Loss: 7.2090, Accuracy: 0.0909, Perplexity: 1351.5557
2024-12-31 20:55:31,177 - TrainingLogger - INFO - Step 26340, Batch metrics: Loss: 7.6898, Accuracy: 0.0942, Perplexity: 2186.0453
2024-12-31 20:55:38,268 - TrainingLogger - INFO - Step 26350, Batch metrics: Loss: 7.7867, Accuracy: 0.0787, Perplexity: 2408.3724
2024-12-31 20:55:45,802 - TrainingLogger - INFO - Step 26360, Batch metrics: Loss: 7.3524, Accuracy: 0.0807, Perplexity: 1559.8627
2024-12-31 20:55:53,323 - TrainingLogger - INFO - Step 26370, Batch metrics: Loss: 7.8098, Accuracy: 0.0739, Perplexity: 2464.6319
2024-12-31 20:56:00,659 - TrainingLogger - INFO - Step 26380, Batch metrics: Loss: 7.6004, Accuracy: 0.0914, Perplexity: 1999.0639
2024-12-31 20:56:07,781 - TrainingLogger - INFO - Step 26390, Batch metrics: Loss: 7.4597, Accuracy: 0.0814, Perplexity: 1736.6388
2024-12-31 20:56:15,701 - TrainingLogger - INFO - Step 26400, Batch metrics: Loss: 7.6226, Accuracy: 0.0941, Perplexity: 2043.8490
2024-12-31 20:56:15,702 - TrainingLogger - INFO - Step 26400, Prediction vs Actual:
2024-12-31 20:56:15,702 - TrainingLogger - INFO - Input 1: אני מאוד מוחמאת להיות מועמדת לתפקיד הקונסולית הכללית של ישראל בניו יורק, ציינה השרה במשרד ראש הממשלה
2024-12-31 20:56:15,702 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:56:15,702 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אני         | ✗     |
|     1 | ▁-              | ▁מאוד        | ✗     |
|     2 | ▁חשוב           | ▁מו          | ✗     |
|     3 | ▁-              | חמאת         | ✗     |
|     4 | ▁-              | ▁להיות       | ✗     |
|     5 | ▁אדם            | ▁מועמד       | ✗     |
|     6 | ים              | ת            | ✗     |
|     7 | ▁-              | ▁לתפקיד      | ✗     |
|     8 | ים              | ▁ה           | ✗     |
|     9 | פרלמנט          | קונסול       | ✗     |
|    10 | יה              | ית           | ✗     |
|    11 | .               | ▁הכללית      | ✗     |
|    12 | .               | ▁של          | ✗     |
|    13 | ▁ארה            | ▁ישראל       | ✗     |
|    14 | .               | ▁בניו        | ✗     |
|    15 | -               | ▁יורק        | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | ▁19             | ▁ציינה       | ✗     |
|    18 | ▁רשמית          | ▁השר         | ✗     |
|    19 | ה               | ה            | ✓     |
|    20 | ▁זו             | ▁במשרד       | ✗     |
|    21 | ▁החוץ           | ▁ראש         | ✗     |
|    22 | ▁העיר           | ▁הממשלה      | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ית              | <pad>        | ✗     |
|    25 | ית              | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | יה              | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | יה              | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ית              | <pad>        | ✗     |
|    33 | ית              | <pad>        | ✗     |
|    34 | ▁זה             | <pad>        | ✗     |
|    35 | ת               | <pad>        | ✗     |
|    36 | ה               | <pad>        | ✗     |
|    37 | ▁ל              | <pad>        | ✗     |
|    38 | ▁זה             | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | ית              | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ית              | <pad>        | ✗     |
|    43 | ה               | <pad>        | ✗     |
|    44 | .               |              | ✗     |

2024-12-31 20:56:15,703 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:56:15,708 - TrainingLogger - INFO - Gradient norm: 10.8101
2024-12-31 20:56:22,937 - TrainingLogger - INFO - Step 26410, Batch metrics: Loss: 7.8777, Accuracy: 0.0431, Perplexity: 2637.8423
2024-12-31 20:56:30,926 - TrainingLogger - INFO - Step 26420, Batch metrics: Loss: 7.8207, Accuracy: 0.0821, Perplexity: 2491.5318
2024-12-31 20:56:37,763 - TrainingLogger - INFO - Step 26430, Batch metrics: Loss: 7.8050, Accuracy: 0.0574, Perplexity: 2452.9462
2024-12-31 20:56:44,344 - TrainingLogger - INFO - Step 26440, Batch metrics: Loss: 7.1973, Accuracy: 0.0730, Perplexity: 1335.8745
2024-12-31 20:56:51,629 - TrainingLogger - INFO - Step 26450, Batch metrics: Loss: 7.2984, Accuracy: 0.0864, Perplexity: 1477.9001
2024-12-31 20:56:58,700 - TrainingLogger - INFO - Step 26460, Batch metrics: Loss: 7.5356, Accuracy: 0.0876, Perplexity: 1873.4944
2024-12-31 20:57:06,084 - TrainingLogger - INFO - Step 26470, Batch metrics: Loss: 7.4087, Accuracy: 0.1019, Perplexity: 1650.2882
2024-12-31 20:57:13,282 - TrainingLogger - INFO - Step 26480, Batch metrics: Loss: 7.3563, Accuracy: 0.0714, Perplexity: 1566.0291
2024-12-31 20:57:20,563 - TrainingLogger - INFO - Step 26490, Batch metrics: Loss: 7.2056, Accuracy: 0.0962, Perplexity: 1346.9562
2024-12-31 20:57:27,679 - TrainingLogger - INFO - Step 26500, Batch metrics: Loss: 7.1617, Accuracy: 0.1020, Perplexity: 1289.0972
2024-12-31 20:57:27,679 - TrainingLogger - INFO - Step 26500, Prediction vs Actual:
2024-12-31 20:57:27,679 - TrainingLogger - INFO - Input 1: אני בוחרת שלא להיות במקום הזה, גם אם זה לא קל לי ומנוגד לטבעי
2024-12-31 20:57:27,680 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:57:27,680 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אני         | ✗     |
|     1 | ▁לא             | ▁בוחרת       | ✗     |
|     2 | ▁את             | ▁שלא         | ✗     |
|     3 | ▁אהיה           | ▁להיות       | ✗     |
|     4 | ▁שם             | ▁במקום       | ✗     |
|     5 | ▁אחר            | ▁הזה         | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | </s>            | ▁גם          | ✗     |
|     8 | ▁אני            | ▁אם          | ✗     |
|     9 | ▁זה             | ▁זה          | ✓     |
|    10 | ▁לא             | ▁לא          | ✓     |
|    11 | ▁יהיה           | ▁קל          | ✗     |
|    12 | ,               | ▁לי          | ✗     |
|    13 | .               | ▁ומ          | ✗     |
|    14 | יותר            | נו           | ✗     |
|    15 | מס              | גד           | ✗     |
|    16 | ,               | ▁לטבע        | ✗     |
|    17 | ,               | י            | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               |              | ✗     |

2024-12-31 20:57:27,680 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:57:27,685 - TrainingLogger - INFO - Gradient norm: 10.1480
2024-12-31 20:57:34,845 - TrainingLogger - INFO - Step 26510, Batch metrics: Loss: 7.8176, Accuracy: 0.0838, Perplexity: 2484.0061
2024-12-31 20:57:41,801 - TrainingLogger - INFO - Step 26520, Batch metrics: Loss: 7.1592, Accuracy: 0.1058, Perplexity: 1285.8220
2024-12-31 20:57:49,291 - TrainingLogger - INFO - Step 26530, Batch metrics: Loss: 7.3130, Accuracy: 0.1053, Perplexity: 1499.7384
2024-12-31 20:57:56,641 - TrainingLogger - INFO - Step 26540, Batch metrics: Loss: 7.5322, Accuracy: 0.0611, Perplexity: 1867.2104
2024-12-31 20:58:03,664 - TrainingLogger - INFO - Step 26550, Batch metrics: Loss: 7.5664, Accuracy: 0.0402, Perplexity: 1932.1895
2024-12-31 20:58:11,888 - TrainingLogger - INFO - Step 26560, Batch metrics: Loss: 7.2839, Accuracy: 0.0429, Perplexity: 1456.6791
2024-12-31 20:58:18,971 - TrainingLogger - INFO - Step 26570, Batch metrics: Loss: 7.3329, Accuracy: 0.0704, Perplexity: 1529.8389
2024-12-31 20:58:25,506 - TrainingLogger - INFO - Step 26580, Batch metrics: Loss: 7.6379, Accuracy: 0.0828, Perplexity: 2075.4737
2024-12-31 20:58:33,046 - TrainingLogger - INFO - Step 26590, Batch metrics: Loss: 7.6841, Accuracy: 0.0537, Perplexity: 2173.5164
2024-12-31 20:58:39,968 - TrainingLogger - INFO - Step 26600, Batch metrics: Loss: 7.0328, Accuracy: 0.1267, Perplexity: 1133.2426
2024-12-31 20:58:39,968 - TrainingLogger - INFO - Step 26600, Prediction vs Actual:
2024-12-31 20:58:39,968 - TrainingLogger - INFO - Input 1: אני לא רוצה לחכות בשביל שהאחים שלי ישוחררו בפעימה בעוד חמש שנים
2024-12-31 20:58:39,968 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:58:39,968 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | ,               | ▁לא          | ✗     |
|     2 | ▁-              | ▁רוצה        | ✗     |
|     3 | ▁את             | ▁לחכות       | ✗     |
|     4 | .               | ▁בשביל       | ✗     |
|     5 | ▁זה             | ▁ש           | ✗     |
|     6 | ות              | האחים        | ✗     |
|     7 | ▁שלי            | ▁שלי         | ✓     |
|     8 | ▁יש             | ▁ישוחרר      | ✗     |
|     9 | ו               | ו            | ✓     |
|    10 | .               | ▁ב           | ✗     |
|    11 | ...             | פעימה        | ✗     |
|    12 | .               | ▁בעוד        | ✗     |
|    13 | י               | ▁חמש         | ✗     |
|    14 | ▁דקות           | ▁שנים        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁כמוכם          | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 20:58:39,969 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:58:39,974 - TrainingLogger - INFO - Gradient norm: 9.1087
2024-12-31 20:58:48,296 - TrainingLogger - INFO - Step 26610, Batch metrics: Loss: 7.5421, Accuracy: 0.0597, Perplexity: 1885.6960
2024-12-31 20:58:55,694 - TrainingLogger - INFO - Step 26620, Batch metrics: Loss: 7.6956, Accuracy: 0.0533, Perplexity: 2198.5887
2024-12-31 20:59:02,809 - TrainingLogger - INFO - Step 26630, Batch metrics: Loss: 7.8130, Accuracy: 0.0556, Perplexity: 2472.6306
2024-12-31 20:59:11,443 - TrainingLogger - INFO - Step 26640, Batch metrics: Loss: 7.1702, Accuracy: 0.1042, Perplexity: 1300.0617
2024-12-31 20:59:18,325 - TrainingLogger - INFO - Step 26650, Batch metrics: Loss: 7.3757, Accuracy: 0.0484, Perplexity: 1596.7030
2024-12-31 20:59:25,642 - TrainingLogger - INFO - Step 26660, Batch metrics: Loss: 7.4335, Accuracy: 0.0857, Perplexity: 1691.6469
2024-12-31 20:59:33,221 - TrainingLogger - INFO - Step 26670, Batch metrics: Loss: 7.7016, Accuracy: 0.0909, Perplexity: 2211.8580
2024-12-31 20:59:40,515 - TrainingLogger - INFO - Step 26680, Batch metrics: Loss: 7.5955, Accuracy: 0.0800, Perplexity: 1989.2726
2024-12-31 20:59:47,449 - TrainingLogger - INFO - Step 26690, Batch metrics: Loss: 7.4167, Accuracy: 0.0803, Perplexity: 1663.4664
2024-12-31 20:59:54,129 - TrainingLogger - INFO - Step 26700, Batch metrics: Loss: 7.5884, Accuracy: 0.0837, Perplexity: 1975.0912
2024-12-31 20:59:54,129 - TrainingLogger - INFO - Step 26700, Prediction vs Actual:
2024-12-31 20:59:54,129 - TrainingLogger - INFO - Input 1: את בקבוק המים שלכם שטפו לפחות פעם אחת ביום ואם אתם לא מסוגלים לעמוד בזה, קחו אותו הביתה בסוף כל יום
2024-12-31 20:59:54,130 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 20:59:54,130 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כמוני          | ▁את          | ✗     |
|     1 | ▁-              | ▁בקבוק       | ✗     |
|     2 | ▁טוב            | ▁המים        | ✗     |
|     3 | ?               | ▁שלכם        | ✗     |
|     4 | .               | ▁ש           | ✗     |
|     5 | קוף             | טפו          | ✗     |
|     6 | יים             | ▁לפחות       | ✗     |
|     7 | ▁לא             | ▁פעם         | ✗     |
|     8 | ▁אחת            | ▁אחת         | ✓     |
|     9 | .               | ▁ביום        | ✗     |
|    10 | .               | ▁ואם         | ✗     |
|    11 | ▁לא             | ▁אתם         | ✗     |
|    12 | ▁לא             | ▁לא          | ✓     |
|    13 | ▁רוצים          | ▁מסוגלים     | ✗     |
|    14 | ▁לעשות          | ▁לעמוד       | ✗     |
|    15 | ▁בזה            | ▁בזה         | ✓     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁קחו         | ✗     |
|    18 | ▁את             | ▁אותו        | ✗     |
|    19 | ▁מכאן           | ▁הביתה       | ✗     |
|    20 | .               | ▁בסוף        | ✗     |
|    21 | ▁הדרך           | ▁כל          | ✗     |
|    22 | ▁הדרך           | ▁יום         | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               |              | ✗     |

2024-12-31 20:59:54,130 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 20:59:54,135 - TrainingLogger - INFO - Gradient norm: 9.7805
2024-12-31 21:00:01,544 - TrainingLogger - INFO - Step 26710, Batch metrics: Loss: 7.6493, Accuracy: 0.0732, Perplexity: 2099.2429
2024-12-31 21:00:08,802 - TrainingLogger - INFO - Step 26720, Batch metrics: Loss: 7.2824, Accuracy: 0.0909, Perplexity: 1454.5004
2024-12-31 21:00:15,956 - TrainingLogger - INFO - Step 26730, Batch metrics: Loss: 7.0760, Accuracy: 0.0839, Perplexity: 1183.2264
2024-12-31 21:00:23,269 - TrainingLogger - INFO - Step 26740, Batch metrics: Loss: 8.1795, Accuracy: 0.0714, Perplexity: 3566.9231
2024-12-31 21:00:30,555 - TrainingLogger - INFO - Step 26750, Batch metrics: Loss: 7.2882, Accuracy: 0.0994, Perplexity: 1462.8944
2024-12-31 21:00:38,104 - TrainingLogger - INFO - Step 26760, Batch metrics: Loss: 7.0937, Accuracy: 0.0988, Perplexity: 1204.3751
2024-12-31 21:00:45,272 - TrainingLogger - INFO - Step 26770, Batch metrics: Loss: 7.1760, Accuracy: 0.0851, Perplexity: 1307.7290
2024-12-31 21:00:51,958 - TrainingLogger - INFO - Step 26780, Batch metrics: Loss: 7.8101, Accuracy: 0.0978, Perplexity: 2465.2714
2024-12-31 21:00:58,851 - TrainingLogger - INFO - Step 26790, Batch metrics: Loss: 7.3146, Accuracy: 0.0872, Perplexity: 1502.0271
2024-12-31 21:01:06,415 - TrainingLogger - INFO - Step 26800, Batch metrics: Loss: 7.3212, Accuracy: 0.0938, Perplexity: 1511.9833
2024-12-31 21:01:06,415 - TrainingLogger - INFO - Step 26800, Prediction vs Actual:
2024-12-31 21:01:06,415 - TrainingLogger - INFO - Input 1: לשכת ראש הממשלה מסרה אמש חמאס ממשיך להתבצר בדרישות מופרכות
2024-12-31 21:01:06,415 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:01:06,415 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁לשכת        | ✗     |
|     1 | ▁-              | ▁ראש         | ✗     |
|     2 | ▁העיר           | ▁הממשלה      | ✗     |
|     3 | :               | ▁מסר         | ✗     |
|     4 | ה               | ה            | ✓     |
|     5 | ▁לי             | ▁אמש         | ✗     |
|     6 | ,               | ▁ח           | ✗     |
|     7 | ח               | מ            | ✗     |
|     8 | אס              | אס           | ✓     |
|     9 | ,               | ▁ממשיך       | ✗     |
|    10 | ▁את             | ▁להת         | ✗     |
|    11 | רעה             | ב            | ✗     |
|    12 | ודה             | צר           | ✗     |
|    13 | יה              | ▁בדרישות     | ✗     |
|    14 | יו              | ▁מופ         | ✗     |
|    15 | יה              | רכות         | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ות              | <pad>        | ✗     |
|    20 | ות              | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ות              | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | יה              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | יות             | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 21:01:06,416 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:01:06,420 - TrainingLogger - INFO - Gradient norm: 15.3742
2024-12-31 21:01:14,054 - TrainingLogger - INFO - Step 26810, Batch metrics: Loss: 7.3199, Accuracy: 0.0877, Perplexity: 1510.0746
2024-12-31 21:01:20,231 - TrainingLogger - INFO - Step 26820, Batch metrics: Loss: 7.4117, Accuracy: 0.1007, Perplexity: 1655.2951
2024-12-31 21:01:27,450 - TrainingLogger - INFO - Step 26830, Batch metrics: Loss: 8.1507, Accuracy: 0.0455, Perplexity: 3465.7831
2024-12-31 21:01:34,786 - TrainingLogger - INFO - Step 26840, Batch metrics: Loss: 7.5717, Accuracy: 0.0902, Perplexity: 1942.4296
2024-12-31 21:01:41,836 - TrainingLogger - INFO - Step 26850, Batch metrics: Loss: 7.8966, Accuracy: 0.0928, Perplexity: 2688.0535
2024-12-31 21:01:48,806 - TrainingLogger - INFO - Step 26860, Batch metrics: Loss: 7.1720, Accuracy: 0.0479, Perplexity: 1302.4319
2024-12-31 21:01:55,766 - TrainingLogger - INFO - Step 26870, Batch metrics: Loss: 6.5822, Accuracy: 0.1127, Perplexity: 722.1528
2024-12-31 21:02:02,831 - TrainingLogger - INFO - Step 26880, Batch metrics: Loss: 7.4979, Accuracy: 0.0881, Perplexity: 1804.2272
2024-12-31 21:02:09,675 - TrainingLogger - INFO - Step 26890, Batch metrics: Loss: 7.3558, Accuracy: 0.1176, Perplexity: 1565.1930
2024-12-31 21:02:17,451 - TrainingLogger - INFO - Step 26900, Batch metrics: Loss: 7.2785, Accuracy: 0.0660, Perplexity: 1448.8547
2024-12-31 21:02:17,451 - TrainingLogger - INFO - Step 26900, Prediction vs Actual:
2024-12-31 21:02:17,485 - TrainingLogger - INFO - Input 1: בין היתר הוחלט כי בנוסח החוק ייכתב שתפילות לא ייאסרו, אם כי יוגבלו בלבד, וכי ההפגנות יוגבלו לכמות של עד 2,000 איש בהפגנה, ובמרחק של לא יותר מקילומטר ממקום המגורים
2024-12-31 21:02:17,486 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:02:17,486 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בין         | ✗     |
|     1 | ▁ל              | ▁היתר        | ✗     |
|     2 | ▁-              | ▁הוחלט       | ✗     |
|     3 | ה               | ▁כי          | ✗     |
|     4 | ▁הוא            | ▁בנוסח       | ✗     |
|     5 | ה               | ▁החוק        | ✗     |
|     6 | ▁הראשון         | ▁יי          | ✗     |
|     7 | בחר             | כתב          | ✗     |
|     8 | ו               | ▁ש           | ✗     |
|     9 | יבה             | תפילות       | ✗     |
|    10 | יו              | ▁לא          | ✗     |
|    11 | ▁טובות          | ▁יי          | ✗     |
|    12 | שוב             | אס           | ✗     |
|    13 | ר               | רו           | ✗     |
|    14 | ▁לו             | ,            | ✗     |
|    15 | <pad>           | ▁אם          | ✗     |
|    16 | ▁לא             | ▁כי          | ✗     |
|    17 | ▁לא             | ▁יוג         | ✗     |
|    18 | ה               | בלו          | ✗     |
|    19 | ▁את             | ▁בלבד        | ✗     |
|    20 | ,               | ,            | ✓     |
|    21 | <pad>           | ▁וכי         | ✗     |
|    22 | ור              | ▁הה          | ✗     |
|    23 | ג               | פג           | ✗     |
|    24 | נה              | נות          | ✗     |
|    25 | ▁החדשות         | ▁יוג         | ✗     |
|    26 | ה               | בלו          | ✗     |
|    27 | ,               | ▁ל           | ✗     |
|    28 | עצ              | כמות         | ✗     |
|    29 | ▁גדולה          | ▁של          | ✗     |
|    30 | ▁כסף            | ▁עד          | ✗     |
|    31 | שות             | ▁2,000       | ✗     |
|    32 | ים              | ▁איש         | ✗     |
|    33 | ,               | ▁בה          | ✗     |
|    34 | ת               | פג           | ✗     |
|    35 | נה              | נה           | ✓     |
|    36 | ,               | ,            | ✓     |
|    37 | ▁הן             | ▁וב          | ✗     |
|    38 | לבד             | מרחק         | ✗     |
|    39 | ▁של             | ▁של          | ✓     |
|    40 | ▁ימים           | ▁לא          | ✗     |
|    41 | ▁פחות           | ▁יותר        | ✗     |
|    42 | ▁מ              | ▁מ           | ✓     |
|    43 | מיליון          | קילומטר      | ✗     |
|    44 | ים              | ▁ממקום       | ✗     |
|    45 | ▁זה             | ▁המגורים     | ✗     |
|    46 | ,               |              | ✗     |

2024-12-31 21:02:17,486 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:02:17,491 - TrainingLogger - INFO - Gradient norm: 9.4049
2024-12-31 21:02:24,573 - TrainingLogger - INFO - Step 26910, Batch metrics: Loss: 7.6642, Accuracy: 0.0867, Perplexity: 2130.7898
2024-12-31 21:02:31,395 - TrainingLogger - INFO - Step 26920, Batch metrics: Loss: 7.9132, Accuracy: 0.0632, Perplexity: 2733.1835
2024-12-31 21:02:38,256 - TrainingLogger - INFO - Step 26930, Batch metrics: Loss: 7.6668, Accuracy: 0.0736, Perplexity: 2136.2071
2024-12-31 21:02:45,401 - TrainingLogger - INFO - Step 26940, Batch metrics: Loss: 7.8030, Accuracy: 0.0559, Perplexity: 2447.8810
2024-12-31 21:02:52,745 - TrainingLogger - INFO - Step 26950, Batch metrics: Loss: 7.8509, Accuracy: 0.0576, Perplexity: 2568.1050
2024-12-31 21:03:00,439 - TrainingLogger - INFO - Step 26960, Batch metrics: Loss: 7.6920, Accuracy: 0.0848, Perplexity: 2190.7473
2024-12-31 21:03:07,475 - TrainingLogger - INFO - Step 26970, Batch metrics: Loss: 7.8952, Accuracy: 0.0485, Perplexity: 2684.3709
2024-12-31 21:03:14,308 - TrainingLogger - INFO - Step 26980, Batch metrics: Loss: 7.6774, Accuracy: 0.0462, Perplexity: 2158.9159
2024-12-31 21:03:21,761 - TrainingLogger - INFO - Step 26990, Batch metrics: Loss: 7.2606, Accuracy: 0.0837, Perplexity: 1423.1646
2024-12-31 21:03:28,482 - TrainingLogger - INFO - Step 27000, Batch metrics: Loss: 7.6713, Accuracy: 0.0503, Perplexity: 2145.8732
2024-12-31 21:03:28,482 - TrainingLogger - INFO - Step 27000, Prediction vs Actual:
2024-12-31 21:03:28,482 - TrainingLogger - INFO - Input 1: אני אומר כעיתונאי הדאגה בעולם מעליית כוחות קיצוניים בישראל היא עמוקה, והיא זוכה לרייטינג לא רע, ויהיו מי שיקדמו אותה לקדמת הבימה
2024-12-31 21:03:28,483 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:03:28,483 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אני         | ✗     |
|     1 | ▁כבר            | ▁אומר        | ✗     |
|     2 | ▁שאני           | ▁כ           | ✗     |
|     3 | "               | עי           | ✗     |
|     4 | תי              | תו           | ✗     |
|     5 | י               | נאי          | ✗     |
|     6 | ת               | ▁הדאגה       | ✗     |
|     7 | ▁שלי            | ▁בעולם       | ✗     |
|     8 | ▁הזה            | ▁מעליי       | ✗     |
|     9 | </s>            | ת            | ✗     |
|    10 | <pad>           | ▁כוחות       | ✗     |
|    11 | </s>            | ▁קיצוניים    | ✗     |
|    12 | </s>            | ▁בישראל      | ✗     |
|    13 | </s>            | ▁היא         | ✗     |
|    14 | ▁לא             | ▁עמוקה       | ✗     |
|    15 | </s>            | ,            | ✗     |
|    16 | </s>            | ▁והיא        | ✗     |
|    17 | ▁לא             | ▁זוכה        | ✗     |
|    18 | ▁ל              | ▁לריי        | ✗     |
|    19 | ▁גדול           | טינג         | ✗     |
|    20 | ,               | ▁לא          | ✗     |
|    21 | ▁משנה           | ▁רע          | ✗     |
|    22 | </s>            | ,            | ✗     |
|    23 | </s>            | ▁ויהיו       | ✗     |
|    24 | ▁לי             | ▁מי          | ✗     |
|    25 | ▁שיש            | ▁שיק         | ✗     |
|    26 | ים              | דמו          | ✗     |
|    27 | ▁את             | ▁אותה        | ✗     |
|    28 | .               | ▁ל           | ✗     |
|    29 | פיצו            | קדמת         | ✗     |
|    30 | ה               | ▁הבי         | ✗     |
|    31 | זה              | מה           | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 21:03:28,483 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:03:28,488 - TrainingLogger - INFO - Gradient norm: 10.3141
2024-12-31 21:03:35,999 - TrainingLogger - INFO - Step 27010, Batch metrics: Loss: 7.7764, Accuracy: 0.0585, Perplexity: 2383.7056
2024-12-31 21:03:42,872 - TrainingLogger - INFO - Step 27020, Batch metrics: Loss: 7.7931, Accuracy: 0.0746, Perplexity: 2423.8553
2024-12-31 21:03:49,769 - TrainingLogger - INFO - Step 27030, Batch metrics: Loss: 7.2188, Accuracy: 0.1076, Perplexity: 1364.8445
2024-12-31 21:03:57,191 - TrainingLogger - INFO - Step 27040, Batch metrics: Loss: 7.2257, Accuracy: 0.0844, Perplexity: 1374.2372
2024-12-31 21:04:04,080 - TrainingLogger - INFO - Step 27050, Batch metrics: Loss: 7.1054, Accuracy: 0.0930, Perplexity: 1218.4836
2024-12-31 21:04:11,242 - TrainingLogger - INFO - Step 27060, Batch metrics: Loss: 7.7686, Accuracy: 0.0479, Perplexity: 2365.0551
2024-12-31 21:04:18,519 - TrainingLogger - INFO - Step 27070, Batch metrics: Loss: 7.5971, Accuracy: 0.0657, Perplexity: 1992.4081
2024-12-31 21:04:25,751 - TrainingLogger - INFO - Step 27080, Batch metrics: Loss: 7.5392, Accuracy: 0.0526, Perplexity: 1880.3356
2024-12-31 21:04:32,977 - TrainingLogger - INFO - Step 27090, Batch metrics: Loss: 7.6149, Accuracy: 0.0562, Perplexity: 2028.2483
2024-12-31 21:04:39,815 - TrainingLogger - INFO - Step 27100, Batch metrics: Loss: 7.3254, Accuracy: 0.0796, Perplexity: 1518.4287
2024-12-31 21:04:39,816 - TrainingLogger - INFO - Step 27100, Prediction vs Actual:
2024-12-31 21:04:39,816 - TrainingLogger - INFO - Input 1: ובשבת בצהריים מוציאים טרקטור, נוסעים לכיוון כפר ויתקין או לעבר החוף, עושים מטווחים וחוזרים לפנות ערב כאילו לא קרה הדבר
2024-12-31 21:04:39,816 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:04:39,816 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁וב          | ✗     |
|     1 | ▁-              | שבת          | ✗     |
|     2 | ▁-              | ▁בצהריים     | ✗     |
|     3 | ▁-              | ▁מוציאים     | ✗     |
|     4 | ▁את             | ▁טר          | ✗     |
|     5 | ▁זה             | קטור         | ✗     |
|     6 | ים              | ,            | ✗     |
|     7 | <pad>           | ▁נוסעים      | ✗     |
|     8 | ▁רבים           | ▁לכיוון      | ✗     |
|     9 | ▁דרום           | ▁כפר         | ✗     |
|    10 | ה               | ▁וית         | ✗     |
|    11 | '               | קין          | ✗     |
|    12 | ,               | ▁או          | ✗     |
|    13 | ▁יותר           | ▁לעבר        | ✗     |
|    14 | ,               | ▁החוף        | ✗     |
|    15 | ,               | ,            | ✓     |
|    16 | </s>            | ▁עושים       | ✗     |
|    17 | ▁זאת            | ▁מטווח       | ✗     |
|    18 | ▁ארוך           | ים           | ✗     |
|    19 | ▁רבים           | ▁וחוזר       | ✗     |
|    20 | ים              | ים           | ✓     |
|    21 | ▁אליהם          | ▁לפנות       | ✗     |
|    22 | ▁אליו           | ▁ערב         | ✗     |
|    23 | יים             | ▁כאילו       | ✗     |
|    24 | ▁זה             | ▁לא          | ✗     |
|    25 | ▁היה            | ▁קרה         | ✗     |
|    26 | ▁שום            | ▁הדבר        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | .               |              | ✗     |

2024-12-31 21:04:39,816 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:04:39,821 - TrainingLogger - INFO - Gradient norm: 10.6430
2024-12-31 21:04:46,970 - TrainingLogger - INFO - Step 27110, Batch metrics: Loss: 7.4817, Accuracy: 0.0941, Perplexity: 1775.1993
2024-12-31 21:04:54,857 - TrainingLogger - INFO - Step 27120, Batch metrics: Loss: 7.4239, Accuracy: 0.0568, Perplexity: 1675.6388
2024-12-31 21:05:02,050 - TrainingLogger - INFO - Step 27130, Batch metrics: Loss: 7.1432, Accuracy: 0.0947, Perplexity: 1265.4170
2024-12-31 21:05:09,074 - TrainingLogger - INFO - Step 27140, Batch metrics: Loss: 7.4828, Accuracy: 0.0704, Perplexity: 1777.2651
2024-12-31 21:05:16,238 - TrainingLogger - INFO - Step 27150, Batch metrics: Loss: 7.4986, Accuracy: 0.0655, Perplexity: 1805.5413
2024-12-31 21:05:23,111 - TrainingLogger - INFO - Step 27160, Batch metrics: Loss: 7.7065, Accuracy: 0.0526, Perplexity: 2222.6961
2024-12-31 21:05:29,733 - TrainingLogger - INFO - Step 27170, Batch metrics: Loss: 7.2171, Accuracy: 0.0588, Perplexity: 1362.5920
2024-12-31 21:05:37,073 - TrainingLogger - INFO - Step 27180, Batch metrics: Loss: 7.2673, Accuracy: 0.1065, Perplexity: 1432.7243
2024-12-31 21:05:44,189 - TrainingLogger - INFO - Step 27190, Batch metrics: Loss: 7.1938, Accuracy: 0.0857, Perplexity: 1331.1799
2024-12-31 21:05:50,824 - TrainingLogger - INFO - Step 27200, Batch metrics: Loss: 7.7448, Accuracy: 0.0636, Perplexity: 2309.4591
2024-12-31 21:05:50,824 - TrainingLogger - INFO - Step 27200, Prediction vs Actual:
2024-12-31 21:05:50,824 - TrainingLogger - INFO - Input 1: לאחר שנערכו אתמול חמישי פגישות בין צוותי הליכוד לנציגי נעם ועוצמה יהודית, אמש החל סבב נוסף של שיחות
2024-12-31 21:05:50,825 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:05:50,825 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לאחר        | ✗     |
|     1 | ▁-              | ▁שנערכו      | ✗     |
|     2 | ▁את             | ▁אתמול       | ✗     |
|     3 | ▁-              | ▁חמישי       | ✗     |
|     4 | ▁בבוקר          | ▁פגישות      | ✗     |
|     5 | ▁עם             | ▁בין         | ✗     |
|     6 | ▁היתר           | ▁צוותי       | ✗     |
|     7 | ▁המדינה         | ▁הלי         | ✗     |
|     8 | כות             | כו           | ✗     |
|     9 | עים             | ד            | ✗     |
|    10 | ונים            | ▁ל           | ✗     |
|    11 | -               | נציג         | ✗     |
|    12 | ות              | י            | ✗     |
|    13 | ▁המדינה         | ▁נ           | ✗     |
|    14 | "               | עם           | ✗     |
|    15 | .               | ▁ו           | ✗     |
|    16 | נבחר            | עוצמה        | ✗     |
|    17 | ▁זו             | ▁יהודי       | ✗     |
|    18 | ת               | ת            | ✓     |
|    19 | .               | ,            | ✗     |
|    20 | <pad>           | ▁אמש         | ✗     |
|    21 | ,               | ▁החל         | ✗     |
|    22 | ▁מה             | ▁סבב         | ✗     |
|    23 | ▁הבחירות        | ▁נוסף        | ✗     |
|    24 | ▁של             | ▁של          | ✓     |
|    25 | ▁ממש            | ▁שיחות       | ✗     |
|    26 | יהם             | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ▁נוספות         | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | ות              |              | ✗     |

2024-12-31 21:05:50,825 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:05:50,830 - TrainingLogger - INFO - Gradient norm: 10.3796
2024-12-31 21:05:58,074 - TrainingLogger - INFO - Step 27210, Batch metrics: Loss: 7.2192, Accuracy: 0.0904, Perplexity: 1365.3978
2024-12-31 21:06:05,209 - TrainingLogger - INFO - Step 27220, Batch metrics: Loss: 8.0230, Accuracy: 0.0724, Perplexity: 3050.2353
2024-12-31 21:06:12,006 - TrainingLogger - INFO - Step 27230, Batch metrics: Loss: 7.3793, Accuracy: 0.0733, Perplexity: 1602.3914
2024-12-31 21:06:19,249 - TrainingLogger - INFO - Step 27240, Batch metrics: Loss: 7.6132, Accuracy: 0.0579, Perplexity: 2024.7000
2024-12-31 21:06:26,852 - TrainingLogger - INFO - Step 27250, Batch metrics: Loss: 7.2437, Accuracy: 0.0766, Perplexity: 1399.2924
2024-12-31 21:06:33,526 - TrainingLogger - INFO - Step 27260, Batch metrics: Loss: 7.0764, Accuracy: 0.0857, Perplexity: 1183.7219
2024-12-31 21:06:40,778 - TrainingLogger - INFO - Step 27270, Batch metrics: Loss: 7.1069, Accuracy: 0.1098, Perplexity: 1220.3716
2024-12-31 21:06:48,216 - TrainingLogger - INFO - Step 27280, Batch metrics: Loss: 7.3964, Accuracy: 0.0752, Perplexity: 1630.0378
2024-12-31 21:06:55,870 - TrainingLogger - INFO - Step 27290, Batch metrics: Loss: 7.2876, Accuracy: 0.0957, Perplexity: 1462.1008
2024-12-31 21:07:03,210 - TrainingLogger - INFO - Step 27300, Batch metrics: Loss: 7.2424, Accuracy: 0.1149, Perplexity: 1397.4407
2024-12-31 21:07:03,210 - TrainingLogger - INFO - Step 27300, Prediction vs Actual:
2024-12-31 21:07:03,210 - TrainingLogger - INFO - Input 1: לפתע פתאום הוא מוכן לוותר על כל אלה לטובת הספין הזה?
2024-12-31 21:07:03,210 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:07:03,210 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁לפתע        | ✗     |
|     1 | ▁-              | ▁פתאום       | ✗     |
|     2 | ▁הוא            | ▁הוא         | ✓     |
|     3 | ▁אמר            | ▁מוכן        | ✗     |
|     4 | ▁לעשות          | ▁לוותר       | ✗     |
|     5 | ▁על             | ▁על          | ✓     |
|     6 | ▁זה             | ▁כל          | ✗     |
|     7 | ▁הבעיות         | ▁אלה         | ✗     |
|     8 | ,               | ▁לטובת       | ✗     |
|     9 | י               | ▁הס          | ✗     |
|    10 | עוד             | פין          | ✗     |
|    11 | נט              | ▁הזה         | ✗     |
|    12 | .               | ?            | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁הוא            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 21:07:03,210 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:07:03,216 - TrainingLogger - INFO - Gradient norm: 11.1584
2024-12-31 21:07:10,271 - TrainingLogger - INFO - Step 27310, Batch metrics: Loss: 7.4924, Accuracy: 0.0642, Perplexity: 1794.3058
2024-12-31 21:07:17,372 - TrainingLogger - INFO - Step 27320, Batch metrics: Loss: 7.5092, Accuracy: 0.0724, Perplexity: 1824.8090
2024-12-31 21:07:24,612 - TrainingLogger - INFO - Step 27330, Batch metrics: Loss: 7.1720, Accuracy: 0.0722, Perplexity: 1302.4785
2024-12-31 21:07:31,305 - TrainingLogger - INFO - Step 27340, Batch metrics: Loss: 7.5466, Accuracy: 0.0812, Perplexity: 1894.2530
2024-12-31 21:07:38,764 - TrainingLogger - INFO - Step 27350, Batch metrics: Loss: 7.6188, Accuracy: 0.0305, Perplexity: 2036.0429
2024-12-31 21:07:46,035 - TrainingLogger - INFO - Step 27360, Batch metrics: Loss: 7.5250, Accuracy: 0.0690, Perplexity: 1853.8010
2024-12-31 21:07:53,601 - TrainingLogger - INFO - Step 27370, Batch metrics: Loss: 7.4145, Accuracy: 0.0606, Perplexity: 1659.7963
2024-12-31 21:08:01,233 - TrainingLogger - INFO - Step 27380, Batch metrics: Loss: 7.4009, Accuracy: 0.0905, Perplexity: 1637.4979
2024-12-31 21:08:08,888 - TrainingLogger - INFO - Step 27390, Batch metrics: Loss: 8.0203, Accuracy: 0.0595, Perplexity: 3041.9967
2024-12-31 21:08:16,221 - TrainingLogger - INFO - Step 27400, Batch metrics: Loss: 7.2994, Accuracy: 0.0778, Perplexity: 1479.4167
2024-12-31 21:08:16,221 - TrainingLogger - INFO - Step 27400, Prediction vs Actual:
2024-12-31 21:08:16,221 - TrainingLogger - INFO - Input 1: במפגש ישתתפו גם מומחים ומובילים בתחום הבינה המלאכותית
2024-12-31 21:08:16,222 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:08:16,222 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ית              | ▁במפגש       | ✗     |
|     1 | ▁-              | ▁יש          | ✗     |
|     2 | ▁לי             | ת            | ✗     |
|     3 | ים              | ת            | ✗     |
|     4 | ים              | פו           | ✗     |
|     5 | פות             | ▁גם          | ✗     |
|     6 | ▁היא            | ▁מומחים      | ✗     |
|     7 | .               | ▁ו           | ✗     |
|     8 | פרטי            | מוביל        | ✗     |
|     9 | ים              | ים           | ✓     |
|    10 | .               | ▁בתחום       | ✗     |
|    11 | ▁הזה            | ▁הבינה       | ✗     |
|    12 | .               | ▁המלא        | ✗     |
|    13 | ים              | כות          | ✗     |
|    14 | י               | ית           | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ים              | <pad>        | ✗     |
|    22 | ית              | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | י               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 21:08:16,222 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:08:16,227 - TrainingLogger - INFO - Gradient norm: 10.7675
2024-12-31 21:08:23,179 - TrainingLogger - INFO - Step 27410, Batch metrics: Loss: 7.3514, Accuracy: 0.0857, Perplexity: 1558.3409
2024-12-31 21:08:29,984 - TrainingLogger - INFO - Step 27420, Batch metrics: Loss: 7.5603, Accuracy: 0.0552, Perplexity: 1920.4927
2024-12-31 21:08:37,168 - TrainingLogger - INFO - Step 27430, Batch metrics: Loss: 7.3756, Accuracy: 0.0950, Perplexity: 1596.5272
2024-12-31 21:08:44,450 - TrainingLogger - INFO - Step 27440, Batch metrics: Loss: 7.2405, Accuracy: 0.0948, Perplexity: 1394.7493
2024-12-31 21:08:51,754 - TrainingLogger - INFO - Step 27450, Batch metrics: Loss: 7.9153, Accuracy: 0.0690, Perplexity: 2738.7685
2024-12-31 21:08:58,515 - TrainingLogger - INFO - Step 27460, Batch metrics: Loss: 6.8180, Accuracy: 0.1013, Perplexity: 914.1656
2024-12-31 21:09:06,150 - TrainingLogger - INFO - Step 27470, Batch metrics: Loss: 7.6992, Accuracy: 0.0547, Perplexity: 2206.6234
2024-12-31 21:09:13,252 - TrainingLogger - INFO - Step 27480, Batch metrics: Loss: 8.4472, Accuracy: 0.0244, Perplexity: 4662.1867
2024-12-31 21:09:20,220 - TrainingLogger - INFO - Step 27490, Batch metrics: Loss: 7.2294, Accuracy: 0.1073, Perplexity: 1379.3422
2024-12-31 21:09:27,394 - TrainingLogger - INFO - Step 27500, Batch metrics: Loss: 6.8834, Accuracy: 0.1189, Perplexity: 975.8998
2024-12-31 21:09:27,394 - TrainingLogger - INFO - Step 27500, Prediction vs Actual:
2024-12-31 21:09:27,394 - TrainingLogger - INFO - Input 1: בגלל זה אנחנו גם באופוזיציה
2024-12-31 21:09:27,395 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:09:27,395 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בגלל        | ✗     |
|     1 | ▁שאני           | ▁זה          | ✗     |
|     2 | .               | ▁אנחנו       | ✗     |
|     3 | ▁לא             | ▁גם          | ✗     |
|     4 | ▁צריכים         | ▁באו         | ✗     |
|     5 | ▁בחשבון         | פוז          | ✗     |
|     6 | ים              | י            | ✗     |
|     7 | ציה             | ציה          | ✓     |
|     8 | ▁שלנו           | <pad>        | ✗     |
|     9 | ▁אנחנו          | <pad>        | ✗     |
|    10 | ▁שלנו           | <pad>        | ✗     |
|    11 | ▁אנחנו          | <pad>        | ✗     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | ▁שלנו           | <pad>        | ✗     |
|    16 | ית              | <pad>        | ✗     |
|    17 | ▁זה             | <pad>        | ✗     |
|    18 | ▁זה             | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ▁לא             | <pad>        | ✗     |
|    22 | ▁לא             | <pad>        | ✗     |
|    23 | ▁אנחנו          | <pad>        | ✗     |
|    24 | ▁זה             | <pad>        | ✗     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | ▁לא             | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | ▁אנחנו          | <pad>        | ✗     |
|    31 | ▁לא             | <pad>        | ✗     |
|    32 | ▁לא             | <pad>        | ✗     |
|    33 | ▁לא             | <pad>        | ✗     |
|    34 | ▁אנחנו          | <pad>        | ✗     |
|    35 | ▁אנחנו          | <pad>        | ✗     |
|    36 | ▁לא             | <pad>        | ✗     |
|    37 | ▁אנחנו          | <pad>        | ✗     |
|    38 | ▁לא             |              | ✗     |

2024-12-31 21:09:27,395 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:09:27,400 - TrainingLogger - INFO - Gradient norm: 11.2164
2024-12-31 21:09:34,617 - TrainingLogger - INFO - Step 27510, Batch metrics: Loss: 7.2354, Accuracy: 0.1014, Perplexity: 1387.6545
2024-12-31 21:09:41,982 - TrainingLogger - INFO - Step 27520, Batch metrics: Loss: 7.9597, Accuracy: 0.0571, Perplexity: 2863.1732
2024-12-31 21:09:49,623 - TrainingLogger - INFO - Step 27530, Batch metrics: Loss: 7.2497, Accuracy: 0.0921, Perplexity: 1407.7269
2024-12-31 21:09:56,751 - TrainingLogger - INFO - Step 27540, Batch metrics: Loss: 7.9647, Accuracy: 0.0755, Perplexity: 2877.6872
2024-12-31 21:10:03,733 - TrainingLogger - INFO - Step 27550, Batch metrics: Loss: 7.5241, Accuracy: 0.0637, Perplexity: 1852.1814
2024-12-31 21:10:10,741 - TrainingLogger - INFO - Step 27560, Batch metrics: Loss: 7.4801, Accuracy: 0.1202, Perplexity: 1772.4014
2024-12-31 21:10:17,597 - TrainingLogger - INFO - Step 27570, Batch metrics: Loss: 7.6477, Accuracy: 0.0680, Perplexity: 2095.9192
2024-12-31 21:10:25,230 - TrainingLogger - INFO - Step 27580, Batch metrics: Loss: 7.3978, Accuracy: 0.0918, Perplexity: 1632.3705
2024-12-31 21:10:32,758 - TrainingLogger - INFO - Step 27590, Batch metrics: Loss: 7.7473, Accuracy: 0.0635, Perplexity: 2315.3428
2024-12-31 21:10:40,329 - TrainingLogger - INFO - Step 27600, Batch metrics: Loss: 7.8425, Accuracy: 0.0470, Perplexity: 2546.5335
2024-12-31 21:10:40,333 - TrainingLogger - INFO - Step 27600, Prediction vs Actual:
2024-12-31 21:10:40,333 - TrainingLogger - INFO - Input 1: כלומר, מחיר הדלק אמור לעלות בחצי שקל ב-1611
2024-12-31 21:10:40,334 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:10:40,334 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁כלומר       | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | ▁לא             | ▁מחיר        | ✗     |
|     3 | ▁כבד            | ▁הדלק        | ✗     |
|     4 | תי              | ▁אמור        | ✗     |
|     5 | ▁להיות          | ▁לעלות       | ✗     |
|     6 | ▁על             | ▁בחצי        | ✗     |
|     7 | ▁מחיר           | ▁שקל         | ✗     |
|     8 | ה               | ▁ב           | ✗     |
|     9 | דולר            | -16          | ✗     |
|    10 | ▁דולר           | 11           | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁ל              | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 21:10:40,334 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:10:40,339 - TrainingLogger - INFO - Gradient norm: 12.5079
2024-12-31 21:10:47,433 - TrainingLogger - INFO - Step 27610, Batch metrics: Loss: 7.3187, Accuracy: 0.0649, Perplexity: 1508.3093
2024-12-31 21:10:54,335 - TrainingLogger - INFO - Step 27620, Batch metrics: Loss: 7.1422, Accuracy: 0.1221, Perplexity: 1264.1662
2024-12-31 21:11:01,528 - TrainingLogger - INFO - Step 27630, Batch metrics: Loss: 7.4751, Accuracy: 0.0820, Perplexity: 1763.5394
2024-12-31 21:11:08,887 - TrainingLogger - INFO - Step 27640, Batch metrics: Loss: 7.3391, Accuracy: 0.0571, Perplexity: 1539.3876
2024-12-31 21:11:16,177 - TrainingLogger - INFO - Step 27650, Batch metrics: Loss: 7.5670, Accuracy: 0.0615, Perplexity: 1933.2955
2024-12-31 21:11:23,254 - TrainingLogger - INFO - Step 27660, Batch metrics: Loss: 7.3505, Accuracy: 0.1364, Perplexity: 1557.0463
2024-12-31 21:11:31,003 - TrainingLogger - INFO - Step 27670, Batch metrics: Loss: 7.5412, Accuracy: 0.0851, Perplexity: 1884.0557
2024-12-31 21:11:38,498 - TrainingLogger - INFO - Step 27680, Batch metrics: Loss: 7.5126, Accuracy: 0.0683, Perplexity: 1830.9643
2024-12-31 21:11:45,841 - TrainingLogger - INFO - Step 27690, Batch metrics: Loss: 7.4464, Accuracy: 0.0828, Perplexity: 1713.7403
2024-12-31 21:11:53,100 - TrainingLogger - INFO - Step 27700, Batch metrics: Loss: 7.4294, Accuracy: 0.0930, Perplexity: 1684.7256
2024-12-31 21:11:53,100 - TrainingLogger - INFO - Step 27700, Prediction vs Actual:
2024-12-31 21:11:53,100 - TrainingLogger - INFO - Input 1: יור הכנסתיולי אדלשטייןהתייחס לפיזור הכנסת לפני שהוקמה ממשלה ואמר אני מתפלל ומקווה שהאירוע הזה יהיה חד פעמי, ורק אולי בעוד 71 שנה ניתקל בו פעם נוספת
2024-12-31 21:11:53,101 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:11:53,101 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁י           | ✗     |
|     1 | ב               | ור           | ✗     |
|     2 | ▁               | ▁הכנסתי      | ✗     |
|     3 | ד               | ולי          | ✗     |
|     4 | ב               | ▁אדל         | ✗     |
|     5 | ר               | שטיין        | ✗     |
|     6 | ,               | ה            | ✗     |
|     7 | מל              | תייחס        | ✗     |
|     8 | ל               | ▁לפי         | ✗     |
|     9 | ר               | זור          | ✗     |
|    10 | ים              | ▁הכנסת       | ✗     |
|    11 | ה               | ▁לפני        | ✗     |
|    12 | ה               | ▁שה          | ✗     |
|    13 | שירות           | וק           | ✗     |
|    14 | ם               | מה           | ✗     |
|    15 | ▁לו             | ▁ממשלה       | ✗     |
|    16 | ,               | ▁ואמר        | ✗     |
|    17 | :               | ▁אני         | ✗     |
|    18 | ▁לא             | ▁מתפלל       | ✗     |
|    19 | ,               | ▁ו           | ✗     |
|    20 | מצליח           | מקווה        | ✗     |
|    21 | ▁שהוא           | ▁שה          | ✗     |
|    22 | קשר             | אירוע        | ✗     |
|    23 | ▁הזה            | ▁הזה         | ✓     |
|    24 | ▁לא             | ▁יהיה        | ✗     |
|    25 | ▁קשה            | ▁חד          | ✗     |
|    26 | ▁פעמי           | ▁פעמי        | ✓     |
|    27 | .               | ,            | ✗     |
|    28 | ▁אם             | ▁ורק         | ✗     |
|    29 | ▁הפעם           | ▁אולי        | ✗     |
|    30 | ▁לא             | ▁בעוד        | ✗     |
|    31 | ▁יום            | ▁71          | ✗     |
|    32 | ים              | ▁שנה         | ✗     |
|    33 | ,               | ▁ניתק        | ✗     |
|    34 | ת               | ל            | ✗     |
|    35 | ▁בכך            | ▁בו          | ✗     |
|    36 | ו               | ▁פעם         | ✗     |
|    37 | ▁אחת            | ▁נוספת       | ✗     |
|    38 | ,               |              | ✗     |

2024-12-31 21:11:53,101 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:11:53,106 - TrainingLogger - INFO - Gradient norm: 9.9217
2024-12-31 21:12:00,336 - TrainingLogger - INFO - Step 27710, Batch metrics: Loss: 7.8134, Accuracy: 0.0746, Perplexity: 2473.5657
2024-12-31 21:12:07,665 - TrainingLogger - INFO - Step 27720, Batch metrics: Loss: 7.6289, Accuracy: 0.0846, Perplexity: 2056.7678
2024-12-31 21:12:14,383 - TrainingLogger - INFO - Step 27730, Batch metrics: Loss: 7.3622, Accuracy: 0.0319, Perplexity: 1575.3709
2024-12-31 21:12:21,778 - TrainingLogger - INFO - Step 27740, Batch metrics: Loss: 7.0404, Accuracy: 0.1067, Perplexity: 1141.8378
2024-12-31 21:12:28,957 - TrainingLogger - INFO - Step 27750, Batch metrics: Loss: 7.4821, Accuracy: 0.0920, Perplexity: 1776.0130
2024-12-31 21:12:36,171 - TrainingLogger - INFO - Step 27760, Batch metrics: Loss: 7.8645, Accuracy: 0.0683, Perplexity: 2603.1825
2024-12-31 21:12:42,947 - TrainingLogger - INFO - Step 27770, Batch metrics: Loss: 7.5586, Accuracy: 0.0848, Perplexity: 1917.2381
2024-12-31 21:12:49,665 - TrainingLogger - INFO - Step 27780, Batch metrics: Loss: 7.9524, Accuracy: 0.0345, Perplexity: 2842.5206
2024-12-31 21:12:56,757 - TrainingLogger - INFO - Step 27790, Batch metrics: Loss: 7.4797, Accuracy: 0.0606, Perplexity: 1771.6527
2024-12-31 21:13:03,519 - TrainingLogger - INFO - Step 27800, Batch metrics: Loss: 7.4843, Accuracy: 0.1111, Perplexity: 1779.9477
2024-12-31 21:13:03,519 - TrainingLogger - INFO - Step 27800, Prediction vs Actual:
2024-12-31 21:13:03,519 - TrainingLogger - INFO - Input 1: את זמנו הפנוי הוא מבלה בקריאה ובכתיבה
2024-12-31 21:13:03,519 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:13:03,519 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁את          | ✗     |
|     1 | נו              | ▁זמנו        | ✗     |
|     2 | ת               | ▁הפנוי       | ✗     |
|     3 | ,               | ▁הוא         | ✗     |
|     4 | ▁היה            | ▁מבלה        | ✗     |
|     5 | ▁עם             | ▁בקריאה      | ✗     |
|     6 | ,               | ▁וב          | ✗     |
|     7 | ס               | כתיב         | ✗     |
|     8 | ה               | ה            | ✓     |
|     9 | ▁זו             | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | ת               | <pad>        | ✗     |
|    12 | ית              | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ית              | <pad>        | ✗     |
|    15 | ית              | <pad>        | ✗     |
|    16 | ית              | <pad>        | ✗     |
|    17 | ית              | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ית              | <pad>        | ✗     |
|    20 | ▁עם             | <pad>        | ✗     |
|    21 | ▁עם             | <pad>        | ✗     |
|    22 | ית              | <pad>        | ✗     |
|    23 | ית              | <pad>        | ✗     |
|    24 | ▁עם             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ית              | <pad>        | ✗     |
|    27 | ית              |              | ✗     |

2024-12-31 21:13:03,519 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:13:03,524 - TrainingLogger - INFO - Gradient norm: 8.5661
2024-12-31 21:13:10,536 - TrainingLogger - INFO - Step 27810, Batch metrics: Loss: 7.7239, Accuracy: 0.0860, Perplexity: 2261.8762
2024-12-31 21:13:17,585 - TrainingLogger - INFO - Step 27820, Batch metrics: Loss: 7.5278, Accuracy: 0.0761, Perplexity: 1858.9980
2024-12-31 21:13:25,368 - TrainingLogger - INFO - Step 27830, Batch metrics: Loss: 7.5448, Accuracy: 0.0822, Perplexity: 1890.8030
2024-12-31 21:13:33,003 - TrainingLogger - INFO - Step 27840, Batch metrics: Loss: 7.5398, Accuracy: 0.0877, Perplexity: 1881.5330
2024-12-31 21:13:39,573 - TrainingLogger - INFO - Step 27850, Batch metrics: Loss: 7.9349, Accuracy: 0.0511, Perplexity: 2793.2027
2024-12-31 21:13:46,854 - TrainingLogger - INFO - Step 27860, Batch metrics: Loss: 7.4424, Accuracy: 0.0684, Perplexity: 1706.8124
2024-12-31 21:13:54,053 - TrainingLogger - INFO - Step 27870, Batch metrics: Loss: 7.6058, Accuracy: 0.0833, Perplexity: 2009.8280
2024-12-31 21:14:00,991 - TrainingLogger - INFO - Step 27880, Batch metrics: Loss: 7.2309, Accuracy: 0.0838, Perplexity: 1381.4716
2024-12-31 21:14:08,665 - TrainingLogger - INFO - Step 27890, Batch metrics: Loss: 7.3577, Accuracy: 0.0500, Perplexity: 1568.2746
2024-12-31 21:14:16,296 - TrainingLogger - INFO - Step 27900, Batch metrics: Loss: 7.4177, Accuracy: 0.0926, Perplexity: 1665.1298
2024-12-31 21:14:16,296 - TrainingLogger - INFO - Step 27900, Prediction vs Actual:
2024-12-31 21:14:16,296 - TrainingLogger - INFO - Input 1: בשלב הראשון פנתה שיכון ובינוי לכ1,000 גופים על מנת לגבש מאגר ראשוני של יזמויות
2024-12-31 21:14:16,297 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:14:16,297 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁בשלב        | ✗     |
|     1 | ▁-              | ▁הראשון      | ✗     |
|     2 | ,               | ▁פנתה        | ✗     |
|     3 | ▁אליו           | ▁ש           | ✗     |
|     4 | ...             | יכון         | ✗     |
|     5 | .               | ▁וב          | ✗     |
|     6 | ערב             | ינו          | ✗     |
|     7 | ▁יחד            | י            | ✗     |
|     8 | .               | ▁לכ          | ✗     |
|     9 | "               | 1,000        | ✗     |
|    10 | י               | ▁ג           | ✗     |
|    11 | '               | ופים         | ✗     |
|    12 | ▁נוספים         | ▁על          | ✗     |
|    13 | ▁פני            | ▁מנת         | ✗     |
|    14 | ▁לקבל           | ▁לג          | ✗     |
|    15 | בש              | בש           | ✓     |
|    16 | ה               | ▁מאגר        | ✗     |
|    17 | ים              | ▁ראשוני      | ✗     |
|    18 | ▁של             | ▁של          | ✓     |
|    19 | ▁תקווה          | ▁יז          | ✗     |
|    20 | מים             | מו           | ✗     |
|    21 | מים             | יות          | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | יות             | <pad>        | ✗     |
|    34 | יות             | <pad>        | ✗     |
|    35 | יות             | <pad>        | ✗     |
|    36 | יות             | <pad>        | ✗     |
|    37 | יות             | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | יות             | <pad>        | ✗     |
|    41 | יות             | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 21:14:16,297 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:14:16,302 - TrainingLogger - INFO - Gradient norm: 11.4298
2024-12-31 21:14:22,796 - TrainingLogger - INFO - Step 27910, Batch metrics: Loss: 7.5428, Accuracy: 0.0816, Perplexity: 1887.0704
2024-12-31 21:14:30,542 - TrainingLogger - INFO - Step 27920, Batch metrics: Loss: 7.3082, Accuracy: 0.0704, Perplexity: 1492.5564
2024-12-31 21:14:37,510 - TrainingLogger - INFO - Step 27930, Batch metrics: Loss: 7.3590, Accuracy: 0.0761, Perplexity: 1570.2434
2024-12-31 21:14:43,733 - TrainingLogger - INFO - Step 27940, Batch metrics: Loss: 7.2380, Accuracy: 0.0727, Perplexity: 1391.2859
2024-12-31 21:14:51,345 - TrainingLogger - INFO - Step 27950, Batch metrics: Loss: 7.3509, Accuracy: 0.0840, Perplexity: 1557.5950
2024-12-31 21:14:58,419 - TrainingLogger - INFO - Step 27960, Batch metrics: Loss: 7.9136, Accuracy: 0.0718, Perplexity: 2734.3058
2024-12-31 21:15:05,229 - TrainingLogger - INFO - Step 27970, Batch metrics: Loss: 8.1243, Accuracy: 0.0581, Perplexity: 3375.5976
2024-12-31 21:15:12,003 - TrainingLogger - INFO - Step 27980, Batch metrics: Loss: 7.3892, Accuracy: 0.0568, Perplexity: 1618.4544
2024-12-31 21:15:19,312 - TrainingLogger - INFO - Step 27990, Batch metrics: Loss: 7.3016, Accuracy: 0.0913, Perplexity: 1482.6505
2024-12-31 21:15:26,723 - TrainingLogger - INFO - Step 28000, Batch metrics: Loss: 7.8672, Accuracy: 0.0439, Perplexity: 2610.1742
2024-12-31 21:15:26,724 - TrainingLogger - INFO - Step 28000, Prediction vs Actual:
2024-12-31 21:15:26,724 - TrainingLogger - INFO - Input 1: יולי-אוגוסט משעמם אז ממציאים כותרות
2024-12-31 21:15:26,724 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:15:26,724 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁יולי        | ✗     |
|     1 | ▁גרמניה         | -            | ✗     |
|     2 | ה               | אוגוסט       | ✗     |
|     3 | ,               | ▁משעמם       | ✗     |
|     4 | ,               | ▁אז          | ✗     |
|     5 | ,               | ▁ממציא       | ✗     |
|     6 | ה               | ים           | ✗     |
|     7 | ▁חדשים          | ▁כותרות      | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 21:15:26,724 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:15:26,729 - TrainingLogger - INFO - Gradient norm: 11.6455
2024-12-31 21:15:34,350 - TrainingLogger - INFO - Step 28010, Batch metrics: Loss: 7.4045, Accuracy: 0.0694, Perplexity: 1643.2846
2024-12-31 21:15:41,101 - TrainingLogger - INFO - Step 28020, Batch metrics: Loss: 7.3943, Accuracy: 0.0664, Perplexity: 1626.6548
2024-12-31 21:15:47,887 - TrainingLogger - INFO - Step 28030, Batch metrics: Loss: 7.7461, Accuracy: 0.0867, Perplexity: 2312.5623
2024-12-31 21:15:54,931 - TrainingLogger - INFO - Step 28040, Batch metrics: Loss: 7.5457, Accuracy: 0.0593, Perplexity: 1892.5024
2024-12-31 21:16:02,263 - TrainingLogger - INFO - Step 28050, Batch metrics: Loss: 7.5700, Accuracy: 0.0510, Perplexity: 1939.1767
2024-12-31 21:16:09,499 - TrainingLogger - INFO - Step 28060, Batch metrics: Loss: 7.7193, Accuracy: 0.0872, Perplexity: 2251.4696
2024-12-31 21:16:16,574 - TrainingLogger - INFO - Step 28070, Batch metrics: Loss: 7.3156, Accuracy: 0.0884, Perplexity: 1503.5685
2024-12-31 21:16:24,177 - TrainingLogger - INFO - Step 28080, Batch metrics: Loss: 8.0554, Accuracy: 0.0326, Perplexity: 3150.8050
2024-12-31 21:16:31,399 - TrainingLogger - INFO - Step 28090, Batch metrics: Loss: 7.6546, Accuracy: 0.0614, Perplexity: 2110.4076
2024-12-31 21:16:38,482 - TrainingLogger - INFO - Step 28100, Batch metrics: Loss: 7.5962, Accuracy: 0.0609, Perplexity: 1990.5384
2024-12-31 21:16:38,483 - TrainingLogger - INFO - Step 28100, Prediction vs Actual:
2024-12-31 21:16:38,483 - TrainingLogger - INFO - Input 1: האינטראקציה עם ארתור בישיבות, כולל בדיון על הסיסמאות, הייתה מדהימה
2024-12-31 21:16:38,483 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:16:38,483 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁ה           | ✗     |
|     1 | ▁-              | אינטר        | ✗     |
|     2 | ▁-              | א            | ✗     |
|     3 | מס              | קציה         | ✗     |
|     4 | ▁שלי            | ▁עם          | ✗     |
|     5 | ▁כל             | ▁ארתור       | ✗     |
|     6 | .               | ▁בי          | ✗     |
|     7 | ר               | שיב          | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | יו              | ,            | ✗     |
|    10 | </s>            | ▁כולל        | ✗     |
|    11 | ▁את             | ▁בדיון       | ✗     |
|    12 | ▁הזה            | ▁על          | ✗     |
|    13 | ▁החוק           | ▁הסיסמא      | ✗     |
|    14 | ות              | ות           | ✓     |
|    15 | ▁שלו            | ,            | ✗     |
|    16 | </s>            | ▁הייתה       | ✗     |
|    17 | ▁להם            | ▁מדהימה      | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ות              | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ות              | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | .               |              | ✗     |

2024-12-31 21:16:38,484 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:16:38,489 - TrainingLogger - INFO - Gradient norm: 10.2337
2024-12-31 21:16:45,557 - TrainingLogger - INFO - Step 28110, Batch metrics: Loss: 7.8278, Accuracy: 0.0541, Perplexity: 2509.4966
2024-12-31 21:16:53,050 - TrainingLogger - INFO - Step 28120, Batch metrics: Loss: 7.7623, Accuracy: 0.0729, Perplexity: 2350.2862
2024-12-31 21:17:00,224 - TrainingLogger - INFO - Step 28130, Batch metrics: Loss: 7.7407, Accuracy: 0.0805, Perplexity: 2300.0770
2024-12-31 21:17:07,730 - TrainingLogger - INFO - Step 28140, Batch metrics: Loss: 7.8211, Accuracy: 0.0865, Perplexity: 2492.5739
2024-12-31 21:17:14,737 - TrainingLogger - INFO - Step 28150, Batch metrics: Loss: 8.3854, Accuracy: 0.0387, Perplexity: 4382.8111
2024-12-31 21:17:22,225 - TrainingLogger - INFO - Step 28160, Batch metrics: Loss: 7.8504, Accuracy: 0.0785, Perplexity: 2566.7815
2024-12-31 21:17:29,637 - TrainingLogger - INFO - Step 28170, Batch metrics: Loss: 8.3568, Accuracy: 0.0532, Perplexity: 4259.1053
2024-12-31 21:17:37,264 - TrainingLogger - INFO - Step 28180, Batch metrics: Loss: 7.5891, Accuracy: 0.0936, Perplexity: 1976.6005
2024-12-31 21:17:44,219 - TrainingLogger - INFO - Step 28190, Batch metrics: Loss: 7.7999, Accuracy: 0.0923, Perplexity: 2440.2685
2024-12-31 21:17:51,796 - TrainingLogger - INFO - Step 28200, Batch metrics: Loss: 7.3119, Accuracy: 0.0864, Perplexity: 1498.0881
2024-12-31 21:17:51,797 - TrainingLogger - INFO - Step 28200, Prediction vs Actual:
2024-12-31 21:17:51,797 - TrainingLogger - INFO - Input 1: בריאיון לאולפן ynet אמר בן גביר הספינרים של נתניהו עובדים שעות נוספות, אני לא פורש
2024-12-31 21:17:51,797 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:17:51,797 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בריא        | ✗     |
|     1 | ▁ל              | יון          | ✗     |
|     2 | ▁גבוה           | ▁לא          | ✗     |
|     3 | י               | ול           | ✗     |
|     4 | פן              | פן           | ✓     |
|     5 | ▁גבוה           | ▁y           | ✗     |
|     6 | ור              | net          | ✗     |
|     7 | </s>            | ▁אמר         | ✗     |
|     8 | ▁לי             | ▁בן          | ✗     |
|     9 | </s>            | ▁ג           | ✗     |
|    10 | '               | ביר          | ✗     |
|    11 | </s>            | ▁ה           | ✗     |
|    12 | ור              | ספי          | ✗     |
|    13 | ג               | נר           | ✗     |
|    14 | י               | ים           | ✗     |
|    15 | :               | ▁של          | ✗     |
|    16 | ▁אמריקה         | ▁נתנ         | ✗     |
|    17 | אל              | יהו          | ✗     |
|    18 | אס              | ▁עובדים      | ✗     |
|    19 | ▁ב              | ▁שעות        | ✗     |
|    20 | ▁נוספות         | ▁נוספות      | ✓     |
|    21 | </s>            | ,            | ✗     |
|    22 | </s>            | ▁אני         | ✗     |
|    23 | ▁חושב           | ▁לא          | ✗     |
|    24 | ▁רוצה           | ▁פורש        | ✗     |
|    25 | ת               | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ▁את             | <pad>        | ✗     |
|    37 | ת               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁את             |              | ✗     |

2024-12-31 21:17:51,797 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:17:51,802 - TrainingLogger - INFO - Gradient norm: 19.2779
2024-12-31 21:17:58,484 - TrainingLogger - INFO - Step 28210, Batch metrics: Loss: 7.1106, Accuracy: 0.1043, Perplexity: 1224.8758
2024-12-31 21:18:05,948 - TrainingLogger - INFO - Step 28220, Batch metrics: Loss: 7.6002, Accuracy: 0.0895, Perplexity: 1998.5788
2024-12-31 21:18:12,947 - TrainingLogger - INFO - Step 28230, Batch metrics: Loss: 7.7387, Accuracy: 0.0531, Perplexity: 2295.5999
2024-12-31 21:18:20,094 - TrainingLogger - INFO - Step 28240, Batch metrics: Loss: 7.5534, Accuracy: 0.1019, Perplexity: 1907.1954
2024-12-31 21:18:27,458 - TrainingLogger - INFO - Step 28250, Batch metrics: Loss: 7.5270, Accuracy: 0.0673, Perplexity: 1857.4545
2024-12-31 21:18:34,575 - TrainingLogger - INFO - Step 28260, Batch metrics: Loss: 7.5149, Accuracy: 0.0747, Perplexity: 1835.2508
2024-12-31 21:18:41,927 - TrainingLogger - INFO - Step 28270, Batch metrics: Loss: 7.5448, Accuracy: 0.0980, Perplexity: 1890.9067
2024-12-31 21:18:48,665 - TrainingLogger - INFO - Step 28280, Batch metrics: Loss: 7.5552, Accuracy: 0.0777, Perplexity: 1910.5824
2024-12-31 21:18:55,840 - TrainingLogger - INFO - Step 28290, Batch metrics: Loss: 7.7210, Accuracy: 0.0700, Perplexity: 2255.2195
2024-12-31 21:18:59,715 - TrainingLogger - ERROR - Error during forward pass: CUDA out of memory. Tried to allocate 64.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 23.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.68 GiB is allocated by PyTorch, and 753.19 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2024-12-31 21:18:59,716 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 175, in forward
    x = self.custom_encoder2(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 769, in forward
    layer_outputs = encoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 303, in forward
    hidden_states, attn_weights, _ = self.self_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 218, in forward
    attn_weights = attn_weights.view(bsz, self.num_heads, tgt_len, src_len) + attention_mask
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 23.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.68 GiB is allocated by PyTorch, and 753.19 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2024-12-31 21:18:59,716 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 21:18:59,718 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 21:18:59,718 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 21:18:59,718 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 21:18:59,718 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([8, 510]), device: cuda:0
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([8, 510]), device: cuda:0
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 21:18:59,719 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 21:19:06,044 - TrainingLogger - INFO - Step 28300, Batch metrics: Loss: 7.5423, Accuracy: 0.0780, Perplexity: 1886.1951
2024-12-31 21:19:06,045 - TrainingLogger - INFO - Step 28300, Prediction vs Actual:
2024-12-31 21:19:06,045 - TrainingLogger - INFO - Input 1: מאז היו שני מקרים נוספים שבהם עצרו נשיאים אמריקנים משלוחי נשק לישראל כולל מטוסי קרב גימי קרטר בסוף שנות ה-70 בשל מדיניות ההתנחלויות, ודונלד רייגן במלחמת לבנון הראשונה
2024-12-31 21:19:06,046 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:19:06,046 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מאז         | ✗     |
|     1 | ▁-              | ▁היו         | ✗     |
|     2 | ▁-              | ▁שני         | ✗     |
|     3 | ▁אנשים          | ▁מקרים       | ✗     |
|     4 | ▁של             | ▁נוספים      | ✗     |
|     5 | ,               | ▁שבהם        | ✗     |
|     6 | ▁הוא            | ▁עצרו        | ✗     |
|     7 | ▁את             | ▁נשיא        | ✗     |
|     8 | ים              | ים           | ✓     |
|     9 | ▁חדשים          | ▁אמריקנים    | ✗     |
|    10 | ,               | ▁משלוח       | ✗     |
|    11 | י               | י            | ✓     |
|    12 | ▁סמים           | ▁נשק         | ✗     |
|    13 | ,               | ▁לישראל      | ✗     |
|    14 | .               | ▁כולל        | ✗     |
|    15 | ם               | ▁מטוסי       | ✗     |
|    16 | ▁מלחמה          | ▁קרב         | ✗     |
|    17 | ה               | ▁ג           | ✗     |
|    18 | '               | ימי          | ✗     |
|    19 | ים              | ▁קרטר        | ✗     |
|    20 | ,               | ▁בסוף        | ✗     |
|    21 | ▁הדרך           | ▁שנות        | ✗     |
|    22 | ▁ה              | ▁ה           | ✓     |
|    23 | -               | -70          | ✗     |
|    24 | ▁שלהם           | ▁בשל         | ✗     |
|    25 | ם               | ▁מדיניות     | ✗     |
|    26 | ▁המדינה         | ▁ההת         | ✗     |
|    27 | רעה             | נחל          | ✗     |
|    28 | ויות            | ויות         | ✓     |
|    29 | ▁שלהם           | ,            | ✗     |
|    30 | <pad>           | ▁ו           | ✗     |
|    31 | למרות           | דונלד        | ✗     |
|    32 | ות              | ▁ריי         | ✗     |
|    33 | צ               | גן           | ✗     |
|    34 | ,               | ▁במלחמת      | ✗     |
|    35 | ▁העולם          | ▁לב          | ✗     |
|    36 | ינה             | נון          | ✗     |
|    37 | .               | ▁הראשונה     | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ▁עם             | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 21:19:06,046 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:19:06,051 - TrainingLogger - INFO - Gradient norm: 10.6144
2024-12-31 21:19:12,857 - TrainingLogger - INFO - Step 28310, Batch metrics: Loss: 7.2985, Accuracy: 0.0481, Perplexity: 1478.1263
2024-12-31 21:19:21,041 - TrainingLogger - INFO - Step 28320, Batch metrics: Loss: 7.5770, Accuracy: 0.0991, Perplexity: 1952.6653
2024-12-31 21:19:27,375 - TrainingLogger - INFO - Step 28330, Batch metrics: Loss: 7.9448, Accuracy: 0.1000, Perplexity: 2820.8693
2024-12-31 21:19:34,281 - TrainingLogger - INFO - Step 28340, Batch metrics: Loss: 7.4000, Accuracy: 0.0850, Perplexity: 1635.9105
2024-12-31 21:19:41,192 - TrainingLogger - INFO - Step 28350, Batch metrics: Loss: 7.1635, Accuracy: 0.0902, Perplexity: 1291.4400
2024-12-31 21:19:47,989 - TrainingLogger - INFO - Step 28360, Batch metrics: Loss: 7.3785, Accuracy: 0.0854, Perplexity: 1601.2625
2024-12-31 21:19:55,148 - TrainingLogger - INFO - Step 28370, Batch metrics: Loss: 7.3995, Accuracy: 0.0452, Perplexity: 1635.2234
2024-12-31 21:20:02,160 - TrainingLogger - INFO - Step 28380, Batch metrics: Loss: 7.4032, Accuracy: 0.1034, Perplexity: 1641.1922
2024-12-31 21:20:09,453 - TrainingLogger - INFO - Step 28390, Batch metrics: Loss: 7.8233, Accuracy: 0.0556, Perplexity: 2498.0234
2024-12-31 21:20:16,192 - TrainingLogger - INFO - Step 28400, Batch metrics: Loss: 7.7513, Accuracy: 0.0496, Perplexity: 2324.5555
2024-12-31 21:20:16,192 - TrainingLogger - INFO - Step 28400, Prediction vs Actual:
2024-12-31 21:20:16,192 - TrainingLogger - INFO - Input 1: זה רק שומר על הבריאות
2024-12-31 21:20:16,193 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:20:16,193 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁זה          | ✗     |
|     1 | </s>            | ▁רק          | ✗     |
|     2 | ,               | ▁שומר        | ✗     |
|     3 | ▁על             | ▁על          | ✓     |
|     4 | ▁עצמו           | ▁הבריאות     | ✗     |
|     5 | ▁הזה            | <pad>        | ✗     |
|     6 | י               | <pad>        | ✗     |
|     7 | ▁הזה            | <pad>        | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | ▁את             | <pad>        | ✗     |
|    10 | ▁על             | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ▁הזה            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | י               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               |              | ✗     |

2024-12-31 21:20:16,193 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:20:16,198 - TrainingLogger - INFO - Gradient norm: 11.0370
2024-12-31 21:20:23,475 - TrainingLogger - INFO - Step 28410, Batch metrics: Loss: 7.4577, Accuracy: 0.0645, Perplexity: 1733.0948
2024-12-31 21:20:30,463 - TrainingLogger - INFO - Step 28420, Batch metrics: Loss: 7.6625, Accuracy: 0.0955, Perplexity: 2127.1038
2024-12-31 21:20:38,018 - TrainingLogger - INFO - Step 28430, Batch metrics: Loss: 7.2593, Accuracy: 0.0755, Perplexity: 1421.1966
2024-12-31 21:20:45,475 - TrainingLogger - INFO - Step 28440, Batch metrics: Loss: 7.6866, Accuracy: 0.0652, Perplexity: 2179.0111
2024-12-31 21:20:52,488 - TrainingLogger - INFO - Step 28450, Batch metrics: Loss: 7.7870, Accuracy: 0.0795, Perplexity: 2409.1730
2024-12-31 21:20:59,245 - TrainingLogger - INFO - Step 28460, Batch metrics: Loss: 7.3214, Accuracy: 0.1000, Perplexity: 1512.3654
2024-12-31 21:21:06,176 - TrainingLogger - INFO - Step 28470, Batch metrics: Loss: 7.1853, Accuracy: 0.0751, Perplexity: 1319.8214
2024-12-31 21:21:13,563 - TrainingLogger - INFO - Step 28480, Batch metrics: Loss: 8.0541, Accuracy: 0.0800, Perplexity: 3146.7901
2024-12-31 21:21:20,425 - TrainingLogger - INFO - Step 28490, Batch metrics: Loss: 7.3848, Accuracy: 0.0698, Perplexity: 1611.3631
2024-12-31 21:21:27,556 - TrainingLogger - INFO - Step 28500, Batch metrics: Loss: 7.5052, Accuracy: 0.0707, Perplexity: 1817.5587
2024-12-31 21:21:27,557 - TrainingLogger - INFO - Step 28500, Prediction vs Actual:
2024-12-31 21:21:27,557 - TrainingLogger - INFO - Input 1: על פי מחקר שערכה הקרן הלאומית למדיניות אמריקנית NFAP, שניתחה את נתוני רשות ההגירה והאזרחות USCIS, בשנת 2015 עמד שיעור הסירוב לבקשות ראשוניות לוויזה מסוג H1B על 6
2024-12-31 21:21:27,558 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:21:27,558 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁על          | ✗     |
|     1 | ▁-              | ▁פי          | ✗     |
|     2 | ▁-              | ▁מחקר        | ✗     |
|     3 | ▁-              | ▁ש           | ✗     |
|     4 | יבה             | ערכה         | ✗     |
|     5 | ▁שלו            | ▁הקרן        | ✗     |
|     6 | ▁שלו            | ▁הלאומית     | ✗     |
|     7 | ▁של             | ▁ל           | ✗     |
|     8 | -               | מדיניות      | ✗     |
|     9 | ▁זו             | ▁אמריקנית    | ✗     |
|    10 | ,               | ▁N           | ✗     |
|    11 | C               | F            | ✗     |
|    12 | E               | A            | ✗     |
|    13 | </s>            | P            | ✗     |
|    14 | 2               | ,            | ✗     |
|    15 | ▁היא            | ▁שנית        | ✗     |
|    16 | נת              | חה           | ✗     |
|    17 | ▁את             | ▁את          | ✓     |
|    18 | ▁זה             | ▁נתוני       | ✗     |
|    19 | ה               | ▁רשות        | ✗     |
|    20 | ה               | ▁ההגירה      | ✗     |
|    21 | .               | ▁וה          | ✗     |
|    22 | ה               | אזרח         | ✗     |
|    23 | ות              | ות           | ✓     |
|    24 | ▁של             | ▁U           | ✗     |
|    25 | S               | S            | ✓     |
|    26 | I               | C            | ✗     |
|    27 | ה               | IS           | ✗     |
|    28 | ת               | ,            | ✗     |
|    29 | ▁לא             | ▁בשנת        | ✗     |
|    30 | ה               | ▁20          | ✗     |
|    31 | 10              | 15           | ✗     |
|    32 | ,               | ▁עמד         | ✗     |
|    33 | ה               | ▁שיעור       | ✗     |
|    34 | ה               | ▁הסירו       | ✗     |
|    35 | פה              | ב            | ✗     |
|    36 | ▁הזה            | ▁לבקש        | ✗     |
|    37 | ה               | ות           | ✗     |
|    38 | ▁נוספות         | ▁ראשוני      | ✗     |
|    39 | ות              | ות           | ✓     |
|    40 | ,               | ▁לווי        | ✗     |
|    41 | ית              | זה           | ✗     |
|    42 | ,               | ▁מסוג        | ✗     |
|    43 | ▁זה             | ▁H           | ✗     |
|    44 | E               | 1            | ✗     |
|    45 | ▁עד             | B            | ✗     |
|    46 | E               | ▁על          | ✗     |
|    47 | ▁מנת            | ▁6           | ✗     |
|    48 | ▁מיליון         |              | ✗     |

2024-12-31 21:21:27,558 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:21:27,563 - TrainingLogger - INFO - Gradient norm: 14.6324
2024-12-31 21:21:34,626 - TrainingLogger - INFO - Step 28510, Batch metrics: Loss: 7.5073, Accuracy: 0.0952, Perplexity: 1821.2284
2024-12-31 21:21:41,528 - TrainingLogger - INFO - Step 28520, Batch metrics: Loss: 8.1264, Accuracy: 0.0301, Perplexity: 3382.4454
2024-12-31 21:21:48,751 - TrainingLogger - INFO - Step 28530, Batch metrics: Loss: 7.5851, Accuracy: 0.0730, Perplexity: 1968.6870
2024-12-31 21:21:55,501 - TrainingLogger - INFO - Step 28540, Batch metrics: Loss: 7.3436, Accuracy: 0.0758, Perplexity: 1546.3163
2024-12-31 21:22:02,666 - TrainingLogger - INFO - Step 28550, Batch metrics: Loss: 7.3309, Accuracy: 0.0913, Perplexity: 1526.8298
2024-12-31 21:22:10,170 - TrainingLogger - INFO - Step 28560, Batch metrics: Loss: 7.4999, Accuracy: 0.0663, Perplexity: 1807.8726
2024-12-31 21:22:17,369 - TrainingLogger - INFO - Step 28570, Batch metrics: Loss: 7.2421, Accuracy: 0.0891, Perplexity: 1397.0783
2024-12-31 21:22:24,219 - TrainingLogger - INFO - Step 28580, Batch metrics: Loss: 7.6471, Accuracy: 0.0462, Perplexity: 2094.5525
2024-12-31 21:22:31,733 - TrainingLogger - INFO - Step 28590, Batch metrics: Loss: 7.5768, Accuracy: 0.0575, Perplexity: 1952.2845
2024-12-31 21:22:38,174 - TrainingLogger - INFO - Step 28600, Batch metrics: Loss: 7.4435, Accuracy: 0.0598, Perplexity: 1708.7668
2024-12-31 21:22:38,174 - TrainingLogger - INFO - Step 28600, Prediction vs Actual:
2024-12-31 21:22:38,174 - TrainingLogger - INFO - Input 1: לפעמים - רק לפעמים - שתיקה שווה זהב
2024-12-31 21:22:38,175 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:22:38,175 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לפעמים      | ✗     |
|     1 | ▁זה             | ▁-           | ✗     |
|     2 | ▁לא             | ▁רק          | ✗     |
|     3 | ▁קצת            | ▁לפעמים      | ✗     |
|     4 | .               | ▁-           | ✗     |
|     5 | ▁גם             | ▁שתיקה       | ✗     |
|     6 | ,               | ▁שווה        | ✗     |
|     7 | ▁ל              | ▁זהב         | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ▁את             | <pad>        | ✗     |
|    10 | ▁את             | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | ▁את             | <pad>        | ✗     |
|    13 | ▁את             | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | ▁את             | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 21:22:38,175 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:22:38,180 - TrainingLogger - INFO - Gradient norm: 11.3763
2024-12-31 21:22:45,872 - TrainingLogger - INFO - Step 28610, Batch metrics: Loss: 6.9224, Accuracy: 0.0924, Perplexity: 1014.7172
2024-12-31 21:22:53,185 - TrainingLogger - INFO - Step 28620, Batch metrics: Loss: 7.3386, Accuracy: 0.0599, Perplexity: 1538.5745
2024-12-31 21:23:00,645 - TrainingLogger - INFO - Step 28630, Batch metrics: Loss: 7.3433, Accuracy: 0.0798, Perplexity: 1545.8732
2024-12-31 21:23:06,971 - TrainingLogger - INFO - Step 28640, Batch metrics: Loss: 7.3049, Accuracy: 0.0859, Perplexity: 1487.5459
2024-12-31 21:23:13,755 - TrainingLogger - INFO - Step 28650, Batch metrics: Loss: 7.7873, Accuracy: 0.0518, Perplexity: 2409.8279
2024-12-31 21:23:20,554 - TrainingLogger - INFO - Step 28660, Batch metrics: Loss: 7.1908, Accuracy: 0.0903, Perplexity: 1327.1749
2024-12-31 21:23:27,751 - TrainingLogger - INFO - Step 28670, Batch metrics: Loss: 7.1671, Accuracy: 0.0851, Perplexity: 1296.1206
2024-12-31 21:23:34,527 - TrainingLogger - INFO - Step 28680, Batch metrics: Loss: 7.4175, Accuracy: 0.1000, Perplexity: 1664.9019
2024-12-31 21:23:41,831 - TrainingLogger - INFO - Step 28690, Batch metrics: Loss: 7.5538, Accuracy: 0.0794, Perplexity: 1908.0168
2024-12-31 21:23:48,569 - TrainingLogger - INFO - Step 28700, Batch metrics: Loss: 7.6752, Accuracy: 0.0930, Perplexity: 2154.2791
2024-12-31 21:23:48,569 - TrainingLogger - INFO - Step 28700, Prediction vs Actual:
2024-12-31 21:23:48,569 - TrainingLogger - INFO - Input 1: הבודקים ביצעו את הספירה עם מסכות וכפפות, על פי הנחיות משרד הבריאות
2024-12-31 21:23:48,570 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:23:48,570 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁של             | ▁הבו         | ✗     |
|     1 | ▁-              | דקים         | ✗     |
|     2 | ,               | ▁ביצעו       | ✗     |
|     3 | יים             | ▁את          | ✗     |
|     4 | ▁זה             | ▁הספירה      | ✗     |
|     5 | ▁האחרונה        | ▁עם          | ✗     |
|     6 | <pad>           | ▁מסכות       | ✗     |
|     7 | ,               | ▁ו           | ✗     |
|     8 | עסקים           | כפפות        | ✗     |
|     9 | ▁שונות          | ,            | ✗     |
|    10 | </s>            | ▁על          | ✗     |
|    11 | ▁מנת            | ▁פי          | ✗     |
|    12 | ▁ה              | ▁הנחיות      | ✗     |
|    13 | ,               | ▁משרד        | ✗     |
|    14 | ים              | ▁הבריאות     | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | יות             | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | י               | <pad>        | ✗     |
|    24 | ות              | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | יות             | <pad>        | ✗     |
|    36 | יות             | <pad>        | ✗     |
|    37 | ות              | <pad>        | ✗     |
|    38 | ות              | <pad>        | ✗     |
|    39 | יות             | <pad>        | ✗     |
|    40 | יות             |              | ✗     |

2024-12-31 21:23:48,570 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:23:48,575 - TrainingLogger - INFO - Gradient norm: 10.8605
2024-12-31 21:23:56,215 - TrainingLogger - INFO - Step 28710, Batch metrics: Loss: 7.1730, Accuracy: 0.1006, Perplexity: 1303.7616
2024-12-31 21:24:03,342 - TrainingLogger - INFO - Step 28720, Batch metrics: Loss: 7.5669, Accuracy: 0.0564, Perplexity: 1933.0632
2024-12-31 21:24:10,428 - TrainingLogger - INFO - Step 28730, Batch metrics: Loss: 7.3569, Accuracy: 0.0682, Perplexity: 1566.9381
2024-12-31 21:24:17,572 - TrainingLogger - INFO - Step 28740, Batch metrics: Loss: 6.6943, Accuracy: 0.1405, Perplexity: 807.7811
2024-12-31 21:24:24,798 - TrainingLogger - INFO - Step 28750, Batch metrics: Loss: 7.0358, Accuracy: 0.1313, Perplexity: 1136.6445
2024-12-31 21:24:31,518 - TrainingLogger - INFO - Step 28760, Batch metrics: Loss: 7.4871, Accuracy: 0.0511, Perplexity: 1784.9249
2024-12-31 21:24:38,832 - TrainingLogger - INFO - Step 28770, Batch metrics: Loss: 7.5600, Accuracy: 0.0843, Perplexity: 1919.9379
2024-12-31 21:24:45,794 - TrainingLogger - INFO - Step 28780, Batch metrics: Loss: 7.5027, Accuracy: 0.0698, Perplexity: 1812.9071
2024-12-31 21:24:53,038 - TrainingLogger - INFO - Step 28790, Batch metrics: Loss: 8.0383, Accuracy: 0.0376, Perplexity: 3097.4069
2024-12-31 21:25:00,256 - TrainingLogger - INFO - Step 28800, Batch metrics: Loss: 6.9885, Accuracy: 0.0934, Perplexity: 1084.0560
2024-12-31 21:25:00,256 - TrainingLogger - INFO - Step 28800, Prediction vs Actual:
2024-12-31 21:25:00,256 - TrainingLogger - INFO - Input 1: בציבור הרחב יש תחושה שאני נכנסת בהליכה לתוך הרשימה, אבל אני מאוד חוששת
2024-12-31 21:25:00,256 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:25:00,256 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בציבור      | ✗     |
|     1 | ▁-              | ▁הרחב        | ✗     |
|     2 | ה               | ▁יש          | ✗     |
|     3 | ▁לי             | ▁תחושה       | ✗     |
|     4 | ▁כזאת           | ▁שאני        | ✗     |
|     5 | ▁לא             | ▁נכנסת       | ✗     |
|     6 | ▁לשם            | ▁ב           | ✗     |
|     7 | פס              | הליכה        | ✗     |
|     8 | .               | ▁לתוך        | ✗     |
|     9 | ▁הבית           | ▁הרשימה      | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁אבל         | ✗     |
|    12 | ▁אני            | ▁אני         | ✓     |
|    13 | ▁לא             | ▁מאוד        | ✗     |
|    14 | ▁מתקשה          | ▁חוששת       | ✗     |
|    15 | ▁שזה            | <pad>        | ✗     |
|    16 | ▁שזה            | <pad>        | ✗     |
|    17 | ▁שאני           | <pad>        | ✗     |
|    18 | ▁שזה            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ▁שזה            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ▁זה             | <pad>        | ✗     |
|    28 | ▁שזה            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 21:25:00,256 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:25:00,261 - TrainingLogger - INFO - Gradient norm: 8.0676
2024-12-31 21:25:07,541 - TrainingLogger - INFO - Step 28810, Batch metrics: Loss: 7.7916, Accuracy: 0.0658, Perplexity: 2420.0766
2024-12-31 21:25:14,667 - TrainingLogger - INFO - Step 28820, Batch metrics: Loss: 7.5309, Accuracy: 0.1071, Perplexity: 1864.7110
2024-12-31 21:25:21,543 - TrainingLogger - INFO - Step 28830, Batch metrics: Loss: 6.9669, Accuracy: 0.0966, Perplexity: 1060.8912
2024-12-31 21:25:28,524 - TrainingLogger - INFO - Step 28840, Batch metrics: Loss: 7.7073, Accuracy: 0.0696, Perplexity: 2224.4180
2024-12-31 21:25:35,549 - TrainingLogger - INFO - Step 28850, Batch metrics: Loss: 7.5123, Accuracy: 0.0500, Perplexity: 1830.3375
2024-12-31 21:25:42,561 - TrainingLogger - INFO - Step 28860, Batch metrics: Loss: 8.1455, Accuracy: 0.0914, Perplexity: 3447.7900
2024-12-31 21:25:50,464 - TrainingLogger - INFO - Step 28870, Batch metrics: Loss: 7.5166, Accuracy: 0.0928, Perplexity: 1838.2392
2024-12-31 21:25:57,837 - TrainingLogger - INFO - Step 28880, Batch metrics: Loss: 7.7444, Accuracy: 0.0533, Perplexity: 2308.6476
2024-12-31 21:26:04,469 - TrainingLogger - INFO - Step 28890, Batch metrics: Loss: 7.8340, Accuracy: 0.0694, Perplexity: 2524.9951
2024-12-31 21:26:11,591 - TrainingLogger - INFO - Step 28900, Batch metrics: Loss: 7.2527, Accuracy: 0.0950, Perplexity: 1411.9170
2024-12-31 21:26:11,592 - TrainingLogger - INFO - Step 28900, Prediction vs Actual:
2024-12-31 21:26:11,592 - TrainingLogger - INFO - Input 1: נקודה מעניינת נוספת שמעלה ליליה היא כי בעיני מעסיקים, העובדה שגבר הוא אבא צעיר זה מצטיירת אפילו כיתרון, כי מדובר באדם יציב ומיושב יותר, עם צורך בפרנסה קבועה
2024-12-31 21:26:11,592 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:26:11,592 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁נקודה       | ✗     |
|     1 | ▁-              | ▁מעניינת     | ✗     |
|     2 | ▁יותר           | ▁נוספת       | ✗     |
|     3 | .               | ▁שמע         | ✗     |
|     4 | יה              | לה           | ✗     |
|     5 | ,               | ▁לילי        | ✗     |
|     6 | ין              | ה            | ✗     |
|     7 | :               | ▁היא         | ✗     |
|     8 | ▁לא             | ▁כי          | ✗     |
|     9 | פא              | ▁בעיני       | ✗     |
|    10 | ה               | ▁מעסיק       | ✗     |
|    11 | ה               | ים           | ✗     |
|    12 | ▁אותו           | ,            | ✗     |
|    13 | <pad>           | ▁העובדה      | ✗     |
|    14 | ▁היא            | ▁שגבר        | ✗     |
|    15 | י               | ▁הוא         | ✗     |
|    16 | ▁זה             | ▁אבא         | ✗     |
|    17 | ▁שלה            | ▁צעיר        | ✗     |
|    18 | ▁מאוד           | ▁זה          | ✗     |
|    19 | ▁לא             | ▁מצט         | ✗     |
|    20 | פן              | יירת         | ✗     |
|    21 | ▁רק             | ▁אפילו       | ✗     |
|    22 | ▁יותר           | ▁כ           | ✗     |
|    23 | נשיא            | יתרון        | ✗     |
|    24 | ה               | ,            | ✗     |
|    25 | </s>            | ▁כי          | ✗     |
|    26 | ון              | ▁מדובר       | ✗     |
|    27 | ▁בו             | ▁באדם        | ✗     |
|    28 | ▁אחר            | ▁יציב        | ✗     |
|    29 | ן               | ▁ומ          | ✗     |
|    30 | ודה             | יושב         | ✗     |
|    31 | ,               | ▁יותר        | ✗     |
|    32 | ,               | ,            | ✓     |
|    33 | ▁לא             | ▁עם          | ✗     |
|    34 | ▁זאת            | ▁צורך        | ✗     |
|    35 | ▁זה             | ▁בפר         | ✗     |
|    36 | יש              | נסה          | ✗     |
|    37 | ▁זו             | ▁קבועה       | ✗     |
|    38 | .               |              | ✗     |

2024-12-31 21:26:11,592 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:26:11,597 - TrainingLogger - INFO - Gradient norm: 9.6942
2024-12-31 21:26:18,939 - TrainingLogger - INFO - Step 28910, Batch metrics: Loss: 7.7878, Accuracy: 0.0592, Perplexity: 2411.1060
2024-12-31 21:26:25,684 - TrainingLogger - INFO - Step 28920, Batch metrics: Loss: 7.3755, Accuracy: 0.0970, Perplexity: 1596.3262
2024-12-31 21:26:32,825 - TrainingLogger - INFO - Step 28930, Batch metrics: Loss: 7.3493, Accuracy: 0.0750, Perplexity: 1555.0985
2024-12-31 21:26:40,157 - TrainingLogger - INFO - Step 28940, Batch metrics: Loss: 7.5824, Accuracy: 0.0673, Perplexity: 1963.2620
2024-12-31 21:26:47,293 - TrainingLogger - INFO - Step 28950, Batch metrics: Loss: 7.6047, Accuracy: 0.0857, Perplexity: 2007.6489
2024-12-31 21:26:54,721 - TrainingLogger - INFO - Step 28960, Batch metrics: Loss: 7.6356, Accuracy: 0.0732, Perplexity: 2070.6350
2024-12-31 21:27:01,429 - TrainingLogger - INFO - Step 28970, Batch metrics: Loss: 7.5645, Accuracy: 0.0570, Perplexity: 1928.5748
2024-12-31 21:27:08,655 - TrainingLogger - INFO - Step 28980, Batch metrics: Loss: 7.5413, Accuracy: 0.0577, Perplexity: 1884.1896
2024-12-31 21:27:15,530 - TrainingLogger - INFO - Step 28990, Batch metrics: Loss: 7.5304, Accuracy: 0.0727, Perplexity: 1863.9074
2024-12-31 21:27:22,353 - TrainingLogger - INFO - Step 29000, Batch metrics: Loss: 7.0859, Accuracy: 0.0949, Perplexity: 1194.9570
2024-12-31 21:27:22,353 - TrainingLogger - INFO - Step 29000, Prediction vs Actual:
2024-12-31 21:27:22,353 - TrainingLogger - INFO - Input 1: הכוח של חמאס הוא בגיוס
2024-12-31 21:27:22,354 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:27:22,354 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הכוח        | ✗     |
|     1 | ▁-              | ▁של          | ✗     |
|     2 | ▁ג              | ▁ח           | ✗     |
|     3 | נו              | מ            | ✗     |
|     4 | אס              | אס           | ✓     |
|     5 | ה               | ▁הוא         | ✗     |
|     6 | ▁-              | ▁בג          | ✗     |
|     7 | '               | יוס          | ✗     |
|     8 | ה               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | מה              | <pad>        | ✗     |
|    11 | מה              | <pad>        | ✗     |
|    12 | ▁עם             | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | מה              | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁ב              | <pad>        | ✗     |
|    17 | יה              | <pad>        | ✗     |
|    18 | אס              | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ▁היה            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ▁(              | <pad>        | ✗     |
|    25 | אס              | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ▁ס              | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁עם             |              | ✗     |

2024-12-31 21:27:22,354 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:27:22,359 - TrainingLogger - INFO - Gradient norm: 7.8061
2024-12-31 21:27:29,923 - TrainingLogger - INFO - Step 29010, Batch metrics: Loss: 7.7176, Accuracy: 0.0701, Perplexity: 2247.6669
2024-12-31 21:27:36,869 - TrainingLogger - INFO - Step 29020, Batch metrics: Loss: 7.4775, Accuracy: 0.0511, Perplexity: 1767.8123
2024-12-31 21:27:44,286 - TrainingLogger - INFO - Step 29030, Batch metrics: Loss: 7.3253, Accuracy: 0.0575, Perplexity: 1518.2267
2024-12-31 21:27:51,641 - TrainingLogger - INFO - Step 29040, Batch metrics: Loss: 7.2872, Accuracy: 0.0947, Perplexity: 1461.4665
2024-12-31 21:27:58,852 - TrainingLogger - INFO - Step 29050, Batch metrics: Loss: 7.2243, Accuracy: 0.0709, Perplexity: 1372.3978
2024-12-31 21:28:05,782 - TrainingLogger - INFO - Step 29060, Batch metrics: Loss: 7.6161, Accuracy: 0.1044, Perplexity: 2030.5581
2024-12-31 21:28:13,054 - TrainingLogger - INFO - Step 29070, Batch metrics: Loss: 7.4617, Accuracy: 0.0918, Perplexity: 1740.1742
2024-12-31 21:28:19,914 - TrainingLogger - INFO - Step 29080, Batch metrics: Loss: 7.5710, Accuracy: 0.0677, Perplexity: 1941.1333
2024-12-31 21:28:27,116 - TrainingLogger - INFO - Step 29090, Batch metrics: Loss: 7.4618, Accuracy: 0.0842, Perplexity: 1740.3310
2024-12-31 21:28:34,411 - TrainingLogger - INFO - Step 29100, Batch metrics: Loss: 7.9557, Accuracy: 0.0918, Perplexity: 2851.9060
2024-12-31 21:28:34,412 - TrainingLogger - INFO - Step 29100, Prediction vs Actual:
2024-12-31 21:28:34,445 - TrainingLogger - INFO - Input 1: כאשר נתניהו יסיים את תפקידו, בכוונתי להתמודד
2024-12-31 21:28:34,446 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:28:34,446 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁כאשר        | ✗     |
|     1 | ,               | ▁נתנ         | ✗     |
|     2 | ▁לו             | יהו          | ✗     |
|     3 | ,               | ▁יסיים       | ✗     |
|     4 | ,               | ▁את          | ✗     |
|     5 | ▁העולם          | ▁תפקידו      | ✗     |
|     6 | ,               | ,            | ✓     |
|     7 | ▁לא             | ▁בכוונת      | ✗     |
|     8 | ו               | י            | ✗     |
|     9 | ▁לשלם           | ▁להתמודד     | ✗     |
|    10 | ▁עם             | <pad>        | ✗     |
|    11 | ▁עם             | <pad>        | ✗     |
|    12 | ▁עם             | <pad>        | ✗     |
|    13 | ▁עם             | <pad>        | ✗     |
|    14 | ▁עם             | <pad>        | ✗     |
|    15 | ▁עם             | <pad>        | ✗     |
|    16 | ▁עם             | <pad>        | ✗     |
|    17 | ▁להיות          | <pad>        | ✗     |
|    18 | ▁לדאוג          | <pad>        | ✗     |
|    19 | ▁עם             | <pad>        | ✗     |
|    20 | יות             | <pad>        | ✗     |
|    21 | ▁ב              | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | ▁עם             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁להיות          | <pad>        | ✗     |
|    27 | ▁להיות          | <pad>        | ✗     |
|    28 | ▁להיות          | <pad>        | ✗     |
|    29 | ▁להיות          | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ▁לנצח           | <pad>        | ✗     |
|    32 | ▁להיות          | <pad>        | ✗     |
|    33 | ▁גם             | <pad>        | ✗     |
|    34 | ▁בפני           | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ▁להיות          | <pad>        | ✗     |
|    39 | ▁את             | <pad>        | ✗     |
|    40 | ▁להיות          | <pad>        | ✗     |
|    41 | ▁עם             | <pad>        | ✗     |
|    42 | ▁להיות          |              | ✗     |

2024-12-31 21:28:34,446 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:28:34,451 - TrainingLogger - INFO - Gradient norm: 9.9832
2024-12-31 21:28:41,436 - TrainingLogger - INFO - Step 29110, Batch metrics: Loss: 7.9261, Accuracy: 0.0452, Perplexity: 2768.7224
2024-12-31 21:28:48,528 - TrainingLogger - INFO - Step 29120, Batch metrics: Loss: 7.3359, Accuracy: 0.0539, Perplexity: 1534.3369
2024-12-31 21:28:55,500 - TrainingLogger - INFO - Step 29130, Batch metrics: Loss: 7.7065, Accuracy: 0.0775, Perplexity: 2222.6993
2024-12-31 21:29:03,152 - TrainingLogger - INFO - Step 29140, Batch metrics: Loss: 7.7810, Accuracy: 0.0758, Perplexity: 2394.6184
2024-12-31 21:29:10,737 - TrainingLogger - INFO - Step 29150, Batch metrics: Loss: 7.5361, Accuracy: 0.0635, Perplexity: 1874.5542
2024-12-31 21:29:18,174 - TrainingLogger - INFO - Step 29160, Batch metrics: Loss: 7.1179, Accuracy: 0.0892, Perplexity: 1233.8159
2024-12-31 21:29:25,629 - TrainingLogger - INFO - Step 29170, Batch metrics: Loss: 7.5800, Accuracy: 0.0638, Perplexity: 1958.5392
2024-12-31 21:29:32,557 - TrainingLogger - INFO - Step 29180, Batch metrics: Loss: 7.8189, Accuracy: 0.0711, Perplexity: 2487.2264
2024-12-31 21:29:39,265 - TrainingLogger - INFO - Step 29190, Batch metrics: Loss: 7.6530, Accuracy: 0.0750, Perplexity: 2106.8663
2024-12-31 21:29:46,633 - TrainingLogger - INFO - Step 29200, Batch metrics: Loss: 7.3177, Accuracy: 0.0933, Perplexity: 1506.7997
2024-12-31 21:29:46,633 - TrainingLogger - INFO - Step 29200, Prediction vs Actual:
2024-12-31 21:29:46,633 - TrainingLogger - INFO - Input 1: כשהם היו רעבים המאמן אק היה משתמש בפנס כדי להאיר את הנטיפים למעלה ואומר להם לשתות את המים שמטפטפים
2024-12-31 21:29:46,634 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:29:46,634 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כשהם        | ✗     |
|     1 | ▁-              | ▁היו         | ✗     |
|     2 | ▁לך             | ▁רעבים       | ✗     |
|     3 | ▁-              | ▁המאמן       | ✗     |
|     4 | ?               | ▁אק          | ✗     |
|     5 | ד               | ▁היה         | ✗     |
|     6 | ▁צריך           | ▁משתמש       | ✗     |
|     7 | ▁ב              | ▁ב           | ✓     |
|     8 | תיבה            | פנס          | ✗     |
|     9 | ים              | ▁כדי         | ✗     |
|    10 | ▁להגן           | ▁להאיר       | ✗     |
|    11 | ▁את             | ▁את          | ✓     |
|    12 | ▁עצמו           | ▁ה           | ✗     |
|    13 | פס              | נט           | ✗     |
|    14 | ונות            | יפים         | ✗     |
|    15 | ▁האלה           | ▁למעלה       | ✗     |
|    16 | .               | ▁ואומר       | ✗     |
|    17 | ▁להם            | ▁להם         | ✓     |
|    18 | ▁את             | ▁לשתות       | ✗     |
|    19 | ▁ול             | ▁את          | ✗     |
|    20 | ▁זה             | ▁המים        | ✗     |
|    21 | .               | ▁שמ          | ✗     |
|    22 | יש              | טפט          | ✗     |
|    23 | פים             | פים          | ✓     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               |              | ✗     |

2024-12-31 21:29:46,634 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:29:46,639 - TrainingLogger - INFO - Gradient norm: 9.1274
2024-12-31 21:29:53,330 - TrainingLogger - INFO - Step 29210, Batch metrics: Loss: 7.4205, Accuracy: 0.1020, Perplexity: 1669.9443
2024-12-31 21:30:00,436 - TrainingLogger - INFO - Step 29220, Batch metrics: Loss: 7.6588, Accuracy: 0.0808, Perplexity: 2119.1495
2024-12-31 21:30:07,122 - TrainingLogger - INFO - Step 29230, Batch metrics: Loss: 7.6097, Accuracy: 0.0577, Perplexity: 2017.6722
2024-12-31 21:30:14,088 - TrainingLogger - INFO - Step 29240, Batch metrics: Loss: 7.5571, Accuracy: 0.0905, Perplexity: 1914.2181
2024-12-31 21:30:20,855 - TrainingLogger - INFO - Step 29250, Batch metrics: Loss: 7.5199, Accuracy: 0.0621, Perplexity: 1844.3931
2024-12-31 21:30:27,828 - TrainingLogger - INFO - Step 29260, Batch metrics: Loss: 7.4475, Accuracy: 0.0615, Perplexity: 1715.6511
2024-12-31 21:30:34,858 - TrainingLogger - INFO - Step 29270, Batch metrics: Loss: 8.0536, Accuracy: 0.0377, Perplexity: 3144.9810
2024-12-31 21:30:42,540 - TrainingLogger - INFO - Step 29280, Batch metrics: Loss: 7.7848, Accuracy: 0.0843, Perplexity: 2403.7052
2024-12-31 21:30:49,569 - TrainingLogger - INFO - Step 29290, Batch metrics: Loss: 7.2031, Accuracy: 0.1085, Perplexity: 1343.5705
2024-12-31 21:30:56,893 - TrainingLogger - INFO - Step 29300, Batch metrics: Loss: 7.5676, Accuracy: 0.0508, Perplexity: 1934.3983
2024-12-31 21:30:56,894 - TrainingLogger - INFO - Step 29300, Prediction vs Actual:
2024-12-31 21:30:56,894 - TrainingLogger - INFO - Input 1: בשעה זו קבינט המלחמה מתכנס במשרד ראש הממשלה בירושלים, כשבקהיר מצפים לתגובה מישראל עד מחר לתשובת חמאס
2024-12-31 21:30:56,894 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:30:56,894 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בשעה        | ✗     |
|     1 | ▁-              | ▁זו          | ✗     |
|     2 | ▁לא             | ▁ק           | ✗     |
|     3 | ִ               | בי           | ✗     |
|     4 | נל              | נט           | ✗     |
|     5 | ים              | ▁המלחמה      | ✗     |
|     6 | ▁הראשונה        | ▁מ           | ✗     |
|     7 | ובה             | תכנס         | ✗     |
|     8 | ת               | ▁במשרד       | ✗     |
|     9 | ו               | ▁ראש         | ✗     |
|    10 | ▁העיר           | ▁הממשלה      | ✗     |
|    11 | .               | ▁בירושלים    | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁כש          | ✗     |
|    14 | ע               | בק           | ✗     |
|    15 | ד               | ה            | ✗     |
|    16 | ▁את             | יר           | ✗     |
|    17 | ,               | ▁מצפים       | ✗     |
|    18 | ▁לה             | ▁ל           | ✗     |
|    19 | להקה            | תגובה        | ✗     |
|    20 | .               | ▁מ           | ✗     |
|    21 | נטלי            | ישראל        | ✗     |
|    22 | .               | ▁עד          | ✗     |
|    23 | ▁היום           | ▁מחר         | ✗     |
|    24 | ,               | ▁ל           | ✗     |
|    25 | ערך             | תשובת        | ✗     |
|    26 | ו               | ▁ח           | ✗     |
|    27 | ות              | מ            | ✗     |
|    28 | אס              | אס           | ✓     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 21:30:56,894 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:30:56,899 - TrainingLogger - INFO - Gradient norm: 9.1013
2024-12-31 21:31:03,853 - TrainingLogger - INFO - Step 29310, Batch metrics: Loss: 7.3908, Accuracy: 0.0769, Perplexity: 1621.0743
2024-12-31 21:31:10,370 - TrainingLogger - INFO - Step 29320, Batch metrics: Loss: 7.0312, Accuracy: 0.0968, Perplexity: 1131.4219
2024-12-31 21:31:17,663 - TrainingLogger - INFO - Step 29330, Batch metrics: Loss: 7.4856, Accuracy: 0.0616, Perplexity: 1782.1082
2024-12-31 21:31:24,909 - TrainingLogger - INFO - Step 29340, Batch metrics: Loss: 7.6750, Accuracy: 0.0845, Perplexity: 2153.8754
2024-12-31 21:31:32,776 - TrainingLogger - INFO - Step 29350, Batch metrics: Loss: 7.9028, Accuracy: 0.0628, Perplexity: 2704.9165
2024-12-31 21:31:39,875 - TrainingLogger - INFO - Step 29360, Batch metrics: Loss: 8.2081, Accuracy: 0.0733, Perplexity: 3670.5314
2024-12-31 21:31:47,007 - TrainingLogger - INFO - Step 29370, Batch metrics: Loss: 7.8174, Accuracy: 0.0414, Perplexity: 2483.3761
2024-12-31 21:31:54,163 - TrainingLogger - INFO - Step 29380, Batch metrics: Loss: 6.7781, Accuracy: 0.1065, Perplexity: 878.4049
2024-12-31 21:32:01,560 - TrainingLogger - INFO - Step 29390, Batch metrics: Loss: 7.2575, Accuracy: 0.0930, Perplexity: 1418.6772
2024-12-31 21:32:09,103 - TrainingLogger - INFO - Step 29400, Batch metrics: Loss: 7.6031, Accuracy: 0.0476, Perplexity: 2004.4818
2024-12-31 21:32:09,103 - TrainingLogger - INFO - Step 29400, Prediction vs Actual:
2024-12-31 21:32:09,103 - TrainingLogger - INFO - Input 1: משמעות סיום המלחמה היא שחמאס תוך כמה חודשים ספורים משקם את עצמו, ואז אנחנו חוזרים ל-6 באוקטובר
2024-12-31 21:32:09,104 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:32:09,104 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ון              | ▁משמעות      | ✗     |
|     1 | ▁-              | ▁סיום        | ✗     |
|     2 | ▁-              | ▁המלחמה      | ✗     |
|     3 | ▁-              | ▁היא         | ✗     |
|     4 | ▁לא             | ▁שח          | ✗     |
|     5 | ה               | מ            | ✗     |
|     6 | "               | אס           | ✗     |
|     7 | ,               | ▁תוך         | ✗     |
|     8 | ▁זמן            | ▁כמה         | ✗     |
|     9 | ▁ימים           | ▁חודשים      | ✗     |
|    10 | ,               | ▁ספורים      | ✗     |
|    11 | .               | ▁משק         | ✗     |
|    12 | ים              | ם            | ✗     |
|    13 | ▁את             | ▁את          | ✓     |
|    14 | ▁זה             | ▁עצמו        | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | <pad>           | ▁ואז         | ✗     |
|    17 | ▁הוא            | ▁אנחנו       | ✗     |
|    18 | ▁צריכים         | ▁חוזרים      | ✗     |
|    19 | ▁אליו           | ▁ל           | ✗     |
|    20 | ים              | -6           | ✗     |
|    21 | ▁חודשים         | ▁באוקטובר    | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ▁עד             | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | ▁עד             | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | ▁את             | <pad>        | ✗     |
|    35 | ▁עד             | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ▁עד             | <pad>        | ✗     |
|    38 | ▁זה             | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ▁עד             |              | ✗     |

2024-12-31 21:32:09,104 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:32:09,109 - TrainingLogger - INFO - Gradient norm: 11.2748
2024-12-31 21:32:16,145 - TrainingLogger - INFO - Step 29410, Batch metrics: Loss: 7.2524, Accuracy: 0.0899, Perplexity: 1411.5307
2024-12-31 21:32:23,257 - TrainingLogger - INFO - Step 29420, Batch metrics: Loss: 7.3099, Accuracy: 0.0879, Perplexity: 1495.0359
2024-12-31 21:32:30,159 - TrainingLogger - INFO - Step 29430, Batch metrics: Loss: 7.0989, Accuracy: 0.1037, Perplexity: 1210.5877
2024-12-31 21:32:37,588 - TrainingLogger - INFO - Step 29440, Batch metrics: Loss: 7.5460, Accuracy: 0.0792, Perplexity: 1893.0746
2024-12-31 21:32:45,085 - TrainingLogger - INFO - Step 29450, Batch metrics: Loss: 7.7388, Accuracy: 0.0741, Perplexity: 2295.6930
2024-12-31 21:32:52,439 - TrainingLogger - INFO - Step 29460, Batch metrics: Loss: 7.3295, Accuracy: 0.0807, Perplexity: 1524.6167
2024-12-31 21:32:59,522 - TrainingLogger - INFO - Step 29470, Batch metrics: Loss: 7.6770, Accuracy: 0.0747, Perplexity: 2158.0308
2024-12-31 21:33:07,049 - TrainingLogger - INFO - Step 29480, Batch metrics: Loss: 7.6181, Accuracy: 0.0543, Perplexity: 2034.7618
2024-12-31 21:33:14,609 - TrainingLogger - INFO - Step 29490, Batch metrics: Loss: 7.2940, Accuracy: 0.0886, Perplexity: 1471.3839
2024-12-31 21:33:21,600 - TrainingLogger - INFO - Step 29500, Batch metrics: Loss: 7.5193, Accuracy: 0.0655, Perplexity: 1843.3583
2024-12-31 21:33:21,601 - TrainingLogger - INFO - Step 29500, Prediction vs Actual:
2024-12-31 21:33:21,601 - TrainingLogger - INFO - Input 1: חדאד אמר בנוסף אמרתי להם - אתה פונה לבן אדם הלא נכון
2024-12-31 21:33:21,601 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:33:21,601 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁חד          | ✗     |
|     1 | ▁-              | אד           | ✗     |
|     2 | ▁-              | ▁אמר         | ✗     |
|     3 | ▁-              | ▁בנוסף       | ✗     |
|     4 | ,               | ▁אמרתי       | ✗     |
|     5 | ▁לך             | ▁להם         | ✗     |
|     6 | ,               | ▁-           | ✗     |
|     7 | <pad>           | ▁אתה         | ✗     |
|     8 | ▁לא             | ▁פונה        | ✗     |
|     9 | ▁אליי           | ▁לבן         | ✗     |
|    10 | ▁שלי            | ▁אדם         | ✗     |
|    11 | ▁אחר            | ▁הלא         | ✗     |
|    12 | ▁נכון           | ▁נכון        | ✓     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ▁לא             | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | .               | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | ▁לא             |              | ✗     |

2024-12-31 21:33:21,601 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:33:21,606 - TrainingLogger - INFO - Gradient norm: 8.9383
2024-12-31 21:33:28,533 - TrainingLogger - INFO - Step 29510, Batch metrics: Loss: 7.1160, Accuracy: 0.1077, Perplexity: 1231.4683
2024-12-31 21:33:35,298 - TrainingLogger - INFO - Step 29520, Batch metrics: Loss: 7.3650, Accuracy: 0.0688, Perplexity: 1579.6819
2024-12-31 21:33:41,912 - TrainingLogger - INFO - Step 29530, Batch metrics: Loss: 7.8844, Accuracy: 0.0654, Perplexity: 2655.6462
2024-12-31 21:33:49,232 - TrainingLogger - INFO - Step 29540, Batch metrics: Loss: 7.3479, Accuracy: 0.0643, Perplexity: 1552.8985
2024-12-31 21:33:56,425 - TrainingLogger - INFO - Step 29550, Batch metrics: Loss: 7.2543, Accuracy: 0.0837, Perplexity: 1414.1533
2024-12-31 21:34:04,003 - TrainingLogger - INFO - Step 29560, Batch metrics: Loss: 7.4119, Accuracy: 0.0994, Perplexity: 1655.5216
2024-12-31 21:34:11,629 - TrainingLogger - INFO - Step 29570, Batch metrics: Loss: 7.5614, Accuracy: 0.0843, Perplexity: 1922.5048
2024-12-31 21:34:18,836 - TrainingLogger - INFO - Step 29580, Batch metrics: Loss: 7.8877, Accuracy: 0.0447, Perplexity: 2664.3816
2024-12-31 21:34:26,098 - TrainingLogger - INFO - Step 29590, Batch metrics: Loss: 7.2153, Accuracy: 0.0838, Perplexity: 1360.1233
2024-12-31 21:34:33,258 - TrainingLogger - INFO - Step 29600, Batch metrics: Loss: 7.8055, Accuracy: 0.0622, Perplexity: 2454.0869
2024-12-31 21:34:33,258 - TrainingLogger - INFO - Step 29600, Prediction vs Actual:
2024-12-31 21:34:33,258 - TrainingLogger - INFO - Input 1: בנוסף, בישראל דורשים לקבל את תנאי חמאס להחלפת שבויים, כלומר כמה מחבלים ישוחררו מבחינתם בעבור כל חטוף מהקטגוריות השונות נשים, חולים כרוניים, מבוגרים וחיילות
2024-12-31 21:34:33,259 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:34:33,259 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בנוסף       | ✗     |
|     1 | יה              | ,            | ✗     |
|     2 | ▁לא             | ▁בישראל      | ✗     |
|     3 | .               | ▁דורשים      | ✗     |
|     4 | ▁כסף            | ▁לקבל        | ✗     |
|     5 | ▁את             | ▁את          | ✓     |
|     6 | ▁זה             | ▁תנאי        | ✗     |
|     7 | ▁העבודה         | ▁ח           | ✗     |
|     8 | ות              | מ            | ✗     |
|     9 | אס              | אס           | ✓     |
|    10 | ,               | ▁ל           | ✗     |
|    11 | -               | החלפת        | ✗     |
|    12 | ם               | ▁שבויים      | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | </s>            | ▁כלומר       | ✗     |
|    15 | ,               | ▁כמה         | ✗     |
|    16 | ▁אנשים          | ▁מחבל        | ✗     |
|    17 | ים              | ים           | ✓     |
|    18 | ▁קטנים          | ▁ישוחרר      | ✗     |
|    19 | ים              | ו            | ✗     |
|    20 | .               | ▁מבחינת      | ✗     |
|    21 | ו               | ם            | ✗     |
|    22 | .               | ▁בעבור       | ✗     |
|    23 | ו               | ▁כל          | ✗     |
|    24 | ▁יום            | ▁חטוף        | ✗     |
|    25 | .               | ▁מה          | ✗     |
|    26 | ו               | קט           | ✗     |
|    27 | נה              | גורי         | ✗     |
|    28 | ה               | ות           | ✗     |
|    29 | ▁שלהם           | ▁השונות      | ✗     |
|    30 | .               | ▁נשים        | ✗     |
|    31 | ▁אחרות          | ,            | ✗     |
|    32 | </s>            | ▁חולים       | ✗     |
|    33 | ▁אחרים          | ▁כרוני       | ✗     |
|    34 | ים              | ים           | ✓     |
|    35 | ,               | ,            | ✓     |
|    36 | </s>            | ▁מבוגרים     | ✗     |
|    37 | ,               | ▁וחי         | ✗     |
|    38 | ונות            | ילות         | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | י               | <pad>        | ✗     |
|    41 | ים              | <pad>        | ✗     |
|    42 | יים             | <pad>        | ✗     |
|    43 | יים             | <pad>        | ✗     |
|    44 | י               | <pad>        | ✗     |
|    45 | י               | <pad>        | ✗     |
|    46 | ים              |              | ✗     |

2024-12-31 21:34:33,259 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:34:33,264 - TrainingLogger - INFO - Gradient norm: 13.9889
2024-12-31 21:34:40,909 - TrainingLogger - INFO - Step 29610, Batch metrics: Loss: 7.3994, Accuracy: 0.1067, Perplexity: 1634.9934
2024-12-31 21:34:48,558 - TrainingLogger - INFO - Step 29620, Batch metrics: Loss: 7.6238, Accuracy: 0.0625, Perplexity: 2046.3493
2024-12-31 21:34:55,918 - TrainingLogger - INFO - Step 29630, Batch metrics: Loss: 7.3688, Accuracy: 0.0899, Perplexity: 1585.8041
2024-12-31 21:35:03,261 - TrainingLogger - INFO - Step 29640, Batch metrics: Loss: 8.1649, Accuracy: 0.0519, Perplexity: 3515.5435
2024-12-31 21:35:10,716 - TrainingLogger - INFO - Step 29650, Batch metrics: Loss: 8.1404, Accuracy: 0.0545, Perplexity: 3430.2862
2024-12-31 21:35:17,752 - TrainingLogger - INFO - Step 29660, Batch metrics: Loss: 7.1893, Accuracy: 0.0856, Perplexity: 1325.2095
2024-12-31 21:35:24,752 - TrainingLogger - INFO - Step 29670, Batch metrics: Loss: 7.5924, Accuracy: 0.0751, Perplexity: 1982.9794
2024-12-31 21:35:31,585 - TrainingLogger - INFO - Step 29680, Batch metrics: Loss: 7.3453, Accuracy: 0.0927, Perplexity: 1548.9752
2024-12-31 21:35:39,301 - TrainingLogger - INFO - Step 29690, Batch metrics: Loss: 7.5474, Accuracy: 0.0861, Perplexity: 1895.8271
2024-12-31 21:35:46,328 - TrainingLogger - INFO - Step 29700, Batch metrics: Loss: 7.2306, Accuracy: 0.0682, Perplexity: 1380.9980
2024-12-31 21:35:46,329 - TrainingLogger - INFO - Step 29700, Prediction vs Actual:
2024-12-31 21:35:46,329 - TrainingLogger - INFO - Input 1: זה נובע מכך שאנשים שצריכים לספור כל כך הרבה קולות, ולהעביר מכאן לכאן בלי להתבלבל בשורות ובמספרים
2024-12-31 21:35:46,330 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:35:46,330 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁זה          | ✗     |
|     1 | ▁לא             | ▁נובע        | ✗     |
|     2 | ▁הוא            | ▁מכך         | ✗     |
|     3 | ▁לא             | ▁שאנשים      | ✗     |
|     4 | ▁לא             | ▁שצריכים     | ✗     |
|     5 | ▁לשלם           | ▁לספור       | ✗     |
|     6 | ▁את             | ▁כל          | ✗     |
|     7 | ▁שנה            | ▁כך          | ✗     |
|     8 | ▁הרבה           | ▁הרבה        | ✓     |
|     9 | ▁זמן            | ▁קולות       | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁ולה         | ✗     |
|    12 | ק               | עביר         | ✗     |
|    13 | ▁את             | ▁מכאן        | ✗     |
|    14 | ▁את             | ▁לכאן        | ✗     |
|    15 | .               | ▁בלי         | ✗     |
|    16 | ▁סיבה           | ▁לה          | ✗     |
|    17 | צ               | תבלבל        | ✗     |
|    18 | ים              | ▁בשורות      | ✗     |
|    19 | יהם             | ▁וב          | ✗     |
|    20 | מס              | מספר         | ✗     |
|    21 | ים              | ים           | ✓     |
|    22 | ▁אחרים          | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁שונים          | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁שונים          | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁חדשים          | <pad>        | ✗     |
|    31 | ▁אחרים          | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | </s>            |              | ✗     |

2024-12-31 21:35:46,330 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:35:46,335 - TrainingLogger - INFO - Gradient norm: 10.6768
2024-12-31 21:35:52,998 - TrainingLogger - INFO - Step 29710, Batch metrics: Loss: 7.2585, Accuracy: 0.1082, Perplexity: 1420.1262
2024-12-31 21:35:59,924 - TrainingLogger - INFO - Step 29720, Batch metrics: Loss: 7.1697, Accuracy: 0.0838, Perplexity: 1299.4815
2024-12-31 21:36:07,543 - TrainingLogger - INFO - Step 29730, Batch metrics: Loss: 7.3520, Accuracy: 0.1007, Perplexity: 1559.2470
2024-12-31 21:36:14,910 - TrainingLogger - INFO - Step 29740, Batch metrics: Loss: 7.5501, Accuracy: 0.0556, Perplexity: 1900.8383
2024-12-31 21:36:22,108 - TrainingLogger - INFO - Step 29750, Batch metrics: Loss: 7.6140, Accuracy: 0.0722, Perplexity: 2026.2782
2024-12-31 21:36:29,379 - TrainingLogger - INFO - Step 29760, Batch metrics: Loss: 7.7636, Accuracy: 0.0593, Perplexity: 2353.3533
2024-12-31 21:36:36,105 - TrainingLogger - INFO - Step 29770, Batch metrics: Loss: 7.2339, Accuracy: 0.0902, Perplexity: 1385.6484
2024-12-31 21:36:43,658 - TrainingLogger - INFO - Step 29780, Batch metrics: Loss: 7.4711, Accuracy: 0.0905, Perplexity: 1756.6129
2024-12-31 21:36:51,324 - TrainingLogger - INFO - Step 29790, Batch metrics: Loss: 7.4579, Accuracy: 0.0688, Perplexity: 1733.5023
2024-12-31 21:36:58,944 - TrainingLogger - INFO - Step 29800, Batch metrics: Loss: 7.2294, Accuracy: 0.0427, Perplexity: 1379.3541
2024-12-31 21:36:58,945 - TrainingLogger - INFO - Step 29800, Prediction vs Actual:
2024-12-31 21:36:58,945 - TrainingLogger - INFO - Input 1: ההתנדבות כוללת העברת הפעלההרצאה בנושאים שונים ומגוונים כגון תעסוקה, אמנות, אקטואליה וכו
2024-12-31 21:36:58,945 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:36:58,946 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תה              | ▁ה           | ✗     |
|     1 | ▁-              | התנדב        | ✗     |
|     2 | ▁-              | ות           | ✗     |
|     3 | ▁-              | ▁כוללת       | ✗     |
|     4 | ,               | ▁העברת       | ✗     |
|     5 | ▁כסף            | ▁הפעלה       | ✗     |
|     6 | ▁דומה           | ה            | ✗     |
|     7 | חדש             | רצ           | ✗     |
|     8 | ▁-              | אה           | ✗     |
|     9 | ?               | ▁בנושאים     | ✗     |
|    10 | ▁רבים           | ▁שונים       | ✗     |
|    11 | .               | ▁ומ          | ✗     |
|    12 | זה              | גוונים       | ✗     |
|    13 | ▁רבים           | ▁כגון        | ✗     |
|    14 | ▁זה             | ▁תעסוקה      | ✗     |
|    15 | ▁מלאה           | ,            | ✗     |
|    16 | <pad>           | ▁אמנות       | ✗     |
|    17 | י               | ,            | ✗     |
|    18 | ▁לא             | ▁א           | ✗     |
|    19 | מנה             | קטו          | ✗     |
|    20 | אלית            | אלי          | ✗     |
|    21 | ת               | ה            | ✗     |
|    22 | ,               | ▁וכו         | ✗     |
|    23 | ונה             | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ה               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ה               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 21:36:58,946 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:36:58,951 - TrainingLogger - INFO - Gradient norm: 8.1651
2024-12-31 21:37:06,328 - TrainingLogger - INFO - Step 29810, Batch metrics: Loss: 6.7590, Accuracy: 0.0899, Perplexity: 861.7650
2024-12-31 21:37:13,772 - TrainingLogger - INFO - Step 29820, Batch metrics: Loss: 7.0134, Accuracy: 0.1342, Perplexity: 1111.4795
2024-12-31 21:37:21,068 - TrainingLogger - INFO - Step 29830, Batch metrics: Loss: 7.0344, Accuracy: 0.0878, Perplexity: 1135.0499
2024-12-31 21:37:27,972 - TrainingLogger - INFO - Step 29840, Batch metrics: Loss: 7.5403, Accuracy: 0.0839, Perplexity: 1882.3119
2024-12-31 21:37:35,654 - TrainingLogger - INFO - Step 29850, Batch metrics: Loss: 7.9387, Accuracy: 0.0402, Perplexity: 2803.5989
2024-12-31 21:37:42,589 - TrainingLogger - INFO - Step 29860, Batch metrics: Loss: 7.2837, Accuracy: 0.1303, Perplexity: 1456.3430
2024-12-31 21:37:49,840 - TrainingLogger - INFO - Step 29870, Batch metrics: Loss: 7.4726, Accuracy: 0.0532, Perplexity: 1759.2610
2024-12-31 21:37:57,224 - TrainingLogger - INFO - Step 29880, Batch metrics: Loss: 7.3276, Accuracy: 0.0655, Perplexity: 1521.7985
2024-12-31 21:38:03,854 - TrainingLogger - INFO - Step 29890, Batch metrics: Loss: 7.4048, Accuracy: 0.0833, Perplexity: 1643.9014
2024-12-31 21:38:11,222 - TrainingLogger - INFO - Step 29900, Batch metrics: Loss: 7.5922, Accuracy: 0.0657, Perplexity: 1982.6494
2024-12-31 21:38:11,222 - TrainingLogger - INFO - Step 29900, Prediction vs Actual:
2024-12-31 21:38:11,222 - TrainingLogger - INFO - Input 1: תראו איך טוב מתגלגל בעם שלנו, כמו כדור שלג ממש עמותת הגשמת חלום נעזרה בי כדי לחלק למילואימניקים כרטיסים להופעה של קולדפליי
2024-12-31 21:38:11,223 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:38:11,223 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁תראו        | ✗     |
|     1 | ▁-              | ▁איך         | ✗     |
|     2 | ▁-              | ▁טוב         | ✗     |
|     3 | ,               | ▁מתגלגל      | ✗     |
|     4 | ים              | ▁בעם         | ✗     |
|     5 | .               | ▁שלנו        | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | ▁נכון           | ▁כמו         | ✗     |
|     8 | ▁תמיד           | ▁כדור        | ✗     |
|     9 | ▁אחד            | ▁שלג         | ✗     |
|    10 | .               | ▁ממש         | ✗     |
|    11 | ▁גדול           | ▁עמו         | ✗     |
|    12 | ם               | ת            | ✗     |
|    13 | ת               | ת            | ✓     |
|    14 | .               | ▁הג          | ✗     |
|    15 | '               | שמת          | ✗     |
|    16 | ▁דם             | ▁חלום        | ✗     |
|    17 | .               | ▁נעזר        | ✗     |
|    18 | ת               | ה            | ✗     |
|    19 | ▁בו             | ▁בי          | ✗     |
|    20 | .               | ▁כדי         | ✗     |
|    21 | ▁להיות          | ▁לחלק        | ✗     |
|    22 | ▁את             | ▁למי         | ✗     |
|    23 | צ               | ל            | ✗     |
|    24 | ציות            | ואי          | ✗     |
|    25 | ו               | מני          | ✗     |
|    26 | ו               | קים          | ✗     |
|    27 | .               | ▁כרטיסים     | ✗     |
|    28 | ▁חדשים          | ▁להופעה      | ✗     |
|    29 | ▁שלנו           | ▁של          | ✗     |
|    30 | ▁אנשים          | ▁קול         | ✗     |
|    31 | ני              | ד            | ✗     |
|    32 | אלי             | פליי         | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁חדש            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | ▁של             | <pad>        | ✗     |
|    44 | <pad>           | <pad>        | ✓     |
|    45 | .               |              | ✗     |

2024-12-31 21:38:11,223 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:38:11,228 - TrainingLogger - INFO - Gradient norm: 8.6654
2024-12-31 21:38:19,027 - TrainingLogger - INFO - Step 29910, Batch metrics: Loss: 7.2763, Accuracy: 0.0920, Perplexity: 1445.6547
2024-12-31 21:38:26,232 - TrainingLogger - INFO - Step 29920, Batch metrics: Loss: 7.8807, Accuracy: 0.0690, Perplexity: 2645.7129
2024-12-31 21:38:33,942 - TrainingLogger - INFO - Step 29930, Batch metrics: Loss: 7.1943, Accuracy: 0.0707, Perplexity: 1331.8072
2024-12-31 21:38:41,041 - TrainingLogger - INFO - Step 29940, Batch metrics: Loss: 7.5069, Accuracy: 0.0745, Perplexity: 1820.4974
2024-12-31 21:38:48,023 - TrainingLogger - INFO - Step 29950, Batch metrics: Loss: 7.6639, Accuracy: 0.0523, Perplexity: 2130.1193
2024-12-31 21:38:55,484 - TrainingLogger - INFO - Step 29960, Batch metrics: Loss: 7.6215, Accuracy: 0.0489, Perplexity: 2041.7167
2024-12-31 21:39:02,386 - TrainingLogger - INFO - Step 29970, Batch metrics: Loss: 7.8052, Accuracy: 0.0788, Perplexity: 2453.3030
2024-12-31 21:39:09,563 - TrainingLogger - INFO - Step 29980, Batch metrics: Loss: 7.7967, Accuracy: 0.0545, Perplexity: 2432.5821
2024-12-31 21:39:16,579 - TrainingLogger - INFO - Step 29990, Batch metrics: Loss: 6.9985, Accuracy: 0.0533, Perplexity: 1094.9559
2024-12-31 21:39:23,966 - TrainingLogger - INFO - Step 30000, Batch metrics: Loss: 7.5671, Accuracy: 0.0718, Perplexity: 1933.5748
2024-12-31 21:39:23,967 - TrainingLogger - INFO - Step 30000, Prediction vs Actual:
2024-12-31 21:39:23,967 - TrainingLogger - INFO - Input 1: הם קיבלו החלטה לא לענות ולא לתת שום פרטים על שתי הסוגיות המרכזיות הרשימה המעודכנת של החטופים, ומספר האסירים שישוחררו בעבור כל חטוף ישראלי
2024-12-31 21:39:23,968 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:39:23,968 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הם          | ✗     |
|     1 | ▁-              | ▁קיבלו       | ✗     |
|     2 | ▁את             | ▁החלטה       | ✗     |
|     3 | ▁זו             | ▁לא          | ✗     |
|     4 | ▁נכונה          | ▁לענות       | ✗     |
|     5 | ▁עליהם          | ▁ולא         | ✗     |
|     6 | ▁לה             | ▁לתת         | ✗     |
|     7 | ▁לו             | ▁שום         | ✗     |
|     8 | ▁סיבה           | ▁פרטים       | ✗     |
|     9 | .               | ▁על          | ✗     |
|    10 | ▁זה             | ▁שתי         | ✗     |
|    11 | ▁רגליים         | ▁הסוג        | ✗     |
|    12 | יות             | יות          | ✓     |
|    13 | ▁שלו            | ▁המרכזי      | ✗     |
|    14 | ות              | ות           | ✓     |
|    15 | ▁שלהם           | ▁הרשימה      | ✗     |
|    16 | .               | ▁המ          | ✗     |
|    17 | תבצע            | עוד          | ✗     |
|    18 | כן              | כנת          | ✗     |
|    19 | ות              | ▁של          | ✗     |
|    20 | ▁ה              | ▁הח          | ✗     |
|    21 | מוש             | טופ          | ✗     |
|    22 | ים              | ים           | ✓     |
|    23 | .               | ,            | ✗     |
|    24 | </s>            | ▁ומספר       | ✗     |
|    25 | ים              | ▁האסירים     | ✗     |
|    26 | ,               | ▁שי          | ✗     |
|    27 | סע              | שוחרר        | ✗     |
|    28 | ו               | ו            | ✓     |
|    29 | ▁ב              | ▁בעבור       | ✗     |
|    30 | ם               | ▁כל          | ✗     |
|    31 | ▁הזכויות        | ▁חטוף        | ✗     |
|    32 | .               | ▁ישראל       | ✗     |
|    33 | .               | י            | ✗     |
|    34 | ▁הזה            | <pad>        | ✗     |
|    35 | ▁שלהם           | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ▁המדינה         | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ם               | <pad>        | ✗     |
|    46 | ם               | <pad>        | ✗     |
|    47 | ם               | <pad>        | ✗     |
|    48 | .               |              | ✗     |

2024-12-31 21:39:23,968 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:39:23,973 - TrainingLogger - INFO - Gradient norm: 9.3054
2024-12-31 21:39:30,689 - TrainingLogger - INFO - Step 30010, Batch metrics: Loss: 7.4543, Accuracy: 0.0536, Perplexity: 1727.2966
2024-12-31 21:39:38,022 - TrainingLogger - INFO - Step 30020, Batch metrics: Loss: 7.6572, Accuracy: 0.0633, Perplexity: 2115.8840
2024-12-31 21:39:45,625 - TrainingLogger - INFO - Step 30030, Batch metrics: Loss: 6.9938, Accuracy: 0.0987, Perplexity: 1089.8755
2024-12-31 21:39:53,046 - TrainingLogger - INFO - Step 30040, Batch metrics: Loss: 7.1850, Accuracy: 0.0942, Perplexity: 1319.4470
2024-12-31 21:39:59,912 - TrainingLogger - INFO - Step 30050, Batch metrics: Loss: 7.4499, Accuracy: 0.1000, Perplexity: 1719.6398
2024-12-31 21:40:06,217 - TrainingLogger - INFO - Step 30060, Batch metrics: Loss: 7.4306, Accuracy: 0.0727, Perplexity: 1686.8928
2024-12-31 21:40:13,490 - TrainingLogger - INFO - Step 30070, Batch metrics: Loss: 7.5330, Accuracy: 0.0611, Perplexity: 1868.7380
2024-12-31 21:40:20,325 - TrainingLogger - INFO - Step 30080, Batch metrics: Loss: 7.6166, Accuracy: 0.0748, Perplexity: 2031.6419
2024-12-31 21:40:27,340 - TrainingLogger - INFO - Step 30090, Batch metrics: Loss: 7.2915, Accuracy: 0.1105, Perplexity: 1467.7736
2024-12-31 21:40:33,755 - TrainingLogger - INFO - Step 30100, Batch metrics: Loss: 7.3666, Accuracy: 0.0828, Perplexity: 1582.1741
2024-12-31 21:40:33,756 - TrainingLogger - INFO - Step 30100, Prediction vs Actual:
2024-12-31 21:40:33,756 - TrainingLogger - INFO - Input 1: - נתניהו חושש מהתמודדות שלך? אני לא יודע למה הוא מונע אותה
2024-12-31 21:40:33,756 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:40:33,756 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הזאת           | ▁-           | ✗     |
|     1 | </s>            | ▁נתנ         | ✗     |
|     2 | ך               | יהו          | ✗     |
|     3 | ו               | ▁חושש        | ✗     |
|     4 | "               | ▁מה          | ✗     |
|     5 | סיבה            | ת            | ✗     |
|     6 | ג               | מודד         | ✗     |
|     7 | ות              | ות           | ✓     |
|     8 | ▁שלו            | ▁שלך         | ✗     |
|     9 | .               | ?            | ✗     |
|    10 | ,               | ▁אני         | ✗     |
|    11 | ▁לא             | ▁לא          | ✓     |
|    12 | ▁יודע           | ▁יודע        | ✓     |
|    13 | ▁מה             | ▁למה         | ✗     |
|    14 | .               | ▁הוא         | ✗     |
|    15 | ▁מתכוון         | ▁מונע        | ✗     |
|    16 | ▁מזה            | ▁אותה        | ✗     |
|    17 | ▁בעיה           | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁לעבור          | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ▁מזה            |              | ✗     |

2024-12-31 21:40:33,756 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:40:33,761 - TrainingLogger - INFO - Gradient norm: 15.2770
2024-12-31 21:40:40,498 - TrainingLogger - INFO - Step 30110, Batch metrics: Loss: 7.4130, Accuracy: 0.0865, Perplexity: 1657.3652
2024-12-31 21:40:48,194 - TrainingLogger - INFO - Step 30120, Batch metrics: Loss: 7.2848, Accuracy: 0.0814, Perplexity: 1457.9529
2024-12-31 21:40:55,812 - TrainingLogger - INFO - Step 30130, Batch metrics: Loss: 7.3767, Accuracy: 0.0736, Perplexity: 1598.3538
2024-12-31 21:41:02,898 - TrainingLogger - INFO - Step 30140, Batch metrics: Loss: 7.5089, Accuracy: 0.1020, Perplexity: 1824.2844
2024-12-31 21:41:10,449 - TrainingLogger - INFO - Step 30150, Batch metrics: Loss: 7.2728, Accuracy: 0.1039, Perplexity: 1440.5152
2024-12-31 21:41:17,920 - TrainingLogger - INFO - Step 30160, Batch metrics: Loss: 7.6124, Accuracy: 0.0709, Perplexity: 2023.1385
2024-12-31 21:41:24,620 - TrainingLogger - INFO - Step 30170, Batch metrics: Loss: 7.1696, Accuracy: 0.0778, Perplexity: 1299.3297
2024-12-31 21:41:32,002 - TrainingLogger - INFO - Step 30180, Batch metrics: Loss: 7.5494, Accuracy: 0.0508, Perplexity: 1899.6630
2024-12-31 21:41:39,300 - TrainingLogger - INFO - Step 30190, Batch metrics: Loss: 7.8169, Accuracy: 0.0670, Perplexity: 2482.1306
2024-12-31 21:41:46,719 - TrainingLogger - INFO - Step 30200, Batch metrics: Loss: 7.0850, Accuracy: 0.0828, Perplexity: 1193.9130
2024-12-31 21:41:46,719 - TrainingLogger - INFO - Step 30200, Prediction vs Actual:
2024-12-31 21:41:46,719 - TrainingLogger - INFO - Input 1: הם יושבים מאחורי המליאה, במבואה על הכורסאות, וכולם מדברים עד כמה נמאס ואיזה חוסר אחריות לקחת מדינה לבחירות
2024-12-31 21:41:46,720 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:41:46,720 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הם          | ✗     |
|     1 | ▁לא             | ▁יושבים      | ✗     |
|     2 | ▁-              | ▁מאחורי      | ✗     |
|     3 | ▁הגב            | ▁המל         | ✗     |
|     4 | ו               | יאה          | ✗     |
|     5 | ▁הזאת           | ,            | ✗     |
|     6 | <pad>           | ▁במ          | ✗     |
|     7 | ?               | בוא          | ✗     |
|     8 | ה               | ה            | ✓     |
|     9 | ▁שלהם           | ▁על          | ✗     |
|    10 | ▁ידי            | ▁הכור        | ✗     |
|    11 | ים              | סאות         | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | ▁הם             | ▁וכולם       | ✗     |
|    14 | ▁חושבים         | ▁מדברים      | ✗     |
|    15 | ▁על             | ▁עד          | ✗     |
|    16 | ▁הסוף           | ▁כמה         | ✗     |
|    17 | ▁שהם            | ▁נמאס        | ✗     |
|    18 | ▁לי             | ▁ואיזה       | ✗     |
|    19 | ▁דברים          | ▁חוסר        | ✗     |
|    20 | ▁צדק            | ▁אחריות      | ✗     |
|    21 | .               | ▁לקחת        | ✗     |
|    22 | ▁את             | ▁מדינה       | ✗     |
|    23 | ▁חדשה           | ▁ל           | ✗     |
|    24 | מדינות          | בחירות       | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | יות             | <pad>        | ✗     |
|    33 | <pad>           |              | ✗     |

2024-12-31 21:41:46,720 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:41:46,725 - TrainingLogger - INFO - Gradient norm: 8.7840
2024-12-31 21:41:53,649 - TrainingLogger - INFO - Step 30210, Batch metrics: Loss: 7.0492, Accuracy: 0.1106, Perplexity: 1151.9226
2024-12-31 21:42:00,682 - TrainingLogger - INFO - Step 30220, Batch metrics: Loss: 7.6301, Accuracy: 0.0815, Perplexity: 2059.2594
2024-12-31 21:42:08,009 - TrainingLogger - INFO - Step 30230, Batch metrics: Loss: 7.4863, Accuracy: 0.0764, Perplexity: 1783.3637
2024-12-31 21:42:15,137 - TrainingLogger - INFO - Step 30240, Batch metrics: Loss: 7.2339, Accuracy: 0.0704, Perplexity: 1385.6470
2024-12-31 21:42:22,464 - TrainingLogger - INFO - Step 30250, Batch metrics: Loss: 7.2618, Accuracy: 0.0705, Perplexity: 1424.7487
2024-12-31 21:42:29,164 - TrainingLogger - INFO - Step 30260, Batch metrics: Loss: 7.2030, Accuracy: 0.0919, Perplexity: 1343.4744
2024-12-31 21:42:36,005 - TrainingLogger - INFO - Step 30270, Batch metrics: Loss: 7.9233, Accuracy: 0.0420, Perplexity: 2760.8729
2024-12-31 21:42:43,274 - TrainingLogger - INFO - Step 30280, Batch metrics: Loss: 7.5667, Accuracy: 0.0552, Perplexity: 1932.7286
2024-12-31 21:42:49,923 - TrainingLogger - INFO - Step 30290, Batch metrics: Loss: 7.1841, Accuracy: 0.0556, Perplexity: 1318.2484
2024-12-31 21:42:57,420 - TrainingLogger - INFO - Step 30300, Batch metrics: Loss: 7.6173, Accuracy: 0.0930, Perplexity: 2033.0161
2024-12-31 21:42:57,421 - TrainingLogger - INFO - Step 30300, Prediction vs Actual:
2024-12-31 21:42:57,421 - TrainingLogger - INFO - Input 1: כך למשל, רכבת שיצאה בשבוע שעבר בשעת בוקר מנהריה למודיעין עמדה על תפוסה של 117, ואתמול ירדה באותו הקו ל-94 תפוסה
2024-12-31 21:42:57,421 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:42:57,421 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כך          | ✗     |
|     1 | ▁-              | ▁למשל        | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | <pad>           | ▁רכבת        | ✗     |
|     4 | ,               | ▁שיצאה       | ✗     |
|     5 | ,               | ▁בשבוע       | ✗     |
|     6 | ▁שעבר           | ▁שעבר        | ✓     |
|     7 | .               | ▁בשעת        | ✗     |
|     8 | ▁ה              | ▁בוקר        | ✗     |
|     9 | ,               | ▁מנהר        | ✗     |
|    10 | ,               | יה           | ✗     |
|    11 | ,               | ▁ל           | ✗     |
|    12 | ים              | מודיעין      | ✗     |
|    13 | .               | ▁עמדה        | ✗     |
|    14 | ▁זו             | ▁על          | ✗     |
|    15 | ה               | ▁תפוס        | ✗     |
|    16 | ה               | ה            | ✓     |
|    17 | ,               | ▁של          | ✗     |
|    18 | <pad>           | ▁1           | ✗     |
|    19 | ▁ל              | 17           | ✗     |
|    20 | ,               | ,            | ✓     |
|    21 | 5               | ▁ו           | ✗     |
|    22 | -               | אתמול        | ✗     |
|    23 | ▁בערב           | ▁ירדה        | ✗     |
|    24 | ▁השעה           | ▁באותו       | ✗     |
|    25 | ▁ערב            | ▁הקו         | ✗     |
|    26 | מות             | ▁ל           | ✗     |
|    27 | תו              | -            | ✗     |
|    28 | 29              | 94           | ✗     |
|    29 | יה              | ▁תפוס        | ✗     |
|    30 | ה               | ה            | ✓     |
|    31 | .               |              | ✗     |

2024-12-31 21:42:57,421 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:42:57,426 - TrainingLogger - INFO - Gradient norm: 9.1149
2024-12-31 21:43:04,132 - TrainingLogger - INFO - Step 30310, Batch metrics: Loss: 7.4332, Accuracy: 0.0667, Perplexity: 1691.2243
2024-12-31 21:43:11,289 - TrainingLogger - INFO - Step 30320, Batch metrics: Loss: 7.8167, Accuracy: 0.0864, Perplexity: 2481.6016
2024-12-31 21:43:18,732 - TrainingLogger - INFO - Step 30330, Batch metrics: Loss: 7.6147, Accuracy: 0.0577, Perplexity: 2027.7367
2024-12-31 21:43:25,763 - TrainingLogger - INFO - Step 30340, Batch metrics: Loss: 7.2859, Accuracy: 0.0949, Perplexity: 1459.5451
2024-12-31 21:43:32,532 - TrainingLogger - INFO - Step 30350, Batch metrics: Loss: 7.8530, Accuracy: 0.0351, Perplexity: 2573.4828
2024-12-31 21:43:39,372 - TrainingLogger - INFO - Step 30360, Batch metrics: Loss: 7.5536, Accuracy: 0.0671, Perplexity: 1907.6911
2024-12-31 21:43:46,477 - TrainingLogger - INFO - Step 30370, Batch metrics: Loss: 7.0282, Accuracy: 0.1167, Perplexity: 1127.9507
2024-12-31 21:43:53,477 - TrainingLogger - INFO - Step 30380, Batch metrics: Loss: 7.1821, Accuracy: 0.0812, Perplexity: 1315.6461
2024-12-31 21:44:00,285 - TrainingLogger - INFO - Step 30390, Batch metrics: Loss: 7.0216, Accuracy: 0.0604, Perplexity: 1120.5303
2024-12-31 21:44:07,952 - TrainingLogger - INFO - Step 30400, Batch metrics: Loss: 7.4556, Accuracy: 0.0637, Perplexity: 1729.5804
2024-12-31 21:44:07,952 - TrainingLogger - INFO - Step 30400, Prediction vs Actual:
2024-12-31 21:44:07,952 - TrainingLogger - INFO - Input 1: אנחנו הפצנו סרטון שמדגים כיצד אלכוהול יכול לדלוק, בשימוש באלכוגל ונועד להזהיר את הציבור, להימנע, ולהרחיק את האלכוגל מאש
2024-12-31 21:44:07,953 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:44:07,953 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁ה           | ✗     |
|     2 | ▁-              | פצ           | ✗     |
|     3 | ייה             | נו           | ✗     |
|     4 | ▁-              | ▁סרט         | ✗     |
|     5 | ו               | ון           | ✗     |
|     6 | ▁חדש            | ▁שמ          | ✗     |
|     7 | בוצע            | דגים         | ✗     |
|     8 | ▁לנו            | ▁כיצד        | ✗     |
|     9 | ▁הוא            | ▁אלכוהול     | ✗     |
|    10 | ית              | ▁יכול        | ✗     |
|    11 | ▁להיות          | ▁ל           | ✗     |
|    12 | דה              | דלוק         | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | <pad>           | ▁בשימוש      | ✗     |
|    15 | ▁ב              | ▁בא          | ✗     |
|    16 | ית              | לכו          | ✗     |
|    17 | יות             | גל           | ✗     |
|    18 | ים              | ▁ונ          | ✗     |
|    19 | ה               | ועד          | ✗     |
|    20 | ▁לו             | ▁להזהיר      | ✗     |
|    21 | ▁אותנו          | ▁את          | ✗     |
|    22 | ▁כולם           | ▁הציבור      | ✗     |
|    23 | .               | ,            | ✗     |
|    24 | <pad>           | ▁להימנע      | ✗     |
|    25 | ▁מ              | ,            | ✗     |
|    26 | <pad>           | ▁ולה         | ✗     |
|    27 | קדים            | רחיק         | ✗     |
|    28 | ▁את             | ▁את          | ✓     |
|    29 | ▁זה             | ▁הא          | ✗     |
|    30 | יקס             | לכו          | ✗     |
|    31 | יות             | גל           | ✗     |
|    32 | ה               | ▁מאש         | ✗     |
|    33 | ת               | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | .               |              | ✗     |

2024-12-31 21:44:07,953 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:44:07,958 - TrainingLogger - INFO - Gradient norm: 15.2427
2024-12-31 21:44:14,857 - TrainingLogger - INFO - Step 30410, Batch metrics: Loss: 7.8351, Accuracy: 0.0783, Perplexity: 2527.7622
2024-12-31 21:44:22,083 - TrainingLogger - INFO - Step 30420, Batch metrics: Loss: 7.5213, Accuracy: 0.0743, Perplexity: 1846.8767
2024-12-31 21:44:29,155 - TrainingLogger - INFO - Step 30430, Batch metrics: Loss: 7.5774, Accuracy: 0.0876, Perplexity: 1953.4774
2024-12-31 21:44:36,522 - TrainingLogger - INFO - Step 30440, Batch metrics: Loss: 6.8961, Accuracy: 0.1170, Perplexity: 988.4468
2024-12-31 21:44:43,854 - TrainingLogger - INFO - Step 30450, Batch metrics: Loss: 7.2497, Accuracy: 0.0789, Perplexity: 1407.6470
2024-12-31 21:44:50,422 - TrainingLogger - INFO - Step 30460, Batch metrics: Loss: 7.5373, Accuracy: 0.0696, Perplexity: 1876.8242
2024-12-31 21:44:57,489 - TrainingLogger - INFO - Step 30470, Batch metrics: Loss: 7.4793, Accuracy: 0.0966, Perplexity: 1770.9433
2024-12-31 21:45:04,425 - TrainingLogger - INFO - Step 30480, Batch metrics: Loss: 7.5764, Accuracy: 0.0651, Perplexity: 1951.5679
2024-12-31 21:45:11,512 - TrainingLogger - INFO - Step 30490, Batch metrics: Loss: 7.6640, Accuracy: 0.0464, Perplexity: 2130.1711
2024-12-31 21:45:18,584 - TrainingLogger - INFO - Step 30500, Batch metrics: Loss: 7.7063, Accuracy: 0.0576, Perplexity: 2222.3369
2024-12-31 21:45:18,584 - TrainingLogger - INFO - Step 30500, Prediction vs Actual:
2024-12-31 21:45:18,584 - TrainingLogger - INFO - Input 1: ומה יהיה עם ה-liaison office משרד הקישור, אא בעזה? הרי בכלל לא דובר על כך בקמפ דיוויד
2024-12-31 21:45:18,584 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:45:18,584 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ומה         | ✗     |
|     1 | ▁להם            | ▁יהיה        | ✗     |
|     2 | ▁וי             | ▁עם          | ✗     |
|     3 | ▁זה             | ▁ה           | ✗     |
|     4 | -               | -            | ✓     |
|     5 | י               | li           | ✗     |
|     6 | ב               | ai           | ✗     |
|     7 | ר               | son          | ✗     |
|     8 | .               | ▁            | ✗     |
|     9 | ן               | off          | ✗     |
|    10 | -               | ice          | ✗     |
|    11 | .               | ▁משרד        | ✗     |
|    12 | ▁עורכי          | ▁הקישור      | ✗     |
|    13 | ים              | ,            | ✗     |
|    14 | </s>            | ▁א           | ✗     |
|    15 | "               | א            | ✗     |
|    16 | "               | ▁בע          | ✗     |
|    17 | "               | זה           | ✗     |
|    18 | "               | ?            | ✗     |
|    19 | ▁שם             | ▁הרי         | ✗     |
|    20 | ▁לך             | ▁בכלל        | ✗     |
|    21 | ,               | ▁לא          | ✗     |
|    22 | ▁אכפת           | ▁דובר        | ✗     |
|    23 | ים              | ▁על          | ✗     |
|    24 | ▁אנשים          | ▁כך          | ✗     |
|    25 | ▁שהוא           | ▁ב           | ✗     |
|    26 | "               | קמפ          | ✗     |
|    27 | יין             | ▁דיוויד      | ✗     |
|    28 | ,               |              | ✗     |

2024-12-31 21:45:18,585 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:45:18,589 - TrainingLogger - INFO - Gradient norm: 9.9230
2024-12-31 21:45:25,450 - TrainingLogger - INFO - Step 30510, Batch metrics: Loss: 7.4811, Accuracy: 0.0828, Perplexity: 1774.2219
2024-12-31 21:45:32,850 - TrainingLogger - INFO - Step 30520, Batch metrics: Loss: 7.6525, Accuracy: 0.0500, Perplexity: 2106.0065
2024-12-31 21:45:40,263 - TrainingLogger - INFO - Step 30530, Batch metrics: Loss: 7.4449, Accuracy: 0.0622, Perplexity: 1711.0971
2024-12-31 21:45:47,210 - TrainingLogger - INFO - Step 30540, Batch metrics: Loss: 7.2560, Accuracy: 0.0802, Perplexity: 1416.5107
2024-12-31 21:45:54,458 - TrainingLogger - INFO - Step 30550, Batch metrics: Loss: 7.5601, Accuracy: 0.0634, Perplexity: 1920.0944
2024-12-31 21:46:01,335 - TrainingLogger - INFO - Step 30560, Batch metrics: Loss: 7.1425, Accuracy: 0.0915, Perplexity: 1264.5997
2024-12-31 21:46:08,371 - TrainingLogger - INFO - Step 30570, Batch metrics: Loss: 7.3404, Accuracy: 0.0670, Perplexity: 1541.3061
2024-12-31 21:46:15,372 - TrainingLogger - INFO - Step 30580, Batch metrics: Loss: 7.7283, Accuracy: 0.0714, Perplexity: 2271.7632
2024-12-31 21:46:23,171 - TrainingLogger - INFO - Step 30590, Batch metrics: Loss: 7.5645, Accuracy: 0.1095, Perplexity: 1928.5123
2024-12-31 21:46:30,186 - TrainingLogger - INFO - Step 30600, Batch metrics: Loss: 7.7989, Accuracy: 0.0526, Perplexity: 2437.9179
2024-12-31 21:46:30,186 - TrainingLogger - INFO - Step 30600, Prediction vs Actual:
2024-12-31 21:46:30,186 - TrainingLogger - INFO - Input 1: דוברות המפלגה מרוכזת בידי דניאל ספייסר ולינדה ששון, שעבדה בעבר עם מועמדים נוספים בגוש המרכז שמאל וגם במרצ
2024-12-31 21:46:30,186 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:46:30,186 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁דובר        | ✗     |
|     1 | ▁-              | ות           | ✗     |
|     2 | ▁"              | ▁המפלגה      | ✗     |
|     3 | ▁-              | ▁מרוכז       | ✗     |
|     4 | ▁-              | ת            | ✗     |
|     5 | ▁-              | ▁בידי        | ✗     |
|     6 | ▁"              | ▁דניאל       | ✗     |
|     7 | ה               | ▁ספ          | ✗     |
|     8 | אס              | ייסר         | ✗     |
|     9 | :               | ▁ו           | ✗     |
|    10 | -               | לינדה        | ✗     |
|    11 | ,               | ▁שש          | ✗     |
|    12 | אל              | ון           | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | ▁קליפורניה      | ▁שעבד        | ✗     |
|    15 | ה               | ה            | ✓     |
|    16 | ▁עם             | ▁בעבר        | ✗     |
|    17 | ▁ב              | ▁עם          | ✗     |
|    18 | ▁זה             | ▁מועמד       | ✗     |
|    19 | ת               | ים           | ✗     |
|    20 | ▁רבים           | ▁נוספים      | ✗     |
|    21 | .               | ▁ב           | ✗     |
|    22 | -               | גוש          | ✗     |
|    23 | ▁ישראל          | ▁המרכז       | ✗     |
|    24 | ▁הלאומי         | ▁שמאל        | ✗     |
|    25 | ,               | ▁וגם         | ✗     |
|    26 | ▁ב              | ▁במר         | ✗     |
|    27 | עה              | צ            | ✗     |
|    28 | '               |              | ✗     |

2024-12-31 21:46:30,187 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:46:30,192 - TrainingLogger - INFO - Gradient norm: 9.0392
2024-12-31 21:46:37,791 - TrainingLogger - INFO - Step 30610, Batch metrics: Loss: 7.1428, Accuracy: 0.0647, Perplexity: 1264.9754
2024-12-31 21:46:45,017 - TrainingLogger - INFO - Step 30620, Batch metrics: Loss: 7.2975, Accuracy: 0.0894, Perplexity: 1476.5843
2024-12-31 21:46:52,396 - TrainingLogger - INFO - Step 30630, Batch metrics: Loss: 7.4292, Accuracy: 0.0961, Perplexity: 1684.4678
2024-12-31 21:46:59,811 - TrainingLogger - INFO - Step 30640, Batch metrics: Loss: 7.3388, Accuracy: 0.0839, Perplexity: 1538.9017
2024-12-31 21:47:06,843 - TrainingLogger - INFO - Step 30650, Batch metrics: Loss: 7.2218, Accuracy: 0.0842, Perplexity: 1369.0088
2024-12-31 21:47:13,954 - TrainingLogger - INFO - Step 30660, Batch metrics: Loss: 7.5121, Accuracy: 0.0698, Perplexity: 1829.9745
2024-12-31 21:47:21,123 - TrainingLogger - INFO - Step 30670, Batch metrics: Loss: 7.8600, Accuracy: 0.0571, Perplexity: 2591.5973
2024-12-31 21:47:28,299 - TrainingLogger - INFO - Step 30680, Batch metrics: Loss: 7.6428, Accuracy: 0.1007, Perplexity: 2085.5809
2024-12-31 21:47:35,010 - TrainingLogger - INFO - Step 30690, Batch metrics: Loss: 7.1646, Accuracy: 0.1099, Perplexity: 1292.8436
2024-12-31 21:47:41,769 - TrainingLogger - INFO - Step 30700, Batch metrics: Loss: 7.3667, Accuracy: 0.0741, Perplexity: 1582.3492
2024-12-31 21:47:41,770 - TrainingLogger - INFO - Step 30700, Prediction vs Actual:
2024-12-31 21:47:41,770 - TrainingLogger - INFO - Input 1: החברה הישראלית ספגה מכה קשה ביותר שייקח שנים רבות להתאושש ממנה
2024-12-31 21:47:41,770 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:47:41,770 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁החברה       | ✗     |
|     1 | ית              | ▁הישראלי     | ✗     |
|     2 | ▁-              | ת            | ✗     |
|     3 | ▁הזאת           | ▁ספג         | ✗     |
|     4 | ה               | ה            | ✓     |
|     5 | ▁את             | ▁מכה         | ✗     |
|     6 | ▁קשה            | ▁קשה         | ✓     |
|     7 | .               | ▁ביותר       | ✗     |
|     8 | .               | ▁שייקח       | ✗     |
|     9 | ה               | ▁שנים        | ✗     |
|    10 | ▁רבות           | ▁רבות        | ✓     |
|    11 | .               | ▁להתאושש     | ✗     |
|    12 | .               | ▁ממנה        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ▁קשה            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2024-12-31 21:47:41,770 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:47:41,775 - TrainingLogger - INFO - Gradient norm: 11.7849
2024-12-31 21:47:49,283 - TrainingLogger - INFO - Step 30710, Batch metrics: Loss: 7.4188, Accuracy: 0.0758, Perplexity: 1667.0396
2024-12-31 21:47:56,581 - TrainingLogger - INFO - Step 30720, Batch metrics: Loss: 7.5920, Accuracy: 0.0778, Perplexity: 1982.2391
2024-12-31 21:48:03,737 - TrainingLogger - INFO - Step 30730, Batch metrics: Loss: 8.2083, Accuracy: 0.0435, Perplexity: 3671.4207
2024-12-31 21:48:11,033 - TrainingLogger - INFO - Step 30740, Batch metrics: Loss: 7.4022, Accuracy: 0.0667, Perplexity: 1639.6317
2024-12-31 21:48:17,742 - TrainingLogger - INFO - Step 30750, Batch metrics: Loss: 7.3800, Accuracy: 0.1176, Perplexity: 1603.6679
2024-12-31 21:48:24,878 - TrainingLogger - INFO - Step 30760, Batch metrics: Loss: 6.9877, Accuracy: 0.0902, Perplexity: 1083.2721
2024-12-31 21:48:31,928 - TrainingLogger - INFO - Step 30770, Batch metrics: Loss: 7.2720, Accuracy: 0.0904, Perplexity: 1439.3665
2024-12-31 21:48:38,781 - TrainingLogger - INFO - Step 30780, Batch metrics: Loss: 7.6228, Accuracy: 0.0748, Perplexity: 2044.2281
2024-12-31 21:48:45,971 - TrainingLogger - INFO - Step 30790, Batch metrics: Loss: 7.3415, Accuracy: 0.0644, Perplexity: 1542.9606
2024-12-31 21:48:53,501 - TrainingLogger - INFO - Step 30800, Batch metrics: Loss: 7.2387, Accuracy: 0.0759, Perplexity: 1392.3332
2024-12-31 21:48:53,501 - TrainingLogger - INFO - Step 30800, Prediction vs Actual:
2024-12-31 21:48:53,501 - TrainingLogger - INFO - Input 1: מבחינתי זו הייתה הפתעה גמורה, אמר, זה שימח אותי כי בסך הכל אולי יש פה איזשהו סיכוי לקבל טיפה בים בחזרה
2024-12-31 21:48:53,502 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:48:53,502 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מבחינתי     | ✗     |
|     1 | ▁לא             | ▁זו          | ✗     |
|     2 | ▁לא             | ▁הייתה       | ✗     |
|     3 | ▁-              | ▁הפתעה       | ✗     |
|     4 | .               | ▁גמורה       | ✗     |
|     5 | .               | ,            | ✗     |
|     6 | <pad>           | ▁אמר         | ✗     |
|     7 | ▁לי             | ,            | ✗     |
|     8 | ▁לא             | ▁זה          | ✗     |
|     9 | ▁לא             | ▁שי          | ✗     |
|    10 | ב               | מח           | ✗     |
|    11 | יש              | ▁אותי        | ✗     |
|    12 | .               | ▁כי          | ✗     |
|    13 | ▁הוא            | ▁בסך         | ✗     |
|    14 | ▁הכל            | ▁הכל         | ✓     |
|    15 | ,               | ▁אולי        | ✗     |
|    16 | ▁לא             | ▁יש          | ✗     |
|    17 | ▁לי             | ▁פה          | ✗     |
|    18 | ▁משהו           | ▁איזשהו      | ✗     |
|    19 | ▁קשר            | ▁סיכוי       | ✗     |
|    20 | ▁קלוש           | ▁לקבל        | ✗     |
|    21 | ▁את             | ▁טיפה        | ✗     |
|    22 | ▁יותר           | ▁ב           | ✗     |
|    23 | סכום            | ים           | ✗     |
|    24 | ▁הזה            | ▁בחזרה       | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | ▁לא             | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 21:48:53,502 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:48:53,507 - TrainingLogger - INFO - Gradient norm: 13.9171
2024-12-31 21:49:00,775 - TrainingLogger - INFO - Step 30810, Batch metrics: Loss: 7.3297, Accuracy: 0.0872, Perplexity: 1524.8850
2024-12-31 21:49:07,844 - TrainingLogger - INFO - Step 30820, Batch metrics: Loss: 7.5080, Accuracy: 0.1129, Perplexity: 1822.5376
2024-12-31 21:49:14,734 - TrainingLogger - INFO - Step 30830, Batch metrics: Loss: 7.2740, Accuracy: 0.0661, Perplexity: 1442.3703
2024-12-31 21:49:22,055 - TrainingLogger - INFO - Step 30840, Batch metrics: Loss: 7.6900, Accuracy: 0.0704, Perplexity: 2186.2975
2024-12-31 21:49:29,330 - TrainingLogger - INFO - Step 30850, Batch metrics: Loss: 7.7194, Accuracy: 0.0598, Perplexity: 2251.6564
2024-12-31 21:49:36,137 - TrainingLogger - INFO - Step 30860, Batch metrics: Loss: 7.6485, Accuracy: 0.1046, Perplexity: 2097.5889
2024-12-31 21:49:43,064 - TrainingLogger - INFO - Step 30870, Batch metrics: Loss: 7.4846, Accuracy: 0.0697, Perplexity: 1780.4909
2024-12-31 21:49:49,699 - TrainingLogger - INFO - Step 30880, Batch metrics: Loss: 7.7028, Accuracy: 0.0872, Perplexity: 2214.5670
2024-12-31 21:49:56,770 - TrainingLogger - INFO - Step 30890, Batch metrics: Loss: 7.9592, Accuracy: 0.0828, Perplexity: 2861.6459
2024-12-31 21:50:04,078 - TrainingLogger - INFO - Step 30900, Batch metrics: Loss: 8.1312, Accuracy: 0.0298, Perplexity: 3398.9174
2024-12-31 21:50:04,078 - TrainingLogger - INFO - Step 30900, Prediction vs Actual:
2024-12-31 21:50:04,078 - TrainingLogger - INFO - Input 1: אולם כדי שיתאפשר לה להתמודד ברשימה לכנסת, היה צורך באישור מיוחד של יור הליכוד נתניהו לקיצור תקופת האכשרה
2024-12-31 21:50:04,079 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:50:04,079 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אולם        | ✗     |
|     1 | ▁-              | ▁כדי         | ✗     |
|     2 | ▁-              | ▁שית         | ✗     |
|     3 | נו              | אפשר         | ✗     |
|     4 | ו               | ▁לה          | ✗     |
|     5 | ▁לקבל           | ▁להתמודד     | ✗     |
|     6 | ▁עם             | ▁ברשימה      | ✗     |
|     7 | .               | ▁ל           | ✗     |
|     8 | בחירות          | כנס          | ✗     |
|     9 | ים              | ת            | ✗     |
|    10 | <pad>           | ,            | ✗     |
|    11 | <pad>           | ▁היה         | ✗     |
|    12 | ▁לי             | ▁צורך        | ✗     |
|    13 | ▁לדבר           | ▁ב           | ✗     |
|    14 | הצעה            | אישור        | ✗     |
|    15 | ה               | ▁מיוחד       | ✗     |
|    16 | .               | ▁של          | ✗     |
|    17 | <pad>           | ▁י           | ✗     |
|    18 | "               | ור           | ✗     |
|    19 | נל              | ▁הלי         | ✗     |
|    20 | בר              | כו           | ✗     |
|    21 | ד               | ד            | ✓     |
|    22 | ,               | ▁נתנ         | ✗     |
|    23 | יה              | יהו          | ✗     |
|    24 | ,               | ▁ל           | ✗     |
|    25 | שנים            | קיצור        | ✗     |
|    26 | ▁של             | ▁תקופת       | ✗     |
|    27 | ▁מבחן           | ▁הא          | ✗     |
|    28 | סטרו            | כשר          | ✗     |
|    29 | ה               | ה            | ✓     |
|    30 | .               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ,               |              | ✗     |

2024-12-31 21:50:04,079 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:50:04,084 - TrainingLogger - INFO - Gradient norm: 10.8557
2024-12-31 21:50:11,140 - TrainingLogger - INFO - Step 30910, Batch metrics: Loss: 7.8555, Accuracy: 0.0625, Perplexity: 2580.0059
2024-12-31 21:50:18,735 - TrainingLogger - INFO - Step 30920, Batch metrics: Loss: 8.0799, Accuracy: 0.0217, Perplexity: 3228.9220
2024-12-31 21:50:25,879 - TrainingLogger - INFO - Step 30930, Batch metrics: Loss: 7.4003, Accuracy: 0.0726, Perplexity: 1636.5034
2024-12-31 21:50:33,206 - TrainingLogger - INFO - Step 30940, Batch metrics: Loss: 7.0629, Accuracy: 0.0766, Perplexity: 1167.8309
2024-12-31 21:50:39,469 - TrainingLogger - INFO - Step 30950, Batch metrics: Loss: 7.9021, Accuracy: 0.0559, Perplexity: 2702.9515
2024-12-31 21:50:46,910 - TrainingLogger - INFO - Step 30960, Batch metrics: Loss: 7.5561, Accuracy: 0.0549, Perplexity: 1912.4135
2024-12-31 21:50:54,027 - TrainingLogger - INFO - Step 30970, Batch metrics: Loss: 7.7344, Accuracy: 0.1037, Perplexity: 2285.5449
2024-12-31 21:51:00,879 - TrainingLogger - INFO - Step 30980, Batch metrics: Loss: 7.5722, Accuracy: 0.0887, Perplexity: 1943.3403
2024-12-31 21:51:08,099 - TrainingLogger - INFO - Step 30990, Batch metrics: Loss: 7.5200, Accuracy: 0.0532, Perplexity: 1844.6042
2024-12-31 21:51:15,076 - TrainingLogger - INFO - Step 31000, Batch metrics: Loss: 7.7091, Accuracy: 0.0412, Perplexity: 2228.5341
2024-12-31 21:51:15,076 - TrainingLogger - INFO - Step 31000, Prediction vs Actual:
2024-12-31 21:51:15,076 - TrainingLogger - INFO - Input 1: לא רוצים לגייס אותך כי את ערבייה
2024-12-31 21:51:15,077 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:51:15,077 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לא          | ✗     |
|     1 | ▁-              | ▁רוצים       | ✗     |
|     2 | ▁-              | ▁לגייס       | ✗     |
|     3 | ▁את             | ▁אותך        | ✗     |
|     4 | ▁-              | ▁כי          | ✗     |
|     5 | ▁זה             | ▁את          | ✗     |
|     6 | ▁לא             | ▁ערב         | ✗     |
|     7 | ת               | ייה          | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | ▁לא             | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | <pad>           | <pad>        | ✓     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | ▁טובה           | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | ▁לא             | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | ▁לא             | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | ▁לא             | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | ▁לא             | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | <pad>           | <pad>        | ✓     |
|    44 | <pad>           | <pad>        | ✓     |
|    45 | ▁לא             | <pad>        | ✗     |
|    46 | ▁לא             | <pad>        | ✗     |
|    47 | ▁לא             |              | ✗     |

2024-12-31 21:51:15,077 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:51:15,082 - TrainingLogger - INFO - Gradient norm: 10.1733
2024-12-31 21:51:21,966 - TrainingLogger - INFO - Step 31010, Batch metrics: Loss: 7.6699, Accuracy: 0.0514, Perplexity: 2142.7945
2024-12-31 21:51:29,089 - TrainingLogger - INFO - Step 31020, Batch metrics: Loss: 7.5660, Accuracy: 0.0950, Perplexity: 1931.3559
2024-12-31 21:51:35,701 - TrainingLogger - INFO - Step 31030, Batch metrics: Loss: 7.1647, Accuracy: 0.0804, Perplexity: 1292.9774
2024-12-31 21:51:44,393 - TrainingLogger - INFO - Step 31040, Batch metrics: Loss: 7.3626, Accuracy: 0.0955, Perplexity: 1575.9202
2024-12-31 21:51:51,757 - TrainingLogger - INFO - Step 31050, Batch metrics: Loss: 7.9118, Accuracy: 0.0764, Perplexity: 2729.4222
2024-12-31 21:51:58,598 - TrainingLogger - INFO - Step 31060, Batch metrics: Loss: 7.9792, Accuracy: 0.0492, Perplexity: 2919.5343
2024-12-31 21:52:05,890 - TrainingLogger - INFO - Step 31070, Batch metrics: Loss: 7.1928, Accuracy: 0.0733, Perplexity: 1329.7784
2024-12-31 21:52:12,316 - TrainingLogger - INFO - Step 31080, Batch metrics: Loss: 7.2214, Accuracy: 0.0747, Perplexity: 1368.3627
2024-12-31 21:52:19,928 - TrainingLogger - INFO - Step 31090, Batch metrics: Loss: 7.3729, Accuracy: 0.0886, Perplexity: 1592.2917
2024-12-31 21:52:27,205 - TrainingLogger - INFO - Step 31100, Batch metrics: Loss: 7.7230, Accuracy: 0.0649, Perplexity: 2259.8149
2024-12-31 21:52:27,205 - TrainingLogger - INFO - Step 31100, Prediction vs Actual:
2024-12-31 21:52:27,205 - TrainingLogger - INFO - Input 1: כידוע, דרום הסמטה הוא מועדון המורכב משילוב של מבקשי מקלט, עולים מאתיופיה וצברים ילידי הארץ
2024-12-31 21:52:27,206 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:52:27,206 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁כידוע       | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | <pad>           | ▁דרום        | ✗     |
|     3 | ▁-              | ▁הס          | ✗     |
|     4 | בור             | מטה          | ✗     |
|     5 | ▁שלך            | ▁הוא         | ✗     |
|     6 | ▁לא             | ▁מועדון      | ✗     |
|     7 | ▁של             | ▁המורכב      | ✗     |
|     8 | ות              | ▁משי         | ✗     |
|     9 | כות             | לוב          | ✗     |
|    10 | ים              | ▁של          | ✗     |
|    11 | ▁ה              | ▁מבקש        | ✗     |
|    12 | י               | י            | ✓     |
|    13 | ▁נשק            | ▁מקלט        | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | </s>            | ▁עולים       | ✗     |
|    16 | ▁חדשים          | ▁מאת         | ✗     |
|    17 | רים             | יופי         | ✗     |
|    18 | ה               | ה            | ✓     |
|    19 | ▁של             | ▁וצ          | ✗     |
|    20 | '               | ברים         | ✗     |
|    21 | ▁את             | ▁יליד        | ✗     |
|    22 | ים              | י            | ✗     |
|    23 | ▁בית            | ▁הארץ        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | י               | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | ,               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | <pad>           |              | ✗     |

2024-12-31 21:52:27,206 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:52:27,211 - TrainingLogger - INFO - Gradient norm: 10.0561
2024-12-31 21:52:34,301 - TrainingLogger - INFO - Step 31110, Batch metrics: Loss: 7.3587, Accuracy: 0.0923, Perplexity: 1569.8623
2024-12-31 21:52:41,560 - TrainingLogger - INFO - Step 31120, Batch metrics: Loss: 7.9445, Accuracy: 0.0758, Perplexity: 2820.0220
2024-12-31 21:52:48,892 - TrainingLogger - INFO - Step 31130, Batch metrics: Loss: 7.5207, Accuracy: 0.0960, Perplexity: 1845.8202
2024-12-31 21:52:56,431 - TrainingLogger - INFO - Step 31140, Batch metrics: Loss: 7.4013, Accuracy: 0.0943, Perplexity: 1638.1188
2024-12-31 21:53:03,363 - TrainingLogger - INFO - Step 31150, Batch metrics: Loss: 7.7979, Accuracy: 0.0493, Perplexity: 2435.3827
2024-12-31 21:53:10,525 - TrainingLogger - INFO - Step 31160, Batch metrics: Loss: 7.0444, Accuracy: 0.0880, Perplexity: 1146.4303
2024-12-31 21:53:18,330 - TrainingLogger - INFO - Step 31170, Batch metrics: Loss: 7.7558, Accuracy: 0.0254, Perplexity: 2335.0806
2024-12-31 21:53:26,199 - TrainingLogger - INFO - Step 31180, Batch metrics: Loss: 7.6969, Accuracy: 0.0852, Perplexity: 2201.4044
2024-12-31 21:53:33,024 - TrainingLogger - INFO - Step 31190, Batch metrics: Loss: 8.1533, Accuracy: 0.0497, Perplexity: 3474.8115
2024-12-31 21:53:40,192 - TrainingLogger - INFO - Step 31200, Batch metrics: Loss: 7.6552, Accuracy: 0.1026, Perplexity: 2111.4927
2024-12-31 21:53:40,193 - TrainingLogger - INFO - Step 31200, Prediction vs Actual:
2024-12-31 21:53:40,193 - TrainingLogger - INFO - Input 1: גורם בצוות המומ של כחול לבן אמר הערב כי הוא לא מאמין שיקרה משהו, ואילו בכיר בליכוד שנשאל האם יש מה לצפות מחר בפגישת צוותי המומ - השיב לא
2024-12-31 21:53:40,193 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:53:40,193 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁גורם        | ✗     |
|     1 | ▁-              | ▁בצוות       | ✗     |
|     2 | ▁-              | ▁המו         | ✗     |
|     3 | מח              | מ            | ✗     |
|     4 | לץ              | ▁של          | ✗     |
|     5 | לי              | ▁כחול        | ✗     |
|     6 | יה              | ▁לבן         | ✗     |
|     7 | ,               | ▁אמר         | ✗     |
|     8 | ▁שהוא           | ▁הערב        | ✗     |
|     9 | ,               | ▁כי          | ✗     |
|    10 | ▁הוא            | ▁הוא         | ✓     |
|    11 | ▁לא             | ▁לא          | ✓     |
|    12 | ▁יכול           | ▁מאמין       | ✗     |
|    13 | ▁לי             | ▁שיקרה       | ✗     |
|    14 | ▁לו             | ▁משהו        | ✗     |
|    15 | ▁כזה            | ,            | ✗     |
|    16 | </s>            | ▁ואילו       | ✗     |
|    17 | ▁הוא            | ▁בכיר        | ✗     |
|    18 | ים              | ▁בלי         | ✗     |
|    19 | בו              | כו           | ✗     |
|    20 | דים             | ד            | ✗     |
|    21 | ▁אותו           | ▁שנשאל       | ✗     |
|    22 | ו               | ▁האם         | ✗     |
|    23 | ▁הוא            | ▁יש          | ✗     |
|    24 | ▁לו             | ▁מה          | ✗     |
|    25 | ▁לעשות          | ▁לצפות       | ✗     |
|    26 | ▁ממנו           | ▁מחר         | ✗     |
|    27 | ,               | ▁ב           | ✗     |
|    28 | "               | פגיש         | ✗     |
|    29 | תנו             | ת            | ✗     |
|    30 | ▁ילדים          | ▁צוותי       | ✗     |
|    31 | ▁עם             | ▁המו         | ✗     |
|    32 | כן              | מ            | ✗     |
|    33 | כן              | ▁-           | ✗     |
|    34 | <pad>           | ▁השיב        | ✗     |
|    35 | י               | ▁לא          | ✗     |
|    36 | ▁י              |              | ✗     |

2024-12-31 21:53:40,193 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:53:40,198 - TrainingLogger - INFO - Gradient norm: 8.7088
2024-12-31 21:53:47,355 - TrainingLogger - INFO - Step 31210, Batch metrics: Loss: 7.8548, Accuracy: 0.0470, Perplexity: 2578.1513
2024-12-31 21:53:54,702 - TrainingLogger - INFO - Step 31220, Batch metrics: Loss: 7.4297, Accuracy: 0.0968, Perplexity: 1685.2816
2024-12-31 21:54:01,723 - TrainingLogger - INFO - Step 31230, Batch metrics: Loss: 7.6701, Accuracy: 0.0774, Perplexity: 2143.2717
2024-12-31 21:54:08,891 - TrainingLogger - INFO - Step 31240, Batch metrics: Loss: 8.1561, Accuracy: 0.0410, Perplexity: 3484.7241
2024-12-31 21:54:16,205 - TrainingLogger - INFO - Step 31250, Batch metrics: Loss: 7.7589, Accuracy: 0.0807, Perplexity: 2342.4108
2024-12-31 21:54:23,532 - TrainingLogger - INFO - Step 31260, Batch metrics: Loss: 7.1198, Accuracy: 0.1111, Perplexity: 1236.1567
2024-12-31 21:54:31,107 - TrainingLogger - INFO - Step 31270, Batch metrics: Loss: 7.0457, Accuracy: 0.0816, Perplexity: 1147.9609
2024-12-31 21:54:38,044 - TrainingLogger - INFO - Step 31280, Batch metrics: Loss: 7.3331, Accuracy: 0.0884, Perplexity: 1530.1015
2024-12-31 21:54:45,792 - TrainingLogger - INFO - Step 31290, Batch metrics: Loss: 7.2199, Accuracy: 0.0922, Perplexity: 1366.2998
2024-12-31 21:54:52,972 - TrainingLogger - INFO - Step 31300, Batch metrics: Loss: 7.4660, Accuracy: 0.0966, Perplexity: 1747.6649
2024-12-31 21:54:52,972 - TrainingLogger - INFO - Step 31300, Prediction vs Actual:
2024-12-31 21:54:52,972 - TrainingLogger - INFO - Input 1: לבוא ולהגיד ממחר אני מתחיל לעשות הכשרה מקצועית נשמע לי לא הגיוני בלשון המעטה
2024-12-31 21:54:52,973 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:54:52,973 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ית              | ▁לבוא        | ✗     |
|     1 | ה               | ▁ולהגיד      | ✗     |
|     2 | תם              | ▁ממחר        | ✗     |
|     3 | ת               | ▁אני         | ✗     |
|     4 | ים              | ▁מתחיל       | ✗     |
|     5 | ▁לחשוב          | ▁לעשות       | ✗     |
|     6 | ▁דברים          | ▁הכשרה       | ✗     |
|     7 | ▁זו             | ▁מקצועית     | ✗     |
|     8 | </s>            | ▁נשמע        | ✗     |
|     9 | ו               | ▁לי          | ✗     |
|    10 | ▁כמו            | ▁לא          | ✗     |
|    11 | ▁נכונה          | ▁הגיוני      | ✗     |
|    12 | </s>            | ▁בלשון       | ✗     |
|    13 | ▁עבר            | ▁המעטה       | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ▁בלבד           | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁בלבד           | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 21:54:52,973 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:54:52,978 - TrainingLogger - INFO - Gradient norm: 10.5914
2024-12-31 21:54:59,943 - TrainingLogger - INFO - Step 31310, Batch metrics: Loss: 7.6357, Accuracy: 0.0718, Perplexity: 2070.8532
2024-12-31 21:55:07,054 - TrainingLogger - INFO - Step 31320, Batch metrics: Loss: 7.1649, Accuracy: 0.1080, Perplexity: 1293.1950
2024-12-31 21:55:13,690 - TrainingLogger - INFO - Step 31330, Batch metrics: Loss: 7.4462, Accuracy: 0.0929, Perplexity: 1713.2990
2024-12-31 21:55:21,083 - TrainingLogger - INFO - Step 31340, Batch metrics: Loss: 7.1763, Accuracy: 0.0821, Perplexity: 1308.0764
2024-12-31 21:55:28,875 - TrainingLogger - INFO - Step 31350, Batch metrics: Loss: 7.4511, Accuracy: 0.0640, Perplexity: 1721.7501
2024-12-31 21:55:32,494 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 286720
2024-12-31 21:55:32,494 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 286720

2024-12-31 21:55:32,494 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 46]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 46]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 44]), device: cuda:0
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 21:55:32,495 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 21:55:36,922 - TrainingLogger - INFO - Step 31360, Batch metrics: Loss: 7.4027, Accuracy: 0.0754, Perplexity: 1640.4309
2024-12-31 21:55:44,593 - TrainingLogger - INFO - Step 31370, Batch metrics: Loss: 7.4436, Accuracy: 0.0758, Perplexity: 1708.8230
2024-12-31 21:55:51,762 - TrainingLogger - INFO - Step 31380, Batch metrics: Loss: 7.4724, Accuracy: 0.0798, Perplexity: 1758.7963
2024-12-31 21:55:58,497 - TrainingLogger - INFO - Step 31390, Batch metrics: Loss: 7.8354, Accuracy: 0.0553, Perplexity: 2528.6000
2024-12-31 21:56:05,404 - TrainingLogger - INFO - Step 31400, Batch metrics: Loss: 7.3635, Accuracy: 0.0746, Perplexity: 1577.3177
2024-12-31 21:56:05,405 - TrainingLogger - INFO - Step 31400, Prediction vs Actual:
2024-12-31 21:56:05,437 - TrainingLogger - INFO - Input 1: בין היתר הובאו ממוסקבה מכונות הנשמה, מסכות וציוד נוסף
2024-12-31 21:56:05,439 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:56:05,439 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁אלה            | ▁בין         | ✗     |
|     1 | ▁-              | ▁היתר        | ✗     |
|     2 | ▁-              | ▁הובא        | ✗     |
|     3 | ▁-              | ו            | ✗     |
|     4 | ▁גם             | ▁ממו         | ✗     |
|     5 | קדש             | סק           | ✗     |
|     6 | נים             | בה           | ✗     |
|     7 | נים             | ▁מכונות      | ✗     |
|     8 | ▁רבות           | ▁הנשמה       | ✗     |
|     9 | ▁חדשה           | ,            | ✗     |
|    10 | <pad>           | ▁מסכות       | ✗     |
|    11 | ▁רבות           | ▁ו           | ✗     |
|    12 | בטיחות          | ציוד         | ✗     |
|    13 | ▁צבאי           | ▁נוסף        | ✗     |
|    14 | ▁של             | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁גם             | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | יות             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ה               | <pad>        | ✗     |
|    37 | ▁עד             | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | <pad>           | <pad>        | ✓     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ות              | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | ות              |              | ✗     |

2024-12-31 21:56:05,439 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:56:05,444 - TrainingLogger - INFO - Gradient norm: 8.5990
2024-12-31 21:56:12,589 - TrainingLogger - INFO - Step 31410, Batch metrics: Loss: 7.4122, Accuracy: 0.0662, Perplexity: 1656.0254
2024-12-31 21:56:20,385 - TrainingLogger - INFO - Step 31420, Batch metrics: Loss: 7.5398, Accuracy: 0.0823, Perplexity: 1881.5007
2024-12-31 21:56:27,735 - TrainingLogger - INFO - Step 31430, Batch metrics: Loss: 7.3005, Accuracy: 0.0691, Perplexity: 1480.9843
2024-12-31 21:56:35,352 - TrainingLogger - INFO - Step 31440, Batch metrics: Loss: 7.9694, Accuracy: 0.0667, Perplexity: 2891.2033
2024-12-31 21:56:42,315 - TrainingLogger - INFO - Step 31450, Batch metrics: Loss: 7.1841, Accuracy: 0.0976, Perplexity: 1318.2729
2024-12-31 21:56:49,550 - TrainingLogger - INFO - Step 31460, Batch metrics: Loss: 7.3461, Accuracy: 0.0968, Perplexity: 1550.0931
2024-12-31 21:56:56,929 - TrainingLogger - INFO - Step 31470, Batch metrics: Loss: 7.2265, Accuracy: 0.0955, Perplexity: 1375.3845
2024-12-31 21:57:03,892 - TrainingLogger - INFO - Step 31480, Batch metrics: Loss: 7.3407, Accuracy: 0.0544, Perplexity: 1541.8192
2024-12-31 21:57:10,675 - TrainingLogger - INFO - Step 31490, Batch metrics: Loss: 7.4121, Accuracy: 0.0736, Perplexity: 1655.9346
2024-12-31 21:57:18,211 - TrainingLogger - INFO - Step 31500, Batch metrics: Loss: 7.3236, Accuracy: 0.0520, Perplexity: 1515.6271
2024-12-31 21:57:18,212 - TrainingLogger - INFO - Step 31500, Prediction vs Actual:
2024-12-31 21:57:18,212 - TrainingLogger - INFO - Input 1: רוב המנדטים, על פי אותם סקרים, מגיעים מהליכוד וימינה
2024-12-31 21:57:18,212 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:57:18,212 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁רוב         | ✗     |
|     1 | ן               | ▁המ          | ✗     |
|     2 | ▁-              | נדט          | ✗     |
|     3 | ▁-              | ים           | ✗     |
|     4 | ▁-              | ,            | ✗     |
|     5 | ▁-              | ▁על          | ✗     |
|     6 | ▁-              | ▁פי          | ✗     |
|     7 | נו              | ▁אותם        | ✗     |
|     8 | ▁-              | ▁סקר         | ✗     |
|     9 | ים              | ים           | ✓     |
|    10 | ▁רבים           | ,            | ✗     |
|    11 | ▁הם             | ▁מגיעים      | ✗     |
|    12 | ▁אלינו          | ▁מה          | ✗     |
|    13 | צפון            | לי           | ✗     |
|    14 | גה              | כו           | ✗     |
|    15 | יות             | ד            | ✗     |
|    16 | ▁הזה            | ▁וי          | ✗     |
|    17 | סטה             | מינה         | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | יה              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | ים              |              | ✗     |

2024-12-31 21:57:18,212 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:57:18,217 - TrainingLogger - INFO - Gradient norm: 8.8092
2024-12-31 21:57:25,171 - TrainingLogger - INFO - Step 31510, Batch metrics: Loss: 7.1861, Accuracy: 0.0884, Perplexity: 1320.9824
2024-12-31 21:57:32,426 - TrainingLogger - INFO - Step 31520, Batch metrics: Loss: 7.8506, Accuracy: 0.0413, Perplexity: 2567.3520
2024-12-31 21:57:39,779 - TrainingLogger - INFO - Step 31530, Batch metrics: Loss: 7.6192, Accuracy: 0.0559, Perplexity: 2037.0198
2024-12-31 21:57:46,655 - TrainingLogger - INFO - Step 31540, Batch metrics: Loss: 7.5893, Accuracy: 0.0711, Perplexity: 1976.9276
2024-12-31 21:57:54,329 - TrainingLogger - INFO - Step 31550, Batch metrics: Loss: 7.5449, Accuracy: 0.0766, Perplexity: 1891.0167
2024-12-31 21:58:01,506 - TrainingLogger - INFO - Step 31560, Batch metrics: Loss: 7.5791, Accuracy: 0.1187, Perplexity: 1956.7907
2024-12-31 21:58:08,759 - TrainingLogger - INFO - Step 31570, Batch metrics: Loss: 7.9236, Accuracy: 0.0429, Perplexity: 2761.6221
2024-12-31 21:58:15,899 - TrainingLogger - INFO - Step 31580, Batch metrics: Loss: 7.0095, Accuracy: 0.0974, Perplexity: 1107.1515
2024-12-31 21:58:22,977 - TrainingLogger - INFO - Step 31590, Batch metrics: Loss: 8.1183, Accuracy: 0.0621, Perplexity: 3355.2557
2024-12-31 21:58:29,771 - TrainingLogger - INFO - Step 31600, Batch metrics: Loss: 7.5491, Accuracy: 0.0625, Perplexity: 1898.9947
2024-12-31 21:58:29,771 - TrainingLogger - INFO - Step 31600, Prediction vs Actual:
2024-12-31 21:58:29,771 - TrainingLogger - INFO - Input 1: שמועות עיקשות, שקיבלו רוח גבית מהמדובבת של אלזה, אידינה מנזל, טוענות שאלזה היא לסבית
2024-12-31 21:58:29,772 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:58:29,772 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שמועות      | ✗     |
|     1 | ▁-              | ▁עי          | ✗     |
|     2 | ור              | קשות         | ✗     |
|     3 | .               | ,            | ✗     |
|     4 | ▁היא            | ▁שקיבלו      | ✗     |
|     5 | ת               | ▁רוח         | ✗     |
|     6 | ▁חיים           | ▁ג           | ✗     |
|     7 | '               | בית          | ✗     |
|     8 | .               | ▁מה          | ✗     |
|     9 | ה               | מדו          | ✗     |
|    10 | דה              | ב            | ✗     |
|    11 | ▁נפש            | בת           | ✗     |
|    12 | ים              | ▁של          | ✗     |
|    13 | ▁תקווה          | ▁אל          | ✗     |
|    14 | סקה             | זה           | ✗     |
|    15 | ,               | ,            | ✓     |
|    16 | <pad>           | ▁אידי        | ✗     |
|    17 | ה               | נה           | ✗     |
|    18 | ,               | ▁מ           | ✗     |
|    19 | אן              | נזל          | ✗     |
|    20 | ת               | ,            | ✗     |
|    21 | ▁צרפת           | ▁טו          | ✗     |
|    22 | מ               | ענות         | ✗     |
|    23 | יה              | ▁שאל         | ✗     |
|    24 | יה              | זה           | ✗     |
|    25 | ,               | ▁היא         | ✗     |
|    26 | ▁לא             | ▁לסבית       | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ית              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁מ              | <pad>        | ✗     |
|    34 | ▁כמו            | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ית              | <pad>        | ✗     |
|    41 | ית              |              | ✗     |

2024-12-31 21:58:29,772 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:58:29,777 - TrainingLogger - INFO - Gradient norm: 9.7145
2024-12-31 21:58:37,152 - TrainingLogger - INFO - Step 31610, Batch metrics: Loss: 7.3758, Accuracy: 0.0894, Perplexity: 1596.9025
2024-12-31 21:58:45,028 - TrainingLogger - INFO - Step 31620, Batch metrics: Loss: 7.6101, Accuracy: 0.0769, Perplexity: 2018.3823
2024-12-31 21:58:52,052 - TrainingLogger - INFO - Step 31630, Batch metrics: Loss: 7.8352, Accuracy: 0.0317, Perplexity: 2527.9816
2024-12-31 21:58:59,644 - TrainingLogger - INFO - Step 31640, Batch metrics: Loss: 7.6160, Accuracy: 0.0899, Perplexity: 2030.3509
2024-12-31 21:59:06,334 - TrainingLogger - INFO - Step 31650, Batch metrics: Loss: 7.5294, Accuracy: 0.0592, Perplexity: 1862.0037
2024-12-31 21:59:14,017 - TrainingLogger - INFO - Step 31660, Batch metrics: Loss: 7.4653, Accuracy: 0.0507, Perplexity: 1746.4303
2024-12-31 21:59:21,372 - TrainingLogger - INFO - Step 31670, Batch metrics: Loss: 7.3461, Accuracy: 0.0699, Perplexity: 1550.2158
2024-12-31 21:59:28,258 - TrainingLogger - INFO - Step 31680, Batch metrics: Loss: 7.0714, Accuracy: 0.1047, Perplexity: 1177.8426
2024-12-31 21:59:35,930 - TrainingLogger - INFO - Step 31690, Batch metrics: Loss: 7.2798, Accuracy: 0.0884, Perplexity: 1450.6673
2024-12-31 21:59:42,726 - TrainingLogger - INFO - Step 31700, Batch metrics: Loss: 7.6157, Accuracy: 0.0764, Perplexity: 2029.7953
2024-12-31 21:59:42,726 - TrainingLogger - INFO - Step 31700, Prediction vs Actual:
2024-12-31 21:59:42,726 - TrainingLogger - INFO - Input 1: מלחמה לא מנצחים רק בהרג
2024-12-31 21:59:42,726 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 21:59:42,727 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מלחמה       | ✗     |
|     1 | </s>            | ▁לא          | ✗     |
|     2 | ▁-              | ▁מנצחים      | ✗     |
|     3 | ,               | ▁רק          | ✗     |
|     4 | ▁את             | ▁ב           | ✗     |
|     5 | -19             | הרג          | ✗     |
|     6 | נס              | <pad>        | ✗     |
|     7 | ▁אחד            | <pad>        | ✗     |
|     8 | ים              | <pad>        | ✗     |
|     9 | ▁אחד            | <pad>        | ✗     |
|    10 | ▁אחד            | <pad>        | ✗     |
|    11 | ▁אחד            | <pad>        | ✗     |
|    12 | ים              | <pad>        | ✗     |
|    13 | ▁אחד            | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ▁לא             | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ▁אחד            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | ם               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁נגד            | <pad>        | ✗     |
|    31 | ▁עד             | <pad>        | ✗     |
|    32 | ▁אחד            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁אחד            |              | ✗     |

2024-12-31 21:59:42,727 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 21:59:42,732 - TrainingLogger - INFO - Gradient norm: 11.4688
2024-12-31 21:59:49,567 - TrainingLogger - INFO - Step 31710, Batch metrics: Loss: 6.8763, Accuracy: 0.1042, Perplexity: 969.0254
2024-12-31 21:59:56,343 - TrainingLogger - INFO - Step 31720, Batch metrics: Loss: 7.8277, Accuracy: 0.0189, Perplexity: 2509.1161
2024-12-31 22:00:03,308 - TrainingLogger - INFO - Step 31730, Batch metrics: Loss: 7.5356, Accuracy: 0.0676, Perplexity: 1873.5917
2024-12-31 22:00:10,661 - TrainingLogger - INFO - Step 31740, Batch metrics: Loss: 7.9233, Accuracy: 0.0539, Perplexity: 2760.9348
2024-12-31 22:00:17,770 - TrainingLogger - INFO - Step 31750, Batch metrics: Loss: 7.7696, Accuracy: 0.0610, Perplexity: 2367.4358
2024-12-31 22:00:24,889 - TrainingLogger - INFO - Step 31760, Batch metrics: Loss: 7.8293, Accuracy: 0.0486, Perplexity: 2513.0675
2024-12-31 22:00:32,009 - TrainingLogger - INFO - Step 31770, Batch metrics: Loss: 7.6896, Accuracy: 0.0621, Perplexity: 2185.5533
2024-12-31 22:00:39,473 - TrainingLogger - INFO - Step 31780, Batch metrics: Loss: 7.6222, Accuracy: 0.0443, Perplexity: 2043.1269
2024-12-31 22:00:46,497 - TrainingLogger - INFO - Step 31790, Batch metrics: Loss: 7.5316, Accuracy: 0.0796, Perplexity: 1866.1778
2024-12-31 22:00:53,455 - TrainingLogger - INFO - Step 31800, Batch metrics: Loss: 7.1118, Accuracy: 0.0725, Perplexity: 1226.3731
2024-12-31 22:00:53,456 - TrainingLogger - INFO - Step 31800, Prediction vs Actual:
2024-12-31 22:00:53,456 - TrainingLogger - INFO - Input 1: חייבים להמשיך בהתנגדות עד שנציל הדמוקרטיה מניסיון ההתנקשות הזה
2024-12-31 22:00:53,456 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:00:53,456 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁חייבים      | ✗     |
|     1 | ▁ללכת           | ▁להמשיך      | ✗     |
|     2 | </s>            | ▁ב           | ✗     |
|     3 | ▁לא             | התנגדות      | ✗     |
|     4 | </s>            | ▁עד          | ✗     |
|     5 | ▁הסוף           | ▁שנ          | ✗     |
|     6 | שוב             | ציל          | ✗     |
|     7 | ▁את             | ▁הדמוקרטי    | ✗     |
|     8 | ה               | ה            | ✓     |
|     9 | </s>            | ▁מ           | ✗     |
|    10 | נקודת           | ניסיון       | ✗     |
|    11 | </s>            | ▁ההתנקשות    | ✗     |
|    12 | </s>            | ▁הזה         | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁את             |              | ✗     |

2024-12-31 22:00:53,456 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 22:00:53,461 - TrainingLogger - INFO - Gradient norm: 9.1457
2024-12-31 22:01:00,870 - TrainingLogger - INFO - Step 31810, Batch metrics: Loss: 7.6659, Accuracy: 0.0946, Perplexity: 2134.3662
2024-12-31 22:01:07,717 - TrainingLogger - INFO - Step 31820, Batch metrics: Loss: 7.3897, Accuracy: 0.0854, Perplexity: 1619.2333
2024-12-31 22:01:14,353 - TrainingLogger - INFO - Step 31830, Batch metrics: Loss: 6.8562, Accuracy: 0.0867, Perplexity: 949.7369
2024-12-31 22:01:21,525 - TrainingLogger - INFO - Step 31840, Batch metrics: Loss: 7.6962, Accuracy: 0.0807, Perplexity: 2200.0066
2024-12-31 22:01:28,785 - TrainingLogger - INFO - Step 31850, Batch metrics: Loss: 7.4520, Accuracy: 0.0538, Perplexity: 1723.2260
2024-12-31 22:01:35,537 - TrainingLogger - INFO - Step 31860, Batch metrics: Loss: 7.7029, Accuracy: 0.0744, Perplexity: 2214.7381
2024-12-31 22:01:42,659 - TrainingLogger - INFO - Step 31870, Batch metrics: Loss: 6.9497, Accuracy: 0.0739, Perplexity: 1042.8785
2024-12-31 22:01:49,745 - TrainingLogger - INFO - Step 31880, Batch metrics: Loss: 7.6298, Accuracy: 0.0970, Perplexity: 2058.6075
2024-12-31 22:01:56,822 - TrainingLogger - INFO - Step 31890, Batch metrics: Loss: 7.6167, Accuracy: 0.0544, Perplexity: 2031.8734
2024-12-31 22:02:03,878 - TrainingLogger - INFO - Step 31900, Batch metrics: Loss: 7.5390, Accuracy: 0.0914, Perplexity: 1879.9367
2024-12-31 22:02:03,878 - TrainingLogger - INFO - Step 31900, Prediction vs Actual:
2024-12-31 22:02:03,879 - TrainingLogger - INFO - Input 1: הקורונה ביטלה את אפשרות ההתכנסות ואילצה את חברי הכנסת לעשות את ההתאמות הנדרשות באמצעות העברת הזירה לתקשורת ולרשתות החברתיות
2024-12-31 22:02:03,879 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:02:03,879 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הקור        | ✗     |
|     1 | ▁-              | ונה          | ✗     |
|     2 | ▁המערבית        | ▁ביטל        | ✗     |
|     3 | ,               | ה            | ✗     |
|     4 | ▁היא            | ▁את          | ✗     |
|     5 | ▁היא            | ▁אפשרות      | ✗     |
|     6 | ▁היא            | ▁הה          | ✗     |
|     7 | פקה             | תכנס         | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | ▁הראשונה        | ▁ואי         | ✗     |
|    10 | צה              | לצ           | ✗     |
|    11 | יה              | ה            | ✗     |
|    12 | ▁אותו           | ▁את          | ✗     |
|    13 | ▁כל             | ▁חברי        | ✗     |
|    14 | ה               | ▁הכנסת       | ✗     |
|    15 | ▁האמריקאית      | ▁לעשות       | ✗     |
|    16 | ▁זאת            | ▁את          | ✗     |
|    17 | ▁זה             | ▁ההת         | ✗     |
|    18 | אחד             | אמות         | ✗     |
|    19 | ▁שלהם           | ▁הנדרש       | ✗     |
|    20 | ות              | ות           | ✓     |
|    21 | ▁שלה            | ▁באמצעות     | ✗     |
|    22 | ה               | ▁העברת       | ✗     |
|    23 | ם               | ▁הזירה       | ✗     |
|    24 | .               | ▁לתקשורת     | ✗     |
|    25 | .               | ▁ול          | ✗     |
|    26 | פי              | רשת          | ✗     |
|    27 | ות              | ות           | ✓     |
|    28 | ▁חדשות          | ▁החברתי      | ✗     |
|    29 | ת               | ות           | ✗     |
|    30 | ▁שלה            | <pad>        | ✗     |
|    31 | ▁שלה            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | .               | <pad>        | ✗     |
|    37 | :               | <pad>        | ✗     |
|    38 | ▁לא             | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ▁עצמה           | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | </s>            |              | ✗     |

2024-12-31 22:02:03,879 - TrainingLogger - INFO - Learning rate (group 0): 0.000050
2024-12-31 22:02:03,884 - TrainingLogger - INFO - Gradient norm: 9.2593
2024-12-31 22:02:10,515 - TrainingLogger - INFO - Step 31910, Batch metrics: Loss: 7.7048, Accuracy: 0.0493, Perplexity: 2219.0701
2024-12-31 22:02:18,010 - TrainingLogger - INFO - Step 31920, Batch metrics: Loss: 7.1047, Accuracy: 0.0889, Perplexity: 1217.6530
2024-12-31 22:02:25,327 - TrainingLogger - INFO - Step 31930, Batch metrics: Loss: 7.4084, Accuracy: 0.0887, Perplexity: 1649.8633
2024-12-31 22:02:32,442 - TrainingLogger - INFO - Step 31940, Batch metrics: Loss: 7.7829, Accuracy: 0.0382, Perplexity: 2399.2370
2024-12-31 22:02:39,640 - TrainingLogger - INFO - Step 31950, Batch metrics: Loss: 7.8907, Accuracy: 0.0516, Perplexity: 2672.3199
2024-12-31 22:02:45,085 - TrainingLogger - INFO - Epoch 1/5, Average Training Loss: 6.4870
2024-12-31 22:02:45,085 - TrainingLogger - INFO - Current learning rate: 5.00e-05
2024-12-31 22:02:45,087 - TrainingLogger - INFO - Model saved to model_checkpoints/qwen_training_checkpoints/model_epoch_1.pt
2024-12-31 22:02:49,237 - TrainingLogger - INFO - Step 31960, Batch metrics: Loss: 7.1610, Accuracy: 0.0822, Perplexity: 1288.2068
2024-12-31 22:02:56,683 - TrainingLogger - INFO - Step 31970, Batch metrics: Loss: 6.8618, Accuracy: 0.1019, Perplexity: 955.1195
2024-12-31 22:03:03,371 - TrainingLogger - INFO - Step 31980, Batch metrics: Loss: 7.3067, Accuracy: 0.0821, Perplexity: 1490.2530
2024-12-31 22:03:10,608 - TrainingLogger - INFO - Step 31990, Batch metrics: Loss: 7.8302, Accuracy: 0.0803, Perplexity: 2515.5289
2024-12-31 22:03:17,534 - TrainingLogger - INFO - Step 32000, Batch metrics: Loss: 7.8322, Accuracy: 0.0584, Perplexity: 2520.5862
2024-12-31 22:03:17,534 - TrainingLogger - INFO - Step 32000, Prediction vs Actual:
2024-12-31 22:03:17,534 - TrainingLogger - INFO - Input 1: מעולם אני לא נאחז בקרנות מזבח
2024-12-31 22:03:17,534 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:03:17,534 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁מעולם       | ✗     |
|     1 | ▁-              | ▁אני         | ✗     |
|     2 | ▁לא             | ▁לא          | ✓     |
|     3 | ▁יודע           | ▁נאחז        | ✗     |
|     4 | ת               | ▁ב           | ✗     |
|     5 | עזרה            | קרנות        | ✗     |
|     6 | ,               | ▁מזבח        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | ות              | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | יות             | <pad>        | ✗     |
|    13 | ה               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | .               | <pad>        | ✗     |
|    20 | ות              | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | .               | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ▁לא             |              | ✗     |

2024-12-31 22:03:17,534 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:03:17,539 - TrainingLogger - INFO - Gradient norm: 7.5665
2024-12-31 22:03:24,418 - TrainingLogger - INFO - Step 32010, Batch metrics: Loss: 7.2538, Accuracy: 0.0682, Perplexity: 1413.4239
2024-12-31 22:03:31,543 - TrainingLogger - INFO - Step 32020, Batch metrics: Loss: 8.4772, Accuracy: 0.0667, Perplexity: 4804.1290
2024-12-31 22:03:38,563 - TrainingLogger - INFO - Step 32030, Batch metrics: Loss: 7.3225, Accuracy: 0.0749, Perplexity: 1514.0373
2024-12-31 22:03:45,628 - TrainingLogger - INFO - Step 32040, Batch metrics: Loss: 7.5618, Accuracy: 0.0476, Perplexity: 1923.3814
2024-12-31 22:03:52,540 - TrainingLogger - INFO - Step 32050, Batch metrics: Loss: 7.3252, Accuracy: 0.1026, Perplexity: 1518.1413
2024-12-31 22:03:59,786 - TrainingLogger - INFO - Step 32060, Batch metrics: Loss: 7.8023, Accuracy: 0.0553, Perplexity: 2446.2206
2024-12-31 22:04:07,110 - TrainingLogger - INFO - Step 32070, Batch metrics: Loss: 7.6942, Accuracy: 0.0548, Perplexity: 2195.5851
2024-12-31 22:04:14,394 - TrainingLogger - INFO - Step 32080, Batch metrics: Loss: 7.5907, Accuracy: 0.0738, Perplexity: 1979.6953
2024-12-31 22:04:21,943 - TrainingLogger - INFO - Step 32090, Batch metrics: Loss: 7.4536, Accuracy: 0.0748, Perplexity: 1725.9916
2024-12-31 22:04:29,261 - TrainingLogger - INFO - Step 32100, Batch metrics: Loss: 7.5712, Accuracy: 0.0718, Perplexity: 1941.4083
2024-12-31 22:04:29,261 - TrainingLogger - INFO - Step 32100, Prediction vs Actual:
2024-12-31 22:04:29,261 - TrainingLogger - INFO - Input 1: בינתיים נתניהו ממשיך מאז שעות אחר הצהריים בחלוקת התיקים בתוך הליכוד
2024-12-31 22:04:29,262 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:04:29,262 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בינתיים     | ✗     |
|     1 | ▁-              | ▁נתנ         | ✗     |
|     2 | ים              | יהו          | ✗     |
|     3 | ▁-              | ▁ממשיך       | ✗     |
|     4 | ▁לעבוד          | ▁מאז         | ✗     |
|     5 | ן               | ▁שעות        | ✗     |
|     6 | ▁נוספות         | ▁אחר         | ✗     |
|     7 | ונים            | ▁הצהריים     | ✗     |
|     8 | ,               | ▁ב           | ✗     |
|     9 | חמישי           | חלוק         | ✗     |
|    10 | ה               | ת            | ✗     |
|    11 | <pad>           | ▁התיקים      | ✗     |
|    12 | ▁שלו            | ▁בתוך        | ✗     |
|    13 | ▁הבית           | ▁הלי         | ✗     |
|    14 | כות             | כו           | ✗     |
|    15 | ד               | ד            | ✓     |
|    16 | ▁שלי            | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁של             | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ▁הוא            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁שלו            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ▁הוא            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2024-12-31 22:04:29,262 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:04:29,267 - TrainingLogger - INFO - Gradient norm: 10.2240
2024-12-31 22:04:36,541 - TrainingLogger - INFO - Step 32110, Batch metrics: Loss: 7.4662, Accuracy: 0.0855, Perplexity: 1748.0083
2024-12-31 22:04:44,072 - TrainingLogger - INFO - Step 32120, Batch metrics: Loss: 7.3906, Accuracy: 0.0721, Perplexity: 1620.6979
2024-12-31 22:04:51,221 - TrainingLogger - INFO - Step 32130, Batch metrics: Loss: 7.3207, Accuracy: 0.0925, Perplexity: 1511.2740
2024-12-31 22:04:58,135 - TrainingLogger - INFO - Step 32140, Batch metrics: Loss: 7.6220, Accuracy: 0.0688, Perplexity: 2042.6866
2024-12-31 22:05:05,157 - TrainingLogger - INFO - Step 32150, Batch metrics: Loss: 7.9964, Accuracy: 0.0690, Perplexity: 2970.1166
2024-12-31 22:05:12,132 - TrainingLogger - INFO - Step 32160, Batch metrics: Loss: 7.3745, Accuracy: 0.0802, Perplexity: 1594.8182
2024-12-31 22:05:18,947 - TrainingLogger - INFO - Step 32170, Batch metrics: Loss: 7.5910, Accuracy: 0.1000, Perplexity: 1980.3770
2024-12-31 22:05:25,891 - TrainingLogger - INFO - Step 32180, Batch metrics: Loss: 7.5990, Accuracy: 0.0759, Perplexity: 1996.1120
2024-12-31 22:05:32,405 - TrainingLogger - INFO - Step 32190, Batch metrics: Loss: 7.4718, Accuracy: 0.0979, Perplexity: 1757.8103
2024-12-31 22:05:39,984 - TrainingLogger - INFO - Step 32200, Batch metrics: Loss: 7.5837, Accuracy: 0.0703, Perplexity: 1965.9778
2024-12-31 22:05:39,984 - TrainingLogger - INFO - Step 32200, Prediction vs Actual:
2024-12-31 22:05:39,984 - TrainingLogger - INFO - Input 1: ולכן, הזירה הדרומית משפיעה על הזירה הצפונית וחזרתם של התושבים הביתה
2024-12-31 22:05:39,985 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:05:39,985 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | :               | ▁ולכן        | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | ▁אני            | ▁הזירה       | ✗     |
|     3 | ▁-              | ▁הדרומית     | ✗     |
|     4 | ,               | ▁משפיעה      | ✗     |
|     5 | ▁עלינו          | ▁על          | ✗     |
|     6 | ▁עצמך           | ▁הזירה       | ✗     |
|     7 | .               | ▁הצפונית     | ✗     |
|     8 | .               | ▁וחזר        | ✗     |
|     9 | ה               | תם           | ✗     |
|    10 | ▁על             | ▁של          | ✗     |
|    11 | ▁אנשים          | ▁התושבים     | ✗     |
|    12 | .               | ▁הביתה       | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 22:05:39,985 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:05:39,990 - TrainingLogger - INFO - Gradient norm: 9.5170
2024-12-31 22:05:46,765 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 286720
2024-12-31 22:05:46,765 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 286720

2024-12-31 22:05:46,765 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 31]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 31]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 22:05:46,766 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 22:05:48,466 - TrainingLogger - INFO - Step 32210, Batch metrics: Loss: 7.5971, Accuracy: 0.0785, Perplexity: 1992.4775
2024-12-31 22:05:56,223 - TrainingLogger - INFO - Step 32220, Batch metrics: Loss: 7.6639, Accuracy: 0.0695, Perplexity: 2130.0025
2024-12-31 22:06:02,979 - TrainingLogger - INFO - Step 32230, Batch metrics: Loss: 7.7256, Accuracy: 0.0637, Perplexity: 2265.6477
2024-12-31 22:06:10,217 - TrainingLogger - INFO - Step 32240, Batch metrics: Loss: 7.4876, Accuracy: 0.0567, Perplexity: 1785.7413
2024-12-31 22:06:17,399 - TrainingLogger - INFO - Step 32250, Batch metrics: Loss: 7.6097, Accuracy: 0.0879, Perplexity: 2017.7453
2024-12-31 22:06:24,257 - TrainingLogger - INFO - Step 32260, Batch metrics: Loss: 7.6988, Accuracy: 0.0571, Perplexity: 2205.6503
2024-12-31 22:06:31,191 - TrainingLogger - INFO - Step 32270, Batch metrics: Loss: 7.5055, Accuracy: 0.0824, Perplexity: 1818.0632
2024-12-31 22:06:38,535 - TrainingLogger - INFO - Step 32280, Batch metrics: Loss: 7.3303, Accuracy: 0.1111, Perplexity: 1525.8712
2024-12-31 22:06:45,740 - TrainingLogger - INFO - Step 32290, Batch metrics: Loss: 7.5399, Accuracy: 0.0495, Perplexity: 1881.5841
2024-12-31 22:06:53,243 - TrainingLogger - INFO - Step 32300, Batch metrics: Loss: 7.8016, Accuracy: 0.0872, Perplexity: 2444.5636
2024-12-31 22:06:53,243 - TrainingLogger - INFO - Step 32300, Prediction vs Actual:
2024-12-31 22:06:53,243 - TrainingLogger - INFO - Input 1: וכך כתבתי את הספר לצד שמעון בין הטוב ביותר לבין חביב הסקרים - סיפורו של מאבק הוצאת דביר
2024-12-31 22:06:53,243 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:06:53,243 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁וכך         | ✗     |
|     1 | ▁-              | ▁כתבתי       | ✗     |
|     2 | ▁-              | ▁את          | ✗     |
|     3 | ▁-              | ▁הספר        | ✗     |
|     4 | ▁-              | ▁לצד         | ✗     |
|     5 | ▁-              | ▁שמעון       | ✗     |
|     6 | ,               | ▁בין         | ✗     |
|     7 | ▁היתר           | ▁הטוב        | ✗     |
|     8 | פים             | ▁ביותר       | ✗     |
|     9 | .               | ▁לבין        | ✗     |
|    10 | ▁השני           | ▁חביב        | ✗     |
|    11 | ה               | ▁הסקר        | ✗     |
|    12 | ים              | ים           | ✓     |
|    13 | ▁האחרים         | ▁-           | ✗     |
|    14 | <pad>           | ▁סיפורו      | ✗     |
|    15 | ▁של             | ▁של          | ✓     |
|    16 | ▁ישו            | ▁מאבק        | ✗     |
|    17 | ים              | ▁הוצאת       | ✗     |
|    18 | ו               | ▁דבי         | ✗     |
|    19 | ונים            | ר            | ✗     |
|    20 | יש              | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ם               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 22:06:53,244 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:06:53,248 - TrainingLogger - INFO - Gradient norm: 10.1176
2024-12-31 22:06:59,564 - TrainingLogger - INFO - Step 32310, Batch metrics: Loss: 7.5860, Accuracy: 0.0932, Perplexity: 1970.4226
2024-12-31 22:07:06,999 - TrainingLogger - INFO - Step 32320, Batch metrics: Loss: 7.1312, Accuracy: 0.0815, Perplexity: 1250.3549
2024-12-31 22:07:14,493 - TrainingLogger - INFO - Step 32330, Batch metrics: Loss: 7.2909, Accuracy: 0.1163, Perplexity: 1466.8340
2024-12-31 22:07:21,738 - TrainingLogger - INFO - Step 32340, Batch metrics: Loss: 7.5666, Accuracy: 0.0682, Perplexity: 1932.5194
2024-12-31 22:07:29,277 - TrainingLogger - INFO - Step 32350, Batch metrics: Loss: 7.3871, Accuracy: 0.1198, Perplexity: 1614.9676
2024-12-31 22:07:35,856 - TrainingLogger - INFO - Step 32360, Batch metrics: Loss: 7.7439, Accuracy: 0.0747, Perplexity: 2307.3468
2024-12-31 22:07:43,387 - TrainingLogger - INFO - Step 32370, Batch metrics: Loss: 7.8838, Accuracy: 0.0608, Perplexity: 2654.0296
2024-12-31 22:07:51,747 - TrainingLogger - INFO - Step 32380, Batch metrics: Loss: 7.9423, Accuracy: 0.0625, Perplexity: 2813.9157
2024-12-31 22:07:58,996 - TrainingLogger - INFO - Step 32390, Batch metrics: Loss: 7.4199, Accuracy: 0.0968, Perplexity: 1668.9071
2024-12-31 22:08:05,851 - TrainingLogger - INFO - Step 32400, Batch metrics: Loss: 7.9414, Accuracy: 0.0600, Perplexity: 2811.2401
2024-12-31 22:08:05,852 - TrainingLogger - INFO - Step 32400, Prediction vs Actual:
2024-12-31 22:08:05,852 - TrainingLogger - INFO - Input 1: זאת בנוסף לצורך האסטרטגי לחסום את הברחות הנשק והכסף לחמאס דרך מעבר רפיח וציר פילדלפי
2024-12-31 22:08:05,852 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:08:05,852 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁זאת         | ✗     |
|     1 | ▁-              | ▁בנוסף       | ✗     |
|     2 | ▁-              | ▁לצורך       | ✗     |
|     3 | ▁בזה            | ▁ה           | ✗     |
|     4 | לה              | אסטרטג       | ✗     |
|     5 | ▁לא             | י            | ✗     |
|     6 | ▁הטוב           | ▁לחסום       | ✗     |
|     7 | ▁את             | ▁את          | ✓     |
|     8 | ▁זה             | ▁הבר         | ✗     |
|     9 | ונים            | חות          | ✗     |
|    10 | ▁שלו            | ▁הנשק        | ✗     |
|    11 | ▁הזה            | ▁והכסף       | ✗     |
|    12 | .               | ▁לחמ         | ✗     |
|    13 | ים              | אס           | ✗     |
|    14 | .               | ▁דרך         | ✗     |
|    15 | ▁אחת            | ▁מעבר        | ✗     |
|    16 | ▁לפינה          | ▁ר           | ✗     |
|    17 | ה               | פיח          | ✗     |
|    18 | ון              | ▁ו           | ✗     |
|    19 | ון              | ציר          | ✗     |
|    20 | יו              | ▁            | ✗     |
|    21 | ים              | פילד         | ✗     |
|    22 | .               | לפי          | ✗     |
|    23 | ו               | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ית              | <pad>        | ✗     |
|    26 | יה              | <pad>        | ✗     |
|    27 | יה              | <pad>        | ✗     |
|    28 | ון              | <pad>        | ✗     |
|    29 | ון              | <pad>        | ✗     |
|    30 | יה              | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | יקה             | <pad>        | ✗     |
|    33 | ה               | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ה               |              | ✗     |

2024-12-31 22:08:05,852 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:08:05,857 - TrainingLogger - INFO - Gradient norm: 8.3088
2024-12-31 22:08:12,929 - TrainingLogger - INFO - Step 32410, Batch metrics: Loss: 7.4297, Accuracy: 0.0721, Perplexity: 1685.3853
2024-12-31 22:08:19,663 - TrainingLogger - INFO - Step 32420, Batch metrics: Loss: 7.3083, Accuracy: 0.0678, Perplexity: 1492.6660
2024-12-31 22:08:27,281 - TrainingLogger - INFO - Step 32430, Batch metrics: Loss: 7.6753, Accuracy: 0.0784, Perplexity: 2154.5349
2024-12-31 22:08:34,250 - TrainingLogger - INFO - Step 32440, Batch metrics: Loss: 7.3936, Accuracy: 0.0759, Perplexity: 1625.5948
2024-12-31 22:08:41,344 - TrainingLogger - INFO - Step 32450, Batch metrics: Loss: 7.4626, Accuracy: 0.0667, Perplexity: 1741.6718
2024-12-31 22:08:48,478 - TrainingLogger - INFO - Step 32460, Batch metrics: Loss: 7.4765, Accuracy: 0.0833, Perplexity: 1765.9756
2024-12-31 22:08:56,126 - TrainingLogger - INFO - Step 32470, Batch metrics: Loss: 7.6332, Accuracy: 0.0691, Perplexity: 2065.6430
2024-12-31 22:09:02,896 - TrainingLogger - INFO - Step 32480, Batch metrics: Loss: 7.4589, Accuracy: 0.1164, Perplexity: 1735.1935
2024-12-31 22:09:10,020 - TrainingLogger - INFO - Step 32490, Batch metrics: Loss: 7.1245, Accuracy: 0.1165, Perplexity: 1242.0339
2024-12-31 22:09:17,328 - TrainingLogger - INFO - Step 32500, Batch metrics: Loss: 7.5758, Accuracy: 0.0652, Perplexity: 1950.4375
2024-12-31 22:09:17,329 - TrainingLogger - INFO - Step 32500, Prediction vs Actual:
2024-12-31 22:09:17,329 - TrainingLogger - INFO - Input 1: רשת אל-חדת הסעודית דיווחה אמש כי במשא ומתן נרשמה פריצת דרך, וכי הוסכם על הפסקת אש בשני שלבים - שבכל שלב יתבצע חילופי שבויים ויוכנס סיוע
2024-12-31 22:09:17,329 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:09:17,329 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁רשת         | ✗     |
|     1 | ▁-              | ▁אל          | ✗     |
|     2 | ▁-              | -            | ✗     |
|     3 | ▁-              | חד           | ✗     |
|     4 | ▁-              | ת            | ✗     |
|     5 | ▁-              | ▁הס          | ✗     |
|     6 | ח               | עוד          | ✗     |
|     7 | ה               | ית           | ✗     |
|     8 | ▁שלי            | ▁דיווח       | ✗     |
|     9 | ▁-              | ה            | ✗     |
|    10 | ▁שלי            | ▁אמש         | ✗     |
|    11 | ,               | ▁כי          | ✗     |
|    12 | ▁אני            | ▁במשא        | ✗     |
|    13 | ב               | ▁ומתן        | ✗     |
|    14 | ,               | ▁נרשמה       | ✗     |
|    15 | ▁גם             | ▁פריצ        | ✗     |
|    16 | ות              | ת            | ✗     |
|    17 | ▁דרך            | ▁דרך         | ✓     |
|    18 | .               | ,            | ✗     |
|    19 | <pad>           | ▁וכי         | ✗     |
|    20 | ת               | ▁הוס         | ✗     |
|    21 | ,               | כם           | ✗     |
|    22 | ▁את             | ▁על          | ✗     |
|    23 | ▁ידי            | ▁הפסקת       | ✗     |
|    24 | ▁אש             | ▁אש          | ✓     |
|    25 | .               | ▁בשני        | ✗     |
|    26 | ה               | ▁של          | ✗     |
|    27 | בים             | בים          | ✓     |
|    28 | .               | ▁-           | ✗     |
|    29 | <pad>           | ▁שבכל        | ✗     |
|    30 | ▁מקום           | ▁שלב         | ✗     |
|    31 | .               | ▁י           | ✗     |
|    32 | ג               | תבצע         | ✗     |
|    33 | ו               | ▁חילופי      | ✗     |
|    34 | ם               | ▁שבויים      | ✗     |
|    35 | .               | ▁ויו         | ✗     |
|    36 | טל              | כנס          | ✗     |
|    37 | ו               | ▁סיוע        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ▁מחדש           | <pad>        | ✗     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ▁זה             | <pad>        | ✗     |
|    46 | ה               | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | .               | <pad>        | ✗     |
|    50 | </s>            |              | ✗     |

2024-12-31 22:09:17,329 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:09:17,334 - TrainingLogger - INFO - Gradient norm: 10.0611
2024-12-31 22:09:24,842 - TrainingLogger - INFO - Step 32510, Batch metrics: Loss: 7.3803, Accuracy: 0.0649, Perplexity: 1604.0756
2024-12-31 22:09:32,487 - TrainingLogger - INFO - Step 32520, Batch metrics: Loss: 7.2399, Accuracy: 0.1056, Perplexity: 1393.9208
2024-12-31 22:09:39,793 - TrainingLogger - INFO - Step 32530, Batch metrics: Loss: 8.0870, Accuracy: 0.0317, Perplexity: 3252.0037
2024-12-31 22:09:46,992 - TrainingLogger - INFO - Step 32540, Batch metrics: Loss: 7.3730, Accuracy: 0.1119, Perplexity: 1592.4496
2024-12-31 22:09:53,933 - TrainingLogger - INFO - Step 32550, Batch metrics: Loss: 7.9269, Accuracy: 0.0654, Perplexity: 2770.8871
2024-12-31 22:10:01,042 - TrainingLogger - INFO - Step 32560, Batch metrics: Loss: 7.5317, Accuracy: 0.0686, Perplexity: 1866.2597
2024-12-31 22:10:08,214 - TrainingLogger - INFO - Step 32570, Batch metrics: Loss: 7.8100, Accuracy: 0.0651, Perplexity: 2465.1820
2024-12-31 22:10:15,098 - TrainingLogger - INFO - Step 32580, Batch metrics: Loss: 7.5746, Accuracy: 0.0698, Perplexity: 1948.0126
2024-12-31 22:10:22,029 - TrainingLogger - INFO - Step 32590, Batch metrics: Loss: 7.4091, Accuracy: 0.0667, Perplexity: 1650.9250
2024-12-31 22:10:28,922 - TrainingLogger - INFO - Step 32600, Batch metrics: Loss: 7.8834, Accuracy: 0.0446, Perplexity: 2652.7884
2024-12-31 22:10:28,922 - TrainingLogger - INFO - Step 32600, Prediction vs Actual:
2024-12-31 22:10:28,922 - TrainingLogger - INFO - Input 1: אבל ללא ספק, מי שיכולה להרוויח יותר מכל אם המודל יהפוך מתיאורטי למעשי היא הרשימה המשותפת
2024-12-31 22:10:28,923 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:10:28,923 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אבל         | ✗     |
|     1 | ▁-              | ▁ללא         | ✗     |
|     2 | ▁-              | ▁ספק         | ✗     |
|     3 | ▁זה             | ,            | ✗     |
|     4 | ▁זה             | ▁מי          | ✗     |
|     5 | ▁זה             | ▁שיכול       | ✗     |
|     6 | ▁היה            | ה            | ✗     |
|     7 | ▁לעשות          | ▁להרוויח     | ✗     |
|     8 | ▁את             | ▁יותר        | ✗     |
|     9 | ▁מזה            | ▁מכל         | ✗     |
|    10 | ▁אחד            | ▁אם          | ✗     |
|    11 | ▁לא             | ▁המודל       | ✗     |
|    12 | ▁הזה            | ▁            | ✗     |
|    13 | ים              | יהפוך        | ✗     |
|    14 | ▁ל              | ▁מתי         | ✗     |
|    15 | יש              | אור          | ✗     |
|    16 | .               | טי           | ✗     |
|    17 | .               | ▁למעשי       | ✗     |
|    18 | ו               | ▁היא         | ✗     |
|    19 | ▁תהיה           | ▁הרשימה      | ✗     |
|    20 | ,               | ▁המשותפת     | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁היא            | <pad>        | ✗     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | ▁לא             | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | ▁זה             | <pad>        | ✗     |
|    31 | ▁לא             | <pad>        | ✗     |
|    32 | ▁לא             | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ▁לא             | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | ▁לא             | <pad>        | ✗     |
|    39 | ▁לא             | <pad>        | ✗     |
|    40 | <pad>           |              | ✗     |

2024-12-31 22:10:28,923 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:10:28,928 - TrainingLogger - INFO - Gradient norm: 8.6744
2024-12-31 22:10:35,790 - TrainingLogger - INFO - Step 32610, Batch metrics: Loss: 7.5917, Accuracy: 0.0652, Perplexity: 1981.6277
2024-12-31 22:10:43,270 - TrainingLogger - INFO - Step 32620, Batch metrics: Loss: 7.6318, Accuracy: 0.0651, Perplexity: 2062.6715
2024-12-31 22:10:50,589 - TrainingLogger - INFO - Step 32630, Batch metrics: Loss: 7.5140, Accuracy: 0.0656, Perplexity: 1833.5355
2024-12-31 22:10:57,285 - TrainingLogger - INFO - Step 32640, Batch metrics: Loss: 7.4701, Accuracy: 0.0990, Perplexity: 1754.7235
2024-12-31 22:11:04,298 - TrainingLogger - INFO - Step 32650, Batch metrics: Loss: 7.5417, Accuracy: 0.0791, Perplexity: 1885.0937
2024-12-31 22:11:11,477 - TrainingLogger - INFO - Step 32660, Batch metrics: Loss: 7.0999, Accuracy: 0.0863, Perplexity: 1211.7896
2024-12-31 22:11:18,875 - TrainingLogger - INFO - Step 32670, Batch metrics: Loss: 7.4530, Accuracy: 0.0995, Perplexity: 1724.9607
2024-12-31 22:11:26,574 - TrainingLogger - INFO - Step 32680, Batch metrics: Loss: 7.2936, Accuracy: 0.0899, Perplexity: 1470.8101
2024-12-31 22:11:33,166 - TrainingLogger - INFO - Step 32690, Batch metrics: Loss: 8.1484, Accuracy: 0.0432, Perplexity: 3457.8234
2024-12-31 22:11:40,027 - TrainingLogger - INFO - Step 32700, Batch metrics: Loss: 7.3519, Accuracy: 0.0931, Perplexity: 1559.0879
2024-12-31 22:11:40,028 - TrainingLogger - INFO - Step 32700, Prediction vs Actual:
2024-12-31 22:11:40,028 - TrainingLogger - INFO - Input 1: דר קווין סמית שהוביל את המחקר אמר נהגנו לחשוב שגישה פוליטית נובעת מהסביבה
2024-12-31 22:11:40,028 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:11:40,028 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁דר          | ✗     |
|     1 | ▁-              | ▁קווין       | ✗     |
|     2 | :               | ▁סמית        | ✗     |
|     3 | ▁-              | ▁שהוביל      | ✗     |
|     4 | ה               | ▁את          | ✗     |
|     5 | ▁זה             | ▁המחקר       | ✗     |
|     6 | ▁הזה            | ▁אמר         | ✗     |
|     7 | ד               | ▁נהגנו       | ✗     |
|     8 | ת               | ▁לחשוב       | ✗     |
|     9 | ▁כך             | ▁ש           | ✗     |
|    10 | ...             | גישה         | ✗     |
|    11 | ▁זו             | ▁פוליטית     | ✗     |
|    12 | ▁טובה           | ▁נובע        | ✗     |
|    13 | ת               | ת            | ✓     |
|    14 | ▁מכך            | ▁מה          | ✗     |
|    15 | ה               | סביב         | ✗     |
|    16 | ה               | ה            | ✓     |
|    17 | ▁שלנו           | <pad>        | ✗     |
|    18 | ית              | <pad>        | ✗     |
|    19 | ית              | <pad>        | ✗     |
|    20 | ית              | <pad>        | ✗     |
|    21 | ▁חדשה           | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ה               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁זו             | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ▁משפטית         | <pad>        | ✗     |
|    41 | ▁משפטית         | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | ▁זו             |              | ✗     |

2024-12-31 22:11:40,028 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:11:40,033 - TrainingLogger - INFO - Gradient norm: 9.0902
2024-12-31 22:11:46,751 - TrainingLogger - INFO - Step 32710, Batch metrics: Loss: 6.9684, Accuracy: 0.1192, Perplexity: 1062.5705
2024-12-31 22:11:54,086 - TrainingLogger - INFO - Step 32720, Batch metrics: Loss: 7.3586, Accuracy: 0.0680, Perplexity: 1569.5936
2024-12-31 22:12:01,140 - TrainingLogger - INFO - Step 32730, Batch metrics: Loss: 7.9140, Accuracy: 0.0491, Perplexity: 2735.2839
2024-12-31 22:12:08,148 - TrainingLogger - INFO - Step 32740, Batch metrics: Loss: 7.8248, Accuracy: 0.0732, Perplexity: 2501.9513
2024-12-31 22:12:15,256 - TrainingLogger - INFO - Step 32750, Batch metrics: Loss: 7.1202, Accuracy: 0.1150, Perplexity: 1236.7351
2024-12-31 22:12:22,715 - TrainingLogger - INFO - Step 32760, Batch metrics: Loss: 7.6806, Accuracy: 0.0526, Perplexity: 2165.9833
2024-12-31 22:12:29,984 - TrainingLogger - INFO - Step 32770, Batch metrics: Loss: 7.4666, Accuracy: 0.0548, Perplexity: 1748.7203
2024-12-31 22:12:37,102 - TrainingLogger - INFO - Step 32780, Batch metrics: Loss: 7.1080, Accuracy: 0.1007, Perplexity: 1221.7288
2024-12-31 22:12:44,252 - TrainingLogger - INFO - Step 32790, Batch metrics: Loss: 7.1786, Accuracy: 0.0874, Perplexity: 1311.0125
2024-12-31 22:12:50,924 - TrainingLogger - INFO - Step 32800, Batch metrics: Loss: 7.3264, Accuracy: 0.0703, Perplexity: 1519.9435
2024-12-31 22:12:50,925 - TrainingLogger - INFO - Step 32800, Prediction vs Actual:
2024-12-31 22:12:50,925 - TrainingLogger - INFO - Input 1: אורבך התקשה לצאת מהבית והילדים של סילמן עברו חוויות בלתי נסבלות בבית הספר
2024-12-31 22:12:50,925 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:12:50,925 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אורב        | ✗     |
|     1 | ▁-              | ך            | ✗     |
|     2 | ר               | ▁הת          | ✗     |
|     3 | בה              | קשה          | ✗     |
|     4 | ▁חדשה           | ▁לצאת        | ✗     |
|     5 | ▁עם             | ▁מהבית       | ✗     |
|     6 | ▁-              | ▁והילדים     | ✗     |
|     7 | .               | ▁של          | ✗     |
|     8 | <pad>           | ▁סיל         | ✗     |
|     9 | ב               | מן           | ✗     |
|    10 | .               | ▁עברו        | ✗     |
|    11 | .               | ▁חוויות      | ✗     |
|    12 | ▁רבות           | ▁בלתי        | ✗     |
|    13 | ▁ברורות         | ▁נסבל        | ✗     |
|    14 | ות              | ות           | ✓     |
|    15 | .               | ▁בבית        | ✗     |
|    16 | ▁המשפט          | ▁הספר        | ✗     |
|    17 | ▁"              | <pad>        | ✗     |
|    18 | ▁התיכון         | <pad>        | ✗     |
|    19 | י               | <pad>        | ✗     |
|    20 | י               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ות              | <pad>        | ✗     |
|    23 | ▁הזה            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | ▁אחר            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | ים              |              | ✗     |

2024-12-31 22:12:50,925 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:12:50,930 - TrainingLogger - INFO - Gradient norm: 9.8774
2024-12-31 22:12:58,640 - TrainingLogger - INFO - Step 32810, Batch metrics: Loss: 7.6923, Accuracy: 0.1256, Perplexity: 2191.4630
2024-12-31 22:13:05,428 - TrainingLogger - INFO - Step 32820, Batch metrics: Loss: 7.5652, Accuracy: 0.0769, Perplexity: 1929.9299
2024-12-31 22:13:12,528 - TrainingLogger - INFO - Step 32830, Batch metrics: Loss: 9.2520, Accuracy: 0.0107, Perplexity: 10425.1456
2024-12-31 22:13:19,726 - TrainingLogger - INFO - Step 32840, Batch metrics: Loss: 7.2450, Accuracy: 0.0417, Perplexity: 1401.0584
2024-12-31 22:13:26,683 - TrainingLogger - INFO - Step 32850, Batch metrics: Loss: 7.8787, Accuracy: 0.0526, Perplexity: 2640.3604
2024-12-31 22:13:33,368 - TrainingLogger - INFO - Step 32860, Batch metrics: Loss: 7.1156, Accuracy: 0.1250, Perplexity: 1231.0262
2024-12-31 22:13:40,458 - TrainingLogger - INFO - Step 32870, Batch metrics: Loss: 7.5785, Accuracy: 0.0748, Perplexity: 1955.7441
2024-12-31 22:13:47,609 - TrainingLogger - INFO - Step 32880, Batch metrics: Loss: 7.5515, Accuracy: 0.0507, Perplexity: 1903.5748
2024-12-31 22:13:54,416 - TrainingLogger - INFO - Step 32890, Batch metrics: Loss: 7.6922, Accuracy: 0.0566, Perplexity: 2191.1746
2024-12-31 22:14:01,545 - TrainingLogger - INFO - Step 32900, Batch metrics: Loss: 7.4237, Accuracy: 0.0773, Perplexity: 1675.2760
2024-12-31 22:14:01,546 - TrainingLogger - INFO - Step 32900, Prediction vs Actual:
2024-12-31 22:14:01,546 - TrainingLogger - INFO - Input 1: הם יגלו זאת רק לאחר מותהב-15 השנים האחרונות אני נתקל יותר ויותר בבקשות לעריכת צוואות לא שוויוניות, אומר עוד נתן פנץ מראש פינה
2024-12-31 22:14:01,546 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:14:01,546 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הם          | ✗     |
|     1 | .               | ▁יגלו        | ✗     |
|     2 | .               | ▁זאת         | ✗     |
|     3 | .               | ▁רק          | ✗     |
|     4 | ▁בגלל           | ▁לאחר        | ✗     |
|     5 | ▁זמן            | ▁מותה        | ✗     |
|     6 | ▁של             | ב            | ✗     |
|     7 | .               | -15          | ✗     |
|     8 | ▁שנה            | ▁השנים       | ✗     |
|     9 | ▁האחרונות       | ▁האחרונות    | ✓     |
|    10 | .               | ▁אני         | ✗     |
|    11 | ▁יודע           | ▁נתקל        | ✗     |
|    12 | ▁ב              | ▁יותר        | ✗     |
|    13 | ▁בזה            | ▁ויותר       | ✗     |
|    14 | .               | ▁ב           | ✗     |
|    15 | ם               | בקש          | ✗     |
|    16 | ו               | ות           | ✗     |
|    17 | .               | ▁לערי        | ✗     |
|    18 | פת              | כת           | ✗     |
|    19 | ו               | ▁צ           | ✗     |
|    20 | '               | וואו         | ✗     |
|    21 | ת               | ת            | ✓     |
|    22 | .               | ▁לא          | ✗     |
|    23 | ב               | ▁שווי        | ✗     |
|    24 | יץ              | וניות        | ✗     |
|    25 | .               | ,            | ✗     |
|    26 | </s>            | ▁אומר        | ✗     |
|    27 | ▁לך             | ▁עוד         | ✗     |
|    28 | ▁כמה            | ▁נתן         | ✗     |
|    29 | ▁את             | ▁פ           | ✗     |
|    30 | קטור            | נץ           | ✗     |
|    31 | '               | ▁מראש        | ✗     |
|    32 | .               | ▁פינה        | ✗     |
|    33 | ▁את             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 22:14:01,546 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:14:01,551 - TrainingLogger - INFO - Gradient norm: 10.1920
2024-12-31 22:14:09,018 - TrainingLogger - INFO - Step 32910, Batch metrics: Loss: 7.8401, Accuracy: 0.0391, Perplexity: 2540.4850
2024-12-31 22:14:16,200 - TrainingLogger - INFO - Step 32920, Batch metrics: Loss: 7.1828, Accuracy: 0.0978, Perplexity: 1316.5962
2024-12-31 22:14:23,548 - TrainingLogger - INFO - Step 32930, Batch metrics: Loss: 7.6876, Accuracy: 0.0619, Perplexity: 2181.2098
2024-12-31 22:14:25,849 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 336896
2024-12-31 22:14:25,849 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 336896

2024-12-31 22:14:25,849 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 64]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 64]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 50]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 50]), device: cuda:0
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 22:14:25,851 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 22:14:31,623 - TrainingLogger - INFO - Step 32940, Batch metrics: Loss: 7.5616, Accuracy: 0.0451, Perplexity: 1922.8761
2024-12-31 22:14:39,429 - TrainingLogger - INFO - Step 32950, Batch metrics: Loss: 7.8176, Accuracy: 0.0722, Perplexity: 2484.0369
2024-12-31 22:14:46,906 - TrainingLogger - INFO - Step 32960, Batch metrics: Loss: 7.0552, Accuracy: 0.0759, Perplexity: 1158.8141
2024-12-31 22:14:53,890 - TrainingLogger - INFO - Step 32970, Batch metrics: Loss: 7.8351, Accuracy: 0.0305, Perplexity: 2527.9056
2024-12-31 22:15:00,825 - TrainingLogger - INFO - Step 32980, Batch metrics: Loss: 7.2903, Accuracy: 0.1022, Perplexity: 1466.0627
2024-12-31 22:15:08,211 - TrainingLogger - INFO - Step 32990, Batch metrics: Loss: 7.3244, Accuracy: 0.0663, Perplexity: 1516.9126
2024-12-31 22:15:15,467 - TrainingLogger - INFO - Step 33000, Batch metrics: Loss: 7.2631, Accuracy: 0.1134, Perplexity: 1426.6705
2024-12-31 22:15:15,468 - TrainingLogger - INFO - Step 33000, Prediction vs Actual:
2024-12-31 22:15:15,468 - TrainingLogger - INFO - Input 1: ההזנה תוצג על מסכי וידאו כדי שהמשקיפים יוכלו לעקוב אחריה
2024-12-31 22:15:15,468 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:15:15,468 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ב               | ▁הה          | ✗     |
|     1 | ה               | זנה          | ✗     |
|     2 | ▁של             | ▁ת           | ✗     |
|     3 | וק              | וצ           | ✗     |
|     4 | ק               | ג            | ✗     |
|     5 | מ               | ▁על          | ✗     |
|     6 | ▁               | ▁מס          | ✗     |
|     7 | ה               | כי           | ✗     |
|     8 | נים             | ▁וידאו       | ✗     |
|     9 | .               | ▁כדי         | ✗     |
|    10 | ▁להגן           | ▁שה          | ✗     |
|    11 | ייה             | משק          | ✗     |
|    12 | ▁ית             | יפים         | ✗     |
|    13 | ▁לא             | ▁יוכלו       | ✗     |
|    14 | ▁לעבוד          | ▁לעקוב       | ✗     |
|    15 | ▁אחריו          | ▁אחריה       | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            |              | ✗     |

2024-12-31 22:15:15,468 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:15:15,473 - TrainingLogger - INFO - Gradient norm: 8.2020
2024-12-31 22:15:23,030 - TrainingLogger - INFO - Step 33010, Batch metrics: Loss: 7.2550, Accuracy: 0.0788, Perplexity: 1415.1402
2024-12-31 22:15:30,106 - TrainingLogger - INFO - Step 33020, Batch metrics: Loss: 7.1026, Accuracy: 0.0933, Perplexity: 1215.0708
2024-12-31 22:15:37,035 - TrainingLogger - INFO - Step 33030, Batch metrics: Loss: 7.1297, Accuracy: 0.0629, Perplexity: 1248.4865
2024-12-31 22:15:44,149 - TrainingLogger - INFO - Step 33040, Batch metrics: Loss: 7.9126, Accuracy: 0.0435, Perplexity: 2731.3790
2024-12-31 22:15:51,421 - TrainingLogger - INFO - Step 33050, Batch metrics: Loss: 7.3542, Accuracy: 0.0556, Perplexity: 1562.8169
2024-12-31 22:15:58,352 - TrainingLogger - INFO - Step 33060, Batch metrics: Loss: 7.8547, Accuracy: 0.0333, Perplexity: 2577.6965
2024-12-31 22:16:05,527 - TrainingLogger - INFO - Step 33070, Batch metrics: Loss: 7.1146, Accuracy: 0.0973, Perplexity: 1229.7965
2024-12-31 22:16:12,996 - TrainingLogger - INFO - Step 33080, Batch metrics: Loss: 7.3590, Accuracy: 0.0892, Perplexity: 1570.3115
2024-12-31 22:16:20,294 - TrainingLogger - INFO - Step 33090, Batch metrics: Loss: 7.1588, Accuracy: 0.0860, Perplexity: 1285.3101
2024-12-31 22:16:27,612 - TrainingLogger - INFO - Step 33100, Batch metrics: Loss: 7.3051, Accuracy: 0.0452, Perplexity: 1487.8119
2024-12-31 22:16:27,612 - TrainingLogger - INFO - Step 33100, Prediction vs Actual:
2024-12-31 22:16:27,612 - TrainingLogger - INFO - Input 1: הזוכות והזוכים במקצי הזוגיות - נשים, 200 מטרים 1
2024-12-31 22:16:27,613 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:16:27,613 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הזו         | ✗     |
|     1 | .               | כות          | ✗     |
|     2 | ▁שלה            | ▁וה          | ✗     |
|     3 | רבות            | זו           | ✗     |
|     4 | כות             | כים          | ✗     |
|     5 | ▁שלה            | ▁ב           | ✗     |
|     6 | עצ              | מק           | ✗     |
|     7 | ומן             | צי           | ✗     |
|     8 | מה              | ▁הזוג        | ✗     |
|     9 | ות              | יות          | ✗     |
|    10 | ▁שלהם           | ▁-           | ✗     |
|    11 | -               | ▁נשים        | ✗     |
|    12 | ▁את             | ,            | ✗     |
|    13 | <pad>           | ▁200         | ✗     |
|    14 | ▁דולר           | ▁מטרים       | ✗     |
|    15 | </s>            | ▁1           | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ▁-              | <pad>        | ✗     |
|    18 | ▁-              | <pad>        | ✗     |
|    19 | ות              | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ות              |              | ✗     |

2024-12-31 22:16:27,613 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:16:27,618 - TrainingLogger - INFO - Gradient norm: 10.7634
2024-12-31 22:16:34,817 - TrainingLogger - INFO - Step 33110, Batch metrics: Loss: 6.9225, Accuracy: 0.1209, Perplexity: 1014.9010
2024-12-31 22:16:42,125 - TrainingLogger - INFO - Step 33120, Batch metrics: Loss: 7.1579, Accuracy: 0.0674, Perplexity: 1284.2356
2024-12-31 22:16:49,138 - TrainingLogger - INFO - Step 33130, Batch metrics: Loss: 7.7191, Accuracy: 0.0833, Perplexity: 2251.0026
2024-12-31 22:16:56,921 - TrainingLogger - INFO - Step 33140, Batch metrics: Loss: 7.4632, Accuracy: 0.0443, Perplexity: 1742.7235
2024-12-31 22:17:03,871 - TrainingLogger - INFO - Step 33150, Batch metrics: Loss: 7.5566, Accuracy: 0.0864, Perplexity: 1913.2974
2024-12-31 22:17:11,058 - TrainingLogger - INFO - Step 33160, Batch metrics: Loss: 7.1612, Accuracy: 0.0814, Perplexity: 1288.4366
2024-12-31 22:17:18,493 - TrainingLogger - INFO - Step 33170, Batch metrics: Loss: 8.0818, Accuracy: 0.0513, Perplexity: 3235.1852
2024-12-31 22:17:25,962 - TrainingLogger - INFO - Step 33180, Batch metrics: Loss: 7.3443, Accuracy: 0.0553, Perplexity: 1547.4087
2024-12-31 22:17:32,711 - TrainingLogger - INFO - Step 33190, Batch metrics: Loss: 7.1696, Accuracy: 0.0452, Perplexity: 1299.3068
2024-12-31 22:17:39,835 - TrainingLogger - INFO - Step 33200, Batch metrics: Loss: 7.3439, Accuracy: 0.0829, Perplexity: 1546.6717
2024-12-31 22:17:39,835 - TrainingLogger - INFO - Step 33200, Prediction vs Actual:
2024-12-31 22:17:39,835 - TrainingLogger - INFO - Input 1: פניתי גם לשרה איילת שקד יחד עם כל פורום האתרים
2024-12-31 22:17:39,836 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:17:39,836 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | -               | ▁פני         | ✗     |
|     1 | ▁לא             | תי           | ✗     |
|     2 | ▁אל             | ▁גם          | ✗     |
|     3 | ▁אליו           | ▁לשר         | ✗     |
|     4 | ות              | ה            | ✗     |
|     5 | ,               | ▁אייל        | ✗     |
|     6 | ה               | ת            | ✗     |
|     7 | -               | ▁שק          | ✗     |
|     8 | מה              | ד            | ✗     |
|     9 | "               | ▁יחד         | ✗     |
|    10 | .               | ▁עם          | ✗     |
|    11 | ▁בית            | ▁כל          | ✗     |
|    12 | ▁הנשים          | ▁פו          | ✗     |
|    13 | א               | רום          | ✗     |
|    14 | .               | ▁האתר        | ✗     |
|    15 | ים              | ים           | ✓     |
|    16 | .               | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁הם             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               |              | ✗     |

2024-12-31 22:17:39,836 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:17:39,841 - TrainingLogger - INFO - Gradient norm: 9.7788
2024-12-31 22:17:47,292 - TrainingLogger - INFO - Step 33210, Batch metrics: Loss: 7.2459, Accuracy: 0.0567, Perplexity: 1402.2895
2024-12-31 22:17:51,383 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 329728
2024-12-31 22:17:51,383 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 329728

2024-12-31 22:17:51,383 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 52]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - input_ids_2 min: 1, max: 151643
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 52]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 46]), device: cuda:0
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 22:17:51,384 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 22:17:54,751 - TrainingLogger - INFO - Step 33220, Batch metrics: Loss: 7.2169, Accuracy: 0.0612, Perplexity: 1362.2886
2024-12-31 22:18:02,087 - TrainingLogger - INFO - Step 33230, Batch metrics: Loss: 7.5078, Accuracy: 0.0741, Perplexity: 1822.1379
2024-12-31 22:18:09,017 - TrainingLogger - INFO - Step 33240, Batch metrics: Loss: 7.4354, Accuracy: 0.0691, Perplexity: 1694.9404
2024-12-31 22:18:15,895 - TrainingLogger - INFO - Step 33250, Batch metrics: Loss: 7.4983, Accuracy: 0.0532, Perplexity: 1804.9775
2024-12-31 22:18:22,781 - TrainingLogger - INFO - Step 33260, Batch metrics: Loss: 7.3159, Accuracy: 0.0862, Perplexity: 1504.0719
2024-12-31 22:18:29,959 - TrainingLogger - INFO - Step 33270, Batch metrics: Loss: 7.0958, Accuracy: 0.0942, Perplexity: 1206.9196
2024-12-31 22:18:37,064 - TrainingLogger - INFO - Step 33280, Batch metrics: Loss: 7.1102, Accuracy: 0.1045, Perplexity: 1224.4238
2024-12-31 22:18:44,129 - TrainingLogger - INFO - Step 33290, Batch metrics: Loss: 7.0488, Accuracy: 0.0828, Perplexity: 1151.4256
2024-12-31 22:18:51,283 - TrainingLogger - INFO - Step 33300, Batch metrics: Loss: 7.5376, Accuracy: 0.0824, Perplexity: 1877.4024
2024-12-31 22:18:51,284 - TrainingLogger - INFO - Step 33300, Prediction vs Actual:
2024-12-31 22:18:51,284 - TrainingLogger - INFO - Input 1: תם כמעט לגמרי עידן הקורונה
2024-12-31 22:18:51,284 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:18:51,284 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁תם          | ✗     |
|     1 | ▁-              | ▁כמעט        | ✗     |
|     2 | ▁כן             | ▁לגמרי       | ✗     |
|     3 | .               | ▁            | ✗     |
|     4 | תקיף            | עידן         | ✗     |
|     5 | ▁חדש            | ▁הקור        | ✗     |
|     6 | ה               | ונה          | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | -               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁היום           | <pad>        | ✗     |
|    12 | ▁הגיע           | <pad>        | ✗     |
|    13 | ▁עד             | <pad>        | ✗     |
|    14 | ▁מגיע           | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | ▁אחד            | <pad>        | ✗     |
|    19 | ▁הגיע           | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | ▁יום            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ▁היה            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               |              | ✗     |

2024-12-31 22:18:51,284 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:18:51,289 - TrainingLogger - INFO - Gradient norm: 9.7183
2024-12-31 22:18:58,747 - TrainingLogger - INFO - Step 33310, Batch metrics: Loss: 7.2101, Accuracy: 0.1148, Perplexity: 1352.9665
2024-12-31 22:19:05,867 - TrainingLogger - INFO - Step 33320, Batch metrics: Loss: 7.0572, Accuracy: 0.0841, Perplexity: 1161.2363
2024-12-31 22:19:13,797 - TrainingLogger - INFO - Step 33330, Batch metrics: Loss: 7.8178, Accuracy: 0.0429, Perplexity: 2484.3627
2024-12-31 22:19:20,943 - TrainingLogger - INFO - Step 33340, Batch metrics: Loss: 7.6363, Accuracy: 0.0505, Perplexity: 2072.0493
2024-12-31 22:19:27,779 - TrainingLogger - INFO - Step 33350, Batch metrics: Loss: 7.1336, Accuracy: 0.1095, Perplexity: 1253.3401
2024-12-31 22:19:34,281 - TrainingLogger - INFO - Step 33360, Batch metrics: Loss: 7.5540, Accuracy: 0.0604, Perplexity: 1908.4208
2024-12-31 22:19:41,343 - TrainingLogger - INFO - Step 33370, Batch metrics: Loss: 7.6950, Accuracy: 0.0667, Perplexity: 2197.2797
2024-12-31 22:19:48,654 - TrainingLogger - INFO - Step 33380, Batch metrics: Loss: 6.8480, Accuracy: 0.0964, Perplexity: 942.0364
2024-12-31 22:19:56,352 - TrainingLogger - INFO - Step 33390, Batch metrics: Loss: 7.1962, Accuracy: 0.0955, Perplexity: 1334.3613
2024-12-31 22:20:03,246 - TrainingLogger - INFO - Step 33400, Batch metrics: Loss: 6.8842, Accuracy: 0.0892, Perplexity: 976.7676
2024-12-31 22:20:03,247 - TrainingLogger - INFO - Step 33400, Prediction vs Actual:
2024-12-31 22:20:03,247 - TrainingLogger - INFO - Input 1: לגוש הימין, שכולל את כחלון והחרדים, לפי סקר זה - 61 מנדטים, ולגוש השמאל-מרכז 59
2024-12-31 22:20:03,247 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:20:03,247 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ל           | ✗     |
|     1 | ▁ל              | גוש          | ✗     |
|     2 | </s>            | ▁הי          | ✗     |
|     3 | ח               | מין          | ✗     |
|     4 | </s>            | ,            | ✗     |
|     5 | ▁הא             | ▁ש           | ✗     |
|     6 | כם              | כולל         | ✗     |
|     7 | ▁את             | ▁את          | ✓     |
|     8 | ר               | ▁כ           | ✗     |
|     9 | דה              | חלון         | ✗     |
|    10 | ,               | ▁והח         | ✗     |
|    11 | מה              | רד           | ✗     |
|    12 | .               | ים           | ✗     |
|    13 | ,               | ,            | ✓     |
|    14 | </s>            | ▁לפי         | ✗     |
|    15 | ר               | ▁סקר         | ✗     |
|    16 | ים              | ▁זה          | ✗     |
|    17 | ה               | ▁-           | ✗     |
|    18 | -               | ▁61          | ✗     |
|    19 | </s>            | ▁מנד         | ✗     |
|    20 | רי              | טים          | ✗     |
|    21 | ▁-              | ,            | ✗     |
|    22 | </s>            | ▁ול          | ✗     |
|    23 | עו              | גוש          | ✗     |
|    24 | ים              | ▁ה           | ✗     |
|    25 | פש              | שמאל         | ✗     |
|    26 | ,               | -            | ✗     |
|    27 | ה               | מרכז         | ✗     |
|    28 | ים              | ▁59          | ✗     |
|    29 | ,               |              | ✗     |

2024-12-31 22:20:03,247 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:20:03,252 - TrainingLogger - INFO - Gradient norm: 8.3424
2024-12-31 22:20:10,914 - TrainingLogger - INFO - Step 33410, Batch metrics: Loss: 7.2309, Accuracy: 0.1167, Perplexity: 1381.4143
2024-12-31 22:20:18,001 - TrainingLogger - INFO - Step 33420, Batch metrics: Loss: 7.6863, Accuracy: 0.0777, Perplexity: 2178.2683
2024-12-31 22:20:25,006 - TrainingLogger - INFO - Step 33430, Batch metrics: Loss: 7.6110, Accuracy: 0.0536, Perplexity: 2020.3601
2024-12-31 22:20:32,408 - TrainingLogger - INFO - Step 33440, Batch metrics: Loss: 6.8149, Accuracy: 0.1244, Perplexity: 911.3570
2024-12-31 22:20:39,448 - TrainingLogger - INFO - Step 33450, Batch metrics: Loss: 7.0909, Accuracy: 0.0733, Perplexity: 1201.0448
2024-12-31 22:20:46,985 - TrainingLogger - INFO - Step 33460, Batch metrics: Loss: 7.5986, Accuracy: 0.1000, Perplexity: 1995.3098
2024-12-31 22:20:54,469 - TrainingLogger - INFO - Step 33470, Batch metrics: Loss: 7.0873, Accuracy: 0.1126, Perplexity: 1196.6226
2024-12-31 22:21:02,434 - TrainingLogger - INFO - Step 33480, Batch metrics: Loss: 7.3796, Accuracy: 0.0838, Perplexity: 1602.9088
2024-12-31 22:21:09,350 - TrainingLogger - INFO - Step 33490, Batch metrics: Loss: 7.2188, Accuracy: 0.0802, Perplexity: 1364.9174
2024-12-31 22:21:16,790 - TrainingLogger - INFO - Step 33500, Batch metrics: Loss: 7.1953, Accuracy: 0.0814, Perplexity: 1333.1783
2024-12-31 22:21:16,791 - TrainingLogger - INFO - Step 33500, Prediction vs Actual:
2024-12-31 22:21:16,791 - TrainingLogger - INFO - Input 1: המטה נכנס לוואקום שבו הוא מסייע לחקירתו של התובע כעמותה, וכך יוכל בית הדין להגיש את אישומיו נגד אנשים פרטיים
2024-12-31 22:21:16,791 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:21:16,791 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁המטה        | ✗     |
|     1 | ▁-              | ▁נכנס        | ✗     |
|     2 | ▁-              | ▁לו          | ✗     |
|     3 | ו               | וא           | ✗     |
|     4 | סקי             | קום          | ✗     |
|     5 | ▁יש             | ▁שבו         | ✗     |
|     6 | ▁הוא            | ▁הוא         | ✓     |
|     7 | ▁לא             | ▁מסייע       | ✗     |
|     8 | ▁לו             | ▁ל           | ✗     |
|     9 | נסי             | חקירת        | ✗     |
|    10 | ו               | ו            | ✓     |
|    11 | .               | ▁של          | ✗     |
|    12 | ▁ג              | ▁התובע       | ✗     |
|    13 | ▁המחוזי         | ▁כ           | ✗     |
|    14 | נשיא            | עמו          | ✗     |
|    15 | ן               | תה           | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | ▁הוא            | ▁וכך         | ✗     |
|    18 | ▁הוא            | ▁יוכל        | ✗     |
|    19 | ▁לעשות          | ▁בית         | ✗     |
|    20 | ▁המשפט          | ▁הדין        | ✗     |
|    21 | ▁שלו            | ▁להגיש       | ✗     |
|    22 | ▁את             | ▁את          | ✓     |
|    23 | ▁זה             | ▁איש         | ✗     |
|    24 | ▁הקשר           | ומי          | ✗     |
|    25 | ו               | ו            | ✓     |
|    26 | .               | ▁נגד         | ✗     |
|    27 | ▁החוק           | ▁אנשים       | ✗     |
|    28 | ▁אחרים          | ▁פרטיים      | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ים              |              | ✗     |

2024-12-31 22:21:16,791 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:21:16,796 - TrainingLogger - INFO - Gradient norm: 11.6324
2024-12-31 22:21:24,260 - TrainingLogger - INFO - Step 33510, Batch metrics: Loss: 7.0440, Accuracy: 0.0774, Perplexity: 1145.9248
2024-12-31 22:21:30,919 - TrainingLogger - INFO - Step 33520, Batch metrics: Loss: 7.0484, Accuracy: 0.0882, Perplexity: 1150.9958
2024-12-31 22:21:38,277 - TrainingLogger - INFO - Step 33530, Batch metrics: Loss: 6.9713, Accuracy: 0.0983, Perplexity: 1065.6383
2024-12-31 22:21:45,168 - TrainingLogger - INFO - Step 33540, Batch metrics: Loss: 7.3945, Accuracy: 0.0812, Perplexity: 1627.0496
2024-12-31 22:21:52,379 - TrainingLogger - INFO - Step 33550, Batch metrics: Loss: 7.3781, Accuracy: 0.0760, Perplexity: 1600.5312
2024-12-31 22:22:00,120 - TrainingLogger - INFO - Step 33560, Batch metrics: Loss: 7.2134, Accuracy: 0.0864, Perplexity: 1357.5490
2024-12-31 22:22:06,620 - TrainingLogger - INFO - Step 33570, Batch metrics: Loss: 7.9338, Accuracy: 0.0783, Perplexity: 2789.9548
2024-12-31 22:22:14,131 - TrainingLogger - INFO - Step 33580, Batch metrics: Loss: 7.4982, Accuracy: 0.0888, Perplexity: 1804.8166
2024-12-31 22:22:21,603 - TrainingLogger - INFO - Step 33590, Batch metrics: Loss: 7.4525, Accuracy: 0.0870, Perplexity: 1724.0882
2024-12-31 22:22:28,804 - TrainingLogger - INFO - Step 33600, Batch metrics: Loss: 7.1229, Accuracy: 0.0821, Perplexity: 1239.9893
2024-12-31 22:22:28,804 - TrainingLogger - INFO - Step 33600, Prediction vs Actual:
2024-12-31 22:22:28,804 - TrainingLogger - INFO - Input 1: אין במדינה הזו סיווג ביטחוני גבוה משלי
2024-12-31 22:22:28,805 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:22:28,805 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁אין         | ✗     |
|     1 | ▁זה             | ▁במדינה      | ✗     |
|     2 | .               | ▁הזו         | ✗     |
|     3 | .               | ▁סיווג       | ✗     |
|     4 | ▁עצמי           | ▁ביטחוני     | ✗     |
|     5 | ▁גבוה           | ▁גבוה        | ✓     |
|     6 | ▁יותר           | ▁משלי        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁גבוה           | <pad>        | ✗     |
|    12 | ▁גבוה           | <pad>        | ✗     |
|    13 | ▁גבוה           | <pad>        | ✗     |
|    14 | ▁גבוה           | <pad>        | ✗     |
|    15 | ▁גבוה           | <pad>        | ✗     |
|    16 | ▁גבוה           | <pad>        | ✗     |
|    17 | ▁גבוה           | <pad>        | ✗     |
|    18 | ▁גבוה           | <pad>        | ✗     |
|    19 | ▁חדש            | <pad>        | ✗     |
|    20 | ▁גבוה           | <pad>        | ✗     |
|    21 | ▁גבוה           | <pad>        | ✗     |
|    22 | ▁גבוה           | <pad>        | ✗     |
|    23 | ▁גבוה           | <pad>        | ✗     |
|    24 | ▁גבוה           | <pad>        | ✗     |
|    25 | ▁טוב            | <pad>        | ✗     |
|    26 | ▁גבוה           | <pad>        | ✗     |
|    27 | ▁גבוה           | <pad>        | ✗     |
|    28 | ▁גבוה           | <pad>        | ✗     |
|    29 | ▁גבוה           | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ▁גבוה           | <pad>        | ✗     |
|    32 | ▁גבוה           | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | ▁גבוה           | <pad>        | ✗     |
|    35 | ▁גבוה           | <pad>        | ✗     |
|    36 | ▁גבוה           | <pad>        | ✗     |
|    37 | ▁טוב            | <pad>        | ✗     |
|    38 | ▁גבוה           | <pad>        | ✗     |
|    39 | ▁גבוה           | <pad>        | ✗     |
|    40 | ▁גבוה           | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | ▁גבוה           |              | ✗     |

2024-12-31 22:22:28,805 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:22:28,810 - TrainingLogger - INFO - Gradient norm: 8.9532
2024-12-31 22:22:36,181 - TrainingLogger - INFO - Step 33610, Batch metrics: Loss: 7.5107, Accuracy: 0.0849, Perplexity: 1827.5145
2024-12-31 22:22:42,869 - TrainingLogger - INFO - Step 33620, Batch metrics: Loss: 7.4417, Accuracy: 0.0925, Perplexity: 1705.5839
2024-12-31 22:22:49,890 - TrainingLogger - INFO - Step 33630, Batch metrics: Loss: 7.5412, Accuracy: 0.0950, Perplexity: 1884.1177
2024-12-31 22:22:56,891 - TrainingLogger - INFO - Step 33640, Batch metrics: Loss: 7.3046, Accuracy: 0.0707, Perplexity: 1487.1459
2024-12-31 22:23:04,017 - TrainingLogger - INFO - Step 33650, Batch metrics: Loss: 7.4703, Accuracy: 0.0884, Perplexity: 1755.1452
2024-12-31 22:23:11,258 - TrainingLogger - INFO - Step 33660, Batch metrics: Loss: 7.6591, Accuracy: 0.0821, Perplexity: 2119.8357
2024-12-31 22:23:18,736 - TrainingLogger - INFO - Step 33670, Batch metrics: Loss: 7.1224, Accuracy: 0.1149, Perplexity: 1239.3657
2024-12-31 22:23:26,232 - TrainingLogger - INFO - Step 33680, Batch metrics: Loss: 7.6083, Accuracy: 0.0644, Perplexity: 2014.7629
2024-12-31 22:23:33,478 - TrainingLogger - INFO - Step 33690, Batch metrics: Loss: 7.6182, Accuracy: 0.0667, Perplexity: 2034.7957
2024-12-31 22:23:40,521 - TrainingLogger - INFO - Step 33700, Batch metrics: Loss: 7.3645, Accuracy: 0.0530, Perplexity: 1578.9966
2024-12-31 22:23:40,522 - TrainingLogger - INFO - Step 33700, Prediction vs Actual:
2024-12-31 22:23:40,522 - TrainingLogger - INFO - Input 1: לא יהיה מצב כזה אנשים שומעים את זה, שיערותיהם סומרות
2024-12-31 22:23:40,522 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:23:40,522 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ות              | ▁לא          | ✗     |
|     1 | ▁לא             | ▁יהיה        | ✗     |
|     2 | ▁בקרוב          | ▁מצב         | ✗     |
|     3 | ▁טוב            | ▁כזה         | ✗     |
|     4 | ▁רע             | ▁אנשים       | ✗     |
|     5 | ▁לא             | ▁שומעים      | ✗     |
|     6 | ▁דברים          | ▁את          | ✗     |
|     7 | ▁זה             | ▁זה          | ✓     |
|     8 | ?               | ,            | ✗     |
|     9 | </s>            | ▁שיער        | ✗     |
|    10 | ו               | ותיהם        | ✗     |
|    11 | ▁לא             | ▁סומ         | ✗     |
|    12 | חים             | רות          | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 22:23:40,522 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:23:40,527 - TrainingLogger - INFO - Gradient norm: 18.0485
2024-12-31 22:23:47,416 - TrainingLogger - INFO - Step 33710, Batch metrics: Loss: 7.0559, Accuracy: 0.0652, Perplexity: 1159.6261
2024-12-31 22:23:54,539 - TrainingLogger - INFO - Step 33720, Batch metrics: Loss: 7.5765, Accuracy: 0.0815, Perplexity: 1951.8070
2024-12-31 22:24:01,501 - TrainingLogger - INFO - Step 33730, Batch metrics: Loss: 7.9907, Accuracy: 0.0423, Perplexity: 2953.3573
2024-12-31 22:24:08,606 - TrainingLogger - INFO - Step 33740, Batch metrics: Loss: 7.2799, Accuracy: 0.1000, Perplexity: 1450.7725
2024-12-31 22:24:16,116 - TrainingLogger - INFO - Step 33750, Batch metrics: Loss: 7.6485, Accuracy: 0.0746, Perplexity: 2097.5229
2024-12-31 22:24:23,182 - TrainingLogger - INFO - Step 33760, Batch metrics: Loss: 7.5185, Accuracy: 0.0370, Perplexity: 1841.8585
2024-12-31 22:24:30,686 - TrainingLogger - INFO - Step 33770, Batch metrics: Loss: 7.1033, Accuracy: 0.1126, Perplexity: 1215.9791
2024-12-31 22:24:37,748 - TrainingLogger - INFO - Step 33780, Batch metrics: Loss: 6.8819, Accuracy: 0.1221, Perplexity: 974.4885
2024-12-31 22:24:44,853 - TrainingLogger - INFO - Step 33790, Batch metrics: Loss: 7.2445, Accuracy: 0.0726, Perplexity: 1400.3904
2024-12-31 22:24:51,558 - TrainingLogger - INFO - Step 33800, Batch metrics: Loss: 7.0061, Accuracy: 0.0603, Perplexity: 1103.3501
2024-12-31 22:24:51,558 - TrainingLogger - INFO - Step 33800, Prediction vs Actual:
2024-12-31 22:24:51,558 - TrainingLogger - INFO - Input 1: אני מעולם לא כתבתי דיבה
2024-12-31 22:24:51,559 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:24:51,559 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁אני         | ✗     |
|     1 | ▁אני            | ▁מעולם       | ✗     |
|     2 | ▁לא             | ▁לא          | ✓     |
|     3 | ▁ראיתי          | ▁כתבתי       | ✗     |
|     4 | ▁את             | ▁די          | ✗     |
|     5 | ▁פעמים          | בה           | ✗     |
|     6 | </s>            | <pad>        | ✗     |
|     7 | </s>            | <pad>        | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            |              | ✗     |

2024-12-31 22:24:51,559 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:24:51,564 - TrainingLogger - INFO - Gradient norm: 8.1404
2024-12-31 22:24:58,881 - TrainingLogger - INFO - Step 33810, Batch metrics: Loss: 7.5945, Accuracy: 0.0654, Perplexity: 1987.3167
2024-12-31 22:25:05,930 - TrainingLogger - INFO - Step 33820, Batch metrics: Loss: 7.3735, Accuracy: 0.0569, Perplexity: 1593.2532
2024-12-31 22:25:13,306 - TrainingLogger - INFO - Step 33830, Batch metrics: Loss: 7.3572, Accuracy: 0.0754, Perplexity: 1567.4739
2024-12-31 22:25:20,354 - TrainingLogger - INFO - Step 33840, Batch metrics: Loss: 7.5506, Accuracy: 0.0733, Perplexity: 1901.8773
2024-12-31 22:25:27,295 - TrainingLogger - INFO - Step 33850, Batch metrics: Loss: 7.3692, Accuracy: 0.0699, Perplexity: 1586.3010
2024-12-31 22:25:34,249 - TrainingLogger - INFO - Step 33860, Batch metrics: Loss: 7.7683, Accuracy: 0.0640, Perplexity: 2364.4225
2024-12-31 22:25:40,954 - TrainingLogger - INFO - Step 33870, Batch metrics: Loss: 6.9410, Accuracy: 0.0927, Perplexity: 1033.8498
2024-12-31 22:25:48,310 - TrainingLogger - INFO - Step 33880, Batch metrics: Loss: 7.3111, Accuracy: 0.0675, Perplexity: 1496.7671
2024-12-31 22:25:55,084 - TrainingLogger - INFO - Step 33890, Batch metrics: Loss: 7.3785, Accuracy: 0.0846, Perplexity: 1601.2175
2024-12-31 22:26:02,621 - TrainingLogger - INFO - Step 33900, Batch metrics: Loss: 7.1122, Accuracy: 0.0598, Perplexity: 1226.8785
2024-12-31 22:26:02,622 - TrainingLogger - INFO - Step 33900, Prediction vs Actual:
2024-12-31 22:26:02,622 - TrainingLogger - INFO - Input 1: עד שלא הבטתי בעיניה - שמרתי את כל הרגשות והתחושות בפנים, שיתף
2024-12-31 22:26:02,622 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:26:02,622 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עד          | ✗     |
|     1 | ▁עתה            | ▁שלא         | ✗     |
|     2 | ▁ית             | ▁הבטתי       | ✗     |
|     3 | ה               | ▁בעיניה      | ✗     |
|     4 | ,               | ▁-           | ✗     |
|     5 | -               | ▁שמרתי       | ✗     |
|     6 | ▁על             | ▁את          | ✗     |
|     7 | ▁זה             | ▁כל          | ✗     |
|     8 | ▁הפרטים         | ▁הרגשות      | ✗     |
|     9 | ▁שלך            | ▁וה          | ✗     |
|    10 | זונות           | תחושות       | ✗     |
|    11 | ▁שלך            | ▁בפנים       | ✗     |
|    12 | </s>            | ,            | ✗     |
|    13 | </s>            | ▁שית         | ✗     |
|    14 | ן               | ף            | ✗     |
|    15 | ▁אותנו          | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ▁פעולה          | <pad>        | ✗     |
|    18 | ▁אותם           | <pad>        | ✗     |
|    19 | ▁אותם           | <pad>        | ✗     |
|    20 | ▁אותם           | <pad>        | ✗     |
|    21 | ▁פעולה          | <pad>        | ✗     |
|    22 | ▁פעולה          | <pad>        | ✗     |
|    23 | ▁פעולה          | <pad>        | ✗     |
|    24 | ▁אותם           | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁פעולה          | <pad>        | ✗     |
|    27 | ▁אותם           | <pad>        | ✗     |
|    28 | ▁אותם           | <pad>        | ✗     |
|    29 | ▁פעולה          | <pad>        | ✗     |
|    30 | ▁את             | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | ▁ה              | <pad>        | ✗     |
|    33 | ▁אותם           | <pad>        | ✗     |
|    34 | ▁פעולה          | <pad>        | ✗     |
|    35 | ▁פעולה          | <pad>        | ✗     |
|    36 | ▁אותם           | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁פעולה          | <pad>        | ✗     |
|    39 | ▁אותם           | <pad>        | ✗     |
|    40 | ▁פעולה          | <pad>        | ✗     |
|    41 | ▁את             | <pad>        | ✗     |
|    42 | ▁אותם           |              | ✗     |

2024-12-31 22:26:02,622 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:26:02,627 - TrainingLogger - INFO - Gradient norm: 10.1151
2024-12-31 22:26:09,869 - TrainingLogger - INFO - Step 33910, Batch metrics: Loss: 7.1202, Accuracy: 0.0749, Perplexity: 1236.7434
2024-12-31 22:26:17,200 - TrainingLogger - INFO - Step 33920, Batch metrics: Loss: 7.1946, Accuracy: 0.1081, Perplexity: 1332.1800
2024-12-31 22:26:24,741 - TrainingLogger - INFO - Step 33930, Batch metrics: Loss: 7.6528, Accuracy: 0.0844, Perplexity: 2106.4635
2024-12-31 22:26:31,988 - TrainingLogger - INFO - Step 33940, Batch metrics: Loss: 7.6905, Accuracy: 0.0769, Perplexity: 2187.5239
2024-12-31 22:26:38,977 - TrainingLogger - INFO - Step 33950, Batch metrics: Loss: 7.2824, Accuracy: 0.0798, Perplexity: 1454.5296
2024-12-31 22:26:46,001 - TrainingLogger - INFO - Step 33960, Batch metrics: Loss: 7.8929, Accuracy: 0.0599, Perplexity: 2678.2990
2024-12-31 22:26:52,555 - TrainingLogger - INFO - Step 33970, Batch metrics: Loss: 7.6054, Accuracy: 0.0959, Perplexity: 2009.0912
2024-12-31 22:26:59,631 - TrainingLogger - INFO - Step 33980, Batch metrics: Loss: 7.4333, Accuracy: 0.0500, Perplexity: 1691.4550
2024-12-31 22:27:06,712 - TrainingLogger - INFO - Step 33990, Batch metrics: Loss: 7.5875, Accuracy: 0.0735, Perplexity: 1973.3835
2024-12-31 22:27:14,047 - TrainingLogger - INFO - Step 34000, Batch metrics: Loss: 7.2469, Accuracy: 0.0542, Perplexity: 1403.8155
2024-12-31 22:27:14,047 - TrainingLogger - INFO - Step 34000, Prediction vs Actual:
2024-12-31 22:27:14,047 - TrainingLogger - INFO - Input 1: עוד מוצרים שעשויים לרדת מהמדפים חטיפים, ממרחים למיניהם ודגנים מהרבנות נמסר יש הקפדת יתר על נוהלי הכשרות שלנו
2024-12-31 22:27:14,048 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:27:14,048 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עוד         | ✗     |
|     1 | ▁-              | ▁מוצרים      | ✗     |
|     2 | ▁-              | ▁שעשוי       | ✗     |
|     3 | ▁להיות          | ים           | ✗     |
|     4 | ▁להיות          | ▁לרדת        | ✗     |
|     5 | ▁בו             | ▁מה          | ✗     |
|     6 | לב              | מ            | ✗     |
|     7 | רוץ             | דפים         | ✗     |
|     8 | .               | ▁חטיפים      | ✗     |
|     9 | ▁האלה           | ,            | ✗     |
|    10 | <pad>           | ▁ממר         | ✗     |
|    11 | ץ               | חים          | ✗     |
|    12 | ▁את             | ▁ל           | ✗     |
|    13 | ים              | מיני         | ✗     |
|    14 | הם              | הם           | ✓     |
|    15 | .               | ▁וד          | ✗     |
|    16 | נים             | גנים         | ✗     |
|    17 | ▁חדשים          | ▁מהר         | ✗     |
|    18 | ▁יותר           | בנות         | ✗     |
|    19 | ▁שלהם           | ▁נמסר        | ✗     |
|    20 | ו               | ▁יש          | ✗     |
|    21 | ▁להם            | ▁הקפד        | ✗     |
|    22 | ה               | ת            | ✗     |
|    23 | ▁על             | ▁יתר         | ✗     |
|    24 | ▁על             | ▁על          | ✓     |
|    25 | ה               | ▁נוהל        | ✗     |
|    26 | י               | י            | ✓     |
|    27 | ▁ה              | ▁הכ          | ✗     |
|    28 | פה              | שרות         | ✗     |
|    29 | .               | ▁שלנו        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           |              | ✗     |

2024-12-31 22:27:14,048 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:27:14,053 - TrainingLogger - INFO - Gradient norm: 13.5047
2024-12-31 22:27:21,402 - TrainingLogger - INFO - Step 34010, Batch metrics: Loss: 7.3081, Accuracy: 0.0854, Perplexity: 1492.2874
2024-12-31 22:27:28,381 - TrainingLogger - INFO - Step 34020, Batch metrics: Loss: 6.7686, Accuracy: 0.1130, Perplexity: 870.1302
2024-12-31 22:27:35,475 - TrainingLogger - INFO - Step 34030, Batch metrics: Loss: 7.1127, Accuracy: 0.0769, Perplexity: 1227.4314
2024-12-31 22:27:42,778 - TrainingLogger - INFO - Step 34040, Batch metrics: Loss: 7.0681, Accuracy: 0.0948, Perplexity: 1173.9513
2024-12-31 22:27:49,949 - TrainingLogger - INFO - Step 34050, Batch metrics: Loss: 7.3189, Accuracy: 0.0823, Perplexity: 1508.5496
2024-12-31 22:27:57,308 - TrainingLogger - INFO - Step 34060, Batch metrics: Loss: 7.0766, Accuracy: 0.0619, Perplexity: 1183.9652
2024-12-31 22:28:04,731 - TrainingLogger - INFO - Step 34070, Batch metrics: Loss: 7.0692, Accuracy: 0.0878, Perplexity: 1175.2400
2024-12-31 22:28:11,824 - TrainingLogger - INFO - Step 34080, Batch metrics: Loss: 7.1655, Accuracy: 0.0888, Perplexity: 1294.0512
2024-12-31 22:28:18,914 - TrainingLogger - INFO - Step 34090, Batch metrics: Loss: 7.6167, Accuracy: 0.0896, Perplexity: 2031.8415
2024-12-31 22:28:25,759 - TrainingLogger - INFO - Step 34100, Batch metrics: Loss: 7.3221, Accuracy: 0.0878, Perplexity: 1513.3299
2024-12-31 22:28:25,759 - TrainingLogger - INFO - Step 34100, Prediction vs Actual:
2024-12-31 22:28:25,759 - TrainingLogger - INFO - Input 1: הניסיונות של ארגוני הטרור ובראשם חמאס לפגוע באזרחים ישראלים לא פסקו, אמר גורם ביטחוני בכיר לנוכח כוונתם של אלפי בני אדם לטייל באזור במהלך הפסח
2024-12-31 22:28:25,760 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:28:25,760 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הניסיונות   | ✗     |
|     1 | ▁היו            | ▁של          | ✗     |
|     2 | ▁ג              | ▁ארגוני      | ✗     |
|     3 | ם               | ▁הטרור       | ✗     |
|     4 | .               | ▁ובר         | ✗     |
|     5 | יט              | אשם          | ✗     |
|     6 | ▁אותו           | ▁ח           | ✗     |
|     7 | אל              | מ            | ✗     |
|     8 | אס              | אס           | ✓     |
|     9 | .               | ▁לפגוע       | ✗     |
|    10 | ▁בו             | ▁ב           | ✗     |
|    11 | אנשי            | אזרחים       | ✗     |
|    12 | .               | ▁ישראל       | ✗     |
|    13 | יים             | ים           | ✗     |
|    14 | .               | ▁לא          | ✗     |
|    15 | ▁רע             | ▁פסק         | ✗     |
|    16 | יים             | ו            | ✗     |
|    17 | ▁על             | ,            | ✗     |
|    18 | </s>            | ▁אמר         | ✗     |
|    19 | ▁לי             | ▁גורם        | ✗     |
|    20 | ▁לי             | ▁ביטחוני     | ✗     |
|    21 | </s>            | ▁בכיר        | ✗     |
|    22 | ה               | ▁לנוכח       | ✗     |
|    23 | ות              | ▁כוונת       | ✗     |
|    24 | ו               | ם            | ✗     |
|    25 | ▁של             | ▁של          | ✓     |
|    26 | ▁אנשים          | ▁אלפי        | ✗     |
|    27 | ▁אנשים          | ▁בני         | ✗     |
|    28 | ▁ישראל          | ▁אדם         | ✗     |
|    29 | </s>            | ▁לטייל       | ✗     |
|    30 | ▁בו             | ▁באזור       | ✗     |
|    31 | ים              | ▁במהלך       | ✗     |
|    32 | ▁המלחמה         | ▁הפסח        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 22:28:25,760 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:28:25,765 - TrainingLogger - INFO - Gradient norm: 9.3181
2024-12-31 22:28:34,685 - TrainingLogger - INFO - Step 34110, Batch metrics: Loss: 7.3379, Accuracy: 0.0628, Perplexity: 1537.4817
2024-12-31 22:28:42,152 - TrainingLogger - INFO - Step 34120, Batch metrics: Loss: 6.9548, Accuracy: 0.1179, Perplexity: 1048.1625
2024-12-31 22:28:49,068 - TrainingLogger - INFO - Step 34130, Batch metrics: Loss: 7.1693, Accuracy: 0.0680, Perplexity: 1298.9252
2024-12-31 22:28:56,179 - TrainingLogger - INFO - Step 34140, Batch metrics: Loss: 7.0302, Accuracy: 0.0909, Perplexity: 1130.2588
2024-12-31 22:29:03,902 - TrainingLogger - INFO - Step 34150, Batch metrics: Loss: 7.2179, Accuracy: 0.0892, Perplexity: 1363.5858
2024-12-31 22:29:11,248 - TrainingLogger - INFO - Step 34160, Batch metrics: Loss: 7.4265, Accuracy: 0.0725, Perplexity: 1679.9918
2024-12-31 22:29:18,537 - TrainingLogger - INFO - Step 34170, Batch metrics: Loss: 6.9788, Accuracy: 0.0478, Perplexity: 1073.6546
2024-12-31 22:29:25,716 - TrainingLogger - INFO - Step 34180, Batch metrics: Loss: 7.4986, Accuracy: 0.0613, Perplexity: 1805.4983
2024-12-31 22:29:32,965 - TrainingLogger - INFO - Step 34190, Batch metrics: Loss: 7.3238, Accuracy: 0.1024, Perplexity: 1515.9242
2024-12-31 22:29:40,251 - TrainingLogger - INFO - Step 34200, Batch metrics: Loss: 7.3117, Accuracy: 0.0656, Perplexity: 1497.7467
2024-12-31 22:29:40,251 - TrainingLogger - INFO - Step 34200, Prediction vs Actual:
2024-12-31 22:29:40,251 - TrainingLogger - INFO - Input 1: הם יזהו שיש לך בלוג, שאתה פעיל ברשתות החברתיות, שאתה מומחה למה שאתה עושה
2024-12-31 22:29:40,252 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:29:40,252 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הם          | ✗     |
|     1 | ▁-              | ▁י           | ✗     |
|     2 | בוצע            | זהו          | ✗     |
|     3 | .               | ▁שיש         | ✗     |
|     4 | ▁להם            | ▁לך          | ✗     |
|     5 | ▁את             | ▁ב           | ✗     |
|     6 | אותם            | לוג          | ✗     |
|     7 | מה              | ,            | ✗     |
|     8 | <pad>           | ▁שאתה        | ✗     |
|     9 | ▁לא             | ▁פעיל        | ✗     |
|    10 | ▁בו             | ▁ברשת        | ✗     |
|    11 | ▁שלו            | ות           | ✗     |
|    12 | ▁גדולות         | ▁החברתי      | ✗     |
|    13 | ות              | ות           | ✓     |
|    14 | ▁שלו            | ,            | ✗     |
|    15 | <pad>           | ▁שאתה        | ✗     |
|    16 | ▁יודע           | ▁מומחה       | ✗     |
|    17 | ▁להן            | ▁למה         | ✗     |
|    18 | לך              | ▁שאתה        | ✗     |
|    19 | ▁צריך           | ▁עושה        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 22:29:40,252 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:29:40,257 - TrainingLogger - INFO - Gradient norm: 7.8460
2024-12-31 22:29:47,251 - TrainingLogger - INFO - Step 34210, Batch metrics: Loss: 7.2944, Accuracy: 0.0766, Perplexity: 1472.1060
2024-12-31 22:29:54,307 - TrainingLogger - INFO - Step 34220, Batch metrics: Loss: 7.2794, Accuracy: 0.0971, Perplexity: 1450.1383
2024-12-31 22:30:01,390 - TrainingLogger - INFO - Step 34230, Batch metrics: Loss: 7.6913, Accuracy: 0.0522, Perplexity: 2189.1820
2024-12-31 22:30:08,379 - TrainingLogger - INFO - Step 34240, Batch metrics: Loss: 6.9478, Accuracy: 0.0745, Perplexity: 1040.8987
2024-12-31 22:30:15,018 - TrainingLogger - INFO - Step 34250, Batch metrics: Loss: 7.2841, Accuracy: 0.0870, Perplexity: 1457.0209
2024-12-31 22:30:21,932 - TrainingLogger - INFO - Step 34260, Batch metrics: Loss: 7.1170, Accuracy: 0.0943, Perplexity: 1232.7003
2024-12-31 22:30:28,869 - TrainingLogger - INFO - Step 34270, Batch metrics: Loss: 7.5104, Accuracy: 0.0785, Perplexity: 1826.9447
2024-12-31 22:30:35,474 - TrainingLogger - INFO - Step 34280, Batch metrics: Loss: 7.4898, Accuracy: 0.0449, Perplexity: 1789.7052
2024-12-31 22:30:42,363 - TrainingLogger - INFO - Step 34290, Batch metrics: Loss: 7.3437, Accuracy: 0.0444, Perplexity: 1546.4741
2024-12-31 22:30:50,578 - TrainingLogger - INFO - Step 34300, Batch metrics: Loss: 7.6520, Accuracy: 0.0932, Perplexity: 2104.9012
2024-12-31 22:30:50,578 - TrainingLogger - INFO - Step 34300, Prediction vs Actual:
2024-12-31 22:30:50,578 - TrainingLogger - INFO - Input 1: כאמור, בסער הביעו אתמול תמיכה חברות הכנסת שרן השכל ואתי עטיה
2024-12-31 22:30:50,579 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:30:50,579 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁כאמור       | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | <pad>           | ▁בס          | ✗     |
|     3 | עוד             | ער           | ✗     |
|     4 | ה               | ▁הביע        | ✗     |
|     5 | ה               | ו            | ✗     |
|     6 | ▁את             | ▁אתמול       | ✗     |
|     7 | ▁בלילה          | ▁תמיכה       | ✗     |
|     8 | ▁ב              | ▁חברות       | ✗     |
|     9 | ▁טובות          | ▁הכנסת       | ✗     |
|    10 | ▁כספים          | ▁שר          | ✗     |
|    11 | רה              | ן            | ✗     |
|    12 | י               | ▁השכל        | ✗     |
|    13 | ית              | ▁ואת         | ✗     |
|    14 | ▁עצמה           | י            | ✗     |
|    15 | ונות            | ▁עט          | ✗     |
|    16 | ו               | יה           | ✗     |
|    17 | ▁של             | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁אושר           | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ות              | <pad>        | ✗     |
|    22 | א               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | י               | <pad>        | ✗     |
|    26 | ה               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁ג              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | י               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | י               | <pad>        | ✗     |
|    40 | ה               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 22:30:50,579 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:30:50,584 - TrainingLogger - INFO - Gradient norm: 8.6769
2024-12-31 22:30:57,377 - TrainingLogger - INFO - Step 34310, Batch metrics: Loss: 7.5703, Accuracy: 0.0651, Perplexity: 1939.7390
2024-12-31 22:31:04,197 - TrainingLogger - INFO - Step 34320, Batch metrics: Loss: 7.3654, Accuracy: 0.0769, Perplexity: 1580.3916
2024-12-31 22:31:10,599 - TrainingLogger - INFO - Step 34330, Batch metrics: Loss: 7.1305, Accuracy: 0.1172, Perplexity: 1249.5466
2024-12-31 22:31:17,985 - TrainingLogger - INFO - Step 34340, Batch metrics: Loss: 7.2801, Accuracy: 0.0859, Perplexity: 1451.0838
2024-12-31 22:31:24,872 - TrainingLogger - INFO - Step 34350, Batch metrics: Loss: 7.9582, Accuracy: 0.0861, Perplexity: 2858.7941
2024-12-31 22:31:31,871 - TrainingLogger - INFO - Step 34360, Batch metrics: Loss: 7.6318, Accuracy: 0.0519, Perplexity: 2062.7148
2024-12-31 22:31:38,880 - TrainingLogger - INFO - Step 34370, Batch metrics: Loss: 7.3589, Accuracy: 0.0658, Perplexity: 1570.0697
2024-12-31 22:31:46,328 - TrainingLogger - INFO - Step 34380, Batch metrics: Loss: 7.1034, Accuracy: 0.0695, Perplexity: 1216.0678
2024-12-31 22:31:53,923 - TrainingLogger - INFO - Step 34390, Batch metrics: Loss: 6.9148, Accuracy: 0.1266, Perplexity: 1007.0573
2024-12-31 22:32:01,167 - TrainingLogger - INFO - Step 34400, Batch metrics: Loss: 7.1892, Accuracy: 0.0619, Perplexity: 1325.0212
2024-12-31 22:32:01,168 - TrainingLogger - INFO - Step 34400, Prediction vs Actual:
2024-12-31 22:32:01,168 - TrainingLogger - INFO - Input 1: הבעיה היא לא רק הפליטים העזתים שמרוכזים כעת ברפיח, אלא גם הרגישות המצרית לריבונותה בשטח שגובל ברצועה
2024-12-31 22:32:01,168 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:32:01,168 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הבעיה       | ✗     |
|     1 | ▁-              | ▁היא         | ✗     |
|     2 | ▁-              | ▁לא          | ✗     |
|     3 | ,               | ▁רק          | ✗     |
|     4 | ▁לא             | ▁הפל         | ✗     |
|     5 | מות             | יטים         | ✗     |
|     6 | ▁האלה           | ▁העז         | ✗     |
|     7 | ים              | ת            | ✗     |
|     8 | ▁שלך            | ים           | ✗     |
|     9 | ▁האלה           | ▁שמרו        | ✗     |
|    10 | ▁על             | כ            | ✗     |
|    11 | זים             | זים          | ✓     |
|    12 | ▁בהם            | ▁כעת         | ✗     |
|    13 | ,               | ▁בר          | ✗     |
|    14 | קוד             | פיח          | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁אלא         | ✗     |
|    17 | ▁גם             | ▁גם          | ✓     |
|    18 | ▁לא             | ▁הרגיש       | ✗     |
|    19 | ים              | ות           | ✗     |
|    20 | ▁יותר           | ▁המצרי       | ✗     |
|    21 | ות              | ת            | ✗     |
|    22 | .               | ▁לריב        | ✗     |
|    23 | ור              | ונות         | ✗     |
|    24 | .               | ה            | ✗     |
|    25 | .               | ▁בשטח        | ✗     |
|    26 | .               | ▁שג          | ✗     |
|    27 | '               | ובל          | ✗     |
|    28 | ים              | ▁ב           | ✗     |
|    29 | -20             | רצועה        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2024-12-31 22:32:01,168 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:32:01,173 - TrainingLogger - INFO - Gradient norm: 9.2035
2024-12-31 22:32:08,204 - TrainingLogger - INFO - Step 34410, Batch metrics: Loss: 7.5305, Accuracy: 0.0470, Perplexity: 1864.0674
2024-12-31 22:32:15,034 - TrainingLogger - INFO - Step 34420, Batch metrics: Loss: 6.9504, Accuracy: 0.1078, Perplexity: 1043.5958
2024-12-31 22:32:22,130 - TrainingLogger - INFO - Step 34430, Batch metrics: Loss: 7.2315, Accuracy: 0.0984, Perplexity: 1382.2781
2024-12-31 22:32:29,323 - TrainingLogger - INFO - Step 34440, Batch metrics: Loss: 7.7019, Accuracy: 0.0523, Perplexity: 2212.5025
2024-12-31 22:32:36,357 - TrainingLogger - INFO - Step 34450, Batch metrics: Loss: 7.3830, Accuracy: 0.1000, Perplexity: 1608.3524
2024-12-31 22:32:43,843 - TrainingLogger - INFO - Step 34460, Batch metrics: Loss: 7.0500, Accuracy: 0.1083, Perplexity: 1152.9024
2024-12-31 22:32:50,859 - TrainingLogger - INFO - Step 34470, Batch metrics: Loss: 7.3586, Accuracy: 0.0633, Perplexity: 1569.6258
2024-12-31 22:32:57,767 - TrainingLogger - INFO - Step 34480, Batch metrics: Loss: 6.6265, Accuracy: 0.1416, Perplexity: 754.8469
2024-12-31 22:33:04,819 - TrainingLogger - INFO - Step 34490, Batch metrics: Loss: 7.4336, Accuracy: 0.1111, Perplexity: 1691.8333
2024-12-31 22:33:11,590 - TrainingLogger - INFO - Step 34500, Batch metrics: Loss: 7.6001, Accuracy: 0.0851, Perplexity: 1998.3405
2024-12-31 22:33:11,590 - TrainingLogger - INFO - Step 34500, Prediction vs Actual:
2024-12-31 22:33:11,591 - TrainingLogger - INFO - Input 1: חזרתי, אני פה ואני בחיים, ואני אמשיך לחיות
2024-12-31 22:33:11,591 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:33:11,591 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁חזרתי       | ✗     |
|     1 | ▁חוזר           | ,            | ✗     |
|     2 | ▁אדוני          | ▁אני         | ✗     |
|     3 | ...             | ▁פה          | ✗     |
|     4 | .               | ▁ואני        | ✗     |
|     5 | .               | ▁בחיים       | ✗     |
|     6 | ▁לא             | ,            | ✗     |
|     7 | </s>            | ▁ואני        | ✗     |
|     8 | ▁לא             | ▁אמשיך       | ✗     |
|     9 | .               | ▁לחיות       | ✗     |
|    10 | ▁את             | <pad>        | ✗     |
|    11 | ▁את             | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ▁אני            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁לא             | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2024-12-31 22:33:11,591 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:33:11,596 - TrainingLogger - INFO - Gradient norm: 8.1552
2024-12-31 22:33:18,969 - TrainingLogger - INFO - Step 34510, Batch metrics: Loss: 6.4779, Accuracy: 0.1079, Perplexity: 650.5850
2024-12-31 22:33:26,227 - TrainingLogger - INFO - Step 34520, Batch metrics: Loss: 6.9502, Accuracy: 0.0795, Perplexity: 1043.3391
2024-12-31 22:33:32,890 - TrainingLogger - INFO - Step 34530, Batch metrics: Loss: 7.2816, Accuracy: 0.1212, Perplexity: 1453.2609
2024-12-31 22:33:41,568 - TrainingLogger - INFO - Step 34540, Batch metrics: Loss: 7.4721, Accuracy: 0.0847, Perplexity: 1758.2806
2024-12-31 22:33:48,641 - TrainingLogger - INFO - Step 34550, Batch metrics: Loss: 6.8195, Accuracy: 0.1234, Perplexity: 915.4865
2024-12-31 22:33:55,619 - TrainingLogger - INFO - Step 34560, Batch metrics: Loss: 7.1343, Accuracy: 0.0852, Perplexity: 1254.2572
2024-12-31 22:34:02,861 - TrainingLogger - INFO - Step 34570, Batch metrics: Loss: 7.5599, Accuracy: 0.0867, Perplexity: 1919.6312
2024-12-31 22:34:10,177 - TrainingLogger - INFO - Step 34580, Batch metrics: Loss: 7.1099, Accuracy: 0.0968, Perplexity: 1223.9697
2024-12-31 22:34:17,623 - TrainingLogger - INFO - Step 34590, Batch metrics: Loss: 7.2943, Accuracy: 0.0614, Perplexity: 1471.9537
2024-12-31 22:34:25,418 - TrainingLogger - INFO - Step 34600, Batch metrics: Loss: 7.6069, Accuracy: 0.0691, Perplexity: 2012.0028
2024-12-31 22:34:25,418 - TrainingLogger - INFO - Step 34600, Prediction vs Actual:
2024-12-31 22:34:25,418 - TrainingLogger - INFO - Input 1: בקו אווירי, אלעד נפל במרחק של 500 מטר ממקום נפילתו של רז שהיה מבוגר ממנו בשנתיים, מספר מיקי פולק
2024-12-31 22:34:25,419 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:34:25,419 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁בקו         | ✗     |
|     1 | ה               | ▁אוויר       | ✗     |
|     2 | י               | י            | ✓     |
|     3 | סטן             | ,            | ✗     |
|     4 | ▁ברגל           | ▁אל          | ✗     |
|     5 | ים              | עד           | ✗     |
|     6 | ה               | ▁נפל         | ✗     |
|     7 | ון              | ▁במרחק       | ✗     |
|     8 | ▁רב             | ▁של          | ✗     |
|     9 | ▁100            | ▁500         | ✗     |
|    10 | ▁מטרים          | ▁מטר         | ✗     |
|    11 | ,               | ▁ממקום       | ✗     |
|    12 | ▁זה             | ▁נפילת       | ✗     |
|    13 | ו               | ו            | ✓     |
|    14 | ▁של             | ▁של          | ✓     |
|    15 | ▁המטוס          | ▁רז          | ✗     |
|    16 | ון              | ▁שהיה        | ✗     |
|    17 | ▁לו             | ▁מבוגר       | ✗     |
|    18 | ▁יותר           | ▁ממנו        | ✗     |
|    19 | .               | ▁בשנתיים     | ✗     |
|    20 | ▁האחרונות       | ,            | ✗     |
|    21 | </s>            | ▁מספר        | ✗     |
|    22 | ▁פעמים          | ▁מיקי        | ✗     |
|    23 | ו               | ▁פולק        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ה               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | תו              | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ות              | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 22:34:25,419 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:34:25,424 - TrainingLogger - INFO - Gradient norm: 9.1450
2024-12-31 22:34:32,514 - TrainingLogger - INFO - Step 34610, Batch metrics: Loss: 6.9115, Accuracy: 0.1128, Perplexity: 1003.7503
2024-12-31 22:34:39,654 - TrainingLogger - INFO - Step 34620, Batch metrics: Loss: 7.3170, Accuracy: 0.0690, Perplexity: 1505.7489
2024-12-31 22:34:46,742 - TrainingLogger - INFO - Step 34630, Batch metrics: Loss: 6.7721, Accuracy: 0.1236, Perplexity: 873.1319
2024-12-31 22:34:53,715 - TrainingLogger - INFO - Step 34640, Batch metrics: Loss: 7.4157, Accuracy: 0.0927, Perplexity: 1661.9354
2024-12-31 22:35:00,462 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 258048
2024-12-31 22:35:00,462 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 258048

2024-12-31 22:35:00,463 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 22:35:00,463 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 22:35:00,463 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 42]), device: cuda:0
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 42]), device: cuda:0
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 22:35:00,464 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 22:35:02,106 - TrainingLogger - INFO - Step 34650, Batch metrics: Loss: 7.6382, Accuracy: 0.0703, Perplexity: 2075.9458
2024-12-31 22:35:09,621 - TrainingLogger - INFO - Step 34660, Batch metrics: Loss: 7.3327, Accuracy: 0.0755, Perplexity: 1529.4764
2024-12-31 22:35:16,434 - TrainingLogger - INFO - Step 34670, Batch metrics: Loss: 7.4142, Accuracy: 0.0511, Perplexity: 1659.3452
2024-12-31 22:35:23,522 - TrainingLogger - INFO - Step 34680, Batch metrics: Loss: 7.1969, Accuracy: 0.0637, Perplexity: 1335.2231
2024-12-31 22:35:31,001 - TrainingLogger - INFO - Step 34690, Batch metrics: Loss: 7.3764, Accuracy: 0.0829, Perplexity: 1597.8318
2024-12-31 22:35:38,519 - TrainingLogger - INFO - Step 34700, Batch metrics: Loss: 7.1644, Accuracy: 0.0850, Perplexity: 1292.5508
2024-12-31 22:35:38,520 - TrainingLogger - INFO - Step 34700, Prediction vs Actual:
2024-12-31 22:35:38,520 - TrainingLogger - INFO - Input 1: גם בשלב זה הוא המשיך במעשיו - דבר שאילץ את השוטרים לאזוק אותו
2024-12-31 22:35:38,520 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:35:38,521 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁גם          | ✗     |
|     1 | ▁את             | ▁בשלב        | ✗     |
|     2 | ▁זה             | ▁זה          | ✓     |
|     3 | ות              | ▁הוא         | ✗     |
|     4 | ▁לא             | ▁המשיך       | ✗     |
|     5 | ▁הלאה           | ▁במעשי       | ✗     |
|     6 | ו               | ו            | ✓     |
|     7 | .               | ▁-           | ✗     |
|     8 | </s>            | ▁דבר         | ✗     |
|     9 | ▁לא             | ▁שאי         | ✗     |
|    10 | ▁אפשר           | לץ           | ✗     |
|    11 | ▁אותו           | ▁את          | ✗     |
|    12 | ▁עצמו           | ▁השוטרים     | ✗     |
|    13 | </s>            | ▁לא          | ✗     |
|    14 | ▁להיות          | זו           | ✗     |
|    15 | א               | ק            | ✗     |
|    16 | ▁את             | ▁אותו        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁הוא            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ▁-              | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁.              | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁הוא            | <pad>        | ✗     |
|    39 | ▁הוא            | <pad>        | ✗     |
|    40 | ▁לא             | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ▁לא             | <pad>        | ✗     |
|    43 | ▁הוא            | <pad>        | ✗     |
|    44 | ▁אותו           | <pad>        | ✗     |
|    45 | ▁אותו           | <pad>        | ✗     |
|    46 | ▁הוא            | <pad>        | ✗     |
|    47 | ▁הוא            |              | ✗     |

2024-12-31 22:35:38,521 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:35:38,526 - TrainingLogger - INFO - Gradient norm: 9.3153
2024-12-31 22:35:45,844 - TrainingLogger - INFO - Step 34710, Batch metrics: Loss: 7.0083, Accuracy: 0.0850, Perplexity: 1105.7233
2024-12-31 22:35:52,370 - TrainingLogger - INFO - Step 34720, Batch metrics: Loss: 7.6142, Accuracy: 0.0935, Perplexity: 2026.8560
2024-12-31 22:35:59,119 - TrainingLogger - INFO - Step 34730, Batch metrics: Loss: 7.0747, Accuracy: 0.0806, Perplexity: 1181.6392
2024-12-31 22:36:06,255 - TrainingLogger - INFO - Step 34740, Batch metrics: Loss: 7.7616, Accuracy: 0.0638, Perplexity: 2348.5710
2024-12-31 22:36:13,465 - TrainingLogger - INFO - Step 34750, Batch metrics: Loss: 7.6372, Accuracy: 0.0946, Perplexity: 2073.9808
2024-12-31 22:36:20,883 - TrainingLogger - INFO - Step 34760, Batch metrics: Loss: 7.4018, Accuracy: 0.0671, Perplexity: 1638.9384
2024-12-31 22:36:27,453 - TrainingLogger - INFO - Step 34770, Batch metrics: Loss: 7.4951, Accuracy: 0.0455, Perplexity: 1799.2725
2024-12-31 22:36:34,522 - TrainingLogger - INFO - Step 34780, Batch metrics: Loss: 7.5381, Accuracy: 0.0928, Perplexity: 1878.2647
2024-12-31 22:36:41,771 - TrainingLogger - INFO - Step 34790, Batch metrics: Loss: 7.4275, Accuracy: 0.0711, Perplexity: 1681.5578
2024-12-31 22:36:48,812 - TrainingLogger - INFO - Step 34800, Batch metrics: Loss: 7.6976, Accuracy: 0.0552, Perplexity: 2203.1329
2024-12-31 22:36:48,812 - TrainingLogger - INFO - Step 34800, Prediction vs Actual:
2024-12-31 22:36:48,813 - TrainingLogger - INFO - Input 1: ילדי מעלולה מדקלמים שירים בארמיתצילום AFP צילום AFP בחנות הקטנה שלו במעלולה, שבה הוא מוכר בעיקר סמלים נוצריים, זערור מסדר ספרים ואנציקלופדיות בארמית
2024-12-31 22:36:48,813 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:36:48,813 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ילדי        | ✗     |
|     1 | ,               | ▁מעל         | ✗     |
|     2 | יה              | ולה          | ✗     |
|     3 | ▁ראשונה         | ▁מ           | ✗     |
|     4 | איי             | דק           | ✗     |
|     5 | לנד             | למים         | ✗     |
|     6 | </s>            | ▁שירים       | ✗     |
|     7 | </s>            | ▁באר         | ✗     |
|     8 | ה               | מית          | ✗     |
|     9 | ון              | צילום        | ✗     |
|    10 | </s>            | ▁A           | ✗     |
|    11 | IM              | F            | ✗     |
|    12 | :               | P            | ✗     |
|    13 | I               | ▁צילום       | ✗     |
|    14 | </s>            | ▁A           | ✗     |
|    15 | </s>            | F            | ✗     |
|    16 | S               | P            | ✗     |
|    17 | </s>            | ▁בחנות       | ✗     |
|    18 | </s>            | ▁הקטנה       | ✗     |
|    19 | </s>            | ▁שלו         | ✗     |
|    20 | </s>            | ▁במע         | ✗     |
|    21 | רה              | לולה         | ✗     |
|    22 | ▁גבוהה          | ,            | ✗     |
|    23 | </s>            | ▁שבה         | ✗     |
|    24 | ▁הם             | ▁הוא         | ✗     |
|    25 | ▁לא             | ▁מוכר        | ✗     |
|    26 | ▁את             | ▁בעיקר       | ✗     |
|    27 | ▁את             | ▁סמלים       | ✗     |
|    28 | </s>            | ▁נוצרי       | ✗     |
|    29 | ים              | ים           | ✓     |
|    30 | </s>            | ,            | ✗     |
|    31 | </s>            | ▁זע          | ✗     |
|    32 | מה              | רור          | ✗     |
|    33 | ,               | ▁מסדר        | ✗     |
|    34 | ון              | ▁ספרים       | ✗     |
|    35 | ,               | ▁ו           | ✗     |
|    36 | פיתוח           | אנ           | ✗     |
|    37 | כי              | ציקלופ       | ✗     |
|    38 | ציה             | די           | ✗     |
|    39 | ים              | ות           | ✗     |
|    40 | </s>            | ▁באר         | ✗     |
|    41 | כי              | מית          | ✗     |
|    42 | ד               |              | ✗     |

2024-12-31 22:36:48,813 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:36:48,818 - TrainingLogger - INFO - Gradient norm: 7.0325
2024-12-31 22:36:56,285 - TrainingLogger - INFO - Step 34810, Batch metrics: Loss: 7.0998, Accuracy: 0.0562, Perplexity: 1211.7757
2024-12-31 22:37:03,459 - TrainingLogger - INFO - Step 34820, Batch metrics: Loss: 7.2594, Accuracy: 0.1000, Perplexity: 1421.3748
2024-12-31 22:37:11,150 - TrainingLogger - INFO - Step 34830, Batch metrics: Loss: 7.5395, Accuracy: 0.0643, Perplexity: 1880.9768
2024-12-31 22:37:18,862 - TrainingLogger - INFO - Step 34840, Batch metrics: Loss: 7.2906, Accuracy: 0.0952, Perplexity: 1466.4906
2024-12-31 22:37:25,663 - TrainingLogger - INFO - Step 34850, Batch metrics: Loss: 7.3170, Accuracy: 0.1007, Perplexity: 1505.6355
2024-12-31 22:37:32,646 - TrainingLogger - INFO - Step 34860, Batch metrics: Loss: 7.5387, Accuracy: 0.0606, Perplexity: 1879.3021
2024-12-31 22:37:40,261 - TrainingLogger - INFO - Step 34870, Batch metrics: Loss: 7.3212, Accuracy: 0.0759, Perplexity: 1512.0301
2024-12-31 22:37:47,189 - TrainingLogger - INFO - Step 34880, Batch metrics: Loss: 7.4012, Accuracy: 0.0617, Perplexity: 1637.9954
2024-12-31 22:37:54,307 - TrainingLogger - INFO - Step 34890, Batch metrics: Loss: 7.4353, Accuracy: 0.0632, Perplexity: 1694.7731
2024-12-31 22:38:01,285 - TrainingLogger - INFO - Step 34900, Batch metrics: Loss: 7.2409, Accuracy: 0.0678, Perplexity: 1395.3805
2024-12-31 22:38:01,286 - TrainingLogger - INFO - Step 34900, Prediction vs Actual:
2024-12-31 22:38:01,286 - TrainingLogger - INFO - Input 1: בכפר אחים, שם מתגורר השר ישראל כץ מהליכוד ושם גדל גנץ - ניצחה כחול לבן עם 476, לעומת 276 לליכוד
2024-12-31 22:38:01,286 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:38:01,286 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בכפר        | ✗     |
|     1 | ▁-              | ▁אחים        | ✗     |
|     2 | ▁רבים           | ,            | ✗     |
|     3 | ▁הם             | ▁שם          | ✗     |
|     4 | .               | ▁מתגורר      | ✗     |
|     5 | ים              | ▁השר         | ✗     |
|     6 | ים              | ▁ישראל       | ✗     |
|     7 | .               | ▁כ           | ✗     |
|     8 | חוק             | ץ            | ✗     |
|     9 | .               | ▁מה          | ✗     |
|    10 | ארץ             | לי           | ✗     |
|    11 | ו               | כו           | ✗     |
|    12 | ב               | ד            | ✗     |
|    13 | .               | ▁ושם         | ✗     |
|    14 | ▁הוא            | ▁גדל         | ✗     |
|    15 | .               | ▁ג           | ✗     |
|    16 | '               | נץ           | ✗     |
|    17 | '               | ▁-           | ✗     |
|    18 | -               | ▁ניצח        | ✗     |
|    19 | ונות            | ה            | ✗     |
|    20 | .               | ▁כחול        | ✗     |
|    21 | יה              | ▁לבן         | ✗     |
|    22 | .               | ▁עם          | ✗     |
|    23 | ▁דם             | ▁4           | ✗     |
|    24 | ▁רגליים         | 76           | ✗     |
|    25 | ▁נפש            | ,            | ✗     |
|    26 | 5               | ▁לעומת       | ✗     |
|    27 | ▁זאת            | ▁2           | ✗     |
|    28 | ▁שנים           | 76           | ✗     |
|    29 | ▁איש            | ▁ללי         | ✗     |
|    30 | דים             | כו           | ✗     |
|    31 | ש               | ד            | ✗     |
|    32 | ש               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               |              | ✗     |

2024-12-31 22:38:01,286 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:38:01,291 - TrainingLogger - INFO - Gradient norm: 9.9687
2024-12-31 22:38:08,457 - TrainingLogger - INFO - Step 34910, Batch metrics: Loss: 7.4011, Accuracy: 0.0766, Perplexity: 1637.7579
2024-12-31 22:38:15,678 - TrainingLogger - INFO - Step 34920, Batch metrics: Loss: 7.0531, Accuracy: 0.0980, Perplexity: 1156.4857
2024-12-31 22:38:22,510 - TrainingLogger - INFO - Step 34930, Batch metrics: Loss: 6.8972, Accuracy: 0.0446, Perplexity: 989.4744
2024-12-31 22:38:29,204 - TrainingLogger - INFO - Step 34940, Batch metrics: Loss: 7.0901, Accuracy: 0.0738, Perplexity: 1199.9829
2024-12-31 22:38:35,744 - TrainingLogger - INFO - Step 34950, Batch metrics: Loss: 7.8094, Accuracy: 0.0435, Perplexity: 2463.6990
2024-12-31 22:38:42,573 - TrainingLogger - INFO - Step 34960, Batch metrics: Loss: 6.6658, Accuracy: 0.0893, Perplexity: 785.0906
2024-12-31 22:38:49,858 - TrainingLogger - INFO - Step 34970, Batch metrics: Loss: 7.5530, Accuracy: 0.0548, Perplexity: 1906.3898
2024-12-31 22:38:56,678 - TrainingLogger - INFO - Step 34980, Batch metrics: Loss: 7.3077, Accuracy: 0.0972, Perplexity: 1491.7126
2024-12-31 22:39:03,122 - TrainingLogger - INFO - Step 34990, Batch metrics: Loss: 7.1498, Accuracy: 0.1210, Perplexity: 1273.9062
2024-12-31 22:39:11,092 - TrainingLogger - INFO - Step 35000, Batch metrics: Loss: 7.2923, Accuracy: 0.0669, Perplexity: 1468.9863
2024-12-31 22:39:11,092 - TrainingLogger - INFO - Step 35000, Prediction vs Actual:
2024-12-31 22:39:11,092 - TrainingLogger - INFO - Input 1: היו שם אני כרמטכל, סגן הרמטכל, ראש אמן, ורבין לא מכיר את הפרטים ולא מתעסק בתרגילים
2024-12-31 22:39:11,093 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:39:11,093 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היו         | ✗     |
|     1 | ,               | ▁שם          | ✗     |
|     2 | ,               | ▁אני         | ✗     |
|     3 | ▁שם             | ▁כר          | ✗     |
|     4 | ויות            | מט           | ✗     |
|     5 | ן               | כל           | ✗     |
|     6 | נים             | ,            | ✗     |
|     7 | ▁שם             | ▁סגן         | ✗     |
|     8 | ▁הנשיא          | ▁הר          | ✗     |
|     9 | אק              | מט           | ✗     |
|    10 | יל              | כל           | ✗     |
|    11 | ,               | ,            | ✓     |
|    12 | ▁צרפת           | ▁ראש         | ✗     |
|    13 | ▁העיר           | ▁אמן         | ✗     |
|    14 | ,               | ,            | ✓     |
|    15 | </s>            | ▁ורב         | ✗     |
|    16 | ל               | ין           | ✗     |
|    17 | ,               | ▁לא          | ✗     |
|    18 | ▁עזב            | ▁מכיר        | ✗     |
|    19 | ▁את             | ▁את          | ✓     |
|    20 | ▁המדינה         | ▁הפרטים      | ✗     |
|    21 | ▁הללו           | ▁ולא         | ✗     |
|    22 | ן               | ▁מתעסק       | ✗     |
|    23 | .               | ▁ב           | ✗     |
|    24 | פעולות          | תרגיל        | ✗     |
|    25 | ים              | ים           | ✓     |
|    26 | ▁שונים          | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 22:39:11,093 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:39:11,098 - TrainingLogger - INFO - Gradient norm: 8.1852
2024-12-31 22:39:18,295 - TrainingLogger - INFO - Step 35010, Batch metrics: Loss: 7.3189, Accuracy: 0.1088, Perplexity: 1508.5424
2024-12-31 22:39:25,292 - TrainingLogger - INFO - Step 35020, Batch metrics: Loss: 7.5039, Accuracy: 0.0733, Perplexity: 1815.0860
2024-12-31 22:39:32,316 - TrainingLogger - INFO - Step 35030, Batch metrics: Loss: 7.1812, Accuracy: 0.1103, Perplexity: 1314.5117
2024-12-31 22:39:39,399 - TrainingLogger - INFO - Step 35040, Batch metrics: Loss: 7.0968, Accuracy: 0.1203, Perplexity: 1208.1109
2024-12-31 22:39:46,512 - TrainingLogger - INFO - Step 35050, Batch metrics: Loss: 7.0872, Accuracy: 0.1050, Perplexity: 1196.5547
2024-12-31 22:39:54,123 - TrainingLogger - INFO - Step 35060, Batch metrics: Loss: 7.5308, Accuracy: 0.0775, Perplexity: 1864.6346
2024-12-31 22:40:01,700 - TrainingLogger - INFO - Step 35070, Batch metrics: Loss: 6.8729, Accuracy: 0.1034, Perplexity: 965.7268
2024-12-31 22:40:10,605 - TrainingLogger - INFO - Step 35080, Batch metrics: Loss: 7.4516, Accuracy: 0.0872, Perplexity: 1722.6419
2024-12-31 22:40:17,545 - TrainingLogger - INFO - Step 35090, Batch metrics: Loss: 6.9777, Accuracy: 0.1143, Perplexity: 1072.4440
2024-12-31 22:40:25,050 - TrainingLogger - INFO - Step 35100, Batch metrics: Loss: 6.5846, Accuracy: 0.1061, Perplexity: 723.8959
2024-12-31 22:40:25,050 - TrainingLogger - INFO - Step 35100, Prediction vs Actual:
2024-12-31 22:40:25,051 - TrainingLogger - INFO - Input 1: מיה רגב, ששוחררה משבי חמאס, דיברה בדמעות בוועדה
2024-12-31 22:40:25,051 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:40:25,051 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | רה              | ▁מי          | ✗     |
|     1 | ן               | ה            | ✗     |
|     2 | .               | ▁רג          | ✗     |
|     3 | ה               | ב            | ✗     |
|     4 | מל              | ,            | ✗     |
|     5 | </s>            | ▁ש           | ✗     |
|     6 | כם              | שוחרר        | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | .               | ▁מ           | ✗     |
|     9 | תפקיד           | שבי          | ✗     |
|    10 | ה               | ▁ח           | ✗     |
|    11 | ומים            | מ            | ✗     |
|    12 | אס              | אס           | ✓     |
|    13 | ה               | ,            | ✗     |
|    14 | </s>            | ▁דיברה       | ✗     |
|    15 | ה               | ▁ב           | ✗     |
|    16 | -19             | דמעות        | ✗     |
|    17 | יה              | ▁בוועד       | ✗     |
|    18 | ה               | ה            | ✓     |
|    19 | ▁הלאומית        | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ה               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 22:40:25,051 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:40:25,056 - TrainingLogger - INFO - Gradient norm: 7.9942
2024-12-31 22:40:32,180 - TrainingLogger - INFO - Step 35110, Batch metrics: Loss: 7.0693, Accuracy: 0.0880, Perplexity: 1175.2815
2024-12-31 22:40:39,173 - TrainingLogger - INFO - Step 35120, Batch metrics: Loss: 7.4268, Accuracy: 0.0784, Perplexity: 1680.4324
2024-12-31 22:40:46,370 - TrainingLogger - INFO - Step 35130, Batch metrics: Loss: 7.0930, Accuracy: 0.0876, Perplexity: 1203.5255
2024-12-31 22:40:53,560 - TrainingLogger - INFO - Step 35140, Batch metrics: Loss: 7.3856, Accuracy: 0.0562, Perplexity: 1612.6352
2024-12-31 22:41:01,045 - TrainingLogger - INFO - Step 35150, Batch metrics: Loss: 6.9371, Accuracy: 0.0947, Perplexity: 1029.8006
2024-12-31 22:41:07,747 - TrainingLogger - INFO - Step 35160, Batch metrics: Loss: 7.2215, Accuracy: 0.0839, Perplexity: 1368.5963
2024-12-31 22:41:15,062 - TrainingLogger - INFO - Step 35170, Batch metrics: Loss: 7.4209, Accuracy: 0.0667, Perplexity: 1670.4628
2024-12-31 22:41:21,923 - TrainingLogger - INFO - Step 35180, Batch metrics: Loss: 7.5328, Accuracy: 0.0645, Perplexity: 1868.3780
2024-12-31 22:41:29,221 - TrainingLogger - INFO - Step 35190, Batch metrics: Loss: 7.1325, Accuracy: 0.0914, Perplexity: 1251.9770
2024-12-31 22:41:35,755 - TrainingLogger - INFO - Step 35200, Batch metrics: Loss: 7.2427, Accuracy: 0.1105, Perplexity: 1397.8926
2024-12-31 22:41:35,755 - TrainingLogger - INFO - Step 35200, Prediction vs Actual:
2024-12-31 22:41:35,755 - TrainingLogger - INFO - Input 1: יעידו על כך אלה שממשיכים לעשות חשבונות פוליטיים קטנים
2024-12-31 22:41:35,756 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:41:35,756 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ו               | ▁יעיד        | ✗     |
|     1 | ו               | ו            | ✓     |
|     2 | ה               | ▁על          | ✗     |
|     3 | ▁על             | ▁כך          | ✗     |
|     4 | ▁על             | ▁אלה         | ✗     |
|     5 | ▁לא             | ▁ש           | ✗     |
|     6 | עבור            | ממשיכים      | ✗     |
|     7 | ▁על             | ▁לעשות       | ✗     |
|     8 | ▁זאת            | ▁חשבונות     | ✗     |
|     9 | ▁חדשים          | ▁פוליטיים    | ✗     |
|    10 | .               | ▁קטנים       | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ,               |              | ✗     |

2024-12-31 22:41:35,756 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:41:35,761 - TrainingLogger - INFO - Gradient norm: 8.9531
2024-12-31 22:41:43,226 - TrainingLogger - INFO - Step 35210, Batch metrics: Loss: 7.2848, Accuracy: 0.1130, Perplexity: 1457.9619
2024-12-31 22:41:50,065 - TrainingLogger - INFO - Step 35220, Batch metrics: Loss: 7.7846, Accuracy: 0.0563, Perplexity: 2403.2445
2024-12-31 22:41:57,216 - TrainingLogger - INFO - Step 35230, Batch metrics: Loss: 7.6605, Accuracy: 0.0541, Perplexity: 2122.7752
2024-12-31 22:42:04,599 - TrainingLogger - INFO - Step 35240, Batch metrics: Loss: 7.4572, Accuracy: 0.1165, Perplexity: 1732.3496
2024-12-31 22:42:11,735 - TrainingLogger - INFO - Step 35250, Batch metrics: Loss: 7.4105, Accuracy: 0.0622, Perplexity: 1653.3317
2024-12-31 22:42:18,725 - TrainingLogger - INFO - Step 35260, Batch metrics: Loss: 7.2140, Accuracy: 0.0899, Perplexity: 1358.2664
2024-12-31 22:42:25,417 - TrainingLogger - INFO - Step 35270, Batch metrics: Loss: 7.4809, Accuracy: 0.0774, Perplexity: 1773.8539
2024-12-31 22:42:32,776 - TrainingLogger - INFO - Step 35280, Batch metrics: Loss: 7.3686, Accuracy: 0.0862, Perplexity: 1585.3807
2024-12-31 22:42:39,712 - TrainingLogger - INFO - Step 35290, Batch metrics: Loss: 7.2014, Accuracy: 0.0690, Perplexity: 1341.3153
2024-12-31 22:42:47,180 - TrainingLogger - INFO - Step 35300, Batch metrics: Loss: 6.8803, Accuracy: 0.1206, Perplexity: 972.8811
2024-12-31 22:42:47,180 - TrainingLogger - INFO - Step 35300, Prediction vs Actual:
2024-12-31 22:42:47,180 - TrainingLogger - INFO - Input 1: במקביל תתבצע נסיגה של הכוחות הישראליים מזרחה הרחק מאזורים מיושבים
2024-12-31 22:42:47,181 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:42:47,181 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁במקביל      | ✗     |
|     1 | ▁ל              | ▁ת           | ✗     |
|     2 | ▁ו              | תבצע         | ✗     |
|     3 | ה               | ▁נסיגה       | ✗     |
|     4 | ▁חמורה          | ▁של          | ✗     |
|     5 | ▁החוק           | ▁הכוחות      | ✗     |
|     6 | ▁המיוחדים       | ▁הישראלי     | ✗     |
|     7 | ם               | ים           | ✗     |
|     8 | .               | ▁מזרחה       | ✗     |
|     9 | .               | ▁הרחק        | ✗     |
|    10 | ה               | ▁מאזור       | ✗     |
|    11 | ▁ישראל          | ים           | ✗     |
|    12 | ▁אלה            | ▁מיושב       | ✗     |
|    13 | ים              | ים           | ✓     |
|    14 | ▁אלה            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | .               |              | ✗     |

2024-12-31 22:42:47,181 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:42:47,186 - TrainingLogger - INFO - Gradient norm: 8.1366
2024-12-31 22:42:54,894 - TrainingLogger - INFO - Step 35310, Batch metrics: Loss: 7.3570, Accuracy: 0.0805, Perplexity: 1567.1406
2024-12-31 22:43:01,890 - TrainingLogger - INFO - Step 35320, Batch metrics: Loss: 7.5637, Accuracy: 0.0617, Perplexity: 1927.0323
2024-12-31 22:43:08,826 - TrainingLogger - INFO - Step 35330, Batch metrics: Loss: 7.5133, Accuracy: 0.0663, Perplexity: 1832.3128
2024-12-31 22:43:15,973 - TrainingLogger - INFO - Step 35340, Batch metrics: Loss: 6.9625, Accuracy: 0.0851, Perplexity: 1056.2887
2024-12-31 22:43:23,638 - TrainingLogger - INFO - Step 35350, Batch metrics: Loss: 7.3505, Accuracy: 0.0843, Perplexity: 1556.9668
2024-12-31 22:43:31,085 - TrainingLogger - INFO - Step 35360, Batch metrics: Loss: 7.1980, Accuracy: 0.0795, Perplexity: 1336.7411
2024-12-31 22:43:38,475 - TrainingLogger - INFO - Step 35370, Batch metrics: Loss: 7.0439, Accuracy: 0.0769, Perplexity: 1145.7964
2024-12-31 22:43:45,155 - TrainingLogger - INFO - Step 35380, Batch metrics: Loss: 7.3918, Accuracy: 0.0935, Perplexity: 1622.5676
2024-12-31 22:43:52,002 - TrainingLogger - INFO - Step 35390, Batch metrics: Loss: 7.7799, Accuracy: 0.0745, Perplexity: 2392.1054
2024-12-31 22:43:59,394 - TrainingLogger - INFO - Step 35400, Batch metrics: Loss: 7.6763, Accuracy: 0.0564, Perplexity: 2156.5269
2024-12-31 22:43:59,395 - TrainingLogger - INFO - Step 35400, Prediction vs Actual:
2024-12-31 22:43:59,395 - TrainingLogger - INFO - Input 1: ביום שני האחרוןהצהיר ליברמןכי גם במחיר של הליכה מחדש לבחירות חדשות - לא יהיה שום ויתור של ישראל ביתנו בנושא גיוס בני הישיבות
2024-12-31 22:43:59,395 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:43:59,395 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ביום        | ✗     |
|     1 | ▁-              | ▁שני         | ✗     |
|     2 | ▁אני            | ▁האחרון      | ✗     |
|     3 | ,               | ה            | ✗     |
|     4 | ה               | צהיר         | ✗     |
|     5 | ים              | ▁לי          | ✗     |
|     6 | ן               | ברמן         | ✗     |
|     7 | .               | כי           | ✗     |
|     8 | ▁זה             | ▁גם          | ✗     |
|     9 | ▁הפעם           | ▁במחיר       | ✗     |
|    10 | ים              | ▁של          | ✗     |
|    11 | ▁10             | ▁הליכה       | ✗     |
|    12 | ▁אחת            | ▁מחדש        | ✗     |
|    13 | .               | ▁ל           | ✗     |
|    14 | -               | בחירות       | ✗     |
|    15 | .               | ▁חדשות       | ✗     |
|    16 | ▁רעות           | ▁-           | ✗     |
|    17 | <pad>           | ▁לא          | ✗     |
|    18 | ▁הייתה          | ▁יהיה        | ✗     |
|    19 | ▁לי             | ▁שום         | ✗     |
|    20 | ▁סיכוי          | ▁            | ✗     |
|    21 | הליך            | ויתור        | ✗     |
|    22 | ▁על             | ▁של          | ✗     |
|    23 | ▁ממש            | ▁ישראל       | ✗     |
|    24 | .               | ▁ביתנו       | ✗     |
|    25 | .               | ▁בנושא       | ✗     |
|    26 | .               | ▁גיוס        | ✗     |
|    27 | ▁כספים          | ▁בני         | ✗     |
|    28 | ▁אדם            | ▁הישיבות     | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            |              | ✗     |

2024-12-31 22:43:59,395 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:43:59,400 - TrainingLogger - INFO - Gradient norm: 9.2784
2024-12-31 22:44:06,072 - TrainingLogger - INFO - Step 35410, Batch metrics: Loss: 7.2243, Accuracy: 0.0807, Perplexity: 1372.3664
2024-12-31 22:44:13,500 - TrainingLogger - INFO - Step 35420, Batch metrics: Loss: 6.9773, Accuracy: 0.0592, Perplexity: 1072.0733
2024-12-31 22:44:20,517 - TrainingLogger - INFO - Step 35430, Batch metrics: Loss: 7.1503, Accuracy: 0.0756, Perplexity: 1274.4397
2024-12-31 22:44:27,608 - TrainingLogger - INFO - Step 35440, Batch metrics: Loss: 7.4241, Accuracy: 0.0681, Perplexity: 1675.8601
2024-12-31 22:44:34,393 - TrainingLogger - INFO - Step 35450, Batch metrics: Loss: 7.2293, Accuracy: 0.0638, Perplexity: 1379.1982
2024-12-31 22:44:41,231 - TrainingLogger - INFO - Step 35460, Batch metrics: Loss: 7.6365, Accuracy: 0.0486, Perplexity: 2072.4742
2024-12-31 22:44:48,626 - TrainingLogger - INFO - Step 35470, Batch metrics: Loss: 7.4198, Accuracy: 0.0861, Perplexity: 1668.6859
2024-12-31 22:44:55,791 - TrainingLogger - INFO - Step 35480, Batch metrics: Loss: 7.5711, Accuracy: 0.0724, Perplexity: 1941.3037
2024-12-31 22:45:03,244 - TrainingLogger - INFO - Step 35490, Batch metrics: Loss: 7.0298, Accuracy: 0.0773, Perplexity: 1129.8423
2024-12-31 22:45:10,437 - TrainingLogger - INFO - Step 35500, Batch metrics: Loss: 7.5593, Accuracy: 0.0426, Perplexity: 1918.5651
2024-12-31 22:45:10,437 - TrainingLogger - INFO - Step 35500, Prediction vs Actual:
2024-12-31 22:45:10,437 - TrainingLogger - INFO - Input 1: בקשר למלחמה אפשרית בצפון סיפר ליברמן כי ב-236 ראיתי סרטון של נסראללה שאומר שאם תיפתח מלחמה מול לבנון, היא תהיה ללא מגבלות, כללים וסייגים
2024-12-31 22:45:10,438 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:45:10,438 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בקשר        | ✗     |
|     1 | ▁...            | ▁למלחמה      | ✗     |
|     2 | ▁עם             | ▁אפשרית      | ✗     |
|     3 | ?               | ▁בצפון       | ✗     |
|     4 | ▁המדינה         | ▁סיפר        | ✗     |
|     5 | ד               | ▁לי          | ✗     |
|     6 | ▁על             | ברמן         | ✗     |
|     7 | ,               | ▁כי          | ✗     |
|     8 | ▁הוא            | ▁ב           | ✗     |
|     9 | -19             | -2           | ✗     |
|    10 | ▁בערב           | 36           | ✗     |
|    11 | ▁היה            | ▁ראיתי       | ✗     |
|    12 | ▁את             | ▁סרט         | ✗     |
|    13 | ון              | ון           | ✓     |
|    14 | ▁חדש            | ▁של          | ✗     |
|    15 | ▁היום           | ▁נס          | ✗     |
|    16 | לי              | ר            | ✗     |
|    17 | ,               | אל           | ✗     |
|    18 | סון             | לה           | ✗     |
|    19 | </s>            | ▁שאומר       | ✗     |
|    20 | ▁"              | ▁שאם         | ✗     |
|    21 | ▁הוא            | ▁תיפתח       | ✗     |
|    22 | ו               | ▁מלחמה       | ✗     |
|    23 | ▁זה             | ▁מול         | ✗     |
|    24 | ה               | ▁לב          | ✗     |
|    25 | לב              | נון          | ✗     |
|    26 | </s>            | ,            | ✗     |
|    27 | </s>            | ▁היא         | ✗     |
|    28 | ▁ת              | ▁תהיה        | ✗     |
|    29 | ▁אחראית         | ▁ללא         | ✗     |
|    30 | ▁ספק            | ▁מגבלות      | ✗     |
|    31 | ,               | ,            | ✓     |
|    32 | </s>            | ▁כללים       | ✗     |
|    33 | ,               | ▁וסי         | ✗     |
|    34 | כ               | יג           | ✗     |
|    35 | ה               | ים           | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ה               | <pad>        | ✗     |
|    38 | ▁את             | <pad>        | ✗     |
|    39 | ות              | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ▁אותם           |              | ✗     |

2024-12-31 22:45:10,438 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:45:10,443 - TrainingLogger - INFO - Gradient norm: 8.4771
2024-12-31 22:45:18,292 - TrainingLogger - INFO - Step 35510, Batch metrics: Loss: 7.2946, Accuracy: 0.0866, Perplexity: 1472.2977
2024-12-31 22:45:25,817 - TrainingLogger - INFO - Step 35520, Batch metrics: Loss: 7.5958, Accuracy: 0.0889, Perplexity: 1989.7972
2024-12-31 22:45:32,638 - TrainingLogger - INFO - Step 35530, Batch metrics: Loss: 7.4463, Accuracy: 0.0481, Perplexity: 1713.5695
2024-12-31 22:45:39,795 - TrainingLogger - INFO - Step 35540, Batch metrics: Loss: 7.2919, Accuracy: 0.0753, Perplexity: 1468.2867
2024-12-31 22:45:46,821 - TrainingLogger - INFO - Step 35550, Batch metrics: Loss: 8.0496, Accuracy: 0.0563, Perplexity: 3132.6362
2024-12-31 22:45:54,373 - TrainingLogger - INFO - Step 35560, Batch metrics: Loss: 7.4208, Accuracy: 0.0793, Perplexity: 1670.3003
2024-12-31 22:46:01,513 - TrainingLogger - INFO - Step 35570, Batch metrics: Loss: 7.8508, Accuracy: 0.0749, Perplexity: 2567.7695
2024-12-31 22:46:09,179 - TrainingLogger - INFO - Step 35580, Batch metrics: Loss: 7.1881, Accuracy: 0.0741, Perplexity: 1323.5442
2024-12-31 22:46:16,743 - TrainingLogger - INFO - Step 35590, Batch metrics: Loss: 7.2086, Accuracy: 0.0929, Perplexity: 1351.0183
2024-12-31 22:46:24,031 - TrainingLogger - INFO - Step 35600, Batch metrics: Loss: 7.0018, Accuracy: 0.1348, Perplexity: 1098.6288
2024-12-31 22:46:24,031 - TrainingLogger - INFO - Step 35600, Prediction vs Actual:
2024-12-31 22:46:24,031 - TrainingLogger - INFO - Input 1: זה משרת גם צרכים של מעסיק, שיכול לשלם פחות לעובד, או לשלם לו רק עבור העבודה שביצע ולוותר על שכר גלובלי
2024-12-31 22:46:24,032 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:46:24,032 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זה          | ✗     |
|     1 | .               | ▁משרת        | ✗     |
|     2 | ▁הוא            | ▁גם          | ✗     |
|     3 | ▁הוא            | ▁צרכים       | ✗     |
|     4 | ▁טובים          | ▁של          | ✗     |
|     5 | ▁אנשים          | ▁מעסיק       | ✗     |
|     6 | ים              | ,            | ✗     |
|     7 | <pad>           | ▁שיכול       | ✗     |
|     8 | ▁להיות          | ▁לשלם        | ✗     |
|     9 | ▁את             | ▁פחות        | ✗     |
|    10 | ▁או             | ▁ל           | ✗     |
|    11 | מדינות          | עובד         | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | <pad>           | ▁או          | ✗     |
|    14 | ▁יותר           | ▁לשלם        | ✗     |
|    15 | ▁את             | ▁לו          | ✗     |
|    16 | ▁כסף            | ▁רק          | ✗     |
|    17 | ▁בשביל          | ▁עבור        | ✗     |
|    18 | ▁זה             | ▁העבודה      | ✗     |
|    19 | ▁שלו            | ▁שביצע       | ✗     |
|    20 | תי              | ▁ולו         | ✗     |
|    21 | ▁יש             | ות           | ✗     |
|    22 | ר               | ר            | ✓     |
|    23 | ▁על             | ▁על          | ✓     |
|    24 | ▁זה             | ▁שכר         | ✗     |
|    25 | ▁הדירה          | ▁גלו         | ✗     |
|    26 | לה              | בלי          | ✗     |
|    27 | .               |              | ✗     |

2024-12-31 22:46:24,032 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:46:24,037 - TrainingLogger - INFO - Gradient norm: 7.9079
2024-12-31 22:46:31,333 - TrainingLogger - INFO - Step 35610, Batch metrics: Loss: 7.5487, Accuracy: 0.0927, Perplexity: 1898.3156
2024-12-31 22:46:38,146 - TrainingLogger - INFO - Step 35620, Batch metrics: Loss: 7.4111, Accuracy: 0.0710, Perplexity: 1654.2188
2024-12-31 22:46:45,746 - TrainingLogger - INFO - Step 35630, Batch metrics: Loss: 7.1948, Accuracy: 0.1089, Perplexity: 1332.4347
2024-12-31 22:46:52,376 - TrainingLogger - INFO - Step 35640, Batch metrics: Loss: 7.5925, Accuracy: 0.0651, Perplexity: 1983.2546
2024-12-31 22:46:59,336 - TrainingLogger - INFO - Step 35650, Batch metrics: Loss: 7.7429, Accuracy: 0.0884, Perplexity: 2305.0902
2024-12-31 22:47:06,078 - TrainingLogger - INFO - Step 35660, Batch metrics: Loss: 7.3986, Accuracy: 0.0455, Perplexity: 1633.7465
2024-12-31 22:47:12,803 - TrainingLogger - INFO - Step 35670, Batch metrics: Loss: 7.2347, Accuracy: 0.0794, Perplexity: 1386.7575
2024-12-31 22:47:19,744 - TrainingLogger - INFO - Step 35680, Batch metrics: Loss: 7.3611, Accuracy: 0.0788, Perplexity: 1573.5218
2024-12-31 22:47:26,797 - TrainingLogger - INFO - Step 35690, Batch metrics: Loss: 6.9321, Accuracy: 0.1195, Perplexity: 1024.6423
2024-12-31 22:47:34,318 - TrainingLogger - INFO - Step 35700, Batch metrics: Loss: 7.4244, Accuracy: 0.0581, Perplexity: 1676.4459
2024-12-31 22:47:34,318 - TrainingLogger - INFO - Step 35700, Prediction vs Actual:
2024-12-31 22:47:34,318 - TrainingLogger - INFO - Input 1: נחנקנו, אני מרגישה כאילו שאנחנו חיים לבד בעולם אחר, סיפרה אישה אחרת המתגוררת באזור
2024-12-31 22:47:34,319 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:47:34,319 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁נחנק        | ✗     |
|     1 | ▁-              | נו           | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | ▁נכון           | ▁אני         | ✗     |
|     4 | ▁חושב           | ▁מרגישה      | ✗     |
|     5 | ▁שזה            | ▁כאילו       | ✗     |
|     6 | ▁אני            | ▁שאנחנו      | ✗     |
|     7 | ▁לא             | ▁חיים        | ✗     |
|     8 | ▁חיים           | ▁לבד         | ✗     |
|     9 | .               | ▁בעולם       | ✗     |
|    10 | ▁הזה            | ▁אחר         | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | </s>            | ▁סיפרה       | ✗     |
|    13 | ▁לי             | ▁אישה        | ✗     |
|    14 | .               | ▁אחרת        | ✗     |
|    15 | .               | ▁המתגורר     | ✗     |
|    16 | ת               | ת            | ✓     |
|    17 | ▁את             | ▁באזור       | ✗     |
|    18 | ▁הזה            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            |              | ✗     |

2024-12-31 22:47:34,319 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:47:34,324 - TrainingLogger - INFO - Gradient norm: 10.5491
2024-12-31 22:47:41,450 - TrainingLogger - INFO - Step 35710, Batch metrics: Loss: 7.2747, Accuracy: 0.0872, Perplexity: 1443.3080
2024-12-31 22:47:48,728 - TrainingLogger - INFO - Step 35720, Batch metrics: Loss: 7.4720, Accuracy: 0.0865, Perplexity: 1758.1397
2024-12-31 22:47:55,921 - TrainingLogger - INFO - Step 35730, Batch metrics: Loss: 7.7059, Accuracy: 0.0729, Perplexity: 2221.3060
2024-12-31 22:48:03,509 - TrainingLogger - INFO - Step 35740, Batch metrics: Loss: 7.5118, Accuracy: 0.0657, Perplexity: 1829.4667
2024-12-31 22:48:04,254 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 322560
2024-12-31 22:48:04,254 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 322560

2024-12-31 22:48:04,254 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 45]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 58]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 58]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 22:48:04,256 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 22:48:11,346 - TrainingLogger - INFO - Step 35750, Batch metrics: Loss: 7.2719, Accuracy: 0.0541, Perplexity: 1439.2491
2024-12-31 22:48:17,984 - TrainingLogger - INFO - Step 35760, Batch metrics: Loss: 6.8825, Accuracy: 0.0833, Perplexity: 975.0212
2024-12-31 22:48:25,046 - TrainingLogger - INFO - Step 35770, Batch metrics: Loss: 7.1612, Accuracy: 0.1033, Perplexity: 1288.3960
2024-12-31 22:48:32,371 - TrainingLogger - INFO - Step 35780, Batch metrics: Loss: 7.1509, Accuracy: 0.0755, Perplexity: 1275.2092
2024-12-31 22:48:39,538 - TrainingLogger - INFO - Step 35790, Batch metrics: Loss: 7.2149, Accuracy: 0.0619, Perplexity: 1359.5520
2024-12-31 22:48:46,436 - TrainingLogger - INFO - Step 35800, Batch metrics: Loss: 7.0870, Accuracy: 0.1019, Perplexity: 1196.2574
2024-12-31 22:48:46,437 - TrainingLogger - INFO - Step 35800, Prediction vs Actual:
2024-12-31 22:48:46,437 - TrainingLogger - INFO - Input 1: על ספינות השטח אין צידוק מבצעי ויש שאלה אם זה התקבל כדין, כי הדרך התקינה הייתה לקיים מכרז על עסקאות כאלה
2024-12-31 22:48:46,437 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:48:46,437 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁על          | ✗     |
|     1 | .               | ▁ספינות      | ✗     |
|     2 | ▁-              | ▁השטח        | ✗     |
|     3 | ▁-              | ▁אין         | ✗     |
|     4 | ▁מקום           | ▁ציד         | ✗     |
|     5 | .               | וק           | ✗     |
|     6 | .               | ▁מבצעי       | ✗     |
|     7 | .               | ▁ויש         | ✗     |
|     8 | ▁לי             | ▁שאלה        | ✗     |
|     9 | :               | ▁אם          | ✗     |
|    10 | ▁זה             | ▁זה          | ✓     |
|    11 | ▁נכון           | ▁התקבל       | ✗     |
|    12 | ▁על             | ▁כדי         | ✗     |
|    13 | ▁לקבל           | ן            | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | <pad>           | ▁כי          | ✗     |
|    16 | ▁הם             | ▁הדרך        | ✗     |
|    17 | ▁היחידה         | ▁התק         | ✗     |
|    18 | ינה             | ינה          | ✓     |
|    19 | ▁היא            | ▁הייתה       | ✗     |
|    20 | ▁להגיע          | ▁לקיים       | ✗     |
|    21 | ▁את             | ▁מכר         | ✗     |
|    22 | ים              | ז            | ✗     |
|    23 | .               | ▁על          | ✗     |
|    24 | ▁ידי            | ▁עסקאות      | ✗     |
|    25 | .               | ▁כאלה        | ✗     |
|    26 | ,               |              | ✗     |

2024-12-31 22:48:46,437 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:48:46,442 - TrainingLogger - INFO - Gradient norm: 7.6025
2024-12-31 22:48:54,167 - TrainingLogger - INFO - Step 35810, Batch metrics: Loss: 7.4047, Accuracy: 0.0851, Perplexity: 1643.7250
2024-12-31 22:49:01,734 - TrainingLogger - INFO - Step 35820, Batch metrics: Loss: 7.5430, Accuracy: 0.0947, Perplexity: 1887.4610
2024-12-31 22:49:09,233 - TrainingLogger - INFO - Step 35830, Batch metrics: Loss: 7.4898, Accuracy: 0.0596, Perplexity: 1789.6190
2024-12-31 22:49:16,287 - TrainingLogger - INFO - Step 35840, Batch metrics: Loss: 7.1409, Accuracy: 0.0658, Perplexity: 1262.5210
2024-12-31 22:49:23,813 - TrainingLogger - INFO - Step 35850, Batch metrics: Loss: 7.5642, Accuracy: 0.0773, Perplexity: 1927.8448
2024-12-31 22:49:31,164 - TrainingLogger - INFO - Step 35860, Batch metrics: Loss: 7.9018, Accuracy: 0.0485, Perplexity: 2702.0894
2024-12-31 22:49:38,734 - TrainingLogger - INFO - Step 35870, Batch metrics: Loss: 7.4631, Accuracy: 0.0825, Perplexity: 1742.4833
2024-12-31 22:49:45,804 - TrainingLogger - INFO - Step 35880, Batch metrics: Loss: 7.1769, Accuracy: 0.0854, Perplexity: 1308.8806
2024-12-31 22:49:52,502 - TrainingLogger - INFO - Step 35890, Batch metrics: Loss: 7.4542, Accuracy: 0.1214, Perplexity: 1727.1154
2024-12-31 22:50:00,072 - TrainingLogger - INFO - Step 35900, Batch metrics: Loss: 7.4473, Accuracy: 0.0674, Perplexity: 1715.2519
2024-12-31 22:50:00,072 - TrainingLogger - INFO - Step 35900, Prediction vs Actual:
2024-12-31 22:50:00,072 - TrainingLogger - INFO - Input 1: זו דרך של שמאל, גם חלש אבל שמאל, וזה לא ממשלה שאנחנו רוצים לקדם
2024-12-31 22:50:00,073 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:50:00,073 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זו          | ✗     |
|     1 | ▁אני            | ▁דרך         | ✗     |
|     2 | ▁להיות          | ▁של          | ✗     |
|     3 | ▁חיים           | ▁שמאל        | ✗     |
|     4 | .               | ,            | ✗     |
|     5 | <pad>           | ▁גם          | ✗     |
|     6 | ▁אם             | ▁חלש         | ✗     |
|     7 | ות              | ▁אבל         | ✗     |
|     8 | ▁לא             | ▁שמאל        | ✗     |
|     9 | ,               | ,            | ✓     |
|    10 | </s>            | ▁וזה         | ✗     |
|    11 | .               | ▁לא          | ✗     |
|    12 | ▁נכון           | ▁ממשלה       | ✗     |
|    13 | .               | ▁שאנחנו      | ✗     |
|    14 | ▁צריכים         | ▁רוצים       | ✗     |
|    15 | .               | ▁לקדם        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | ▁את             | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ,               | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            |              | ✗     |

2024-12-31 22:50:00,073 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:50:00,078 - TrainingLogger - INFO - Gradient norm: 8.2466
2024-12-31 22:50:07,450 - TrainingLogger - INFO - Step 35910, Batch metrics: Loss: 7.2504, Accuracy: 0.0580, Perplexity: 1408.6172
2024-12-31 22:50:14,847 - TrainingLogger - INFO - Step 35920, Batch metrics: Loss: 7.3401, Accuracy: 0.0852, Perplexity: 1540.8850
2024-12-31 22:50:22,286 - TrainingLogger - INFO - Step 35930, Batch metrics: Loss: 7.2931, Accuracy: 0.0731, Perplexity: 1470.1580
2024-12-31 22:50:29,518 - TrainingLogger - INFO - Step 35940, Batch metrics: Loss: 6.9925, Accuracy: 0.0941, Perplexity: 1088.4546
2024-12-31 22:50:36,406 - TrainingLogger - INFO - Step 35950, Batch metrics: Loss: 7.3177, Accuracy: 0.0548, Perplexity: 1506.7135
2024-12-31 22:50:43,195 - TrainingLogger - INFO - Step 35960, Batch metrics: Loss: 7.6485, Accuracy: 0.0806, Perplexity: 2097.5639
2024-12-31 22:50:49,707 - TrainingLogger - INFO - Step 35970, Batch metrics: Loss: 7.4193, Accuracy: 0.0925, Perplexity: 1667.8625
2024-12-31 22:50:57,122 - TrainingLogger - INFO - Step 35980, Batch metrics: Loss: 7.9401, Accuracy: 0.0351, Perplexity: 2807.7168
2024-12-31 22:51:03,895 - TrainingLogger - INFO - Step 35990, Batch metrics: Loss: 7.1746, Accuracy: 0.0843, Perplexity: 1305.8515
2024-12-31 22:51:11,300 - TrainingLogger - INFO - Step 36000, Batch metrics: Loss: 7.1276, Accuracy: 0.0819, Perplexity: 1245.8734
2024-12-31 22:51:11,301 - TrainingLogger - INFO - Step 36000, Prediction vs Actual:
2024-12-31 22:51:11,301 - TrainingLogger - INFO - Input 1: אם ירצו, שיתפקדו לליכוד כמו כל אחד אחר
2024-12-31 22:51:11,301 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:51:11,301 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אם          | ✗     |
|     1 | ▁לך             | ▁ירצו        | ✗     |
|     2 | ▁טוב            | ,            | ✗     |
|     3 | <pad>           | ▁שיתפ        | ✗     |
|     4 | ▁-              | קדו          | ✗     |
|     5 | .               | ▁ללי         | ✗     |
|     6 | נה              | כו           | ✗     |
|     7 | ד               | ד            | ✓     |
|     8 | .               | ▁כמו         | ✗     |
|     9 | יות             | ▁כל          | ✗     |
|    10 | ▁אלה            | ▁אחד         | ✗     |
|    11 | ▁אחר            | ▁אחר         | ✓     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ▁יש             | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               |              | ✗     |

2024-12-31 22:51:11,301 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:51:11,306 - TrainingLogger - INFO - Gradient norm: 10.0808
2024-12-31 22:51:17,902 - TrainingLogger - INFO - Step 36010, Batch metrics: Loss: 7.6435, Accuracy: 0.0625, Perplexity: 2087.1319
2024-12-31 22:51:24,628 - TrainingLogger - INFO - Step 36020, Batch metrics: Loss: 7.3734, Accuracy: 0.0683, Perplexity: 1593.0557
2024-12-31 22:51:32,491 - TrainingLogger - INFO - Step 36030, Batch metrics: Loss: 7.5034, Accuracy: 0.0524, Perplexity: 1814.2354
2024-12-31 22:51:39,590 - TrainingLogger - INFO - Step 36040, Batch metrics: Loss: 7.7674, Accuracy: 0.1138, Perplexity: 2362.2735
2024-12-31 22:51:46,444 - TrainingLogger - INFO - Step 36050, Batch metrics: Loss: 7.0803, Accuracy: 0.1029, Perplexity: 1188.2891
2024-12-31 22:51:53,888 - TrainingLogger - INFO - Step 36060, Batch metrics: Loss: 7.2328, Accuracy: 0.0851, Perplexity: 1384.1473
2024-12-31 22:52:01,321 - TrainingLogger - INFO - Step 36070, Batch metrics: Loss: 7.5763, Accuracy: 0.0618, Perplexity: 1951.3473
2024-12-31 22:52:07,839 - TrainingLogger - INFO - Step 36080, Batch metrics: Loss: 7.7825, Accuracy: 0.0394, Perplexity: 2398.2133
2024-12-31 22:52:15,110 - TrainingLogger - INFO - Step 36090, Batch metrics: Loss: 7.4427, Accuracy: 0.0457, Perplexity: 1707.3374
2024-12-31 22:52:22,136 - TrainingLogger - INFO - Step 36100, Batch metrics: Loss: 7.6202, Accuracy: 0.0750, Perplexity: 2038.9780
2024-12-31 22:52:22,137 - TrainingLogger - INFO - Step 36100, Prediction vs Actual:
2024-12-31 22:52:22,137 - TrainingLogger - INFO - Input 1: אישה שלא חיה על פי חוקי הפוליטקלי קורקט הישראלי הנדרשים
2024-12-31 22:52:22,137 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:52:22,137 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁אישה        | ✗     |
|     1 | ,               | ▁שלא         | ✗     |
|     2 | ▁הייתה          | ▁חיה         | ✗     |
|     3 | ▁בחיים          | ▁על          | ✗     |
|     4 | ה               | ▁פי          | ✗     |
|     5 | ▁חוק            | ▁חוקי        | ✗     |
|     6 | ▁המדינה         | ▁הפול        | ✗     |
|     7 | אה              | יט           | ✗     |
|     8 | ורה             | קלי          | ✗     |
|     9 | ה               | ▁קור         | ✗     |
|    10 | ב               | קט           | ✗     |
|    11 | ורה             | ▁הישראלי     | ✗     |
|    12 | ם               | ▁הנדרש       | ✗     |
|    13 | ת               | ים           | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ,               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | יים             |              | ✗     |

2024-12-31 22:52:22,137 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:52:22,142 - TrainingLogger - INFO - Gradient norm: 8.5931
2024-12-31 22:52:29,207 - TrainingLogger - INFO - Step 36110, Batch metrics: Loss: 7.1603, Accuracy: 0.0690, Perplexity: 1287.2452
2024-12-31 22:52:36,748 - TrainingLogger - INFO - Step 36120, Batch metrics: Loss: 6.7558, Accuracy: 0.0778, Perplexity: 859.0118
2024-12-31 22:52:43,722 - TrainingLogger - INFO - Step 36130, Batch metrics: Loss: 7.2629, Accuracy: 0.0825, Perplexity: 1426.4087
2024-12-31 22:52:50,167 - TrainingLogger - INFO - Step 36140, Batch metrics: Loss: 7.7347, Accuracy: 0.0654, Perplexity: 2286.2687
2024-12-31 22:52:57,103 - TrainingLogger - INFO - Step 36150, Batch metrics: Loss: 7.1888, Accuracy: 0.0860, Perplexity: 1324.5190
2024-12-31 22:53:04,264 - TrainingLogger - INFO - Step 36160, Batch metrics: Loss: 7.4706, Accuracy: 0.0734, Perplexity: 1755.6181
2024-12-31 22:53:11,162 - TrainingLogger - INFO - Step 36170, Batch metrics: Loss: 7.3497, Accuracy: 0.0769, Perplexity: 1555.7423
2024-12-31 22:53:18,767 - TrainingLogger - INFO - Step 36180, Batch metrics: Loss: 7.1179, Accuracy: 0.1067, Perplexity: 1233.8100
2024-12-31 22:53:26,443 - TrainingLogger - INFO - Step 36190, Batch metrics: Loss: 7.2862, Accuracy: 0.0806, Perplexity: 1459.9425
2024-12-31 22:53:33,540 - TrainingLogger - INFO - Step 36200, Batch metrics: Loss: 7.4157, Accuracy: 0.0782, Perplexity: 1661.8459
2024-12-31 22:53:33,541 - TrainingLogger - INFO - Step 36200, Prediction vs Actual:
2024-12-31 22:53:33,541 - TrainingLogger - INFO - Input 1: בעוד בלינקן לוחץ על ישראל לאפשר חזרת תושבים פלסטינים לצפון הרצועה, בישראל חוששים שמהלך כזה יפגע במטרות המלחמה - מיטוט חמאס והחזרת החטופים
2024-12-31 22:53:33,541 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:53:33,541 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בעוד        | ✗     |
|     1 | ▁-              | ▁בלי         | ✗     |
|     2 | ▁בעיות          | נקן          | ✗     |
|     3 | .               | ▁לוחץ        | ✗     |
|     4 | .               | ▁על          | ✗     |
|     5 | ▁מנת            | ▁ישראל       | ✗     |
|     6 | ים              | ▁לאפשר       | ✗     |
|     7 | ▁להם            | ▁חזרת        | ✗     |
|     8 | .               | ▁תושבים      | ✗     |
|     9 | ▁חדשים          | ▁פלסטי       | ✗     |
|    10 | ת               | נים          | ✗     |
|    11 | .               | ▁לצפון       | ✗     |
|    12 | ▁אמריקה         | ▁הרצועה      | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | </s>            | ▁בישראל      | ✗     |
|    15 | ,               | ▁חוששים      | ✗     |
|    16 | ▁יותר           | ▁שמה         | ✗     |
|    17 | ם               | לך           | ✗     |
|    18 | ▁זה             | ▁כזה         | ✗     |
|    19 | ,               | ▁יפגע        | ✗     |
|    20 | ▁בהם            | ▁ב           | ✗     |
|    21 | בריאות          | מטרות        | ✗     |
|    22 | יהם             | ▁המלחמה      | ✗     |
|    23 | .               | ▁-           | ✗     |
|    24 | </s>            | ▁מי          | ✗     |
|    25 | ▁ייתן           | טוט          | ✗     |
|    26 | ה               | ▁ח           | ✗     |
|    27 | נו              | מ            | ✗     |
|    28 | אס              | אס           | ✓     |
|    29 | ,               | ▁וה          | ✗     |
|    30 | ה               | חזרת         | ✗     |
|    31 | ה               | ▁הח          | ✗     |
|    32 | ת               | טופ          | ✗     |
|    33 | ה               | ים           | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ה               |              | ✗     |

2024-12-31 22:53:33,541 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:53:33,546 - TrainingLogger - INFO - Gradient norm: 8.4651
2024-12-31 22:53:40,492 - TrainingLogger - INFO - Step 36210, Batch metrics: Loss: 8.0885, Accuracy: 0.0333, Perplexity: 3256.8019
2024-12-31 22:53:47,549 - TrainingLogger - INFO - Step 36220, Batch metrics: Loss: 7.1958, Accuracy: 0.1000, Perplexity: 1333.8517
2024-12-31 22:53:54,460 - TrainingLogger - INFO - Step 36230, Batch metrics: Loss: 6.8908, Accuracy: 0.0926, Perplexity: 983.1459
2024-12-31 22:54:01,595 - TrainingLogger - INFO - Step 36240, Batch metrics: Loss: 6.6960, Accuracy: 0.0902, Perplexity: 809.1713
2024-12-31 22:54:08,557 - TrainingLogger - INFO - Step 36250, Batch metrics: Loss: 7.2666, Accuracy: 0.0811, Perplexity: 1431.6706
2024-12-31 22:54:15,750 - TrainingLogger - INFO - Step 36260, Batch metrics: Loss: 7.8772, Accuracy: 0.0761, Perplexity: 2636.5936
2024-12-31 22:54:23,120 - TrainingLogger - INFO - Step 36270, Batch metrics: Loss: 7.2157, Accuracy: 0.0802, Perplexity: 1360.6396
2024-12-31 22:54:30,169 - TrainingLogger - INFO - Step 36280, Batch metrics: Loss: 7.2056, Accuracy: 0.0573, Perplexity: 1347.0166
2024-12-31 22:54:37,616 - TrainingLogger - INFO - Step 36290, Batch metrics: Loss: 7.2726, Accuracy: 0.0969, Perplexity: 1440.2219
2024-12-31 22:54:45,382 - TrainingLogger - INFO - Step 36300, Batch metrics: Loss: 7.2390, Accuracy: 0.0913, Perplexity: 1392.7634
2024-12-31 22:54:45,382 - TrainingLogger - INFO - Step 36300, Prediction vs Actual:
2024-12-31 22:54:45,382 - TrainingLogger - INFO - Input 1: עודה הוכחה לכך שבית המשפט העליון הוא כבר מזמן לא שומר שלטון החוק
2024-12-31 22:54:45,383 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:54:45,383 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עוד         | ✗     |
|     1 | ▁-              | ה            | ✗     |
|     2 | ▁-              | ▁הוכחה       | ✗     |
|     3 | ▁-              | ▁לכך         | ✗     |
|     4 | ,               | ▁שבית        | ✗     |
|     5 | ▁הוא            | ▁המשפט       | ✗     |
|     6 | ▁העליון         | ▁העליון      | ✓     |
|     7 | ,               | ▁הוא         | ✗     |
|     8 | ▁לא             | ▁כבר         | ✗     |
|     9 | ▁לא             | ▁מזמן        | ✗     |
|    10 | .               | ▁לא          | ✗     |
|    11 | ▁היה            | ▁שומר        | ✗     |
|    12 | ▁את             | ▁שלטון       | ✗     |
|    13 | .               | ▁החוק        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | .               | <pad>        | ✗     |
|    20 | ▁לא             | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | ,               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁הוא            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁הוא            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2024-12-31 22:54:45,383 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:54:45,388 - TrainingLogger - INFO - Gradient norm: 8.4842
2024-12-31 22:54:52,413 - TrainingLogger - INFO - Step 36310, Batch metrics: Loss: 7.2666, Accuracy: 0.0604, Perplexity: 1431.7163
2024-12-31 22:54:59,538 - TrainingLogger - INFO - Step 36320, Batch metrics: Loss: 7.6622, Accuracy: 0.0724, Perplexity: 2126.3807
2024-12-31 22:55:06,513 - TrainingLogger - INFO - Step 36330, Batch metrics: Loss: 6.9917, Accuracy: 0.1022, Perplexity: 1087.5773
2024-12-31 22:55:14,213 - TrainingLogger - INFO - Step 36340, Batch metrics: Loss: 7.2195, Accuracy: 0.0681, Perplexity: 1365.7507
2024-12-31 22:55:21,584 - TrainingLogger - INFO - Step 36350, Batch metrics: Loss: 7.4736, Accuracy: 0.0850, Perplexity: 1760.9698
2024-12-31 22:55:28,478 - TrainingLogger - INFO - Step 36360, Batch metrics: Loss: 7.4814, Accuracy: 0.0606, Perplexity: 1774.7186
2024-12-31 22:55:35,378 - TrainingLogger - INFO - Step 36370, Batch metrics: Loss: 6.7258, Accuracy: 0.1045, Perplexity: 833.6172
2024-12-31 22:55:42,616 - TrainingLogger - INFO - Step 36380, Batch metrics: Loss: 7.3898, Accuracy: 0.1150, Perplexity: 1619.3267
2024-12-31 22:55:49,840 - TrainingLogger - INFO - Step 36390, Batch metrics: Loss: 7.4405, Accuracy: 0.0746, Perplexity: 1703.6079
2024-12-31 22:55:57,138 - TrainingLogger - INFO - Step 36400, Batch metrics: Loss: 7.1004, Accuracy: 0.0667, Perplexity: 1212.4855
2024-12-31 22:55:57,139 - TrainingLogger - INFO - Step 36400, Prediction vs Actual:
2024-12-31 22:55:57,139 - TrainingLogger - INFO - Input 1: לגבי נתניהו, שווה להתעכב על המהלך האחרון
2024-12-31 22:55:57,139 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:55:57,139 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הוא            | ▁לגבי        | ✗     |
|     1 | ▁-              | ▁נתנ         | ✗     |
|     2 | ▁-              | יהו          | ✗     |
|     3 | ?               | ,            | ✗     |
|     4 | ▁הוא            | ▁שווה        | ✗     |
|     5 | ▁-              | ▁לה          | ✗     |
|     6 | ורי             | תעכב         | ✗     |
|     7 | ▁על             | ▁על          | ✓     |
|     8 | ▁זה             | ▁המהלך       | ✗     |
|     9 | ▁הזה            | ▁האחרון      | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | ▁על             | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | ▁הוא            | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁הוא            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           |              | ✗     |

2024-12-31 22:55:57,139 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:55:57,144 - TrainingLogger - INFO - Gradient norm: 8.5772
2024-12-31 22:56:03,971 - TrainingLogger - INFO - Step 36410, Batch metrics: Loss: 7.5954, Accuracy: 0.0519, Perplexity: 1988.9861
2024-12-31 22:56:11,455 - TrainingLogger - INFO - Step 36420, Batch metrics: Loss: 7.5023, Accuracy: 0.0730, Perplexity: 1812.1863
2024-12-31 22:56:18,913 - TrainingLogger - INFO - Step 36430, Batch metrics: Loss: 7.7361, Accuracy: 0.0612, Perplexity: 2289.4455
2024-12-31 22:56:25,727 - TrainingLogger - INFO - Step 36440, Batch metrics: Loss: 7.6294, Accuracy: 0.0828, Perplexity: 2057.7802
2024-12-31 22:56:32,911 - TrainingLogger - INFO - Step 36450, Batch metrics: Loss: 7.4823, Accuracy: 0.0635, Perplexity: 1776.2425
2024-12-31 22:56:39,679 - TrainingLogger - INFO - Step 36460, Batch metrics: Loss: 7.2490, Accuracy: 0.0777, Perplexity: 1406.6855
2024-12-31 22:56:47,394 - TrainingLogger - INFO - Step 36470, Batch metrics: Loss: 7.6712, Accuracy: 0.0505, Perplexity: 2145.6358
2024-12-31 22:56:54,576 - TrainingLogger - INFO - Step 36480, Batch metrics: Loss: 7.3640, Accuracy: 0.0629, Perplexity: 1578.2108
2024-12-31 22:57:01,704 - TrainingLogger - INFO - Step 36490, Batch metrics: Loss: 6.8333, Accuracy: 0.0977, Perplexity: 928.2363
2024-12-31 22:57:09,452 - TrainingLogger - INFO - Step 36500, Batch metrics: Loss: 6.9907, Accuracy: 0.1081, Perplexity: 1086.4468
2024-12-31 22:57:09,453 - TrainingLogger - INFO - Step 36500, Prediction vs Actual:
2024-12-31 22:57:09,453 - TrainingLogger - INFO - Input 1: הם חוו חוויה אחרת, ובכל זאת הרוח שלהם לא נשברה
2024-12-31 22:57:09,453 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:57:09,453 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הם          | ✗     |
|     1 | ▁-              | ▁חוו         | ✗     |
|     2 | ▁-              | ▁חוויה       | ✗     |
|     3 | ▁-              | ▁אחרת        | ✗     |
|     4 | ▁כן             | ,            | ✗     |
|     5 | <pad>           | ▁ובכל        | ✗     |
|     6 | ▁זאת            | ▁זאת         | ✓     |
|     7 | ,               | ▁הרוח        | ✗     |
|     8 | .               | ▁שלהם        | ✗     |
|     9 | .               | ▁לא          | ✗     |
|    10 | ▁היה            | ▁נשבר        | ✗     |
|    11 | ה               | ה            | ✓     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ▁נכון           | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ▁לא             | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁נכון           | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ▁אז             | <pad>        | ✗     |
|    35 | ▁זה             | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ,               |              | ✗     |

2024-12-31 22:57:09,453 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:57:09,458 - TrainingLogger - INFO - Gradient norm: 7.5410
2024-12-31 22:57:16,142 - TrainingLogger - INFO - Step 36510, Batch metrics: Loss: 7.2752, Accuracy: 0.0988, Perplexity: 1443.9902
2024-12-31 22:57:22,862 - TrainingLogger - INFO - Step 36520, Batch metrics: Loss: 7.4033, Accuracy: 0.0538, Perplexity: 1641.4348
2024-12-31 22:57:30,652 - TrainingLogger - INFO - Step 36530, Batch metrics: Loss: 6.8783, Accuracy: 0.0959, Perplexity: 971.0115
2024-12-31 22:57:37,789 - TrainingLogger - INFO - Step 36540, Batch metrics: Loss: 7.7798, Accuracy: 0.0602, Perplexity: 2391.7107
2024-12-31 22:57:44,739 - TrainingLogger - INFO - Step 36550, Batch metrics: Loss: 7.8540, Accuracy: 0.0667, Perplexity: 2575.9628
2024-12-31 22:57:51,310 - TrainingLogger - INFO - Step 36560, Batch metrics: Loss: 7.7550, Accuracy: 0.0542, Perplexity: 2333.1061
2024-12-31 22:57:57,821 - TrainingLogger - INFO - Step 36570, Batch metrics: Loss: 7.6374, Accuracy: 0.1040, Perplexity: 2074.3359
2024-12-31 22:58:04,960 - TrainingLogger - INFO - Step 36580, Batch metrics: Loss: 7.5639, Accuracy: 0.0701, Perplexity: 1927.2961
2024-12-31 22:58:12,324 - TrainingLogger - INFO - Step 36590, Batch metrics: Loss: 7.4455, Accuracy: 0.0824, Perplexity: 1712.1344
2024-12-31 22:58:20,008 - TrainingLogger - INFO - Step 36600, Batch metrics: Loss: 7.0291, Accuracy: 0.0850, Perplexity: 1129.0597
2024-12-31 22:58:20,008 - TrainingLogger - INFO - Step 36600, Prediction vs Actual:
2024-12-31 22:58:20,008 - TrainingLogger - INFO - Input 1: במילים אחרות מישהו לא דאג ליום שאחרי
2024-12-31 22:58:20,009 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:58:20,009 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁במילים      | ✗     |
|     1 | :               | ▁אחרות       | ✗     |
|     2 | ,               | ▁מישהו       | ✗     |
|     3 | ▁אחר            | ▁לא          | ✗     |
|     4 | ▁היה            | ▁דאג         | ✗     |
|     5 | ▁לזה            | ▁ליום        | ✗     |
|     6 | ▁אחד            | ▁שאחרי       | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | ▁לי             | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ,               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁לא             | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | ,               | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | ,               | <pad>        | ✗     |
|    45 | ,               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | ,               |              | ✗     |

2024-12-31 22:58:20,009 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:58:20,014 - TrainingLogger - INFO - Gradient norm: 8.0746
2024-12-31 22:58:27,089 - TrainingLogger - INFO - Step 36610, Batch metrics: Loss: 7.3365, Accuracy: 0.1134, Perplexity: 1535.3051
2024-12-31 22:58:34,143 - TrainingLogger - INFO - Step 36620, Batch metrics: Loss: 7.2694, Accuracy: 0.1059, Perplexity: 1435.6595
2024-12-31 22:58:41,507 - TrainingLogger - INFO - Step 36630, Batch metrics: Loss: 7.4228, Accuracy: 0.0921, Perplexity: 1673.7350
2024-12-31 22:58:48,441 - TrainingLogger - INFO - Step 36640, Batch metrics: Loss: 7.2248, Accuracy: 0.0809, Perplexity: 1373.0988
2024-12-31 22:58:55,419 - TrainingLogger - INFO - Step 36650, Batch metrics: Loss: 7.2909, Accuracy: 0.1141, Perplexity: 1466.8774
2024-12-31 22:59:02,283 - TrainingLogger - INFO - Step 36660, Batch metrics: Loss: 7.1039, Accuracy: 0.0980, Perplexity: 1216.6826
2024-12-31 22:59:09,919 - TrainingLogger - INFO - Step 36670, Batch metrics: Loss: 7.4722, Accuracy: 0.0542, Perplexity: 1758.4952
2024-12-31 22:59:17,257 - TrainingLogger - INFO - Step 36680, Batch metrics: Loss: 7.6813, Accuracy: 0.0743, Perplexity: 2167.3367
2024-12-31 22:59:24,579 - TrainingLogger - INFO - Step 36690, Batch metrics: Loss: 6.9996, Accuracy: 0.0750, Perplexity: 1096.1783
2024-12-31 22:59:31,350 - TrainingLogger - INFO - Step 36700, Batch metrics: Loss: 7.0237, Accuracy: 0.0812, Perplexity: 1122.8827
2024-12-31 22:59:31,350 - TrainingLogger - INFO - Step 36700, Prediction vs Actual:
2024-12-31 22:59:31,350 - TrainingLogger - INFO - Input 1: המחבל עצמו פונה לבית החולים סורוקה בבאר שבע עם חבלות בישבנו, ובעקבות כך נפתחה החקירה בחשד להתעללות
2024-12-31 22:59:31,351 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 22:59:31,351 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁המ          | ✗     |
|     1 | ▁-              | חבל          | ✗     |
|     2 | ▁-              | ▁עצמו        | ✗     |
|     3 | ▁-              | ▁פונה        | ✗     |
|     4 | ▁אליו           | ▁לבית        | ✗     |
|     5 | ▁המשפט          | ▁החולים      | ✗     |
|     6 | .               | ▁סור         | ✗     |
|     7 | יה              | וקה          | ✗     |
|     8 | .               | ▁בבאר        | ✗     |
|     9 | ה               | ▁שבע         | ✗     |
|    10 | ▁עיניים         | ▁עם          | ✗     |
|    11 | ▁ישראל          | ▁חבל         | ✗     |
|    12 | ה               | ות           | ✗     |
|    13 | ▁דם             | ▁ביש         | ✗     |
|    14 | .               | בנו          | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁ובעקבות     | ✗     |
|    17 | ▁זאת            | ▁כך          | ✗     |
|    18 | ,               | ▁נפתחה       | ✗     |
|    19 | ▁מסיבה          | ▁החקירה      | ✗     |
|    20 | .               | ▁ב           | ✗     |
|    21 | -19             | חשד          | ✗     |
|    22 | נות             | ▁ל           | ✗     |
|    23 | ...             | התעללות      | ✗     |
|    24 | ▁ב              | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ▁ב              | <pad>        | ✗     |
|    27 | ית              | <pad>        | ✗     |
|    28 | ית              | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | ▁ב              | <pad>        | ✗     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | .               | <pad>        | ✗     |
|    51 | </s>            | <pad>        | ✗     |
|    52 | </s>            | <pad>        | ✗     |
|    53 | </s>            | <pad>        | ✗     |
|    54 | </s>            | <pad>        | ✗     |
|    55 | </s>            | <pad>        | ✗     |
|    56 | .               | <pad>        | ✗     |
|    57 | </s>            |              | ✗     |

2024-12-31 22:59:31,351 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 22:59:31,356 - TrainingLogger - INFO - Gradient norm: 7.4766
2024-12-31 22:59:38,480 - TrainingLogger - INFO - Step 36710, Batch metrics: Loss: 6.9438, Accuracy: 0.0985, Perplexity: 1036.7437
2024-12-31 22:59:45,647 - TrainingLogger - INFO - Step 36720, Batch metrics: Loss: 7.2259, Accuracy: 0.0642, Perplexity: 1374.6226
2024-12-31 22:59:52,325 - TrainingLogger - INFO - Step 36730, Batch metrics: Loss: 7.0633, Accuracy: 0.0795, Perplexity: 1168.3049
2024-12-31 22:59:59,735 - TrainingLogger - INFO - Step 36740, Batch metrics: Loss: 7.1188, Accuracy: 0.1011, Perplexity: 1235.0043
2024-12-31 23:00:06,565 - TrainingLogger - INFO - Step 36750, Batch metrics: Loss: 7.2828, Accuracy: 0.1071, Perplexity: 1455.0478
2024-12-31 23:00:13,780 - TrainingLogger - INFO - Step 36760, Batch metrics: Loss: 7.7652, Accuracy: 0.0471, Perplexity: 2357.1010
2024-12-31 23:00:21,272 - TrainingLogger - INFO - Step 36770, Batch metrics: Loss: 7.6698, Accuracy: 0.0823, Perplexity: 2142.6790
2024-12-31 23:00:28,328 - TrainingLogger - INFO - Step 36780, Batch metrics: Loss: 7.0597, Accuracy: 0.1000, Perplexity: 1164.1531
2024-12-31 23:00:35,398 - TrainingLogger - INFO - Step 36790, Batch metrics: Loss: 7.3557, Accuracy: 0.0615, Perplexity: 1565.0571
2024-12-31 23:00:42,246 - TrainingLogger - INFO - Step 36800, Batch metrics: Loss: 7.5850, Accuracy: 0.0400, Perplexity: 1968.4608
2024-12-31 23:00:42,246 - TrainingLogger - INFO - Step 36800, Prediction vs Actual:
2024-12-31 23:00:42,246 - TrainingLogger - INFO - Input 1: עכשיו בפעם השלישית הם עושים זאת שוב בהונאה שלא הייתה כדוגמתה
2024-12-31 23:00:42,247 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:00:42,247 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עכשיו       | ✗     |
|     1 | ▁כן             | ▁בפעם        | ✗     |
|     2 | ▁-              | ▁השלישית     | ✗     |
|     3 | .               | ▁הם          | ✗     |
|     4 | ▁היו            | ▁עושים       | ✗     |
|     5 | ▁את             | ▁זאת         | ✗     |
|     6 | .               | ▁שוב         | ✗     |
|     7 | .               | ▁ב           | ✗     |
|     8 | חזר             | הונאה        | ✗     |
|     9 | .               | ▁שלא         | ✗     |
|    10 | ▁הייתה          | ▁הייתה       | ✓     |
|    11 | ▁להם            | ▁כדוגמת      | ✗     |
|    12 | ם               | ה            | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | .               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           |              | ✗     |

2024-12-31 23:00:42,247 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:00:42,252 - TrainingLogger - INFO - Gradient norm: 9.1393
2024-12-31 23:00:49,220 - TrainingLogger - INFO - Step 36810, Batch metrics: Loss: 7.9271, Accuracy: 0.0596, Perplexity: 2771.4355
2024-12-31 23:00:56,246 - TrainingLogger - INFO - Step 36820, Batch metrics: Loss: 7.4958, Accuracy: 0.0845, Perplexity: 1800.4612
2024-12-31 23:01:03,972 - TrainingLogger - INFO - Step 36830, Batch metrics: Loss: 7.2524, Accuracy: 0.0757, Perplexity: 1411.5340
2024-12-31 23:01:11,670 - TrainingLogger - INFO - Step 36840, Batch metrics: Loss: 7.5602, Accuracy: 0.0583, Perplexity: 1920.2107
2024-12-31 23:01:18,666 - TrainingLogger - INFO - Step 36850, Batch metrics: Loss: 7.9252, Accuracy: 0.0333, Perplexity: 2766.0423
2024-12-31 23:01:26,105 - TrainingLogger - INFO - Step 36860, Batch metrics: Loss: 7.4336, Accuracy: 0.0650, Perplexity: 1691.8736
2024-12-31 23:01:33,149 - TrainingLogger - INFO - Step 36870, Batch metrics: Loss: 7.4132, Accuracy: 0.0847, Perplexity: 1657.7667
2024-12-31 23:01:40,125 - TrainingLogger - INFO - Step 36880, Batch metrics: Loss: 7.2730, Accuracy: 0.0966, Perplexity: 1440.8202
2024-12-31 23:01:47,477 - TrainingLogger - INFO - Step 36890, Batch metrics: Loss: 7.5431, Accuracy: 0.0777, Perplexity: 1887.6914
2024-12-31 23:01:54,559 - TrainingLogger - INFO - Step 36900, Batch metrics: Loss: 7.1978, Accuracy: 0.0743, Perplexity: 1336.5206
2024-12-31 23:01:54,560 - TrainingLogger - INFO - Step 36900, Prediction vs Actual:
2024-12-31 23:01:54,560 - TrainingLogger - INFO - Input 1: חכ איימן עודה אמר אנו לא ממליצים על אף אחד
2024-12-31 23:01:54,560 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:01:54,560 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ח           | ✗     |
|     1 | ▁-              | כ            | ✗     |
|     2 | </s>            | ▁איי         | ✗     |
|     3 | ▁-              | מן           | ✗     |
|     4 | ▁-              | ▁עוד         | ✗     |
|     5 | ▁לא             | ה            | ✗     |
|     6 | ▁-              | ▁אמר         | ✗     |
|     7 | ▁לך             | ▁אנו         | ✗     |
|     8 | ▁לא             | ▁לא          | ✓     |
|     9 | ▁יכולים         | ▁ממליצים     | ✗     |
|    10 | ▁לך             | ▁על          | ✗     |
|    11 | ▁זה             | ▁אף          | ✗     |
|    12 | ▁אחד            | ▁אחד         | ✓     |
|    13 | ▁מאיתנו         | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ▁לא             | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁לא             | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           |              | ✗     |

2024-12-31 23:01:54,560 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:01:54,565 - TrainingLogger - INFO - Gradient norm: 9.9676
2024-12-31 23:02:01,816 - TrainingLogger - INFO - Step 36910, Batch metrics: Loss: 7.7344, Accuracy: 0.0343, Perplexity: 2285.6593
2024-12-31 23:02:08,786 - TrainingLogger - INFO - Step 36920, Batch metrics: Loss: 6.9881, Accuracy: 0.0861, Perplexity: 1083.6730
2024-12-31 23:02:16,272 - TrainingLogger - INFO - Step 36930, Batch metrics: Loss: 7.0687, Accuracy: 0.1154, Perplexity: 1174.6422
2024-12-31 23:02:23,215 - TrainingLogger - INFO - Step 36940, Batch metrics: Loss: 7.3498, Accuracy: 0.0993, Perplexity: 1555.9256
2024-12-31 23:02:29,642 - TrainingLogger - INFO - Step 36950, Batch metrics: Loss: 7.4691, Accuracy: 0.0684, Perplexity: 1752.9990
2024-12-31 23:02:36,929 - TrainingLogger - INFO - Step 36960, Batch metrics: Loss: 7.4009, Accuracy: 0.1047, Perplexity: 1637.4940
2024-12-31 23:02:43,653 - TrainingLogger - INFO - Step 36970, Batch metrics: Loss: 7.5439, Accuracy: 0.0641, Perplexity: 1889.2628
2024-12-31 23:02:48,084 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 279552
2024-12-31 23:02:48,084 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 279552

2024-12-31 23:02:48,084 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 39]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 43]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 40]), device: cuda:0
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 23:02:48,085 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 23:02:51,803 - TrainingLogger - INFO - Step 36980, Batch metrics: Loss: 7.7028, Accuracy: 0.0483, Perplexity: 2214.5649
2024-12-31 23:02:59,296 - TrainingLogger - INFO - Step 36990, Batch metrics: Loss: 7.2653, Accuracy: 0.0619, Perplexity: 1429.7610
2024-12-31 23:03:06,802 - TrainingLogger - INFO - Step 37000, Batch metrics: Loss: 7.3841, Accuracy: 0.0765, Perplexity: 1610.1142
2024-12-31 23:03:06,802 - TrainingLogger - INFO - Step 37000, Prediction vs Actual:
2024-12-31 23:03:06,802 - TrainingLogger - INFO - Input 1: על משפיעני רשת שמצטלמים ברצועת עזה, ולעיתים מפרסמים משם מסרים ניציים שמשמשים תעמולה אנטי-ישראלית, הגרי אמר אין משפיענים מבחינתי, לפחות בדובר צהל, שאנחנו שולחים לעזה
2024-12-31 23:03:06,803 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:03:06,803 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁על          | ✗     |
|     1 | ▁-              | ▁משפיע       | ✗     |
|     2 | .               | ני           | ✗     |
|     3 | ר               | ▁רשת         | ✗     |
|     4 | ▁זו             | ▁ש           | ✗     |
|     5 | וח              | מצ           | ✗     |
|     6 | ט               | ט            | ✓     |
|     7 | יין             | למים         | ✗     |
|     8 | ▁ב              | ▁ב           | ✓     |
|     9 | -               | רצו          | ✗     |
|    10 | ח               | עת           | ✗     |
|    11 | ▁הטבע           | ▁עזה         | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁ו           | ✗     |
|    14 | ...             | לעיתים       | ✗     |
|    15 | ▁קרובות         | ▁מפר         | ✗     |
|    16 | כים             | סמים         | ✗     |
|    17 | ▁את             | ▁משם         | ✗     |
|    18 | ▁את             | ▁מסר         | ✗     |
|    19 | ים              | ים           | ✓     |
|    20 | ▁רבים           | ▁ניצ         | ✗     |
|    21 | ניים            | יים          | ✗     |
|    22 | ,               | ▁שמש         | ✗     |
|    23 | ים              | מש           | ✗     |
|    24 | ים              | ים           | ✓     |
|    25 | ▁כ              | ▁תעמולה      | ✗     |
|    26 | ,               | ▁אנטי        | ✗     |
|    27 | שמי             | -            | ✗     |
|    28 | כל              | ישראל        | ✗     |
|    29 | יים             | ית           | ✗     |
|    30 | ,               | ,            | ✓     |
|    31 | </s>            | ▁הגר         | ✗     |
|    32 | מה              | י            | ✗     |
|    33 | ונים            | ▁אמר         | ✗     |
|    34 | ▁"              | ▁אין         | ✗     |
|    35 | -               | ▁משפיע       | ✗     |
|    36 | ▁על             | נים          | ✗     |
|    37 | .               | ▁מבחינתי     | ✗     |
|    38 | .               | ,            | ✗     |
|    39 | </s>            | ▁לפחות       | ✗     |
|    40 | ▁הם             | ▁ב           | ✗     |
|    41 | פס              | דובר         | ✗     |
|    42 | ות              | ▁צ           | ✗     |
|    43 | '               | הל           | ✗     |
|    44 | יפים            | ,            | ✗     |
|    45 | </s>            | ▁שאנחנו      | ✗     |
|    46 | ▁עובדים         | ▁שולחים      | ✗     |
|    47 | ▁אותם           | ▁לעז         | ✗     |
|    48 | י               | ה            | ✗     |
|    49 | .               |              | ✗     |

2024-12-31 23:03:06,803 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:03:06,808 - TrainingLogger - INFO - Gradient norm: 8.8392
2024-12-31 23:03:13,593 - TrainingLogger - INFO - Step 37010, Batch metrics: Loss: 7.1810, Accuracy: 0.0802, Perplexity: 1314.1689
2024-12-31 23:03:20,707 - TrainingLogger - INFO - Step 37020, Batch metrics: Loss: 7.7091, Accuracy: 0.0862, Perplexity: 2228.4501
2024-12-31 23:03:27,424 - TrainingLogger - INFO - Step 37030, Batch metrics: Loss: 7.1423, Accuracy: 0.0804, Perplexity: 1264.3380
2024-12-31 23:03:34,660 - TrainingLogger - INFO - Step 37040, Batch metrics: Loss: 7.9934, Accuracy: 0.0730, Perplexity: 2961.3756
2024-12-31 23:03:41,898 - TrainingLogger - INFO - Step 37050, Batch metrics: Loss: 7.0246, Accuracy: 0.0769, Perplexity: 1123.9819
2024-12-31 23:03:48,639 - TrainingLogger - INFO - Step 37060, Batch metrics: Loss: 7.5137, Accuracy: 0.0559, Perplexity: 1832.8939
2024-12-31 23:03:56,198 - TrainingLogger - INFO - Step 37070, Batch metrics: Loss: 7.5109, Accuracy: 0.0621, Perplexity: 1827.8370
2024-12-31 23:04:03,460 - TrainingLogger - INFO - Step 37080, Batch metrics: Loss: 7.4505, Accuracy: 0.0845, Perplexity: 1720.6987
2024-12-31 23:04:11,311 - TrainingLogger - INFO - Step 37090, Batch metrics: Loss: 7.3795, Accuracy: 0.1067, Perplexity: 1602.8194
2024-12-31 23:04:18,842 - TrainingLogger - INFO - Step 37100, Batch metrics: Loss: 7.0744, Accuracy: 0.0979, Perplexity: 1181.3113
2024-12-31 23:04:18,843 - TrainingLogger - INFO - Step 37100, Prediction vs Actual:
2024-12-31 23:04:18,843 - TrainingLogger - INFO - Input 1: נתניהו פנה ברגע האחרון למפלגות החרדיות ולישראל ביתנועם הצעת פשרה לחוק הגיוס, לפיה החוק המקורי יעלה כלשונו לאישור מחדש על-ידי מליאת הכנסת, ולאחר מכן יעלה לקריאה שנייה ושלישית בהסכמה משותפת
2024-12-31 23:04:18,843 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:04:18,843 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁נתנ         | ✗     |
|     1 | ▁-              | יהו          | ✗     |
|     2 | ▁-              | ▁פנה         | ✗     |
|     3 | ▁לו             | ▁ברגע        | ✗     |
|     4 | ▁האחרון         | ▁האחרון      | ✓     |
|     5 | .               | ▁למ          | ✗     |
|     6 | שרה             | פלג          | ✗     |
|     7 | ה               | ות           | ✗     |
|     8 | ▁הראשונות       | ▁החר         | ✗     |
|     9 | ניות            | די           | ✗     |
|    10 | ות              | ות           | ✓     |
|    11 | ▁האלה           | ▁ול          | ✗     |
|    12 | חדשות           | ישראל        | ✗     |
|    13 | ▁יש             | ▁ביתנו       | ✗     |
|    14 | ת               | עם           | ✗     |
|    15 | ה               | ▁הצעת        | ✗     |
|    16 | ▁החוק           | ▁פשר         | ✗     |
|    17 | ות              | ה            | ✗     |
|    18 | ▁חדשה           | ▁לחוק        | ✗     |
|    19 | ה               | ▁הגיוס       | ✗     |
|    20 | ים              | ,            | ✗     |
|    21 | <pad>           | ▁לפי         | ✗     |
|    22 | ית              | ה            | ✗     |
|    23 | ▁הוא            | ▁החוק        | ✗     |
|    24 | ה               | ▁המקורי      | ✗     |
|    25 | ות              | ▁יעלה        | ✗     |
|    26 | ▁לשלטון         | ▁כ           | ✗     |
|    27 | חוק             | לשונו        | ✗     |
|    28 | ת               | ▁לאישור      | ✗     |
|    29 | ים              | ▁מחדש        | ✗     |
|    30 | .               | ▁על          | ✗     |
|    31 | ▁כך             | -            | ✗     |
|    32 | ידי             | ידי          | ✓     |
|    33 | ▁המדינה         | ▁מ           | ✗     |
|    34 | ועצת            | ליאת         | ✗     |
|    35 | ▁המלחמה         | ▁הכנסת       | ✗     |
|    36 | ▁ה              | ,            | ✗     |
|    37 | <pad>           | ▁ולאחר       | ✗     |
|    38 | ▁מכן            | ▁מכן         | ✓     |
|    39 | ,               | ▁יעלה        | ✗     |
|    40 | ▁על             | ▁לקריאה      | ✗     |
|    41 | .               | ▁שנייה       | ✗     |
|    42 | ▁נוספת          | ▁ו           | ✗     |
|    43 | בחזרה           | שלישי        | ✗     |
|    44 | ת               | ת            | ✓     |
|    45 | ▁לכך            | ▁בה          | ✗     |
|    46 | מ               | ס            | ✗     |
|    47 | כמה             | כמה          | ✓     |
|    48 | ▁על             | ▁משותפת      | ✗     |
|    49 | .               |              | ✗     |

2024-12-31 23:04:18,843 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:04:18,848 - TrainingLogger - INFO - Gradient norm: 8.2514
2024-12-31 23:04:25,687 - TrainingLogger - INFO - Step 37110, Batch metrics: Loss: 7.4971, Accuracy: 0.0805, Perplexity: 1802.8047
2024-12-31 23:04:32,815 - TrainingLogger - INFO - Step 37120, Batch metrics: Loss: 7.1357, Accuracy: 0.0699, Perplexity: 1255.9743
2024-12-31 23:04:39,767 - TrainingLogger - INFO - Step 37130, Batch metrics: Loss: 7.4649, Accuracy: 0.0333, Perplexity: 1745.6244
2024-12-31 23:04:47,221 - TrainingLogger - INFO - Step 37140, Batch metrics: Loss: 7.8478, Accuracy: 0.0452, Perplexity: 2560.0587
2024-12-31 23:04:54,134 - TrainingLogger - INFO - Step 37150, Batch metrics: Loss: 7.1965, Accuracy: 0.0789, Perplexity: 1334.6966
2024-12-31 23:05:01,003 - TrainingLogger - INFO - Step 37160, Batch metrics: Loss: 7.4965, Accuracy: 0.0625, Perplexity: 1801.7219
2024-12-31 23:05:07,960 - TrainingLogger - INFO - Step 37170, Batch metrics: Loss: 7.3285, Accuracy: 0.0650, Perplexity: 1523.0690
2024-12-31 23:05:15,494 - TrainingLogger - INFO - Step 37180, Batch metrics: Loss: 7.4624, Accuracy: 0.0503, Perplexity: 1741.2416
2024-12-31 23:05:22,250 - TrainingLogger - INFO - Step 37190, Batch metrics: Loss: 7.5521, Accuracy: 0.0573, Perplexity: 1904.7452
2024-12-31 23:05:29,534 - TrainingLogger - INFO - Step 37200, Batch metrics: Loss: 7.2316, Accuracy: 0.0702, Perplexity: 1382.4950
2024-12-31 23:05:29,535 - TrainingLogger - INFO - Step 37200, Prediction vs Actual:
2024-12-31 23:05:29,535 - TrainingLogger - INFO - Input 1: בלינקן הדגיש את מחויבותה של ארהב לביטחון ישראל, כולל הבטחה ש-7 באוקטובר לעולם לא יחזור על עצמו
2024-12-31 23:05:29,535 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:05:29,535 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בלי         | ✗     |
|     1 | .               | נקן          | ✗     |
|     2 | ה               | ▁הדגיש       | ✗     |
|     3 | ▁אז             | ▁את          | ✗     |
|     4 | ▁זה             | ▁מחויבות     | ✗     |
|     5 | ▁-              | ה            | ✗     |
|     6 | ▁של             | ▁של          | ✓     |
|     7 | ▁אליס           | ▁ארה         | ✗     |
|     8 | ב               | ב            | ✓     |
|     9 | .               | ▁לביטחון     | ✗     |
|    10 | ▁המדינה         | ▁ישראל       | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | </s>            | ▁כולל        | ✗     |
|    13 | ▁את             | ▁הבטחה       | ✗     |
|    14 | ▁גדולה          | ▁ש           | ✗     |
|    15 | עבור            | -7           | ✗     |
|    16 | ▁בנובמבר        | ▁באוקטובר    | ✗     |
|    17 | ,               | ▁לעולם       | ✗     |
|    18 | ▁לא             | ▁לא          | ✓     |
|    19 | ▁תהיה           | ▁יחזור       | ✗     |
|    20 | .               | ▁על          | ✗     |
|    21 | ▁עצמה           | ▁עצמו        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 23:05:29,535 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:05:29,540 - TrainingLogger - INFO - Gradient norm: 8.3531
2024-12-31 23:05:36,574 - TrainingLogger - INFO - Step 37210, Batch metrics: Loss: 7.5440, Accuracy: 0.0600, Perplexity: 1889.2808
2024-12-31 23:05:43,609 - TrainingLogger - INFO - Step 37220, Batch metrics: Loss: 7.4149, Accuracy: 0.0575, Perplexity: 1660.6133
2024-12-31 23:05:50,208 - TrainingLogger - INFO - Step 37230, Batch metrics: Loss: 7.3200, Accuracy: 0.0667, Perplexity: 1510.1315
2024-12-31 23:05:57,890 - TrainingLogger - INFO - Step 37240, Batch metrics: Loss: 7.5156, Accuracy: 0.0859, Perplexity: 1836.4326
2024-12-31 23:06:05,356 - TrainingLogger - INFO - Step 37250, Batch metrics: Loss: 7.1149, Accuracy: 0.0995, Perplexity: 1230.2082
2024-12-31 23:06:12,172 - TrainingLogger - INFO - Step 37260, Batch metrics: Loss: 7.3515, Accuracy: 0.0674, Perplexity: 1558.5817
2024-12-31 23:06:19,243 - TrainingLogger - INFO - Step 37270, Batch metrics: Loss: 7.1162, Accuracy: 0.0843, Perplexity: 1231.7708
2024-12-31 23:06:26,310 - TrainingLogger - INFO - Step 37280, Batch metrics: Loss: 7.3692, Accuracy: 0.0755, Perplexity: 1586.3335
2024-12-31 23:06:33,240 - TrainingLogger - INFO - Step 37290, Batch metrics: Loss: 7.2646, Accuracy: 0.1046, Perplexity: 1428.7967
2024-12-31 23:06:40,538 - TrainingLogger - INFO - Step 37300, Batch metrics: Loss: 7.7680, Accuracy: 0.0629, Perplexity: 2363.6672
2024-12-31 23:06:40,539 - TrainingLogger - INFO - Step 37300, Prediction vs Actual:
2024-12-31 23:06:40,539 - TrainingLogger - INFO - Input 1: יש לקוות כי יהיו מי שיישאו גם את הדגל הזה בכל ממשלה שתקום
2024-12-31 23:06:40,539 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:06:40,539 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁יש          | ✗     |
|     1 | ▁-              | ▁לקוות       | ✗     |
|     2 | ▁-              | ▁כי          | ✗     |
|     3 | ▁-              | ▁יהיו        | ✗     |
|     4 | ▁לך             | ▁מי          | ✗     |
|     5 | ▁ייתן           | ▁שי          | ✗     |
|     6 | כתוב            | יש           | ✗     |
|     7 | מש              | או           | ✗     |
|     8 | ▁לו             | ▁גם          | ✗     |
|     9 | ▁לך             | ▁את          | ✗     |
|    10 | ▁זה             | ▁הדגל        | ✗     |
|    11 | ים              | ▁הזה         | ✗     |
|    12 | .               | ▁בכל         | ✗     |
|    13 | ▁יום            | ▁ממשלה       | ✗     |
|    14 | ▁אחרת           | ▁שתקו        | ✗     |
|    15 | עה              | ם            | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | .               |              | ✗     |

2024-12-31 23:06:40,539 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:06:40,544 - TrainingLogger - INFO - Gradient norm: 9.8052
2024-12-31 23:06:47,315 - TrainingLogger - INFO - Step 37310, Batch metrics: Loss: 7.2197, Accuracy: 0.0870, Perplexity: 1366.1181
2024-12-31 23:06:54,177 - TrainingLogger - INFO - Step 37320, Batch metrics: Loss: 6.7399, Accuracy: 0.1111, Perplexity: 845.4420
2024-12-31 23:07:00,442 - TrainingLogger - INFO - Step 37330, Batch metrics: Loss: 7.3954, Accuracy: 0.0714, Perplexity: 1628.4328
2024-12-31 23:07:07,247 - TrainingLogger - INFO - Step 37340, Batch metrics: Loss: 7.5262, Accuracy: 0.0556, Perplexity: 1855.9547
2024-12-31 23:07:14,537 - TrainingLogger - INFO - Step 37350, Batch metrics: Loss: 6.5499, Accuracy: 0.1604, Perplexity: 699.1616
2024-12-31 23:07:21,936 - TrainingLogger - INFO - Step 37360, Batch metrics: Loss: 7.1711, Accuracy: 0.1084, Perplexity: 1301.2481
2024-12-31 23:07:29,018 - TrainingLogger - INFO - Step 37370, Batch metrics: Loss: 7.2387, Accuracy: 0.0596, Perplexity: 1392.3219
2024-12-31 23:07:35,531 - TrainingLogger - INFO - Step 37380, Batch metrics: Loss: 7.4855, Accuracy: 0.0786, Perplexity: 1782.0597
2024-12-31 23:07:42,619 - TrainingLogger - INFO - Step 37390, Batch metrics: Loss: 7.0513, Accuracy: 0.0876, Perplexity: 1154.3222
2024-12-31 23:07:49,998 - TrainingLogger - INFO - Step 37400, Batch metrics: Loss: 7.4736, Accuracy: 0.1181, Perplexity: 1760.9689
2024-12-31 23:07:49,998 - TrainingLogger - INFO - Step 37400, Prediction vs Actual:
2024-12-31 23:07:49,998 - TrainingLogger - INFO - Input 1: הדוגמה הכי טובה היא בני גנץ
2024-12-31 23:07:49,998 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:07:49,998 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הדוגמה      | ✗     |
|     1 | ית              | ▁הכי         | ✗     |
|     2 | ▁טובה           | ▁טובה        | ✓     |
|     3 | ▁היא            | ▁היא         | ✓     |
|     4 | ▁לא             | ▁בני         | ✗     |
|     5 | ,               | ▁ג           | ✗     |
|     6 | '               | נץ           | ✗     |
|     7 | '               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2024-12-31 23:07:49,998 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:07:50,003 - TrainingLogger - INFO - Gradient norm: 6.9662
2024-12-31 23:07:57,188 - TrainingLogger - INFO - Step 37410, Batch metrics: Loss: 6.8850, Accuracy: 0.0924, Perplexity: 977.5033
2024-12-31 23:08:04,393 - TrainingLogger - INFO - Step 37420, Batch metrics: Loss: 7.7505, Accuracy: 0.0574, Perplexity: 2322.7317
2024-12-31 23:08:11,436 - TrainingLogger - INFO - Step 37430, Batch metrics: Loss: 7.0400, Accuracy: 0.0857, Perplexity: 1141.3876
2024-12-31 23:08:18,547 - TrainingLogger - INFO - Step 37440, Batch metrics: Loss: 7.0583, Accuracy: 0.0741, Perplexity: 1162.4740
2024-12-31 23:08:25,677 - TrainingLogger - INFO - Step 37450, Batch metrics: Loss: 7.0204, Accuracy: 0.0938, Perplexity: 1119.2236
2024-12-31 23:08:33,097 - TrainingLogger - INFO - Step 37460, Batch metrics: Loss: 7.6001, Accuracy: 0.0773, Perplexity: 1998.4501
2024-12-31 23:08:39,813 - TrainingLogger - INFO - Step 37470, Batch metrics: Loss: 7.1066, Accuracy: 0.1067, Perplexity: 1219.9894
2024-12-31 23:08:46,436 - TrainingLogger - INFO - Step 37480, Batch metrics: Loss: 7.3991, Accuracy: 0.0802, Perplexity: 1634.4844
2024-12-31 23:08:53,364 - TrainingLogger - INFO - Step 37490, Batch metrics: Loss: 7.6907, Accuracy: 0.0806, Perplexity: 2187.7972
2024-12-31 23:09:00,105 - TrainingLogger - INFO - Step 37500, Batch metrics: Loss: 7.2925, Accuracy: 0.0667, Perplexity: 1469.2210
2024-12-31 23:09:00,105 - TrainingLogger - INFO - Step 37500, Prediction vs Actual:
2024-12-31 23:09:00,105 - TrainingLogger - INFO - Input 1: אלא שכאן מוסיפה היועצת המשפטית כי נוכח הזמן שחלף ושינוי הנסיבות המשמעותי, הוועדה לא תוכל לאמץ את כל הדיונים הקודמים ולהמשיך מהם אלא אם תמצא הצדקות משכנעות לאימוץ דיון רלוונטי
2024-12-31 23:09:00,106 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:09:00,106 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אלא         | ✗     |
|     1 | ▁-              | ▁שכאן        | ✗     |
|     2 | ▁-              | ▁מוסיפה      | ✗     |
|     3 | ▁לו             | ▁הי          | ✗     |
|     4 | ,               | ועצת         | ✗     |
|     5 | ▁               | ▁המשפטית     | ✗     |
|     6 | ,               | ▁כי          | ✗     |
|     7 | ▁אני            | ▁נוכח        | ✗     |
|     8 | י               | ▁הזמן        | ✗     |
|     9 | ▁הזה            | ▁ש           | ✗     |
|    10 | ניצח            | חלף          | ✗     |
|    11 | ▁מאז            | ▁ו           | ✗     |
|    12 | מצליח           | שינוי        | ✗     |
|    13 | ים              | ▁הנסיבות     | ✗     |
|    14 | ▁הוא            | ▁המשמעות     | ✗     |
|    15 | י               | י            | ✓     |
|    16 | ▁הזה            | ,            | ✗     |
|    17 | </s>            | ▁הוועדה      | ✗     |
|    18 | ▁שלנו           | ▁לא          | ✗     |
|    19 | ▁הייתה          | ▁תוכל        | ✗     |
|    20 | ▁לחזור          | ▁לאמץ        | ✗     |
|    21 | ▁את             | ▁את          | ✓     |
|    22 | ▁זה             | ▁כל          | ✗     |
|    23 | ▁זה             | ▁הדי         | ✗     |
|    24 | עה              | ונים         | ✗     |
|    25 | ▁הללו           | ▁הקודמים     | ✗     |
|    26 | .               | ▁ולהמשיך     | ✗     |
|    27 | ▁הלאה           | ▁מהם         | ✗     |
|    28 | ▁הלאה           | ▁אלא         | ✗     |
|    29 | ▁גם             | ▁אם          | ✗     |
|    30 | ▁הם             | ▁תמצא        | ✗     |
|    31 | ▁אותם           | ▁הצדק        | ✗     |
|    32 | ת               | ות           | ✗     |
|    33 | ▁שלהם           | ▁משכנע       | ✗     |
|    34 | ▁אותם           | ות           | ✗     |
|    35 | ▁אותנו          | ▁לא          | ✗     |
|    36 | ▁ניתן           | י            | ✗     |
|    37 | מוץ             | מוץ          | ✓     |
|    38 | .               | ▁דיון        | ✗     |
|    39 | .               | ▁רלוונטי     | ✗     |
|    40 | ות              |              | ✗     |

2024-12-31 23:09:00,106 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:09:00,111 - TrainingLogger - INFO - Gradient norm: 8.8378
2024-12-31 23:09:07,623 - TrainingLogger - INFO - Step 37510, Batch metrics: Loss: 7.4641, Accuracy: 0.0686, Perplexity: 1744.2898
2024-12-31 23:09:14,166 - TrainingLogger - INFO - Step 37520, Batch metrics: Loss: 6.9644, Accuracy: 0.0938, Perplexity: 1058.2286
2024-12-31 23:09:21,407 - TrainingLogger - INFO - Step 37530, Batch metrics: Loss: 7.4950, Accuracy: 0.0662, Perplexity: 1799.0014
2024-12-31 23:09:28,454 - TrainingLogger - INFO - Step 37540, Batch metrics: Loss: 7.0618, Accuracy: 0.0932, Perplexity: 1166.5258
2024-12-31 23:09:36,354 - TrainingLogger - INFO - Step 37550, Batch metrics: Loss: 7.2082, Accuracy: 0.0856, Perplexity: 1350.4921
2024-12-31 23:09:43,754 - TrainingLogger - INFO - Step 37560, Batch metrics: Loss: 7.2685, Accuracy: 0.0872, Perplexity: 1434.4230
2024-12-31 23:09:50,792 - TrainingLogger - INFO - Step 37570, Batch metrics: Loss: 7.4929, Accuracy: 0.0694, Perplexity: 1795.2523
2024-12-31 23:09:57,595 - TrainingLogger - INFO - Step 37580, Batch metrics: Loss: 6.9448, Accuracy: 0.0920, Perplexity: 1037.6968
2024-12-31 23:10:05,024 - TrainingLogger - INFO - Step 37590, Batch metrics: Loss: 7.2394, Accuracy: 0.0807, Perplexity: 1393.2444
2024-12-31 23:10:12,186 - TrainingLogger - INFO - Step 37600, Batch metrics: Loss: 7.3845, Accuracy: 0.1111, Perplexity: 1610.8775
2024-12-31 23:10:12,186 - TrainingLogger - INFO - Step 37600, Prediction vs Actual:
2024-12-31 23:10:12,186 - TrainingLogger - INFO - Input 1: גון גם הסביר מדוע המשפחה ביקשה לפרסם חלק מהסרטון אי-אפשר לחזור אחורה, זה צריך לעורר סוג של השראה גם למנהיגים ולכל מי שיושב במשא ומתן
2024-12-31 23:10:12,187 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:10:12,187 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁ג           | ✗     |
|     1 | ▁-              | ון           | ✗     |
|     2 | ▁דין            | ▁גם          | ✗     |
|     3 | ▁כן             | ▁הסביר       | ✗     |
|     4 | ▁תודה           | ▁מדוע        | ✗     |
|     5 | ?               | ▁המשפחה      | ✗     |
|     6 | ▁הזאת           | ▁ביקשה       | ✗     |
|     7 | ▁את             | ▁לפרסם       | ✗     |
|     8 | ▁את             | ▁חלק         | ✗     |
|     9 | ▁מה             | ▁מהסרט       | ✗     |
|    10 | ▁"              | ון           | ✗     |
|    11 | ▁הזה            | ▁אי          | ✗     |
|    12 | ▁פעם            | -            | ✗     |
|    13 | פעם             | אפשר         | ✗     |
|    14 | ▁לקבל           | ▁לחזור       | ✗     |
|    15 | ▁בו             | ▁אחורה       | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | <pad>           | ▁זה          | ✗     |
|    18 | ▁לא             | ▁צריך        | ✗     |
|    19 | ▁להיות          | ▁לעורר       | ✗     |
|    20 | ▁את             | ▁סוג         | ✗     |
|    21 | ▁של             | ▁של          | ✓     |
|    22 | ▁כבוד           | ▁השראה       | ✗     |
|    23 | .               | ▁גם          | ✗     |
|    24 | ▁כן             | ▁למנהיג      | ✗     |
|    25 | ה               | ים           | ✗     |
|    26 | ▁אחרים          | ▁ולכל        | ✗     |
|    27 | י               | ▁מי          | ✗     |
|    28 | ת               | ▁שיושב       | ✗     |
|    29 | ▁שם             | ▁במשא        | ✗     |
|    30 | בים             | ▁ומתן        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | <pad>           | <pad>        | ✓     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | <pad>           | <pad>        | ✓     |
|    47 | <pad>           | <pad>        | ✓     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            |              | ✗     |

2024-12-31 23:10:12,187 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:10:12,192 - TrainingLogger - INFO - Gradient norm: 7.4478
2024-12-31 23:10:19,375 - TrainingLogger - INFO - Step 37610, Batch metrics: Loss: 7.6264, Accuracy: 0.0432, Perplexity: 2051.5793
2024-12-31 23:10:27,783 - TrainingLogger - INFO - Step 37620, Batch metrics: Loss: 7.4539, Accuracy: 0.0435, Perplexity: 1726.5958
2024-12-31 23:10:34,889 - TrainingLogger - INFO - Step 37630, Batch metrics: Loss: 7.7323, Accuracy: 0.0769, Perplexity: 2280.7688
2024-12-31 23:10:41,538 - TrainingLogger - INFO - Step 37640, Batch metrics: Loss: 7.4053, Accuracy: 0.0863, Perplexity: 1644.6141
2024-12-31 23:10:48,360 - TrainingLogger - INFO - Step 37650, Batch metrics: Loss: 7.2279, Accuracy: 0.0788, Perplexity: 1377.3311
2024-12-31 23:10:55,497 - TrainingLogger - INFO - Step 37660, Batch metrics: Loss: 7.4034, Accuracy: 0.0699, Perplexity: 1641.5648
2024-12-31 23:11:03,404 - TrainingLogger - INFO - Step 37670, Batch metrics: Loss: 7.7089, Accuracy: 0.0512, Perplexity: 2228.1452
2024-12-31 23:11:10,046 - TrainingLogger - INFO - Step 37680, Batch metrics: Loss: 7.4671, Accuracy: 0.0792, Perplexity: 1749.5768
2024-12-31 23:11:17,018 - TrainingLogger - INFO - Step 37690, Batch metrics: Loss: 7.2779, Accuracy: 0.0904, Perplexity: 1447.9003
2024-12-31 23:11:24,152 - TrainingLogger - INFO - Step 37700, Batch metrics: Loss: 7.1157, Accuracy: 0.0962, Perplexity: 1231.1806
2024-12-31 23:11:24,152 - TrainingLogger - INFO - Step 37700, Prediction vs Actual:
2024-12-31 23:11:24,152 - TrainingLogger - INFO - Input 1: אתמול דווח בסקיי ניוז בערבית כי לפי המתווה שעל הפרק, השלב הראשון יכלול שחרור של 35 חטופים, ותמורתם שחרור של 100 עד 200 מחבלים לכל חטוף
2024-12-31 23:11:24,153 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:11:24,153 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אתמול       | ✗     |
|     1 | ▁הוא            | ▁דווח        | ✗     |
|     2 | ▁-              | ▁בס          | ✗     |
|     3 | ▁אני            | קיי          | ✗     |
|     4 | ▁לא             | ▁ניו         | ✗     |
|     5 | ▁יורק           | ז            | ✗     |
|     6 | לנד             | ▁בערב        | ✗     |
|     7 | .               | ית           | ✗     |
|     8 | <pad>           | ▁כי          | ✗     |
|     9 | ▁אתה            | ▁לפי         | ✗     |
|    10 | ▁ה              | ▁המת         | ✗     |
|    11 | ונים            | ווה          | ✗     |
|    12 | ▁שלו            | ▁שעל         | ✗     |
|    13 | ▁הבמה           | ▁הפרק        | ✗     |
|    14 | ▁שלו            | ,            | ✗     |
|    15 | ▁הוא            | ▁השלב        | ✗     |
|    16 | ▁הזה            | ▁הראשון      | ✗     |
|    17 | ▁בו             | ▁יכלו        | ✗     |
|    18 | ל               | ל            | ✓     |
|    19 | ▁את             | ▁שחרור       | ✗     |
|    20 | ים              | ▁של          | ✗     |
|    21 | ▁               | ▁35          | ✗     |
|    22 | %               | ▁ח           | ✗     |
|    23 | ות              | טופ          | ✗     |
|    24 | ים              | ים           | ✓     |
|    25 | ,               | ,            | ✓     |
|    26 | <pad>           | ▁ות          | ✗     |
|    27 | ק               | מור          | ✗     |
|    28 | ת               | תם           | ✗     |
|    29 | ▁הושלמה         | ▁שחרור       | ✗     |
|    30 | ו               | ▁של          | ✗     |
|    31 | ▁כל             | ▁100         | ✗     |
|    32 | %               | ▁עד          | ✗     |
|    33 | ות              | ▁200         | ✗     |
|    34 | %               | ▁מחבל        | ✗     |
|    35 | ים              | ים           | ✓     |
|    36 | ▁חדשים          | ▁לכל         | ✗     |
|    37 | כלה             | ▁חטוף        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | ,               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | .               | <pad>        | ✗     |
|    49 | .               | <pad>        | ✗     |
|    50 | .               | <pad>        | ✗     |
|    51 | </s>            | <pad>        | ✗     |
|    52 | ,               | <pad>        | ✗     |
|    53 | </s>            | <pad>        | ✗     |
|    54 | .               |              | ✗     |

2024-12-31 23:11:24,153 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:11:24,158 - TrainingLogger - INFO - Gradient norm: 9.7837
2024-12-31 23:11:31,254 - TrainingLogger - INFO - Step 37710, Batch metrics: Loss: 7.1389, Accuracy: 0.0774, Perplexity: 1260.0900
2024-12-31 23:11:38,217 - TrainingLogger - INFO - Step 37720, Batch metrics: Loss: 7.4322, Accuracy: 0.0881, Perplexity: 1689.5429
2024-12-31 23:11:45,790 - TrainingLogger - INFO - Step 37730, Batch metrics: Loss: 7.4207, Accuracy: 0.0963, Perplexity: 1670.2470
2024-12-31 23:11:52,624 - TrainingLogger - INFO - Step 37740, Batch metrics: Loss: 7.4365, Accuracy: 0.0783, Perplexity: 1696.7987
2024-12-31 23:11:57,689 - TrainingLogger - ERROR - Error during forward pass: Attention mask should be of size (7, 1, 55, 48), but is torch.Size([8, 1, 55, 42])
2024-12-31 23:11:57,689 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 215, in forward
    raise ValueError(
ValueError: Attention mask should be of size (7, 1, 55, 48), but is torch.Size([8, 1, 55, 42])

2024-12-31 23:11:57,689 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 42]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 55]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 55]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 48]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 48]), device: cuda:0
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 23:11:57,690 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 23:12:00,366 - TrainingLogger - INFO - Step 37750, Batch metrics: Loss: 7.3855, Accuracy: 0.0714, Perplexity: 1612.3707
2024-12-31 23:12:07,465 - TrainingLogger - INFO - Step 37760, Batch metrics: Loss: 7.4434, Accuracy: 0.0828, Perplexity: 1708.4751
2024-12-31 23:12:09,907 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 379904
2024-12-31 23:12:09,907 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 379904

2024-12-31 23:12:09,907 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 53]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 53]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 71]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 71]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 23:12:09,909 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 23:12:15,485 - TrainingLogger - INFO - Step 37770, Batch metrics: Loss: 7.0665, Accuracy: 0.1061, Perplexity: 1172.0948
2024-12-31 23:12:22,669 - TrainingLogger - INFO - Step 37780, Batch metrics: Loss: 7.5039, Accuracy: 0.0921, Perplexity: 1815.1535
2024-12-31 23:12:29,419 - TrainingLogger - INFO - Step 37790, Batch metrics: Loss: 7.1591, Accuracy: 0.1042, Perplexity: 1285.7263
2024-12-31 23:12:36,445 - TrainingLogger - INFO - Step 37800, Batch metrics: Loss: 7.3522, Accuracy: 0.0769, Perplexity: 1559.6731
2024-12-31 23:12:36,446 - TrainingLogger - INFO - Step 37800, Prediction vs Actual:
2024-12-31 23:12:36,446 - TrainingLogger - INFO - Input 1: למרות שבית שמש משכה אליה קהילה גדולה של עולים מארצות הברית שמחזיקים בזכות הצבעה, מרבית המשתתפים היו פעילי ליכוד מוכרים
2024-12-31 23:12:36,446 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:12:36,446 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁למרות       | ✗     |
|     1 | ▁לא             | ▁שבית        | ✗     |
|     2 | ▁זה             | ▁שמש         | ✗     |
|     3 | ▁לו             | ▁מ           | ✗     |
|     4 | בור             | שכה          | ✗     |
|     5 | ▁אותו           | ▁אליה        | ✗     |
|     6 | ▁את             | ▁קהילה       | ✗     |
|     7 | ▁חדשה           | ▁גדולה       | ✗     |
|     8 | .               | ▁של          | ✗     |
|     9 | ▁אנשים          | ▁עולים       | ✗     |
|    10 | .               | ▁מארצות      | ✗     |
|    11 | ▁הברית          | ▁הברית       | ✓     |
|    12 | ▁אחרת           | ▁שמחזיק      | ✗     |
|    13 | ים              | ים           | ✓     |
|    14 | ▁בה             | ▁בזכות       | ✗     |
|    15 | ה               | ▁הצבעה       | ✗     |
|    16 | ▁זו             | ,            | ✗     |
|    17 | </s>            | ▁מרבית       | ✗     |
|    18 | ה               | ▁ה           | ✗     |
|    19 | אוכלוסיה        | משתתפים      | ✗     |
|    20 | ,               | ▁היו         | ✗     |
|    21 | ▁בה             | ▁פעיל        | ✗     |
|    22 | ,               | י            | ✗     |
|    23 | ▁המדינה         | ▁לי          | ✗     |
|    24 | גה              | כו           | ✗     |
|    25 | ס               | ד            | ✗     |
|    26 | יום             | ▁מוכרים      | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2024-12-31 23:12:36,446 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:12:36,451 - TrainingLogger - INFO - Gradient norm: 8.8999
2024-12-31 23:12:43,729 - TrainingLogger - INFO - Step 37810, Batch metrics: Loss: 6.9857, Accuracy: 0.0846, Perplexity: 1081.0491
2024-12-31 23:12:50,591 - TrainingLogger - INFO - Step 37820, Batch metrics: Loss: 7.3422, Accuracy: 0.0920, Perplexity: 1544.1537
2024-12-31 23:12:57,438 - TrainingLogger - INFO - Step 37830, Batch metrics: Loss: 6.8823, Accuracy: 0.1197, Perplexity: 974.8863
2024-12-31 23:13:04,362 - TrainingLogger - INFO - Step 37840, Batch metrics: Loss: 7.5825, Accuracy: 0.0444, Perplexity: 1963.4511
2024-12-31 23:13:12,156 - TrainingLogger - INFO - Step 37850, Batch metrics: Loss: 7.5454, Accuracy: 0.0674, Perplexity: 1892.0413
2024-12-31 23:13:18,878 - TrainingLogger - INFO - Step 37860, Batch metrics: Loss: 7.0314, Accuracy: 0.1094, Perplexity: 1131.6356
2024-12-31 23:13:25,863 - TrainingLogger - INFO - Step 37870, Batch metrics: Loss: 7.2588, Accuracy: 0.0679, Perplexity: 1420.5705
2024-12-31 23:13:33,318 - TrainingLogger - INFO - Step 37880, Batch metrics: Loss: 7.3312, Accuracy: 0.0830, Perplexity: 1527.2208
2024-12-31 23:13:40,320 - TrainingLogger - INFO - Step 37890, Batch metrics: Loss: 7.2245, Accuracy: 0.0747, Perplexity: 1372.6556
2024-12-31 23:13:47,540 - TrainingLogger - INFO - Step 37900, Batch metrics: Loss: 7.9529, Accuracy: 0.0524, Perplexity: 2843.7285
2024-12-31 23:13:47,540 - TrainingLogger - INFO - Step 37900, Prediction vs Actual:
2024-12-31 23:13:47,540 - TrainingLogger - INFO - Input 1: אפשר, אבל הבעיה היא כשאין
2024-12-31 23:13:47,540 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:13:47,540 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אפשר        | ✗     |
|     1 | ▁-              | ,            | ✗     |
|     2 | ▁אני            | ▁אבל         | ✗     |
|     3 | ▁-              | ▁הבעיה       | ✗     |
|     4 | ▁כל             | ▁היא         | ✗     |
|     5 | ▁לא             | ▁כש          | ✗     |
|     6 | אבא             | אין          | ✗     |
|     7 | ▁לי             | <pad>        | ✗     |
|     8 | ▁לי             | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | ▁בית            | <pad>        | ✗     |
|    11 | ▁היא            | <pad>        | ✗     |
|    12 | ▁בית            | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ▁לא             | <pad>        | ✗     |
|    18 | ▁היא            | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | ▁לא             | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | ▁היא            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | ▁יותר           | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | .               | <pad>        | ✗     |
|    36 | ▁לא             | <pad>        | ✗     |
|    37 | ▁משהו           |              | ✗     |

2024-12-31 23:13:47,540 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:13:47,545 - TrainingLogger - INFO - Gradient norm: 8.2438
2024-12-31 23:13:55,044 - TrainingLogger - INFO - Step 37910, Batch metrics: Loss: 6.9806, Accuracy: 0.1006, Perplexity: 1075.5562
2024-12-31 23:14:01,837 - TrainingLogger - INFO - Step 37920, Batch metrics: Loss: 7.4099, Accuracy: 0.0933, Perplexity: 1652.2788
2024-12-31 23:14:08,787 - TrainingLogger - INFO - Step 37930, Batch metrics: Loss: 6.9699, Accuracy: 0.1209, Perplexity: 1064.0718
2024-12-31 23:14:16,092 - TrainingLogger - INFO - Step 37940, Batch metrics: Loss: 7.0252, Accuracy: 0.0947, Perplexity: 1124.5700
2024-12-31 23:14:23,465 - TrainingLogger - INFO - Step 37950, Batch metrics: Loss: 7.3279, Accuracy: 0.0968, Perplexity: 1522.2471
2024-12-31 23:14:30,448 - TrainingLogger - INFO - Step 37960, Batch metrics: Loss: 7.6216, Accuracy: 0.0549, Perplexity: 2041.8365
2024-12-31 23:14:37,561 - TrainingLogger - INFO - Step 37970, Batch metrics: Loss: 7.6452, Accuracy: 0.0862, Perplexity: 2090.5912
2024-12-31 23:14:44,508 - TrainingLogger - INFO - Step 37980, Batch metrics: Loss: 7.0832, Accuracy: 0.0723, Perplexity: 1191.8352
2024-12-31 23:14:51,339 - TrainingLogger - INFO - Step 37990, Batch metrics: Loss: 6.8741, Accuracy: 0.1159, Perplexity: 966.8842
2024-12-31 23:14:58,259 - TrainingLogger - INFO - Step 38000, Batch metrics: Loss: 7.7171, Accuracy: 0.0615, Perplexity: 2246.3319
2024-12-31 23:14:58,260 - TrainingLogger - INFO - Step 38000, Prediction vs Actual:
2024-12-31 23:14:58,260 - TrainingLogger - INFO - Input 1: את רוב המחיר ממילא ישראל כבר שילמה בפילוג הפנימי, בכלכלה, במעמדה בעולם
2024-12-31 23:14:58,260 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:14:58,260 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁את          | ✗     |
|     1 | ▁את             | ▁רוב         | ✗     |
|     2 | ▁היום           | ▁המחיר       | ✗     |
|     3 | ▁-              | ▁ממילא       | ✗     |
|     4 | .               | ▁ישראל       | ✗     |
|     5 | .               | ▁כבר         | ✗     |
|     6 | ▁לא             | ▁שילמה       | ✗     |
|     7 | ▁את             | ▁בפי         | ✗     |
|     8 | ה               | לוג          | ✗     |
|     9 | ים              | ▁הפנימי      | ✗     |
|    10 | ▁שלו            | ,            | ✗     |
|    11 | <pad>           | ▁בכל         | ✗     |
|    12 | ▁יום            | כלה          | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | </s>            | ▁במעמד       | ✗     |
|    15 | ה               | ה            | ✓     |
|    16 | ,               | ▁בעולם       | ✗     |
|    17 | ▁כולו           | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | ,               |              | ✗     |

2024-12-31 23:14:58,260 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:14:58,266 - TrainingLogger - INFO - Gradient norm: 9.3995
2024-12-31 23:15:05,316 - TrainingLogger - INFO - Step 38010, Batch metrics: Loss: 7.3710, Accuracy: 0.0773, Perplexity: 1589.2810
2024-12-31 23:15:12,836 - TrainingLogger - INFO - Step 38020, Batch metrics: Loss: 7.1837, Accuracy: 0.0879, Perplexity: 1317.8116
2024-12-31 23:15:20,224 - TrainingLogger - INFO - Step 38030, Batch metrics: Loss: 7.0436, Accuracy: 0.1156, Perplexity: 1145.5576
2024-12-31 23:15:27,439 - TrainingLogger - INFO - Step 38040, Batch metrics: Loss: 6.9441, Accuracy: 0.0917, Perplexity: 1036.9870
2024-12-31 23:15:34,264 - TrainingLogger - INFO - Step 38050, Batch metrics: Loss: 7.3691, Accuracy: 0.0670, Perplexity: 1586.2624
2024-12-31 23:15:41,531 - TrainingLogger - INFO - Step 38060, Batch metrics: Loss: 7.0296, Accuracy: 0.0909, Perplexity: 1129.6122
2024-12-31 23:15:48,426 - TrainingLogger - INFO - Step 38070, Batch metrics: Loss: 7.3892, Accuracy: 0.0733, Perplexity: 1618.3803
2024-12-31 23:15:55,490 - TrainingLogger - INFO - Step 38080, Batch metrics: Loss: 7.3798, Accuracy: 0.0807, Perplexity: 1603.2428
2024-12-31 23:16:02,950 - TrainingLogger - INFO - Step 38090, Batch metrics: Loss: 7.2971, Accuracy: 0.0718, Perplexity: 1476.0584
2024-12-31 23:16:09,982 - TrainingLogger - INFO - Step 38100, Batch metrics: Loss: 7.2243, Accuracy: 0.1089, Perplexity: 1372.3500
2024-12-31 23:16:09,982 - TrainingLogger - INFO - Step 38100, Prediction vs Actual:
2024-12-31 23:16:09,982 - TrainingLogger - INFO - Input 1: בתוך כל זה קיבל נתניהו בונוס מחנה המרכז-שמאל היום הוא מחנה מפולג, מסוכסך, חסר אנרגיות ושאינו מאמין למנהיגיו
2024-12-31 23:16:09,983 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:16:09,983 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ו               | ▁בתוך        | ✗     |
|     1 | .               | ▁כל          | ✗     |
|     2 | .               | ▁זה          | ✗     |
|     3 | .               | ▁קיבל        | ✗     |
|     4 | ▁את             | ▁נתנ         | ✗     |
|     5 | יה              | יהו          | ✗     |
|     6 | .               | ▁בונוס       | ✗     |
|     7 | .               | ▁מחנה        | ✗     |
|     8 | .               | ▁המרכז       | ✗     |
|     9 | ▁לבקר           | -            | ✗     |
|    10 | ה               | שמאל         | ✗     |
|    11 | י               | ▁היום        | ✗     |
|    12 | -               | ▁הוא         | ✗     |
|    13 | ▁לא             | ▁מחנה        | ✗     |
|    14 | ▁את             | ▁מפולג       | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁מסו         | ✗     |
|    17 | פת              | כס           | ✗     |
|    18 | ך               | ך            | ✓     |
|    19 | ,               | ,            | ✓     |
|    20 | </s>            | ▁חסר         | ✗     |
|    21 | ▁ביטחון         | ▁אנרגי       | ✗     |
|    22 | ות              | ות           | ✓     |
|    23 | ,               | ▁וש          | ✗     |
|    24 | ון              | אי           | ✗     |
|    25 | נה              | נו           | ✗     |
|    26 | ון              | ▁מאמין       | ✗     |
|    27 | ▁לו             | ▁למנהיג      | ✗     |
|    28 | ים              | יו           | ✗     |
|    29 | ▁של             | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | ים              | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | ,               | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | </s>            |              | ✗     |

2024-12-31 23:16:09,983 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:16:09,988 - TrainingLogger - INFO - Gradient norm: 8.4249
2024-12-31 23:16:17,090 - TrainingLogger - INFO - Step 38110, Batch metrics: Loss: 7.1187, Accuracy: 0.1091, Perplexity: 1234.8859
2024-12-31 23:16:24,819 - TrainingLogger - INFO - Step 38120, Batch metrics: Loss: 7.3653, Accuracy: 0.0753, Perplexity: 1580.1754
2024-12-31 23:16:32,302 - TrainingLogger - INFO - Step 38130, Batch metrics: Loss: 7.1268, Accuracy: 0.0756, Perplexity: 1244.8324
2024-12-31 23:16:39,466 - TrainingLogger - INFO - Step 38140, Batch metrics: Loss: 7.2170, Accuracy: 0.0904, Perplexity: 1362.3535
2024-12-31 23:16:46,685 - TrainingLogger - INFO - Step 38150, Batch metrics: Loss: 7.5516, Accuracy: 0.0556, Perplexity: 1903.7173
2024-12-31 23:16:54,040 - TrainingLogger - INFO - Step 38160, Batch metrics: Loss: 7.5994, Accuracy: 0.0896, Perplexity: 1996.9241
2024-12-31 23:17:01,414 - TrainingLogger - INFO - Step 38170, Batch metrics: Loss: 7.5583, Accuracy: 0.0847, Perplexity: 1916.6065
2024-12-31 23:17:08,540 - TrainingLogger - INFO - Step 38180, Batch metrics: Loss: 7.3489, Accuracy: 0.0585, Perplexity: 1554.5632
2024-12-31 23:17:15,684 - TrainingLogger - INFO - Step 38190, Batch metrics: Loss: 7.3630, Accuracy: 0.0633, Perplexity: 1576.5883
2024-12-31 23:17:22,858 - TrainingLogger - INFO - Step 38200, Batch metrics: Loss: 7.5597, Accuracy: 0.0707, Perplexity: 1919.3420
2024-12-31 23:17:22,858 - TrainingLogger - INFO - Step 38200, Prediction vs Actual:
2024-12-31 23:17:22,858 - TrainingLogger - INFO - Input 1: לגמתי שוב מהתה החמים והוצאתי את הגיזמו שלי
2024-12-31 23:17:22,859 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:17:22,859 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לג          | ✗     |
|     1 | .               | מתי          | ✗     |
|     2 | ▁-              | ▁שוב         | ✗     |
|     3 | .               | ▁מה          | ✗     |
|     4 | ?               | תה           | ✗     |
|     5 | ומה             | ▁החמים       | ✗     |
|     6 | ?               | ▁ו           | ✗     |
|     7 | המצב            | הוצאת        | ✗     |
|     8 | ם               | י            | ✗     |
|     9 | ▁להורג          | ▁את          | ✗     |
|    10 | ▁זה             | ▁הג          | ✗     |
|    11 | פן              | יז           | ✗     |
|    12 | רה              | מו           | ✗     |
|    13 | ם               | ▁שלי         | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | <pad>           | <pad>        | ✓     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ב               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ה               | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | <pad>           |              | ✗     |

2024-12-31 23:17:22,859 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:17:22,864 - TrainingLogger - INFO - Gradient norm: 8.4182
2024-12-31 23:17:30,436 - TrainingLogger - INFO - Step 38210, Batch metrics: Loss: 7.2531, Accuracy: 0.1186, Perplexity: 1412.5440
2024-12-31 23:17:37,715 - TrainingLogger - INFO - Step 38220, Batch metrics: Loss: 7.7810, Accuracy: 0.0538, Perplexity: 2394.5830
2024-12-31 23:17:44,692 - TrainingLogger - INFO - Step 38230, Batch metrics: Loss: 7.2441, Accuracy: 0.0688, Perplexity: 1399.7856
2024-12-31 23:17:51,899 - TrainingLogger - INFO - Step 38240, Batch metrics: Loss: 7.2999, Accuracy: 0.0411, Perplexity: 1480.1146
2024-12-31 23:17:59,218 - TrainingLogger - INFO - Step 38250, Batch metrics: Loss: 7.5875, Accuracy: 0.0749, Perplexity: 1973.3694
2024-12-31 23:18:07,071 - TrainingLogger - INFO - Step 38260, Batch metrics: Loss: 7.5985, Accuracy: 0.0415, Perplexity: 1995.2584
2024-12-31 23:18:14,477 - TrainingLogger - INFO - Step 38270, Batch metrics: Loss: 7.2198, Accuracy: 0.0658, Perplexity: 1366.2581
2024-12-31 23:18:21,560 - TrainingLogger - INFO - Step 38280, Batch metrics: Loss: 7.3269, Accuracy: 0.0893, Perplexity: 1520.6169
2024-12-31 23:18:28,927 - TrainingLogger - INFO - Step 38290, Batch metrics: Loss: 7.5112, Accuracy: 0.0688, Perplexity: 1828.4132
2024-12-31 23:18:36,447 - TrainingLogger - INFO - Step 38300, Batch metrics: Loss: 7.2120, Accuracy: 0.0862, Perplexity: 1355.6019
2024-12-31 23:18:36,448 - TrainingLogger - INFO - Step 38300, Prediction vs Actual:
2024-12-31 23:18:36,448 - TrainingLogger - INFO - Input 1: הם עושים מניפולציה, לא מדברים עם בכירי ליכוד ומפלגות, אבל אנחנו לא רוצים להעמיד את זה במבחן
2024-12-31 23:18:36,448 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:18:36,448 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הם          | ✗     |
|     1 | ▁לא             | ▁עושים       | ✗     |
|     2 | ▁את             | ▁מני         | ✗     |
|     3 | ים              | פול          | ✗     |
|     4 | ציה             | ציה          | ✓     |
|     5 | .               | ,            | ✗     |
|     6 | <pad>           | ▁לא          | ✗     |
|     7 | ?               | ▁מדברים      | ✗     |
|     8 | ▁על             | ▁עם          | ✗     |
|     9 | ▁אנשים          | ▁בכיר        | ✗     |
|    10 | ים              | י            | ✗     |
|    11 | ▁המדינה         | ▁לי          | ✗     |
|    12 | בר              | כו           | ✗     |
|    13 | ון              | ד            | ✗     |
|    14 | .               | ▁ומ          | ✗     |
|    15 | סוכנים          | פלג          | ✗     |
|    16 | ה               | ות           | ✗     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁אבל         | ✗     |
|    19 | ▁גם             | ▁אנחנו       | ✗     |
|    20 | ▁לא             | ▁לא          | ✓     |
|    21 | ▁יכולים         | ▁רוצים       | ✗     |
|    22 | ▁להיות          | ▁להעמיד      | ✗     |
|    23 | ▁את             | ▁את          | ✓     |
|    24 | ▁עצמנו          | ▁זה          | ✗     |
|    25 | ▁לדין           | ▁במבחן       | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            |              | ✗     |

2024-12-31 23:18:36,448 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:18:36,453 - TrainingLogger - INFO - Gradient norm: 7.1938
2024-12-31 23:18:43,183 - TrainingLogger - INFO - Step 38310, Batch metrics: Loss: 7.2019, Accuracy: 0.0819, Perplexity: 1341.9410
2024-12-31 23:18:50,430 - TrainingLogger - INFO - Step 38320, Batch metrics: Loss: 7.1495, Accuracy: 0.0735, Perplexity: 1273.4276
2024-12-31 23:18:58,137 - TrainingLogger - INFO - Step 38330, Batch metrics: Loss: 7.5210, Accuracy: 0.0597, Perplexity: 1846.3818
2024-12-31 23:19:05,381 - TrainingLogger - INFO - Step 38340, Batch metrics: Loss: 7.3153, Accuracy: 0.0833, Perplexity: 1503.0495
2024-12-31 23:19:12,480 - TrainingLogger - INFO - Step 38350, Batch metrics: Loss: 7.1710, Accuracy: 0.0659, Perplexity: 1301.1488
2024-12-31 23:19:19,469 - TrainingLogger - INFO - Step 38360, Batch metrics: Loss: 7.6007, Accuracy: 0.0698, Perplexity: 1999.5968
2024-12-31 23:19:27,110 - TrainingLogger - INFO - Step 38370, Batch metrics: Loss: 7.3179, Accuracy: 0.0824, Perplexity: 1506.9628
2024-12-31 23:19:34,200 - TrainingLogger - INFO - Step 38380, Batch metrics: Loss: 7.1949, Accuracy: 0.1055, Perplexity: 1332.6565
2024-12-31 23:19:40,957 - TrainingLogger - INFO - Step 38390, Batch metrics: Loss: 7.1674, Accuracy: 0.0903, Perplexity: 1296.4989
2024-12-31 23:19:48,278 - TrainingLogger - INFO - Step 38400, Batch metrics: Loss: 6.8594, Accuracy: 0.0872, Perplexity: 952.8200
2024-12-31 23:19:48,279 - TrainingLogger - INFO - Step 38400, Prediction vs Actual:
2024-12-31 23:19:48,279 - TrainingLogger - INFO - Input 1: היית צריך לטוס לשוויץ, ולקנות רולקס ב-200,000 דולר
2024-12-31 23:19:48,279 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:19:48,279 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היית        | ✗     |
|     1 | ▁-              | ▁צריך        | ✗     |
|     2 | ▁להיות          | ▁לטוס        | ✗     |
|     3 | ▁לשם            | ▁ל           | ✗     |
|     4 | ...             | שוויץ        | ✗     |
|     5 | .               | ,            | ✗     |
|     6 | <pad>           | ▁ו           | ✗     |
|     7 | לנצח            | לקנות        | ✗     |
|     8 | ▁את             | ▁רול         | ✗     |
|     9 | ס               | קס           | ✗     |
|    10 | ו               | ▁ב           | ✗     |
|    11 | -19             | -20          | ✗     |
|    12 | ▁דקות           | 0,000        | ✗     |
|    13 | ▁דולר           | ▁דולר        | ✓     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | <pad>           |              | ✗     |

2024-12-31 23:19:48,279 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:19:48,285 - TrainingLogger - INFO - Gradient norm: 7.3162
2024-12-31 23:19:55,807 - TrainingLogger - INFO - Step 38410, Batch metrics: Loss: 7.6973, Accuracy: 0.0702, Perplexity: 2202.3577
2024-12-31 23:20:03,028 - TrainingLogger - INFO - Step 38420, Batch metrics: Loss: 7.3041, Accuracy: 0.0519, Perplexity: 1486.3193
2024-12-31 23:20:10,575 - TrainingLogger - INFO - Step 38430, Batch metrics: Loss: 7.0054, Accuracy: 0.1039, Perplexity: 1102.5286
2024-12-31 23:20:17,729 - TrainingLogger - INFO - Step 38440, Batch metrics: Loss: 7.2396, Accuracy: 0.0783, Perplexity: 1393.5267
2024-12-31 23:20:22,723 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 308224
2024-12-31 23:20:22,723 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 308224

2024-12-31 23:20:22,723 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 43]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 68]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 68]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 47]), device: cuda:0
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 23:20:22,725 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 23:20:25,293 - TrainingLogger - INFO - Step 38450, Batch metrics: Loss: 6.8490, Accuracy: 0.0787, Perplexity: 942.9074
2024-12-31 23:20:32,256 - TrainingLogger - INFO - Step 38460, Batch metrics: Loss: 7.7671, Accuracy: 0.0765, Perplexity: 2361.7058
2024-12-31 23:20:38,886 - TrainingLogger - INFO - Step 38470, Batch metrics: Loss: 7.8535, Accuracy: 0.0719, Perplexity: 2574.7998
2024-12-31 23:20:46,293 - TrainingLogger - INFO - Step 38480, Batch metrics: Loss: 7.5557, Accuracy: 0.0556, Perplexity: 1911.6340
2024-12-31 23:20:53,054 - TrainingLogger - INFO - Step 38490, Batch metrics: Loss: 7.6187, Accuracy: 0.0667, Perplexity: 2035.9730
2024-12-31 23:21:00,033 - TrainingLogger - INFO - Step 38500, Batch metrics: Loss: 7.7482, Accuracy: 0.0736, Perplexity: 2317.4370
2024-12-31 23:21:00,034 - TrainingLogger - INFO - Step 38500, Prediction vs Actual:
2024-12-31 23:21:00,034 - TrainingLogger - INFO - Input 1: על הבית הסמוך ריססו הרוצח ושותפיו יחי מלך המשיח
2024-12-31 23:21:00,034 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:21:00,034 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁על          | ✗     |
|     1 | .               | ▁הבית        | ✗     |
|     2 | .               | ▁הסמוך       | ✗     |
|     3 | .               | ▁ריס         | ✗     |
|     4 | ים              | סו           | ✗     |
|     5 | בו              | ▁הרוצח       | ✗     |
|     6 | </s>            | ▁וש          | ✗     |
|     7 | ות              | ות           | ✓     |
|     8 | ים              | פיו          | ✗     |
|     9 | </s>            | ▁יחי         | ✗     |
|    10 | תו              | ▁מלך         | ✗     |
|    11 | ▁ישראל          | ▁המשיח       | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ▁החדש           | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ▁ישראל          | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁השלטון         | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ▁ישראל          | <pad>        | ✗     |
|    37 | ▁אותו           |              | ✗     |

2024-12-31 23:21:00,034 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:21:00,039 - TrainingLogger - INFO - Gradient norm: 7.6824
2024-12-31 23:21:07,005 - TrainingLogger - INFO - Step 38510, Batch metrics: Loss: 7.4657, Accuracy: 0.0743, Perplexity: 1747.0134
2024-12-31 23:21:13,912 - TrainingLogger - INFO - Step 38520, Batch metrics: Loss: 7.2190, Accuracy: 0.0865, Perplexity: 1365.1699
2024-12-31 23:21:21,407 - TrainingLogger - INFO - Step 38530, Batch metrics: Loss: 7.4148, Accuracy: 0.0993, Perplexity: 1660.3029
2024-12-31 23:21:28,107 - TrainingLogger - INFO - Step 38540, Batch metrics: Loss: 7.3223, Accuracy: 0.0777, Perplexity: 1513.7290
2024-12-31 23:21:35,433 - TrainingLogger - INFO - Step 38550, Batch metrics: Loss: 7.3408, Accuracy: 0.0780, Perplexity: 1542.0221
2024-12-31 23:21:42,585 - TrainingLogger - INFO - Step 38560, Batch metrics: Loss: 7.6330, Accuracy: 0.0588, Perplexity: 2065.2914
2024-12-31 23:21:49,869 - TrainingLogger - INFO - Step 38570, Batch metrics: Loss: 6.5640, Accuracy: 0.1214, Perplexity: 709.1330
2024-12-31 23:21:56,800 - TrainingLogger - INFO - Step 38580, Batch metrics: Loss: 7.5077, Accuracy: 0.0600, Perplexity: 1822.0032
2024-12-31 23:22:04,425 - TrainingLogger - INFO - Step 38590, Batch metrics: Loss: 7.3530, Accuracy: 0.0733, Perplexity: 1560.9074
2024-12-31 23:22:11,872 - TrainingLogger - INFO - Step 38600, Batch metrics: Loss: 7.4559, Accuracy: 0.1135, Perplexity: 1730.0613
2024-12-31 23:22:11,872 - TrainingLogger - INFO - Step 38600, Prediction vs Actual:
2024-12-31 23:22:11,872 - TrainingLogger - INFO - Input 1: הוא אהב את המדינה ותמיד היה גאה ובעל ראש מורם
2024-12-31 23:22:11,873 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:22:11,873 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כמוני          | ▁הוא         | ✗     |
|     1 | ,               | ▁אהב         | ✗     |
|     2 | ▁את             | ▁את          | ✓     |
|     3 | ▁זה             | ▁המדינה      | ✗     |
|     4 | ▁הזאת           | ▁ותמיד       | ✗     |
|     5 | </s>            | ▁היה         | ✗     |
|     6 | ▁לו             | ▁גאה         | ✗     |
|     7 | ▁בו             | ▁ובעל        | ✗     |
|     8 | </s>            | ▁ראש         | ✗     |
|     9 | </s>            | ▁מור         | ✗     |
|    10 | ה               | ם            | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | </s>            |              | ✗     |

2024-12-31 23:22:11,873 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:22:11,878 - TrainingLogger - INFO - Gradient norm: 8.7654
2024-12-31 23:22:18,956 - TrainingLogger - INFO - Step 38610, Batch metrics: Loss: 7.3036, Accuracy: 0.0833, Perplexity: 1485.6072
2024-12-31 23:22:26,298 - TrainingLogger - INFO - Step 38620, Batch metrics: Loss: 7.2721, Accuracy: 0.1009, Perplexity: 1439.5854
2024-12-31 23:22:33,223 - TrainingLogger - INFO - Step 38630, Batch metrics: Loss: 7.5557, Accuracy: 0.0680, Perplexity: 1911.6139
2024-12-31 23:22:40,510 - TrainingLogger - INFO - Step 38640, Batch metrics: Loss: 6.8659, Accuracy: 0.1218, Perplexity: 958.9679
2024-12-31 23:22:48,376 - TrainingLogger - INFO - Step 38650, Batch metrics: Loss: 7.1449, Accuracy: 0.0819, Perplexity: 1267.5845
2024-12-31 23:22:55,384 - TrainingLogger - INFO - Step 38660, Batch metrics: Loss: 7.1802, Accuracy: 0.1064, Perplexity: 1313.1359
2024-12-31 23:23:02,529 - TrainingLogger - INFO - Step 38670, Batch metrics: Loss: 7.6022, Accuracy: 0.0604, Perplexity: 2002.5262
2024-12-31 23:23:09,599 - TrainingLogger - INFO - Step 38680, Batch metrics: Loss: 7.4870, Accuracy: 0.0813, Perplexity: 1784.6746
2024-12-31 23:23:16,659 - TrainingLogger - INFO - Step 38690, Batch metrics: Loss: 7.3929, Accuracy: 0.0976, Perplexity: 1624.3551
2024-12-31 23:23:23,708 - TrainingLogger - INFO - Step 38700, Batch metrics: Loss: 7.1488, Accuracy: 0.1049, Perplexity: 1272.5948
2024-12-31 23:23:23,709 - TrainingLogger - INFO - Step 38700, Prediction vs Actual:
2024-12-31 23:23:23,709 - TrainingLogger - INFO - Input 1: אני נותן את חיי למען המדינה והניצחון שלי הוא ניצחון שלהם
2024-12-31 23:23:23,709 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:23:23,709 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | </s>            | ▁נותן        | ✗     |
|     2 | ▁לך             | ▁את          | ✗     |
|     3 | ▁זה             | ▁חיי         | ✗     |
|     4 | ,               | ▁למען        | ✗     |
|     5 | ▁האמת           | ▁המדינה      | ✗     |
|     6 | ,               | ▁וה          | ✗     |
|     7 | ...             | ניצחון       | ✗     |
|     8 | ▁שלי            | ▁שלי         | ✓     |
|     9 | ,               | ▁הוא         | ✗     |
|    10 | ▁זה             | ▁ניצחון      | ✗     |
|    11 | ▁גדול           | ▁שלהם        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2024-12-31 23:23:23,709 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:23:23,715 - TrainingLogger - INFO - Gradient norm: 9.6188
2024-12-31 23:23:30,494 - TrainingLogger - INFO - Step 38710, Batch metrics: Loss: 7.0953, Accuracy: 0.0970, Perplexity: 1206.3362
2024-12-31 23:23:37,914 - TrainingLogger - INFO - Step 38720, Batch metrics: Loss: 7.4389, Accuracy: 0.0625, Perplexity: 1700.9261
2024-12-31 23:23:45,086 - TrainingLogger - INFO - Step 38730, Batch metrics: Loss: 7.3304, Accuracy: 0.0864, Perplexity: 1525.9316
2024-12-31 23:23:51,318 - TrainingLogger - INFO - Step 38740, Batch metrics: Loss: 7.4116, Accuracy: 0.0769, Perplexity: 1655.1238
2024-12-31 23:23:58,602 - TrainingLogger - INFO - Step 38750, Batch metrics: Loss: 7.1555, Accuracy: 0.1081, Perplexity: 1281.0979
2024-12-31 23:24:05,775 - TrainingLogger - INFO - Step 38760, Batch metrics: Loss: 7.6551, Accuracy: 0.0875, Perplexity: 2111.4655
2024-12-31 23:24:12,796 - TrainingLogger - INFO - Step 38770, Batch metrics: Loss: 7.2841, Accuracy: 0.0769, Perplexity: 1456.9751
2024-12-31 23:24:19,686 - TrainingLogger - INFO - Step 38780, Batch metrics: Loss: 7.2448, Accuracy: 0.0872, Perplexity: 1400.8586
2024-12-31 23:24:26,817 - TrainingLogger - INFO - Step 38790, Batch metrics: Loss: 7.5161, Accuracy: 0.1098, Perplexity: 1837.4391
2024-12-31 23:24:34,001 - TrainingLogger - INFO - Step 38800, Batch metrics: Loss: 7.1909, Accuracy: 0.0955, Perplexity: 1327.2654
2024-12-31 23:24:34,001 - TrainingLogger - INFO - Step 38800, Prediction vs Actual:
2024-12-31 23:24:34,001 - TrainingLogger - INFO - Input 1: -אתה יכול להבטיח שלא תעלו מסים? חד וחלק - אין כוונה להעלות מסים
2024-12-31 23:24:34,002 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:24:34,002 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁-           | ✗     |
|     1 | ▁,              | אתה          | ✗     |
|     2 | ▁לא             | ▁יכול        | ✗     |
|     3 | ▁להגיד          | ▁להבטיח      | ✗     |
|     4 | ▁לי             | ▁שלא         | ✗     |
|     5 | ▁יהיה           | ▁תעלו        | ✗     |
|     6 | ▁את             | ▁מס          | ✗     |
|     7 | ה               | ים           | ✗     |
|     8 | ▁את             | ?            | ✗     |
|     9 | </s>            | ▁חד          | ✗     |
|    10 | ים              | ▁וחלק        | ✗     |
|    11 | .               | ▁-           | ✗     |
|    12 | <pad>           | ▁אין         | ✗     |
|    13 | ▁לי             | ▁כוונה       | ✗     |
|    14 | ▁אחרת           | ▁להעלות      | ✗     |
|    15 | ם               | ▁מס          | ✗     |
|    16 | ה               | ים           | ✗     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | ▁את             | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | ▁שקל            | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | ▁שנה            | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2024-12-31 23:24:34,002 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:24:34,007 - TrainingLogger - INFO - Gradient norm: 7.7656
2024-12-31 23:24:41,030 - TrainingLogger - INFO - Step 38810, Batch metrics: Loss: 7.4893, Accuracy: 0.0630, Perplexity: 1788.8443
2024-12-31 23:24:48,197 - TrainingLogger - INFO - Step 38820, Batch metrics: Loss: 7.1625, Accuracy: 0.0809, Perplexity: 1290.1260
2024-12-31 23:24:55,360 - TrainingLogger - INFO - Step 38830, Batch metrics: Loss: 7.3691, Accuracy: 0.0437, Perplexity: 1586.1724
2024-12-31 23:25:02,467 - TrainingLogger - INFO - Step 38840, Batch metrics: Loss: 7.0161, Accuracy: 0.0753, Perplexity: 1114.4025
2024-12-31 23:25:09,857 - TrainingLogger - INFO - Step 38850, Batch metrics: Loss: 7.6114, Accuracy: 0.0469, Perplexity: 2021.0356
2024-12-31 23:25:17,051 - TrainingLogger - INFO - Step 38860, Batch metrics: Loss: 7.1365, Accuracy: 0.1080, Perplexity: 1256.9586
2024-12-31 23:25:24,346 - TrainingLogger - INFO - Step 38870, Batch metrics: Loss: 7.6712, Accuracy: 0.0960, Perplexity: 2145.5745
2024-12-31 23:25:31,801 - TrainingLogger - INFO - Step 38880, Batch metrics: Loss: 7.5115, Accuracy: 0.0787, Perplexity: 1828.9259
2024-12-31 23:25:38,858 - TrainingLogger - INFO - Step 38890, Batch metrics: Loss: 7.4909, Accuracy: 0.0752, Perplexity: 1791.7357
2024-12-31 23:25:45,943 - TrainingLogger - INFO - Step 38900, Batch metrics: Loss: 7.1721, Accuracy: 0.0885, Perplexity: 1302.6021
2024-12-31 23:25:45,943 - TrainingLogger - INFO - Step 38900, Prediction vs Actual:
2024-12-31 23:25:45,943 - TrainingLogger - INFO - Input 1: עם כניסתו לישיבת הממשלה היום, אמר יור יהדות התורה, השר יצחק גולדקנופף, כי הממשלה תעשה את מה שאמרה שתעשה בהקשר לחוק הגיוס
2024-12-31 23:25:45,944 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:25:45,944 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁עם          | ✗     |
|     1 | ▁-              | ▁כניסת       | ✗     |
|     2 | ▁-              | ו            | ✗     |
|     3 | ▁כן             | ▁לי          | ✗     |
|     4 | ▁-              | שיב          | ✗     |
|     5 | ת               | ת            | ✓     |
|     6 | ▁המשפחה         | ▁הממשלה      | ✗     |
|     7 | ▁החדשה          | ▁היום        | ✗     |
|     8 | ▁אני            | ,            | ✗     |
|     9 | <pad>           | ▁אמר         | ✗     |
|    10 | ▁לו             | ▁י           | ✗     |
|    11 | ון              | ור           | ✗     |
|    12 | נר              | ▁יה          | ✗     |
|    13 | ,               | דות          | ✗     |
|    14 | ,               | ▁התורה       | ✗     |
|    15 | ,               | ,            | ✓     |
|    16 | <pad>           | ▁השר         | ✗     |
|    17 | ים              | ▁יצחק        | ✗     |
|    18 | ה               | ▁גולד        | ✗     |
|    19 | מן              | קנו          | ✗     |
|    20 | ,               | פף           | ✗     |
|    21 | ,               | ,            | ✓     |
|    22 | <pad>           | ▁כי          | ✗     |
|    23 | ון              | ▁הממשלה      | ✗     |
|    24 | ▁הגדולה         | ▁תעשה        | ✗     |
|    25 | ▁את             | ▁את          | ✓     |
|    26 | ▁זה             | ▁מה          | ✗     |
|    27 | ▁ש              | ▁שאמר        | ✗     |
|    28 | ה               | ה            | ✓     |
|    29 | ▁לו             | ▁שתעשה       | ✗     |
|    30 | .               | ▁בהקשר       | ✗     |
|    31 | ▁זה             | ▁לחוק        | ✗     |
|    32 | ה               | ▁הגיוס       | ✗     |
|    33 | ים              |              | ✗     |

2024-12-31 23:25:45,944 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:25:45,949 - TrainingLogger - INFO - Gradient norm: 7.2684
2024-12-31 23:25:53,700 - TrainingLogger - INFO - Step 38910, Batch metrics: Loss: 8.2404, Accuracy: 0.0440, Perplexity: 3791.1263
2024-12-31 23:26:00,963 - TrainingLogger - INFO - Step 38920, Batch metrics: Loss: 7.8362, Accuracy: 0.0461, Perplexity: 2530.6036
2024-12-31 23:26:08,175 - TrainingLogger - INFO - Step 38930, Batch metrics: Loss: 7.5349, Accuracy: 0.0611, Perplexity: 1872.3244
2024-12-31 23:26:15,632 - TrainingLogger - INFO - Step 38940, Batch metrics: Loss: 7.3357, Accuracy: 0.0905, Perplexity: 1534.1496
2024-12-31 23:26:23,632 - TrainingLogger - INFO - Step 38950, Batch metrics: Loss: 7.3519, Accuracy: 0.0561, Perplexity: 1559.1533
2024-12-31 23:26:31,138 - TrainingLogger - INFO - Step 38960, Batch metrics: Loss: 7.5978, Accuracy: 0.0588, Perplexity: 1993.7786
2024-12-31 23:26:38,460 - TrainingLogger - INFO - Step 38970, Batch metrics: Loss: 7.5617, Accuracy: 0.0721, Perplexity: 1923.1338
2024-12-31 23:26:45,737 - TrainingLogger - INFO - Step 38980, Batch metrics: Loss: 7.0311, Accuracy: 0.0769, Perplexity: 1131.2914
2024-12-31 23:26:52,720 - TrainingLogger - INFO - Step 38990, Batch metrics: Loss: 7.2839, Accuracy: 0.0728, Perplexity: 1456.7111
2024-12-31 23:27:00,127 - TrainingLogger - INFO - Step 39000, Batch metrics: Loss: 7.1613, Accuracy: 0.1168, Perplexity: 1288.6381
2024-12-31 23:27:00,128 - TrainingLogger - INFO - Step 39000, Prediction vs Actual:
2024-12-31 23:27:00,128 - TrainingLogger - INFO - Input 1: בתגובה הותקפו יותר מ-50 מטרות איראניות במה שהוגדר על-ידי מנליס כאחד ממבצעיו הגדולים בעשורים האחרונים של חיל האוויר
2024-12-31 23:27:00,128 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:27:00,128 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁ישראל          | ▁בתגובה      | ✗     |
|     1 | ▁הוא            | ▁הו          | ✗     |
|     2 | ▁הוא            | תקפו         | ✗     |
|     3 | ▁-              | ▁יותר        | ✗     |
|     4 | ▁מזה            | ▁מ           | ✗     |
|     5 | פעם             | -50          | ✗     |
|     6 | ▁שנה            | ▁מטרות       | ✗     |
|     7 | ▁אחרות          | ▁אירא        | ✗     |
|     8 | ניות            | ניות         | ✓     |
|     9 | .               | ▁במה         | ✗     |
|    10 | ות              | ▁שהו         | ✗     |
|    11 | מ               | גדר          | ✗     |
|    12 | ו               | ▁על          | ✗     |
|    13 | ▁ידי            | -            | ✗     |
|    14 | ידי             | ידי          | ✓     |
|    15 | ▁המדינה         | ▁מנ          | ✗     |
|    16 | שם              | ליס          | ✗     |
|    17 | .               | ▁כאחד        | ✗     |
|    18 | .               | ▁מ           | ✗     |
|    19 | ביני            | מבצע         | ✗     |
|    20 | יו              | יו           | ✓     |
|    21 | .               | ▁הגדולים     | ✗     |
|    22 | ▁ביותר          | ▁בעשור       | ✗     |
|    23 | ים              | ים           | ✓     |
|    24 | ▁האחרונים       | ▁האחרונים    | ✓     |
|    25 | .               | ▁של          | ✗     |
|    26 | ▁ארצות          | ▁חיל         | ✗     |
|    27 | ▁הים            | ▁האוויר      | ✗     |
|    28 | ▁האמריקני       | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 23:27:00,128 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:27:00,133 - TrainingLogger - INFO - Gradient norm: 7.4962
2024-12-31 23:27:07,587 - TrainingLogger - INFO - Step 39010, Batch metrics: Loss: 6.9801, Accuracy: 0.1057, Perplexity: 1074.9768
2024-12-31 23:27:14,485 - TrainingLogger - INFO - Step 39020, Batch metrics: Loss: 7.1149, Accuracy: 0.0983, Perplexity: 1230.1249
2024-12-31 23:27:21,746 - TrainingLogger - INFO - Step 39030, Batch metrics: Loss: 7.4367, Accuracy: 0.0507, Perplexity: 1697.1871
2024-12-31 23:27:28,856 - TrainingLogger - INFO - Step 39040, Batch metrics: Loss: 7.1448, Accuracy: 0.0882, Perplexity: 1267.4581
2024-12-31 23:27:35,870 - TrainingLogger - INFO - Step 39050, Batch metrics: Loss: 6.8540, Accuracy: 0.1229, Perplexity: 947.6437
2024-12-31 23:27:43,307 - TrainingLogger - INFO - Step 39060, Batch metrics: Loss: 6.8964, Accuracy: 0.1075, Perplexity: 988.7514
2024-12-31 23:27:51,190 - TrainingLogger - INFO - Step 39070, Batch metrics: Loss: 7.2682, Accuracy: 0.0766, Perplexity: 1434.0188
2024-12-31 23:27:58,460 - TrainingLogger - INFO - Step 39080, Batch metrics: Loss: 7.3815, Accuracy: 0.0921, Perplexity: 1605.9713
2024-12-31 23:28:05,761 - TrainingLogger - INFO - Step 39090, Batch metrics: Loss: 7.7239, Accuracy: 0.0739, Perplexity: 2261.7273
2024-12-31 23:28:13,248 - TrainingLogger - INFO - Step 39100, Batch metrics: Loss: 7.6518, Accuracy: 0.0645, Perplexity: 2104.3663
2024-12-31 23:28:13,248 - TrainingLogger - INFO - Step 39100, Prediction vs Actual:
2024-12-31 23:28:13,248 - TrainingLogger - INFO - Input 1: מאחוריה היו שלושה מחבלים שנכנעו ואשר כעת מספקים מידע רבערך במיוחד על הנהגת חמאס ועל החטופים
2024-12-31 23:28:13,249 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:28:13,249 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מאחורי      | ✗     |
|     1 | ▁הדלת           | ה            | ✗     |
|     2 | .               | ▁היו         | ✗     |
|     3 | תו              | ▁שלושה       | ✗     |
|     4 | ▁ימים           | ▁מחבל        | ✗     |
|     5 | ים              | ים           | ✓     |
|     6 | .               | ▁שנ          | ✗     |
|     7 | ורו             | כנע          | ✗     |
|     8 | ו               | ו            | ✓     |
|     9 | ▁ל              | ▁ואשר        | ✗     |
|    10 | ▁היו            | ▁כעת         | ✗     |
|    11 | ▁הם             | ▁מספקים      | ✗     |
|    12 | ▁להם            | ▁מידע        | ✗     |
|    13 | ▁חדש            | ▁רב          | ✗     |
|    14 | ▁יותר           | ערך          | ✗     |
|    15 | .               | ▁במיוחד      | ✗     |
|    16 | .               | ▁על          | ✗     |
|    17 | ▁מנת            | ▁הנהג        | ✗     |
|    18 | ים              | ת            | ✗     |
|    19 | ם               | ▁ח           | ✗     |
|    20 | ות              | מ            | ✗     |
|    21 | אס              | אס           | ✓     |
|    22 | </s>            | ▁ועל         | ✗     |
|    23 | י               | ▁הח          | ✗     |
|    24 | ות              | טופ          | ✗     |
|    25 | ים              | ים           | ✓     |
|    26 | ▁שלהם           | <pad>        | ✗     |
|    27 | ה               | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | ים              | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ים              | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | ים              | <pad>        | ✗     |
|    42 | ים              | <pad>        | ✗     |
|    43 | ים              | <pad>        | ✗     |
|    44 | ים              | <pad>        | ✗     |
|    45 | ים              | <pad>        | ✗     |
|    46 | ים              | <pad>        | ✗     |
|    47 | ה               | <pad>        | ✗     |
|    48 | ים              |              | ✗     |

2024-12-31 23:28:13,249 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:28:13,254 - TrainingLogger - INFO - Gradient norm: 7.2746
2024-12-31 23:28:20,471 - TrainingLogger - INFO - Step 39110, Batch metrics: Loss: 7.1303, Accuracy: 0.1200, Perplexity: 1249.3089
2024-12-31 23:28:27,545 - TrainingLogger - INFO - Step 39120, Batch metrics: Loss: 7.1352, Accuracy: 0.0839, Perplexity: 1255.3629
2024-12-31 23:28:34,727 - TrainingLogger - INFO - Step 39130, Batch metrics: Loss: 7.5343, Accuracy: 0.0816, Perplexity: 1871.1526
2024-12-31 23:28:42,115 - TrainingLogger - INFO - Step 39140, Batch metrics: Loss: 7.3867, Accuracy: 0.0867, Perplexity: 1614.4302
2024-12-31 23:28:49,032 - TrainingLogger - INFO - Step 39150, Batch metrics: Loss: 7.1996, Accuracy: 0.0938, Perplexity: 1338.9197
2024-12-31 23:28:55,147 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 243712
2024-12-31 23:28:55,148 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 243712

2024-12-31 23:28:55,148 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 34]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 46]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 46]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 52]), device: cuda:0
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2024-12-31 23:28:55,149 - TrainingLogger - ERROR - Skipping this batch due to error.
2024-12-31 23:28:57,297 - TrainingLogger - INFO - Step 39160, Batch metrics: Loss: 7.2689, Accuracy: 0.0815, Perplexity: 1435.0422
2024-12-31 23:29:05,067 - TrainingLogger - INFO - Step 39170, Batch metrics: Loss: 7.2105, Accuracy: 0.0772, Perplexity: 1353.5453
2024-12-31 23:29:12,528 - TrainingLogger - INFO - Step 39180, Batch metrics: Loss: 7.3127, Accuracy: 0.0567, Perplexity: 1499.2236
2024-12-31 23:29:20,037 - TrainingLogger - INFO - Step 39190, Batch metrics: Loss: 7.3125, Accuracy: 0.1075, Perplexity: 1498.9041
2024-12-31 23:29:26,738 - TrainingLogger - INFO - Step 39200, Batch metrics: Loss: 7.4025, Accuracy: 0.0506, Perplexity: 1640.0414
2024-12-31 23:29:26,738 - TrainingLogger - INFO - Step 39200, Prediction vs Actual:
2024-12-31 23:29:26,738 - TrainingLogger - INFO - Input 1: הם חמאס צריכים לקבל אותה, אמר בהצהרה שנשא בנמל אשדוד
2024-12-31 23:29:26,739 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:29:26,739 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הם          | ✗     |
|     1 | </s>            | ▁ח           | ✗     |
|     2 | </s>            | מ            | ✗     |
|     3 | אס              | אס           | ✓     |
|     4 | </s>            | ▁צריכים      | ✗     |
|     5 | ▁להיות          | ▁לקבל        | ✗     |
|     6 | ▁את             | ▁אותה        | ✗     |
|     7 | </s>            | ,            | ✗     |
|     8 | <pad>           | ▁אמר         | ✗     |
|     9 | ▁להם            | ▁ב           | ✗     |
|    10 | קה              | הצהרה        | ✗     |
|    11 | </s>            | ▁שנשא        | ✗     |
|    12 | ו               | ▁בנמל        | ✗     |
|    13 | ים              | ▁אש          | ✗     |
|    14 | </s>            | דוד          | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | ▁את             | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁את             | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2024-12-31 23:29:26,739 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:29:26,744 - TrainingLogger - INFO - Gradient norm: 11.7131
2024-12-31 23:29:33,636 - TrainingLogger - INFO - Step 39210, Batch metrics: Loss: 7.3082, Accuracy: 0.0498, Perplexity: 1492.4853
2024-12-31 23:29:40,555 - TrainingLogger - INFO - Step 39220, Batch metrics: Loss: 6.8742, Accuracy: 0.0947, Perplexity: 966.9884
2024-12-31 23:29:47,991 - TrainingLogger - INFO - Step 39230, Batch metrics: Loss: 7.2396, Accuracy: 0.0889, Perplexity: 1393.4709
2024-12-31 23:29:55,095 - TrainingLogger - INFO - Step 39240, Batch metrics: Loss: 7.1607, Accuracy: 0.0947, Perplexity: 1287.7910
2024-12-31 23:30:02,179 - TrainingLogger - INFO - Step 39250, Batch metrics: Loss: 7.1280, Accuracy: 0.0698, Perplexity: 1246.4326
2024-12-31 23:30:09,657 - TrainingLogger - INFO - Step 39260, Batch metrics: Loss: 7.4106, Accuracy: 0.0877, Perplexity: 1653.4965
2024-12-31 23:30:17,183 - TrainingLogger - INFO - Step 39270, Batch metrics: Loss: 7.5882, Accuracy: 0.0867, Perplexity: 1974.7437
2024-12-31 23:30:24,572 - TrainingLogger - INFO - Step 39280, Batch metrics: Loss: 7.7348, Accuracy: 0.0673, Perplexity: 2286.5009
2024-12-31 23:30:31,998 - TrainingLogger - INFO - Step 39290, Batch metrics: Loss: 7.3853, Accuracy: 0.0630, Perplexity: 1612.1401
2024-12-31 23:30:38,700 - TrainingLogger - INFO - Step 39300, Batch metrics: Loss: 7.8008, Accuracy: 0.0963, Perplexity: 2442.6201
2024-12-31 23:30:38,701 - TrainingLogger - INFO - Step 39300, Prediction vs Actual:
2024-12-31 23:30:38,701 - TrainingLogger - INFO - Input 1: דיין קודיש עצמה לא השתכנעה
2024-12-31 23:30:38,701 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:30:38,701 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁די          | ✗     |
|     1 | ▁אני            | ין           | ✗     |
|     2 | ,               | ▁קוד         | ✗     |
|     3 | מן              | יש           | ✗     |
|     4 | ן               | ▁עצמה        | ✗     |
|     5 | :               | ▁לא          | ✗     |
|     6 | ▁יציבה          | ▁השתכנע      | ✗     |
|     7 | ה               | ה            | ✓     |
|     8 | .               | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ית              | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁היא            | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ▁לא             | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ▁היא            | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁לא             | <pad>        | ✗     |
|    32 | ה               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ▁היא            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ה               | <pad>        | ✗     |
|    40 | ה               |              | ✗     |

2024-12-31 23:30:38,702 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:30:38,707 - TrainingLogger - INFO - Gradient norm: 7.0641
2024-12-31 23:30:45,688 - TrainingLogger - INFO - Step 39310, Batch metrics: Loss: 7.4908, Accuracy: 0.0674, Perplexity: 1791.5460
2024-12-31 23:30:52,308 - TrainingLogger - INFO - Step 39320, Batch metrics: Loss: 7.1727, Accuracy: 0.0914, Perplexity: 1303.3955
2024-12-31 23:30:59,943 - TrainingLogger - INFO - Step 39330, Batch metrics: Loss: 7.0043, Accuracy: 0.0914, Perplexity: 1101.3138
2024-12-31 23:31:07,532 - TrainingLogger - INFO - Step 39340, Batch metrics: Loss: 7.1915, Accuracy: 0.0856, Perplexity: 1328.0586
2024-12-31 23:31:14,899 - TrainingLogger - INFO - Step 39350, Batch metrics: Loss: 7.1822, Accuracy: 0.1218, Perplexity: 1315.8481
2024-12-31 23:31:22,428 - TrainingLogger - INFO - Step 39360, Batch metrics: Loss: 7.2022, Accuracy: 0.0751, Perplexity: 1342.3455
2024-12-31 23:31:29,720 - TrainingLogger - INFO - Step 39370, Batch metrics: Loss: 7.4127, Accuracy: 0.0643, Perplexity: 1656.9100
2024-12-31 23:31:37,471 - TrainingLogger - INFO - Step 39380, Batch metrics: Loss: 7.3208, Accuracy: 0.1124, Perplexity: 1511.4614
2024-12-31 23:31:44,586 - TrainingLogger - INFO - Step 39390, Batch metrics: Loss: 7.5192, Accuracy: 0.0853, Perplexity: 1843.0260
2024-12-31 23:31:51,566 - TrainingLogger - INFO - Step 39400, Batch metrics: Loss: 7.5713, Accuracy: 0.0934, Perplexity: 1941.6286
2024-12-31 23:31:51,566 - TrainingLogger - INFO - Step 39400, Prediction vs Actual:
2024-12-31 23:31:51,566 - TrainingLogger - INFO - Input 1: אם היו ננקטים אמצעי פיקוח נוקשים בשלב מוקדם יותר התוצאה הייתה טובה יותר עכשיו, אמר מא גואוציאנג
2024-12-31 23:31:51,567 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:31:51,567 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אם          | ✗     |
|     1 | ▁-              | ▁היו         | ✗     |
|     2 | ▁-              | ▁ננק         | ✗     |
|     3 | ▁-              | טים          | ✗     |
|     4 | ,               | ▁אמצעי       | ✗     |
|     5 | ים              | ▁פיקוח       | ✗     |
|     6 | ,               | ▁נו          | ✗     |
|     7 | קשים            | קשים         | ✓     |
|     8 | .               | ▁בשלב        | ✗     |
|     9 | ▁זה             | ▁מוקדם       | ✗     |
|    10 | ▁יותר           | ▁יותר        | ✓     |
|    11 | .               | ▁התוצאה      | ✗     |
|    12 | ▁היא            | ▁הייתה       | ✗     |
|    13 | ▁קשה            | ▁טובה        | ✗     |
|    14 | ▁יותר           | ▁יותר        | ✓     |
|    15 | .               | ▁עכשיו       | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | <pad>           | ▁אמר         | ✗     |
|    18 | ▁זאת            | ▁מא          | ✗     |
|    19 | נש              | ▁גו          | ✗     |
|    20 | עה              | אוציא        | ✗     |
|    21 | ,               | נג           | ✗     |
|    22 | '               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               |              | ✗     |

2024-12-31 23:31:51,567 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:31:51,572 - TrainingLogger - INFO - Gradient norm: 8.8486
2024-12-31 23:31:58,930 - TrainingLogger - INFO - Step 39410, Batch metrics: Loss: 6.8148, Accuracy: 0.1371, Perplexity: 911.2123
2024-12-31 23:32:05,789 - TrainingLogger - INFO - Step 39420, Batch metrics: Loss: 7.7931, Accuracy: 0.0580, Perplexity: 2423.7929
2024-12-31 23:32:13,080 - TrainingLogger - INFO - Step 39430, Batch metrics: Loss: 7.7741, Accuracy: 0.0658, Perplexity: 2378.2571
2024-12-31 23:32:20,198 - TrainingLogger - INFO - Step 39440, Batch metrics: Loss: 7.6270, Accuracy: 0.1164, Perplexity: 2052.8701
2024-12-31 23:32:26,974 - TrainingLogger - INFO - Step 39450, Batch metrics: Loss: 7.3900, Accuracy: 0.0786, Perplexity: 1619.7847
2024-12-31 23:32:34,125 - TrainingLogger - INFO - Step 39460, Batch metrics: Loss: 6.9812, Accuracy: 0.0565, Perplexity: 1076.2467
2024-12-31 23:32:41,204 - TrainingLogger - INFO - Step 39470, Batch metrics: Loss: 6.9203, Accuracy: 0.0925, Perplexity: 1012.6208
2024-12-31 23:32:48,320 - TrainingLogger - INFO - Step 39480, Batch metrics: Loss: 7.2451, Accuracy: 0.0781, Perplexity: 1401.1933
2024-12-31 23:32:55,382 - TrainingLogger - INFO - Step 39490, Batch metrics: Loss: 7.0098, Accuracy: 0.0915, Perplexity: 1107.4757
2024-12-31 23:33:02,851 - TrainingLogger - INFO - Step 39500, Batch metrics: Loss: 7.1574, Accuracy: 0.0808, Perplexity: 1283.5787
2024-12-31 23:33:02,851 - TrainingLogger - INFO - Step 39500, Prediction vs Actual:
2024-12-31 23:33:02,885 - TrainingLogger - INFO - Input 1: לא אחד, לא שניים לא שלושה
2024-12-31 23:33:02,886 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:33:02,886 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁לא          | ✗     |
|     1 | ▁-              | ▁אחד         | ✗     |
|     2 | ▁מהם            | ,            | ✗     |
|     3 | ▁שתיים          | ▁לא          | ✗     |
|     4 | ?               | ▁שניים       | ✗     |
|     5 | .               | ▁לא          | ✗     |
|     6 | ס               | ▁שלושה       | ✗     |
|     7 | ▁חודשים         | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁לא             | <pad>        | ✗     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | ▁לא             | <pad>        | ✗     |
|    21 | ?               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | ▁לא             | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | ▁לא             | <pad>        | ✗     |
|    37 | ▁לא             | <pad>        | ✗     |
|    38 | ▁לא             | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ,               |              | ✗     |

2024-12-31 23:33:02,886 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:33:02,891 - TrainingLogger - INFO - Gradient norm: 7.1334
2024-12-31 23:33:10,469 - TrainingLogger - INFO - Step 39510, Batch metrics: Loss: 7.1679, Accuracy: 0.0751, Perplexity: 1297.0653
2024-12-31 23:33:17,372 - TrainingLogger - INFO - Step 39520, Batch metrics: Loss: 7.5281, Accuracy: 0.0714, Perplexity: 1859.5096
2024-12-31 23:33:24,202 - TrainingLogger - INFO - Step 39530, Batch metrics: Loss: 7.4856, Accuracy: 0.0575, Perplexity: 1782.1396
2024-12-31 23:33:31,629 - TrainingLogger - INFO - Step 39540, Batch metrics: Loss: 7.4812, Accuracy: 0.0462, Perplexity: 1774.4512
2024-12-31 23:33:39,432 - TrainingLogger - INFO - Step 39550, Batch metrics: Loss: 7.3456, Accuracy: 0.0971, Perplexity: 1549.3542
2024-12-31 23:33:46,395 - TrainingLogger - INFO - Step 39560, Batch metrics: Loss: 7.4235, Accuracy: 0.0375, Perplexity: 1674.8200
2024-12-31 23:33:53,444 - TrainingLogger - INFO - Step 39570, Batch metrics: Loss: 7.4017, Accuracy: 0.0888, Perplexity: 1638.7117
2024-12-31 23:34:00,514 - TrainingLogger - INFO - Step 39580, Batch metrics: Loss: 7.4221, Accuracy: 0.0860, Perplexity: 1672.5678
2024-12-31 23:34:07,444 - TrainingLogger - INFO - Step 39590, Batch metrics: Loss: 7.3118, Accuracy: 0.0946, Perplexity: 1497.8767
2024-12-31 23:34:14,643 - TrainingLogger - INFO - Step 39600, Batch metrics: Loss: 6.8081, Accuracy: 0.1214, Perplexity: 905.1181
2024-12-31 23:34:14,643 - TrainingLogger - INFO - Step 39600, Prediction vs Actual:
2024-12-31 23:34:14,643 - TrainingLogger - INFO - Input 1: האחיות לא הצליחו להיות ביחד בשליחות, אבל שיתפו בחוויות
2024-12-31 23:34:14,643 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:34:14,643 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁האחיות      | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ▁-              | ▁הצליחו      | ✗     |
|     3 | ▁-              | ▁להיות       | ✗     |
|     4 | ▁בטוחים         | ▁ביחד        | ✗     |
|     5 | ▁עם             | ▁בשלי        | ✗     |
|     6 | חות             | חות          | ✓     |
|     7 | .               | ,            | ✗     |
|     8 | <pad>           | ▁אבל         | ✗     |
|     9 | ▁אני            | ▁שיתפ        | ✗     |
|    10 | ת               | ו            | ✗     |
|    11 | ▁פעולה          | ▁ב           | ✗     |
|    12 | דין             | חוויות       | ✗     |
|    13 | ▁שלכם           | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | ▁פעולה          | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 23:34:14,643 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:34:14,648 - TrainingLogger - INFO - Gradient norm: 7.7325
2024-12-31 23:34:21,751 - TrainingLogger - INFO - Step 39610, Batch metrics: Loss: 7.3590, Accuracy: 0.0769, Perplexity: 1570.3205
2024-12-31 23:34:28,757 - TrainingLogger - INFO - Step 39620, Batch metrics: Loss: 7.1303, Accuracy: 0.0789, Perplexity: 1249.2934
2024-12-31 23:34:36,444 - TrainingLogger - INFO - Step 39630, Batch metrics: Loss: 8.1778, Accuracy: 0.0622, Perplexity: 3560.9242
2024-12-31 23:34:43,478 - TrainingLogger - INFO - Step 39640, Batch metrics: Loss: 7.1056, Accuracy: 0.0851, Perplexity: 1218.7532
2024-12-31 23:34:50,797 - TrainingLogger - INFO - Step 39650, Batch metrics: Loss: 7.4034, Accuracy: 0.0718, Perplexity: 1641.6023
2024-12-31 23:34:58,126 - TrainingLogger - INFO - Step 39660, Batch metrics: Loss: 7.7576, Accuracy: 0.0657, Perplexity: 2339.3289
2024-12-31 23:35:05,319 - TrainingLogger - INFO - Step 39670, Batch metrics: Loss: 6.7851, Accuracy: 0.1620, Perplexity: 884.5495
2024-12-31 23:35:12,837 - TrainingLogger - INFO - Step 39680, Batch metrics: Loss: 6.9333, Accuracy: 0.1030, Perplexity: 1025.8332
2024-12-31 23:35:20,307 - TrainingLogger - INFO - Step 39690, Batch metrics: Loss: 7.3702, Accuracy: 0.0886, Perplexity: 1587.9311
2024-12-31 23:35:27,347 - TrainingLogger - INFO - Step 39700, Batch metrics: Loss: 8.3358, Accuracy: 0.0387, Perplexity: 4170.7243
2024-12-31 23:35:27,348 - TrainingLogger - INFO - Step 39700, Prediction vs Actual:
2024-12-31 23:35:27,348 - TrainingLogger - INFO - Input 1: נתניהו מנהל מגעים עם הציבור הערבי ואפילו על פי הפרסום הבוקר גם הפלסטינים ברמלה דרך פטין מולא
2024-12-31 23:35:27,348 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:35:27,348 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁נתנ         | ✗     |
|     1 | ▁-              | יהו          | ✗     |
|     2 | ▁-              | ▁מנהל        | ✗     |
|     3 | ▁-              | ▁מגע         | ✗     |
|     4 | ▁-              | ים           | ✗     |
|     5 | ▁חדשים          | ▁עם          | ✗     |
|     6 | ▁כל             | ▁הציבור      | ✗     |
|     7 | .               | ▁הערב        | ✗     |
|     8 | .               | י            | ✗     |
|     9 | ,               | ▁ואפילו      | ✗     |
|    10 | ▁עם             | ▁על          | ✗     |
|    11 | ▁ידי            | ▁פי          | ✗     |
|    12 | ▁מה             | ▁הפרסום      | ✗     |
|    13 | ▁שלו            | ▁הבוקר       | ✗     |
|    14 | ים              | ▁גם          | ✗     |
|    15 | ▁היום           | ▁הפלסטי      | ✗     |
|    16 | ני              | נים          | ✗     |
|    17 | ▁שלו            | ▁בר          | ✗     |
|    18 | ה               | מלה          | ✗     |
|    19 | .               | ▁דרך         | ✗     |
|    20 | ▁אגב            | ▁פטי         | ✗     |
|    21 | רתו             | ן            | ✗     |
|    22 | ,               | ▁מו          | ✗     |
|    23 | ה               | לא           | ✗     |
|    24 | ס               | <pad>        | ✗     |
|    25 | צה              | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 23:35:27,348 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:35:27,353 - TrainingLogger - INFO - Gradient norm: 8.0606
2024-12-31 23:35:34,068 - TrainingLogger - INFO - Step 39710, Batch metrics: Loss: 7.7134, Accuracy: 0.0697, Perplexity: 2238.1121
2024-12-31 23:35:41,475 - TrainingLogger - INFO - Step 39720, Batch metrics: Loss: 7.4522, Accuracy: 0.0810, Perplexity: 1723.6599
2024-12-31 23:35:48,132 - TrainingLogger - INFO - Step 39730, Batch metrics: Loss: 7.1095, Accuracy: 0.0957, Perplexity: 1223.4842
2024-12-31 23:35:55,506 - TrainingLogger - INFO - Step 39740, Batch metrics: Loss: 7.1623, Accuracy: 0.0564, Perplexity: 1289.9279
2024-12-31 23:36:02,725 - TrainingLogger - INFO - Step 39750, Batch metrics: Loss: 7.6946, Accuracy: 0.0574, Perplexity: 2196.4951
2024-12-31 23:36:10,196 - TrainingLogger - INFO - Step 39760, Batch metrics: Loss: 7.5421, Accuracy: 0.1033, Perplexity: 1885.7329
2024-12-31 23:36:17,285 - TrainingLogger - INFO - Step 39770, Batch metrics: Loss: 7.4361, Accuracy: 0.0818, Perplexity: 1696.1346
2024-12-31 23:36:24,580 - TrainingLogger - INFO - Step 39780, Batch metrics: Loss: 7.0654, Accuracy: 0.0994, Perplexity: 1170.7241
2024-12-31 23:36:31,462 - TrainingLogger - INFO - Step 39790, Batch metrics: Loss: 7.2482, Accuracy: 0.1170, Perplexity: 1405.5363
2024-12-31 23:36:38,547 - TrainingLogger - INFO - Step 39800, Batch metrics: Loss: 7.3596, Accuracy: 0.0520, Perplexity: 1571.2283
2024-12-31 23:36:38,547 - TrainingLogger - INFO - Step 39800, Prediction vs Actual:
2024-12-31 23:36:38,547 - TrainingLogger - INFO - Input 1: זו לא הפעם הראשונה שתושבי עוטף עזה עדים להתעללות בבעלי חיים לצורך ניסיון לבצע פיגוע טרור מצדם של פלסטינים ברצועת עזה
2024-12-31 23:36:38,548 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:36:38,548 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זו          | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ▁-              | ▁הפעם        | ✗     |
|     3 | ▁אני            | ▁הראשונה     | ✗     |
|     4 | ▁שלך            | ▁שתו         | ✗     |
|     5 | ות              | שבי          | ✗     |
|     6 | נו              | ▁עו          | ✗     |
|     7 | "               | טף           | ✗     |
|     8 | .               | ▁עזה         | ✗     |
|     9 | .               | ▁עדים        | ✗     |
|    10 | ▁לזה            | ▁ל           | ✗     |
|    11 | תביעה           | התעללות      | ✗     |
|    12 | ▁הזאת           | ▁בבעלי       | ✗     |
|    13 | ▁חיים           | ▁חיים        | ✓     |
|    14 | ▁חדשים          | ▁לצורך       | ✗     |
|    15 | ▁זה             | ▁ניסיון      | ✗     |
|    16 | ▁נוסף           | ▁לבצע        | ✗     |
|    17 | ▁את             | ▁פי          | ✗     |
|    18 | ה               | גוע          | ✗     |
|    19 | י               | ▁טרור        | ✗     |
|    20 | .               | ▁מצד         | ✗     |
|    21 | ▁שני            | ם            | ✗     |
|    22 | .               | ▁של          | ✗     |
|    23 | ▁אנשים          | ▁פלסטי       | ✗     |
|    24 | ים              | נים          | ✗     |
|    25 | .               | ▁ב           | ✗     |
|    26 | כדורגל          | רצו          | ✗     |
|    27 | נה              | עת           | ✗     |
|    28 | ו               | ▁עזה         | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 23:36:38,548 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:36:38,553 - TrainingLogger - INFO - Gradient norm: 8.8175
2024-12-31 23:36:45,946 - TrainingLogger - INFO - Step 39810, Batch metrics: Loss: 7.5689, Accuracy: 0.0693, Perplexity: 1936.9412
2024-12-31 23:36:53,131 - TrainingLogger - INFO - Step 39820, Batch metrics: Loss: 7.1614, Accuracy: 0.1250, Perplexity: 1288.7346
2024-12-31 23:37:00,258 - TrainingLogger - INFO - Step 39830, Batch metrics: Loss: 7.1255, Accuracy: 0.1135, Perplexity: 1243.2912
2024-12-31 23:37:07,481 - TrainingLogger - INFO - Step 39840, Batch metrics: Loss: 7.4280, Accuracy: 0.0688, Perplexity: 1682.3655
2024-12-31 23:37:14,518 - TrainingLogger - INFO - Step 39850, Batch metrics: Loss: 7.2466, Accuracy: 0.1086, Perplexity: 1403.3089
2024-12-31 23:37:21,906 - TrainingLogger - INFO - Step 39860, Batch metrics: Loss: 7.4766, Accuracy: 0.1018, Perplexity: 1766.2030
2024-12-31 23:37:29,496 - TrainingLogger - INFO - Step 39870, Batch metrics: Loss: 7.2313, Accuracy: 0.0690, Perplexity: 1382.0257
2024-12-31 23:37:36,881 - TrainingLogger - INFO - Step 39880, Batch metrics: Loss: 7.5561, Accuracy: 0.0639, Perplexity: 1912.3579
2024-12-31 23:37:45,478 - TrainingLogger - INFO - Step 39890, Batch metrics: Loss: 7.4584, Accuracy: 0.0684, Perplexity: 1734.4201
2024-12-31 23:37:52,651 - TrainingLogger - INFO - Step 39900, Batch metrics: Loss: 7.1271, Accuracy: 0.0870, Perplexity: 1245.2207
2024-12-31 23:37:52,652 - TrainingLogger - INFO - Step 39900, Prediction vs Actual:
2024-12-31 23:37:52,652 - TrainingLogger - INFO - Input 1: איך אתם מתמודדים עם השינויים בעולם העבודה ועליית הפרילנסרים בישראל? לנו אין סמכות על מי שלא נמצא ביחסי עובד מעביד, ולכן הפתרון יהיה יותר בחינוך מאשר אכיפה
2024-12-31 23:37:52,652 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:37:52,652 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁איך         | ✗     |
|     1 | ?               | ▁אתם         | ✗     |
|     2 | ?               | ▁מתמודדים    | ✗     |
|     3 | ▁עם             | ▁עם          | ✓     |
|     4 | ?               | ▁השינויים    | ✗     |
|     5 | ?               | ▁בעולם       | ✗     |
|     6 | ▁הזה            | ▁העבודה      | ✗     |
|     7 | ▁שלך            | ▁ועליי       | ✗     |
|     8 | ?               | ת            | ✗     |
|     9 | ▁חיים           | ▁הפרי        | ✗     |
|    10 | ציה             | ל            | ✗     |
|    11 | יזם             | נס           | ✗     |
|    12 | ?               | רים          | ✗     |
|    13 | ?               | ▁בישראל      | ✗     |
|    14 | ?               | ?            | ✓     |
|    15 | </s>            | ▁לנו         | ✗     |
|    16 | ▁יש             | ▁אין         | ✗     |
|    17 | ▁סיכוי          | ▁סמכות       | ✗     |
|    18 | </s>            | ▁על          | ✗     |
|    19 | ▁זה             | ▁מי          | ✗     |
|    20 | רב              | ▁שלא         | ✗     |
|    21 | ▁אכפת           | ▁נמצא        | ✗     |
|    22 | ▁בו             | ▁ביחסי       | ✗     |
|    23 | ים              | ▁עובד        | ✗     |
|    24 | ▁עם             | ▁            | ✗     |
|    25 | תקיף            | מעביד        | ✗     |
|    26 | .               | ,            | ✗     |
|    27 | <pad>           | ▁ולכן        | ✗     |
|    28 | ▁לא             | ▁הפתרון      | ✗     |
|    29 | ▁שלנו           | ▁יהיה        | ✗     |
|    30 | ▁קשה            | ▁יותר        | ✗     |
|    31 | ▁גרוע           | ▁ב           | ✗     |
|    32 | פרלמנט          | חינוך        | ✗     |
|    33 | ▁זה             | ▁מאשר        | ✗     |
|    34 | ▁יחד            | ▁אכ          | ✗     |
|    35 | הל              | יפה          | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2024-12-31 23:37:52,652 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:37:52,657 - TrainingLogger - INFO - Gradient norm: 9.1654
2024-12-31 23:37:59,715 - TrainingLogger - INFO - Step 39910, Batch metrics: Loss: 7.4188, Accuracy: 0.0746, Perplexity: 1667.0492
2024-12-31 23:38:07,171 - TrainingLogger - INFO - Step 39920, Batch metrics: Loss: 6.9686, Accuracy: 0.0655, Perplexity: 1062.7382
2024-12-31 23:38:13,973 - TrainingLogger - INFO - Step 39930, Batch metrics: Loss: 7.6583, Accuracy: 0.0649, Perplexity: 2118.1847
2024-12-31 23:38:21,475 - TrainingLogger - INFO - Step 39940, Batch metrics: Loss: 7.4027, Accuracy: 0.0442, Perplexity: 1640.4880
2024-12-31 23:38:28,956 - TrainingLogger - INFO - Step 39950, Batch metrics: Loss: 7.4789, Accuracy: 0.0524, Perplexity: 1770.3446
2024-12-31 23:38:36,438 - TrainingLogger - INFO - Step 39960, Batch metrics: Loss: 7.7586, Accuracy: 0.0757, Perplexity: 2341.6715
2024-12-31 23:38:43,141 - TrainingLogger - INFO - Step 39970, Batch metrics: Loss: 7.2080, Accuracy: 0.0629, Perplexity: 1350.2055
2024-12-31 23:38:50,089 - TrainingLogger - INFO - Step 39980, Batch metrics: Loss: 7.4165, Accuracy: 0.0822, Perplexity: 1663.2340
2024-12-31 23:38:56,631 - TrainingLogger - INFO - Step 39990, Batch metrics: Loss: 7.4005, Accuracy: 0.0570, Perplexity: 1636.8523
2024-12-31 23:39:04,472 - TrainingLogger - INFO - Step 40000, Batch metrics: Loss: 7.6298, Accuracy: 0.0471, Perplexity: 2058.6428
2024-12-31 23:39:04,473 - TrainingLogger - INFO - Step 40000, Prediction vs Actual:
2024-12-31 23:39:04,473 - TrainingLogger - INFO - Input 1: אהבת ישראל היא התנגדות לנתניהו
2024-12-31 23:39:04,473 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:39:04,473 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אהבת        | ✗     |
|     1 | ?               | ▁ישראל       | ✗     |
|     2 | ?               | ▁היא         | ✗     |
|     3 | ▁לא             | ▁התנגדות     | ✗     |
|     4 | ▁לכך            | ▁לנ          | ✗     |
|     5 | כות             | תני          | ✗     |
|     6 | ה               | הו           | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | ▁לא             | <pad>        | ✗     |
|     9 | ה               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ▁לא             | <pad>        | ✗     |
|    16 | ▁ל              | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ▁הדבר           | <pad>        | ✗     |
|    22 | ▁יהוה           | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁היא            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ו               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ▁לא             | <pad>        | ✗     |
|    45 | ▁לא             | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | ועים            | <pad>        | ✗     |
|    50 | </s>            |              | ✗     |

2024-12-31 23:39:04,474 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:39:04,478 - TrainingLogger - INFO - Gradient norm: 13.2736
2024-12-31 23:39:11,684 - TrainingLogger - INFO - Step 40010, Batch metrics: Loss: 7.0705, Accuracy: 0.0922, Perplexity: 1176.6907
2024-12-31 23:39:19,232 - TrainingLogger - INFO - Step 40020, Batch metrics: Loss: 7.2412, Accuracy: 0.0987, Perplexity: 1395.7878
2024-12-31 23:39:26,315 - TrainingLogger - INFO - Step 40030, Batch metrics: Loss: 7.4604, Accuracy: 0.0636, Perplexity: 1737.8001
2024-12-31 23:39:33,767 - TrainingLogger - INFO - Step 40040, Batch metrics: Loss: 6.8751, Accuracy: 0.1099, Perplexity: 967.8690
2024-12-31 23:39:40,681 - TrainingLogger - INFO - Step 40050, Batch metrics: Loss: 6.9744, Accuracy: 0.0833, Perplexity: 1068.9086
2024-12-31 23:39:47,959 - TrainingLogger - INFO - Step 40060, Batch metrics: Loss: 7.3779, Accuracy: 0.0769, Perplexity: 1600.1466
2024-12-31 23:39:55,597 - TrainingLogger - INFO - Step 40070, Batch metrics: Loss: 7.1711, Accuracy: 0.1099, Perplexity: 1301.2419
2024-12-31 23:40:02,722 - TrainingLogger - INFO - Step 40080, Batch metrics: Loss: 7.4685, Accuracy: 0.0602, Perplexity: 1752.0029
2024-12-31 23:40:09,751 - TrainingLogger - INFO - Step 40090, Batch metrics: Loss: 7.3344, Accuracy: 0.0966, Perplexity: 1532.1487
2024-12-31 23:40:17,385 - TrainingLogger - INFO - Step 40100, Batch metrics: Loss: 7.6619, Accuracy: 0.0788, Perplexity: 2125.8890
2024-12-31 23:40:17,385 - TrainingLogger - INFO - Step 40100, Prediction vs Actual:
2024-12-31 23:40:17,419 - TrainingLogger - INFO - Input 1: בסביבת בנט הדגישו כי רהמ לשעבר לא עסק במהלך כהונתו בנושא הפלסטיני, שלא עלה במפגשים מדיניים, ולדבריהם חבל לחזור אחורה
2024-12-31 23:40:17,420 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:40:17,420 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בסביבת      | ✗     |
|     1 | ה               | ▁בנט         | ✗     |
|     2 | ▁היא            | ▁הדגיש       | ✗     |
|     3 | ה               | ו            | ✗     |
|     4 | ▁את             | ▁כי          | ✗     |
|     5 | ▁היא            | ▁ר           | ✗     |
|     6 | ת               | המ           | ✗     |
|     7 | ינגטון          | ▁לשעבר       | ✗     |
|     8 | ,               | ▁לא          | ✗     |
|     9 | ▁הייתה          | ▁עסק         | ✗     |
|    10 | ה               | ▁במהלך       | ✗     |
|    11 | ▁המלחמה         | ▁כה          | ✗     |
|    12 | ונה             | ונת          | ✗     |
|    13 | ו               | ו            | ✓     |
|    14 | .               | ▁בנושא       | ✗     |
|    15 | .               | ▁הפלסטי      | ✗     |
|    16 | ני              | ני           | ✓     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁שלא         | ✗     |
|    19 | ▁היה            | ▁על          | ✗     |
|    20 | ה               | ה            | ✓     |
|    21 | ▁בידו           | ▁במפגש       | ✗     |
|    22 | .               | ים           | ✗     |
|    23 | .               | ▁מדי         | ✗     |
|    24 | .               | ניים         | ✗     |
|    25 | .               | ,            | ✗     |
|    26 | </s>            | ▁ולדבר       | ✗     |
|    27 | ▁עם             | יהם          | ✗     |
|    28 | ▁לא             | ▁חבל         | ✗     |
|    29 | ▁עליהם          | ▁לחזור       | ✗     |
|    30 | ▁עליהם          | ▁אחורה       | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               |              | ✗     |

2024-12-31 23:40:17,420 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:40:17,425 - TrainingLogger - INFO - Gradient norm: 9.1679
2024-12-31 23:40:24,558 - TrainingLogger - INFO - Step 40110, Batch metrics: Loss: 7.3121, Accuracy: 0.0847, Perplexity: 1498.3424
2024-12-31 23:40:31,241 - TrainingLogger - INFO - Step 40120, Batch metrics: Loss: 7.3456, Accuracy: 0.0932, Perplexity: 1549.4310
2024-12-31 23:40:38,369 - TrainingLogger - INFO - Step 40130, Batch metrics: Loss: 7.3806, Accuracy: 0.0394, Perplexity: 1604.5920
2024-12-31 23:40:45,487 - TrainingLogger - INFO - Step 40140, Batch metrics: Loss: 7.1277, Accuracy: 0.0629, Perplexity: 1245.9964
2024-12-31 23:40:52,723 - TrainingLogger - INFO - Step 40150, Batch metrics: Loss: 7.6709, Accuracy: 0.0676, Perplexity: 2145.0681
2024-12-31 23:41:00,046 - TrainingLogger - INFO - Step 40160, Batch metrics: Loss: 6.7030, Accuracy: 0.1071, Perplexity: 814.8510
2024-12-31 23:41:07,580 - TrainingLogger - INFO - Step 40170, Batch metrics: Loss: 7.3655, Accuracy: 0.0866, Perplexity: 1580.5650
2024-12-31 23:41:14,654 - TrainingLogger - INFO - Step 40180, Batch metrics: Loss: 7.3188, Accuracy: 0.1000, Perplexity: 1508.3568
2024-12-31 23:41:21,429 - TrainingLogger - INFO - Step 40190, Batch metrics: Loss: 7.9690, Accuracy: 0.0698, Perplexity: 2890.0772
2024-12-31 23:41:28,478 - TrainingLogger - INFO - Step 40200, Batch metrics: Loss: 7.5467, Accuracy: 0.0881, Perplexity: 1894.4960
2024-12-31 23:41:28,479 - TrainingLogger - INFO - Step 40200, Prediction vs Actual:
2024-12-31 23:41:28,479 - TrainingLogger - INFO - Input 1: סיבוב הפרסה המדיני שעשה דונלד טראמפ יצמצם עוד יותר את מרחב התמרון של האיראנים
2024-12-31 23:41:28,479 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:41:28,479 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁בספרדית        | ▁סיבוב       | ✗     |
|     1 | ▁-              | ▁הפרס        | ✗     |
|     2 | ▁-              | ה            | ✗     |
|     3 | ▁-              | ▁המד         | ✗     |
|     4 | ▁-              | יני          | ✗     |
|     5 | ת               | ▁שעשה        | ✗     |
|     6 | ▁את             | ▁דונלד       | ✗     |
|     7 | סון             | ▁טר          | ✗     |
|     8 | ה               | אמפ          | ✗     |
|     9 | י               | ▁י           | ✗     |
|    10 | ון              | צמצם         | ✗     |
|    11 | ▁את             | ▁עוד         | ✗     |
|    12 | ▁זמן            | ▁יותר        | ✗     |
|    13 | ▁את             | ▁את          | ✓     |
|    14 | ▁המשימה         | ▁מרחב        | ✗     |
|    15 | ▁העבודה         | ▁התמ         | ✗     |
|    16 | רור             | רון          | ✗     |
|    17 | .               | ▁של          | ✗     |
|    18 | ▁"              | ▁האיר        | ✗     |
|    19 | ים              | אני          | ✗     |
|    20 | ות              | ם            | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | יים             | <pad>        | ✗     |
|    25 | ים              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ים              | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ים              | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | ים              | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | ▁הם             | <pad>        | ✗     |
|    40 | י               | <pad>        | ✗     |
|    41 | ▁הם             | <pad>        | ✗     |
|    42 | י               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ה               | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | <pad>           | <pad>        | ✓     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | ▁אני            |              | ✗     |

2024-12-31 23:41:28,479 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:41:28,484 - TrainingLogger - INFO - Gradient norm: 8.5426
2024-12-31 23:41:35,688 - TrainingLogger - INFO - Step 40210, Batch metrics: Loss: 7.4034, Accuracy: 0.0904, Perplexity: 1641.5248
2024-12-31 23:41:42,783 - TrainingLogger - INFO - Step 40220, Batch metrics: Loss: 6.9029, Accuracy: 0.0885, Perplexity: 995.2061
2024-12-31 23:41:50,500 - TrainingLogger - INFO - Step 40230, Batch metrics: Loss: 7.2994, Accuracy: 0.0762, Perplexity: 1479.4104
2024-12-31 23:41:57,148 - TrainingLogger - INFO - Step 40240, Batch metrics: Loss: 6.7533, Accuracy: 0.1183, Perplexity: 856.9192
2024-12-31 23:42:04,532 - TrainingLogger - INFO - Step 40250, Batch metrics: Loss: 7.2548, Accuracy: 0.0544, Perplexity: 1414.8528
2024-12-31 23:42:11,559 - TrainingLogger - INFO - Step 40260, Batch metrics: Loss: 7.3295, Accuracy: 0.0599, Perplexity: 1524.6385
2024-12-31 23:42:18,892 - TrainingLogger - INFO - Step 40270, Batch metrics: Loss: 7.4089, Accuracy: 0.0800, Perplexity: 1650.6353
2024-12-31 23:42:26,436 - TrainingLogger - INFO - Step 40280, Batch metrics: Loss: 7.0209, Accuracy: 0.0833, Perplexity: 1119.7686
2024-12-31 23:42:33,393 - TrainingLogger - INFO - Step 40290, Batch metrics: Loss: 7.4630, Accuracy: 0.0855, Perplexity: 1742.3346
2024-12-31 23:42:40,641 - TrainingLogger - INFO - Step 40300, Batch metrics: Loss: 7.4629, Accuracy: 0.0986, Perplexity: 1742.1602
2024-12-31 23:42:40,641 - TrainingLogger - INFO - Step 40300, Prediction vs Actual:
2024-12-31 23:42:40,641 - TrainingLogger - INFO - Input 1: האמונה מנצחת, הכוח והחזון שלכן ינצחו, אני מצדיע לכן ועוזר במה שצריך
2024-12-31 23:42:40,642 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:42:40,642 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁האמונה      | ✗     |
|     1 | ▁עולמית         | ▁מנצחת       | ✗     |
|     2 | ▁זאת            | ,            | ✗     |
|     3 | ▁היא            | ▁הכוח        | ✗     |
|     4 | ▁הגדול          | ▁וה          | ✗     |
|     5 | כוח             | חזון         | ✗     |
|     6 | ,               | ▁שלכן        | ✗     |
|     7 | ,               | ▁ינצח        | ✗     |
|     8 | ו               | ו            | ✓     |
|     9 | .               | ,            | ✗     |
|    10 | </s>            | ▁אני         | ✗     |
|    11 | ▁מבטיח          | ▁מצדיע       | ✗     |
|    12 | ▁לכם            | ▁לכן         | ✗     |
|    13 | ,               | ▁ועוזר       | ✗     |
|    14 | ▁לכם            | ▁במה         | ✗     |
|    15 | ▁שיש            | ▁שצריך       | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ▁לכם            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁לכם            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁לכם            | <pad>        | ✗     |
|    33 | </s>            |              | ✗     |

2024-12-31 23:42:40,642 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:42:40,647 - TrainingLogger - INFO - Gradient norm: 9.0285
2024-12-31 23:42:48,114 - TrainingLogger - INFO - Step 40310, Batch metrics: Loss: 7.2691, Accuracy: 0.0991, Perplexity: 1435.2584
2024-12-31 23:42:55,184 - TrainingLogger - INFO - Step 40320, Batch metrics: Loss: 7.0336, Accuracy: 0.0724, Perplexity: 1134.1243
2024-12-31 23:43:02,211 - TrainingLogger - INFO - Step 40330, Batch metrics: Loss: 6.9921, Accuracy: 0.0952, Perplexity: 1088.0026
2024-12-31 23:43:09,300 - TrainingLogger - INFO - Step 40340, Batch metrics: Loss: 6.9336, Accuracy: 0.1224, Perplexity: 1026.1688
2024-12-31 23:43:16,577 - TrainingLogger - INFO - Step 40350, Batch metrics: Loss: 7.0315, Accuracy: 0.1357, Perplexity: 1131.7225
2024-12-31 23:43:23,392 - TrainingLogger - INFO - Step 40360, Batch metrics: Loss: 6.9085, Accuracy: 0.1447, Perplexity: 1000.7862
2024-12-31 23:43:30,368 - TrainingLogger - INFO - Step 40370, Batch metrics: Loss: 7.5617, Accuracy: 0.0534, Perplexity: 1923.0512
2024-12-31 23:43:37,482 - TrainingLogger - INFO - Step 40380, Batch metrics: Loss: 7.6234, Accuracy: 0.0867, Perplexity: 2045.6050
2024-12-31 23:43:44,191 - TrainingLogger - INFO - Step 40390, Batch metrics: Loss: 7.4547, Accuracy: 0.0806, Perplexity: 1727.9869
2024-12-31 23:43:51,548 - TrainingLogger - INFO - Step 40400, Batch metrics: Loss: 7.6632, Accuracy: 0.0702, Perplexity: 2128.5232
2024-12-31 23:43:51,548 - TrainingLogger - INFO - Step 40400, Prediction vs Actual:
2024-12-31 23:43:51,548 - TrainingLogger - INFO - Input 1: אהיה בסוף חכ מן המניין - כפי שהתחייבתי מראש, ציין חכ אמסלם לאחר פגישתו עם ראש הממשלה המיועד
2024-12-31 23:43:51,548 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:43:51,548 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אהיה        | ✗     |
|     1 | ▁-              | ▁בסוף        | ✗     |
|     2 | ▁-              | ▁ח           | ✗     |
|     3 | ▁זה             | כ            | ✗     |
|     4 | מי              | ▁מן          | ✗     |
|     5 | ,               | ▁המנ         | ✗     |
|     6 | יין             | יין          | ✓     |
|     7 | .               | ▁-           | ✗     |
|     8 | -               | ▁כפי         | ✗     |
|     9 | ▁שהוא           | ▁שהת         | ✗     |
|    10 | אר              | חייבת        | ✗     |
|    11 | י               | י            | ✓     |
|    12 | ▁לך             | ▁מראש        | ✗     |
|    13 | .               | ,            | ✗     |
|    14 | <pad>           | ▁ציין        | ✗     |
|    15 | ▁גם             | ▁ח           | ✗     |
|    16 | ▁':             | כ            | ✗     |
|    17 | מי              | ▁אמ          | ✗     |
|    18 | "               | סל           | ✗     |
|    19 | :               | ם            | ✗     |
|    20 | ,               | ▁לאחר        | ✗     |
|    21 | ▁מכן            | ▁פגישת       | ✗     |
|    22 | ו               | ו            | ✓     |
|    23 | ▁עם             | ▁עם          | ✓     |
|    24 | ▁ה              | ▁ראש         | ✗     |
|    25 | ▁העיר           | ▁הממשלה      | ✗     |
|    26 | .               | ▁המיועד      | ✗     |
|    27 | ת               | <pad>        | ✗     |
|    28 | ת               | <pad>        | ✗     |
|    29 | </s>            |              | ✗     |

2024-12-31 23:43:51,548 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:43:51,553 - TrainingLogger - INFO - Gradient norm: 7.3687
2024-12-31 23:43:59,146 - TrainingLogger - INFO - Step 40410, Batch metrics: Loss: 8.1140, Accuracy: 0.0213, Perplexity: 3340.9161
2024-12-31 23:44:06,320 - TrainingLogger - INFO - Step 40420, Batch metrics: Loss: 7.5919, Accuracy: 0.0634, Perplexity: 1982.0350
2024-12-31 23:44:13,528 - TrainingLogger - INFO - Step 40430, Batch metrics: Loss: 7.3850, Accuracy: 0.1148, Perplexity: 1611.6866
2024-12-31 23:44:20,575 - TrainingLogger - INFO - Step 40440, Batch metrics: Loss: 7.9361, Accuracy: 0.0543, Perplexity: 2796.4078
2024-12-31 23:44:27,586 - TrainingLogger - INFO - Step 40450, Batch metrics: Loss: 7.2817, Accuracy: 0.0675, Perplexity: 1453.4501
2024-12-31 23:44:34,688 - TrainingLogger - INFO - Step 40460, Batch metrics: Loss: 7.3236, Accuracy: 0.0977, Perplexity: 1515.6358
2024-12-31 23:44:42,303 - TrainingLogger - INFO - Step 40470, Batch metrics: Loss: 7.3088, Accuracy: 0.0526, Perplexity: 1493.3808
2024-12-31 23:44:49,649 - TrainingLogger - INFO - Step 40480, Batch metrics: Loss: 7.3793, Accuracy: 0.0642, Perplexity: 1602.4197
2024-12-31 23:44:56,792 - TrainingLogger - INFO - Step 40490, Batch metrics: Loss: 7.7867, Accuracy: 0.0457, Perplexity: 2408.2495
2024-12-31 23:45:04,044 - TrainingLogger - INFO - Step 40500, Batch metrics: Loss: 7.1117, Accuracy: 0.0988, Perplexity: 1226.2322
2024-12-31 23:45:04,044 - TrainingLogger - INFO - Step 40500, Prediction vs Actual:
2024-12-31 23:45:04,044 - TrainingLogger - INFO - Input 1: בשל טעות אנוש, נמצאות מספר תמונות בגרפיקה של מחבלים שטרם נתפסו, אך נמצאים לפי המידע שברשותנו במרחב בית החולים ומתבצרים בו, נמסר
2024-12-31 23:45:04,045 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:45:04,045 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בשל         | ✗     |
|     1 | ל               | ▁טעות        | ✗     |
|     2 | ▁הו             | ▁אנוש        | ✗     |
|     3 | ות              | ,            | ✗     |
|     4 | <pad>           | ▁נמצאות      | ✗     |
|     5 | ▁בו             | ▁מספר        | ✗     |
|     6 | ד               | ▁תמונות      | ✗     |
|     7 | ▁חדשות          | ▁ב           | ✗     |
|     8 | -19             | גרפי         | ✗     |
|     9 | קה              | קה           | ✓     |
|    10 | .               | ▁של          | ✗     |
|    11 | ▁עדי            | ▁מחבל        | ✗     |
|    12 | ים              | ים           | ✓     |
|    13 | ▁חדשים          | ▁שטרם        | ✗     |
|    14 | ▁ניתן           | ▁נתפס        | ✗     |
|    15 | ו               | ו            | ✓     |
|    16 | ,               | ,            | ✓     |
|    17 | </s>            | ▁אך          | ✗     |
|    18 | ▁ורק            | ▁נמצאים      | ✗     |
|    19 | ▁בהן            | ▁לפי         | ✗     |
|    20 | הן              | ▁המידע       | ✗     |
|    21 | ▁הזה            | ▁ש           | ✗     |
|    22 | בוצע            | ברשות        | ✗     |
|    23 | ו               | נו           | ✗     |
|    24 | ,               | ▁במרחב       | ✗     |
|    25 | י               | ▁בית         | ✗     |
|    26 | ▁המשפט          | ▁החולים      | ✗     |
|    27 | .               | ▁ומת         | ✗     |
|    28 | קיים            | ב            | ✗     |
|    29 | וננים           | צרים         | ✗     |
|    30 | ▁גם             | ▁בו          | ✗     |
|    31 | .               | ,            | ✗     |
|    32 | </s>            | ▁נמסר        | ✗     |
|    33 | ▁להם            | <pad>        | ✗     |
|    34 | ▁גם             |              | ✗     |

2024-12-31 23:45:04,045 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:45:04,050 - TrainingLogger - INFO - Gradient norm: 10.2370
2024-12-31 23:45:11,208 - TrainingLogger - INFO - Step 40510, Batch metrics: Loss: 7.1470, Accuracy: 0.0777, Perplexity: 1270.2577
2024-12-31 23:45:17,897 - TrainingLogger - INFO - Step 40520, Batch metrics: Loss: 7.3040, Accuracy: 0.0645, Perplexity: 1486.2399
2024-12-31 23:45:25,125 - TrainingLogger - INFO - Step 40530, Batch metrics: Loss: 7.2731, Accuracy: 0.0769, Perplexity: 1441.0593
2024-12-31 23:45:32,836 - TrainingLogger - INFO - Step 40540, Batch metrics: Loss: 7.2584, Accuracy: 0.0898, Perplexity: 1419.9455
2024-12-31 23:45:40,161 - TrainingLogger - INFO - Step 40550, Batch metrics: Loss: 6.8236, Accuracy: 0.0933, Perplexity: 919.3230
2024-12-31 23:45:47,446 - TrainingLogger - INFO - Step 40560, Batch metrics: Loss: 7.6388, Accuracy: 0.0571, Perplexity: 2077.2628
2024-12-31 23:45:54,896 - TrainingLogger - INFO - Step 40570, Batch metrics: Loss: 7.6455, Accuracy: 0.0867, Perplexity: 2091.1774
2024-12-31 23:46:01,893 - TrainingLogger - INFO - Step 40580, Batch metrics: Loss: 7.4070, Accuracy: 0.0696, Perplexity: 1647.5465
2024-12-31 23:46:08,668 - TrainingLogger - INFO - Step 40590, Batch metrics: Loss: 6.9731, Accuracy: 0.1441, Perplexity: 1067.5618
2024-12-31 23:46:15,503 - TrainingLogger - INFO - Step 40600, Batch metrics: Loss: 6.7583, Accuracy: 0.0826, Perplexity: 861.1587
2024-12-31 23:46:15,503 - TrainingLogger - INFO - Step 40600, Prediction vs Actual:
2024-12-31 23:46:15,503 - TrainingLogger - INFO - Input 1: גדלת בקיבוץ, ועשית דרך ארוכה עד למקום אליו הגעת
2024-12-31 23:46:15,504 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:46:15,504 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁גדלת        | ✗     |
|     1 | ▁-              | ▁בקי         | ✗     |
|     2 | צו              | בוץ          | ✗     |
|     3 | </s>            | ,            | ✗     |
|     4 | <pad>           | ▁ועשית       | ✗     |
|     5 | ,               | ▁דרך         | ✗     |
|     6 | ▁חדשה           | ▁ארוכה       | ✗     |
|     7 | ▁יותר           | ▁עד          | ✗     |
|     8 | ▁כדי            | ▁למקום       | ✗     |
|     9 | ▁הזה            | ▁אליו        | ✗     |
|    10 | ▁הוא            | ▁הגעת        | ✗     |
|    11 | ▁לכאן           | <pad>        | ✗     |
|    12 | ▁היום           | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁יהוה           | <pad>        | ✗     |
|    19 | ▁אליו           | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁לשם            | <pad>        | ✗     |
|    24 | ▁לשם            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ,               |              | ✗     |

2024-12-31 23:46:15,504 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:46:15,509 - TrainingLogger - INFO - Gradient norm: 9.6683
2024-12-31 23:46:22,648 - TrainingLogger - INFO - Step 40610, Batch metrics: Loss: 7.4923, Accuracy: 0.0637, Perplexity: 1794.2108
2024-12-31 23:46:29,770 - TrainingLogger - INFO - Step 40620, Batch metrics: Loss: 7.3034, Accuracy: 0.0536, Perplexity: 1485.3331
2024-12-31 23:46:36,280 - TrainingLogger - INFO - Step 40630, Batch metrics: Loss: 7.6049, Accuracy: 0.0988, Perplexity: 2007.9611
2024-12-31 23:46:43,535 - TrainingLogger - INFO - Step 40640, Batch metrics: Loss: 7.0883, Accuracy: 0.0936, Perplexity: 1197.8511
2024-12-31 23:46:50,537 - TrainingLogger - INFO - Step 40650, Batch metrics: Loss: 7.1789, Accuracy: 0.0729, Perplexity: 1311.4089
2024-12-31 23:46:57,683 - TrainingLogger - INFO - Step 40660, Batch metrics: Loss: 7.3177, Accuracy: 0.0777, Perplexity: 1506.6625
2024-12-31 23:47:04,905 - TrainingLogger - INFO - Step 40670, Batch metrics: Loss: 7.3914, Accuracy: 0.0497, Perplexity: 1621.9395
2024-12-31 23:47:12,324 - TrainingLogger - INFO - Step 40680, Batch metrics: Loss: 7.0239, Accuracy: 0.1100, Perplexity: 1123.1600
2024-12-31 23:47:19,607 - TrainingLogger - INFO - Step 40690, Batch metrics: Loss: 7.0553, Accuracy: 0.0984, Perplexity: 1159.0152
2024-12-31 23:47:26,622 - TrainingLogger - INFO - Step 40700, Batch metrics: Loss: 7.5361, Accuracy: 0.0699, Perplexity: 1874.4487
2024-12-31 23:47:26,622 - TrainingLogger - INFO - Step 40700, Prediction vs Actual:
2024-12-31 23:47:26,622 - TrainingLogger - INFO - Input 1: אם אזדקק לסיוע, לא אתבייש להיעזר ולהתייעץ עם אחריםלתפיסתה של סילמן, הצעירים כיום מובילים את העולם בהרבה מתחומי החיים, ולכן מתבקש שיתפסו עמדות מובילות עוד בגילאים צעירים גם במערכת הפוליטית
2024-12-31 23:47:26,623 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:47:26,623 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אם          | ✗     |
|     1 | ▁הוא            | ▁אזדקק       | ✗     |
|     2 | ▁-              | ▁לסיוע       | ✗     |
|     3 | .               | ,            | ✗     |
|     4 | <pad>           | ▁לא          | ✗     |
|     5 | .               | ▁את          | ✗     |
|     6 | נגד             | בייש         | ✗     |
|     7 | ▁אותך           | ▁להיעזר      | ✗     |
|     8 | ▁בו             | ▁ולהת        | ✗     |
|     9 | קדם             | ייעץ         | ✗     |
|    10 | ▁עם             | ▁עם          | ✓     |
|    11 | ▁אנשים          | ▁אחרים       | ✗     |
|    12 | .               | לת           | ✗     |
|    13 | ו               | פיסת         | ✗     |
|    14 | ה               | ה            | ✓     |
|    15 | ב               | ▁של          | ✗     |
|    16 | ▁המדינה         | ▁סיל         | ✗     |
|    17 | ה               | מן           | ✗     |
|    18 | .               | ,            | ✗     |
|    19 | <pad>           | ▁הצעירים     | ✗     |
|    20 | ▁האלה           | ▁כיום        | ✗     |
|    21 | .               | ▁מובילים     | ✗     |
|    22 | ▁את             | ▁את          | ✓     |
|    23 | ▁כולם           | ▁העולם       | ✗     |
|    24 | ▁ל              | ▁בהרבה       | ✗     |
|    25 | ▁אנשים          | ▁מ           | ✗     |
|    26 | מונים           | תחומי        | ✗     |
|    27 | ▁החקירה         | ▁החיים       | ✗     |
|    28 | .               | ,            | ✗     |
|    29 | </s>            | ▁ולכן        | ✗     |
|    30 | ▁הם             | ▁מתבקש       | ✗     |
|    31 | ים              | ▁שי          | ✗     |
|    32 | צ               | תפסו         | ✗     |
|    33 | ▁אותו           | ▁עמדות       | ✗     |
|    34 | יהם             | ▁מוביל       | ✗     |
|    35 | .               | ות           | ✗     |
|    36 | ▁ל              | ▁עוד         | ✗     |
|    37 | ▁יותר           | ▁ב           | ✗     |
|    38 | שלטון           | גילאים       | ✗     |
|    39 | ▁כאלה           | ▁צעירים      | ✗     |
|    40 | ▁יותר           | ▁גם          | ✗     |
|    41 | ▁הם             | ▁במערכת      | ✗     |
|    42 | ▁היחסים         | ▁הפוליטית    | ✗     |
|    43 | .               |              | ✗     |

2024-12-31 23:47:26,623 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:47:26,628 - TrainingLogger - INFO - Gradient norm: 9.3260
2024-12-31 23:47:34,160 - TrainingLogger - INFO - Step 40710, Batch metrics: Loss: 7.7516, Accuracy: 0.0741, Perplexity: 2325.3437
2024-12-31 23:47:41,536 - TrainingLogger - INFO - Step 40720, Batch metrics: Loss: 7.5424, Accuracy: 0.0669, Perplexity: 1886.4056
2024-12-31 23:47:48,438 - TrainingLogger - INFO - Step 40730, Batch metrics: Loss: 7.4175, Accuracy: 0.0899, Perplexity: 1664.9487
2024-12-31 23:47:55,606 - TrainingLogger - INFO - Step 40740, Batch metrics: Loss: 6.9038, Accuracy: 0.1285, Perplexity: 996.0768
2024-12-31 23:48:02,408 - TrainingLogger - INFO - Step 40750, Batch metrics: Loss: 7.1327, Accuracy: 0.0774, Perplexity: 1252.3126
2024-12-31 23:48:10,230 - TrainingLogger - INFO - Step 40760, Batch metrics: Loss: 7.1575, Accuracy: 0.1000, Perplexity: 1283.7249
2024-12-31 23:48:17,259 - TrainingLogger - INFO - Step 40770, Batch metrics: Loss: 7.4088, Accuracy: 0.0898, Perplexity: 1650.4889
2024-12-31 23:48:25,220 - TrainingLogger - INFO - Step 40780, Batch metrics: Loss: 7.3151, Accuracy: 0.0796, Perplexity: 1502.8933
2024-12-31 23:48:32,773 - TrainingLogger - INFO - Step 40790, Batch metrics: Loss: 7.5802, Accuracy: 0.0710, Perplexity: 1958.9230
2024-12-31 23:48:39,793 - TrainingLogger - INFO - Step 40800, Batch metrics: Loss: 7.0670, Accuracy: 0.1076, Perplexity: 1172.6337
2024-12-31 23:48:39,793 - TrainingLogger - INFO - Step 40800, Prediction vs Actual:
2024-12-31 23:48:39,827 - TrainingLogger - INFO - Input 1: ועכשיו בישראל אנחנו רואים את זה? מה אתם לא יודעים באיזו מהירות עוברים מדמוקרטיה לדיקטטורה?
2024-12-31 23:48:39,828 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:48:39,828 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ועכשיו      | ✗     |
|     1 | ▁כן             | ▁בישראל      | ✗     |
|     2 | .               | ▁אנחנו       | ✗     |
|     3 | ▁צריכים         | ▁רואים       | ✗     |
|     4 | ▁את             | ▁את          | ✓     |
|     5 | ▁זה             | ▁זה          | ✓     |
|     6 | .               | ?            | ✗     |
|     7 | </s>            | ▁מה          | ✗     |
|     8 | ?               | ▁אתם         | ✗     |
|     9 | ▁עושים          | ▁לא          | ✗     |
|    10 | ▁עושים          | ▁יודעים      | ✗     |
|    11 | ?               | ▁באיזו       | ✗     |
|    12 | ?               | ▁מהירות      | ✗     |
|    13 | ?               | ▁עוברים      | ✗     |
|    14 | ?               | ▁מ           | ✗     |
|    15 | דלת             | דמוקרט       | ✗     |
|    16 | יה              | יה           | ✓     |
|    17 | ?               | ▁ל           | ✗     |
|    18 | מדינות          | דיקטטור      | ✗     |
|    19 | ה               | ה            | ✓     |
|    20 | ?               | ?            | ✓     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁זה             | <pad>        | ✗     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2024-12-31 23:48:39,828 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:48:39,833 - TrainingLogger - INFO - Gradient norm: 7.1121
2024-12-31 23:48:46,595 - TrainingLogger - INFO - Step 40810, Batch metrics: Loss: 7.8219, Accuracy: 0.0380, Perplexity: 2494.7416
2024-12-31 23:48:53,537 - TrainingLogger - INFO - Step 40820, Batch metrics: Loss: 7.0405, Accuracy: 0.1000, Perplexity: 1141.9940
2024-12-31 23:49:00,312 - TrainingLogger - INFO - Step 40830, Batch metrics: Loss: 7.0828, Accuracy: 0.0640, Perplexity: 1191.3272
2024-12-31 23:49:07,171 - TrainingLogger - INFO - Step 40840, Batch metrics: Loss: 7.8411, Accuracy: 0.0922, Perplexity: 2543.0581
2024-12-31 23:49:14,211 - TrainingLogger - INFO - Step 40850, Batch metrics: Loss: 6.8062, Accuracy: 0.1131, Perplexity: 903.4433
2024-12-31 23:49:21,006 - TrainingLogger - INFO - Step 40860, Batch metrics: Loss: 6.9458, Accuracy: 0.1196, Perplexity: 1038.7914
2024-12-31 23:49:28,192 - TrainingLogger - INFO - Step 40870, Batch metrics: Loss: 7.2414, Accuracy: 0.0841, Perplexity: 1396.0221
2024-12-31 23:49:35,076 - TrainingLogger - INFO - Step 40880, Batch metrics: Loss: 7.6194, Accuracy: 0.0610, Perplexity: 2037.2685
2024-12-31 23:49:41,928 - TrainingLogger - INFO - Step 40890, Batch metrics: Loss: 7.2787, Accuracy: 0.0863, Perplexity: 1449.0475
2024-12-31 23:49:48,941 - TrainingLogger - INFO - Step 40900, Batch metrics: Loss: 7.6537, Accuracy: 0.0663, Perplexity: 2108.3296
2024-12-31 23:49:48,942 - TrainingLogger - INFO - Step 40900, Prediction vs Actual:
2024-12-31 23:49:48,942 - TrainingLogger - INFO - Input 1: החלטתי שאני הולכת להפריע ולהפעיל לחץ, ומבחינתי כל האמצעים כשרים - מלבד פגיעה באנשים
2024-12-31 23:49:48,943 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:49:48,943 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁החלטתי      | ✗     |
|     1 | ▁הוא            | ▁שאני        | ✗     |
|     2 | ▁לא             | ▁הולכת       | ✗     |
|     3 | ▁לעבוד          | ▁להפריע      | ✗     |
|     4 | ▁לה             | ▁ולה         | ✗     |
|     5 | מש              | פעיל         | ✗     |
|     6 | ▁את             | ▁לחץ         | ✗     |
|     7 | ▁נוסף           | ,            | ✗     |
|     8 | <pad>           | ▁ו           | ✗     |
|     9 | ...             | מבחינת       | ✗     |
|    10 | ו               | י            | ✗     |
|    11 | ,               | ▁כל          | ✗     |
|    12 | ▁אלה            | ▁האמצעים     | ✗     |
|    13 | ▁הללו           | ▁כשר         | ✗     |
|    14 | ים              | ים           | ✓     |
|    15 | ,               | ▁-           | ✗     |
|    16 | -               | ▁מלבד        | ✗     |
|    17 | ▁זה             | ▁פגיעה       | ✗     |
|    18 | ▁ב              | ▁באנשים      | ✗     |
|    19 | ▁אחרים          | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | י               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            |              | ✗     |

2024-12-31 23:49:48,943 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:49:48,948 - TrainingLogger - INFO - Gradient norm: 7.9288
2024-12-31 23:49:55,970 - TrainingLogger - INFO - Step 40910, Batch metrics: Loss: 7.2342, Accuracy: 0.0427, Perplexity: 1386.0614
2024-12-31 23:50:03,288 - TrainingLogger - INFO - Step 40920, Batch metrics: Loss: 7.3339, Accuracy: 0.0893, Perplexity: 1531.3628
2024-12-31 23:50:10,066 - TrainingLogger - INFO - Step 40930, Batch metrics: Loss: 6.8033, Accuracy: 0.0968, Perplexity: 900.8283
2024-12-31 23:50:17,715 - TrainingLogger - INFO - Step 40940, Batch metrics: Loss: 7.8109, Accuracy: 0.0452, Perplexity: 2467.3529
2024-12-31 23:50:24,218 - TrainingLogger - INFO - Step 40950, Batch metrics: Loss: 7.3443, Accuracy: 0.0944, Perplexity: 1547.2928
2024-12-31 23:50:31,599 - TrainingLogger - INFO - Step 40960, Batch metrics: Loss: 7.6691, Accuracy: 0.0843, Perplexity: 2141.2471
2024-12-31 23:50:38,277 - TrainingLogger - INFO - Step 40970, Batch metrics: Loss: 7.5976, Accuracy: 0.0331, Perplexity: 1993.3955
2024-12-31 23:50:45,457 - TrainingLogger - INFO - Step 40980, Batch metrics: Loss: 7.5814, Accuracy: 0.0505, Perplexity: 1961.4102
2024-12-31 23:50:52,576 - TrainingLogger - INFO - Step 40990, Batch metrics: Loss: 7.7494, Accuracy: 0.0658, Perplexity: 2320.1559
2024-12-31 23:51:00,151 - TrainingLogger - INFO - Step 41000, Batch metrics: Loss: 7.1106, Accuracy: 0.0798, Perplexity: 1224.8215
2024-12-31 23:51:00,152 - TrainingLogger - INFO - Step 41000, Prediction vs Actual:
2024-12-31 23:51:00,152 - TrainingLogger - INFO - Input 1: במציאות ששולטת כאן בשנה האחרונה גוטליב היא התקן, היא הכנסת, היא הממשלה, היא הנורמה
2024-12-31 23:51:00,152 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:51:00,152 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלה            | ▁במציאות     | ✗     |
|     1 | ▁זה             | ▁ששולט       | ✗     |
|     2 | ▁בה             | ת            | ✗     |
|     3 | ▁ב              | ▁כאן         | ✗     |
|     4 | .               | ▁בשנה        | ✗     |
|     5 | ▁שעברה          | ▁האחרונה     | ✗     |
|     6 | ?               | ▁ג           | ✗     |
|     7 | '               | וט           | ✗     |
|     8 | מה              | ליב          | ✗     |
|     9 | אן              | ▁היא         | ✗     |
|    10 | ▁זו             | ▁התקן        | ✗     |
|    11 | ▁זה             | ,            | ✗     |
|    12 | </s>            | ▁היא         | ✗     |
|    13 | ▁לא             | ▁הכנסת       | ✗     |
|    14 | ▁את             | ,            | ✗     |
|    15 | ▁את             | ▁היא         | ✗     |
|    16 | ▁אמרה           | ▁הממשלה      | ✗     |
|    17 | ▁שלה            | ,            | ✗     |
|    18 | </s>            | ▁היא         | ✗     |
|    19 | ▁לא             | ▁הנו         | ✗     |
|    20 | תר              | רמה          | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ית              | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            |              | ✗     |

2024-12-31 23:51:00,152 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:51:00,157 - TrainingLogger - INFO - Gradient norm: 8.5022
2024-12-31 23:51:07,629 - TrainingLogger - INFO - Step 41010, Batch metrics: Loss: 7.5830, Accuracy: 0.0581, Perplexity: 1964.4391
2024-12-31 23:51:14,610 - TrainingLogger - INFO - Step 41020, Batch metrics: Loss: 7.4873, Accuracy: 0.0889, Perplexity: 1785.1572
2024-12-31 23:51:21,649 - TrainingLogger - INFO - Step 41030, Batch metrics: Loss: 7.2482, Accuracy: 0.0963, Perplexity: 1405.5443
2024-12-31 23:51:29,151 - TrainingLogger - INFO - Step 41040, Batch metrics: Loss: 7.1637, Accuracy: 0.0612, Perplexity: 1291.6913
2024-12-31 23:51:36,413 - TrainingLogger - INFO - Step 41050, Batch metrics: Loss: 7.4492, Accuracy: 0.0633, Perplexity: 1718.5585
2024-12-31 23:51:43,613 - TrainingLogger - INFO - Step 41060, Batch metrics: Loss: 6.8221, Accuracy: 0.0964, Perplexity: 917.8854
2024-12-31 23:51:51,216 - TrainingLogger - INFO - Step 41070, Batch metrics: Loss: 7.4754, Accuracy: 0.0820, Perplexity: 1764.0255
2024-12-31 23:51:58,409 - TrainingLogger - INFO - Step 41080, Batch metrics: Loss: 7.4938, Accuracy: 0.0680, Perplexity: 1796.8530
2024-12-31 23:52:05,422 - TrainingLogger - INFO - Step 41090, Batch metrics: Loss: 7.4498, Accuracy: 0.0617, Perplexity: 1719.5110
2024-12-31 23:52:12,345 - TrainingLogger - INFO - Step 41100, Batch metrics: Loss: 7.4194, Accuracy: 0.0576, Perplexity: 1667.9596
2024-12-31 23:52:12,345 - TrainingLogger - INFO - Step 41100, Prediction vs Actual:
2024-12-31 23:52:12,379 - TrainingLogger - INFO - Input 1: רכיביה מוכרים חמאס מנסה לייצר מציאות שלטונית שתוביל לגירוש אלים של הרשות הפלסטינית היעדר אופק מדיני מול ישראל והרכיב הכלכלי, שכעת נכנס למשבר עמוק ואיטי
2024-12-31 23:52:12,380 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:52:12,380 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁רכיב        | ✗     |
|     1 | ▁-              | יה           | ✗     |
|     2 | ▁"              | ▁מוכרים      | ✗     |
|     3 | ▁"              | ▁ח           | ✗     |
|     4 | ▁הוא            | מ            | ✗     |
|     5 | ▁הוא            | אס           | ✗     |
|     6 | ,               | ▁מנסה        | ✗     |
|     7 | ▁לעשות          | ▁לייצר       | ✗     |
|     8 | ▁את             | ▁מציאות      | ✗     |
|     9 | ▁חדשה           | ▁שלט         | ✗     |
|    10 | ונית            | ונית         | ✓     |
|    11 | ▁חדשה           | ▁שתו         | ✗     |
|    12 | חלת             | ביל          | ✗     |
|    13 | ▁את             | ▁ל           | ✗     |
|    14 | איידס           | גירוש        | ✗     |
|    15 | ים              | ▁אל          | ✗     |
|    16 | יפות            | ים           | ✗     |
|    17 | ▁חדשים          | ▁של          | ✗     |
|    18 | ▁ארצות          | ▁הרשות       | ✗     |
|    19 | ▁הפלסטי         | ▁הפלסטי      | ✓     |
|    20 | נית             | נית          | ✓     |
|    21 | ,               | ▁היעדר       | ✗     |
|    22 | ות              | ▁או          | ✗     |
|    23 | תר              | פק           | ✗     |
|    24 | ים              | ▁מדי         | ✗     |
|    25 | ה               | ני           | ✗     |
|    26 | .               | ▁מול         | ✗     |
|    27 | ה               | ▁ישראל       | ✗     |
|    28 | ,               | ▁וה          | ✗     |
|    29 | צבא             | רכיב         | ✗     |
|    30 | ה               | ▁הכלכלי      | ✗     |
|    31 | ▁שלה            | ,            | ✗     |
|    32 | </s>            | ▁שכעת        | ✗     |
|    33 | ▁הוא            | ▁נכנס        | ✗     |
|    34 | ▁לתמונה         | ▁ל           | ✗     |
|    35 | תוקף            | משבר         | ✗     |
|    36 | ▁הכלכלי         | ▁עמוק        | ✗     |
|    37 | ▁יותר           | ▁ו           | ✗     |
|    38 | עומד            | איטי         | ✗     |
|    39 | .               |              | ✗     |

2024-12-31 23:52:12,380 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:52:12,385 - TrainingLogger - INFO - Gradient norm: 7.6892
2024-12-31 23:52:19,203 - TrainingLogger - INFO - Step 41110, Batch metrics: Loss: 7.0936, Accuracy: 0.1092, Perplexity: 1204.2712
2024-12-31 23:52:26,606 - TrainingLogger - INFO - Step 41120, Batch metrics: Loss: 7.4052, Accuracy: 0.0909, Perplexity: 1644.4784
2024-12-31 23:52:34,045 - TrainingLogger - INFO - Step 41130, Batch metrics: Loss: 7.4763, Accuracy: 0.0714, Perplexity: 1765.7053
2024-12-31 23:52:41,038 - TrainingLogger - INFO - Step 41140, Batch metrics: Loss: 7.3009, Accuracy: 0.0995, Perplexity: 1481.6208
2024-12-31 23:52:48,841 - TrainingLogger - INFO - Step 41150, Batch metrics: Loss: 7.5264, Accuracy: 0.0792, Perplexity: 1856.3866
2024-12-31 23:52:55,501 - TrainingLogger - INFO - Step 41160, Batch metrics: Loss: 7.5000, Accuracy: 0.1034, Perplexity: 1808.0398
2024-12-31 23:53:02,693 - TrainingLogger - INFO - Step 41170, Batch metrics: Loss: 7.5763, Accuracy: 0.0838, Perplexity: 1951.3752
2024-12-31 23:53:09,810 - TrainingLogger - INFO - Step 41180, Batch metrics: Loss: 7.0964, Accuracy: 0.0867, Perplexity: 1207.6686
2024-12-31 23:53:16,947 - TrainingLogger - INFO - Step 41190, Batch metrics: Loss: 7.3537, Accuracy: 0.1123, Perplexity: 1561.9654
2024-12-31 23:53:24,214 - TrainingLogger - INFO - Step 41200, Batch metrics: Loss: 7.4907, Accuracy: 0.0513, Perplexity: 1791.2975
2024-12-31 23:53:24,215 - TrainingLogger - INFO - Step 41200, Prediction vs Actual:
2024-12-31 23:53:24,215 - TrainingLogger - INFO - Input 1: כל מי שמנסה להוציא את הרב כאדם חשוך חלילה, הוא טועה ומראה על חוסר הכירות מוחלט עם כבוד הרב
2024-12-31 23:53:24,215 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:53:24,215 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁שלו            | ▁כל          | ✗     |
|     1 | ▁-              | ▁מי          | ✗     |
|     2 | ▁אני            | ▁שמנסה       | ✗     |
|     3 | ▁להשיג          | ▁להוציא      | ✗     |
|     4 | ▁את             | ▁את          | ✓     |
|     5 | ▁זה             | ▁הרב         | ✗     |
|     6 | דים             | ▁כאדם        | ✗     |
|     7 | ▁אחר            | ▁חשוך        | ✗     |
|     8 | .               | ▁חלילה       | ✗     |
|     9 | .               | ,            | ✗     |
|    10 | ▁נכון           | ▁הוא         | ✗     |
|    11 | ▁לא             | ▁טועה        | ✗     |
|    12 | .               | ▁ו           | ✗     |
|    13 | מצליח           | מראה         | ✗     |
|    14 | ▁את             | ▁על          | ✗     |
|    15 | ▁זה             | ▁חוסר        | ✗     |
|    16 | ▁הביטחון        | ▁הכיר        | ✗     |
|    17 | יים             | ות           | ✗     |
|    18 | ▁שלו            | ▁מוחלט       | ✗     |
|    19 | .               | ▁עם          | ✗     |
|    20 | ▁כל             | ▁כבוד        | ✗     |
|    21 | .               | ▁הרב         | ✗     |
|    22 | ▁שלו            | <pad>        | ✗     |
|    23 | ▁שלו            | <pad>        | ✗     |
|    24 | ▁וה             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2024-12-31 23:53:24,215 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:53:24,220 - TrainingLogger - INFO - Gradient norm: 7.8682
2024-12-31 23:53:30,783 - TrainingLogger - INFO - Step 41210, Batch metrics: Loss: 7.1449, Accuracy: 0.1538, Perplexity: 1267.5875
2024-12-31 23:53:37,646 - TrainingLogger - INFO - Step 41220, Batch metrics: Loss: 7.1938, Accuracy: 0.0655, Perplexity: 1331.0948
2024-12-31 23:53:44,523 - TrainingLogger - INFO - Step 41230, Batch metrics: Loss: 7.5992, Accuracy: 0.1018, Perplexity: 1996.5994
2024-12-31 23:53:51,904 - TrainingLogger - INFO - Step 41240, Batch metrics: Loss: 7.3977, Accuracy: 0.0598, Perplexity: 1632.2888
2024-12-31 23:53:59,468 - TrainingLogger - INFO - Step 41250, Batch metrics: Loss: 7.6158, Accuracy: 0.0222, Perplexity: 2030.0412
2024-12-31 23:54:06,702 - TrainingLogger - INFO - Step 41260, Batch metrics: Loss: 7.1448, Accuracy: 0.1211, Perplexity: 1267.4588
2024-12-31 23:54:13,448 - TrainingLogger - INFO - Step 41270, Batch metrics: Loss: 7.4642, Accuracy: 0.0952, Perplexity: 1744.5410
2024-12-31 23:54:20,340 - TrainingLogger - INFO - Step 41280, Batch metrics: Loss: 7.4415, Accuracy: 0.0562, Perplexity: 1705.2960
2024-12-31 23:54:27,865 - TrainingLogger - INFO - Step 41290, Batch metrics: Loss: 7.2947, Accuracy: 0.0727, Perplexity: 1472.4044
2024-12-31 23:54:34,909 - TrainingLogger - INFO - Step 41300, Batch metrics: Loss: 7.6823, Accuracy: 0.0457, Perplexity: 2169.6343
2024-12-31 23:54:34,910 - TrainingLogger - INFO - Step 41300, Prediction vs Actual:
2024-12-31 23:54:34,910 - TrainingLogger - INFO - Input 1: במשחק הגמר הוא פיגר 31 117, 117, 1012, 114, מול יונתן שוסטרמן הפועל חיפה, אבל גבר עליו בשלוש המערכות הבאות 711, 411, 511 והשלים מהפך 34 בסיום
2024-12-31 23:54:34,910 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:54:34,910 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁במשחק       | ✗     |
|     1 | ▁-              | ▁הגמר        | ✗     |
|     2 | ▁-              | ▁הוא         | ✗     |
|     3 | ▁לא             | ▁פי          | ✗     |
|     4 | גור             | גר           | ✗     |
|     5 | ▁את             | ▁31          | ✗     |
|     6 | .               | ▁1           | ✗     |
|     7 | ▁מה             | 17           | ✗     |
|     8 | .               | ,            | ✗     |
|     9 | <pad>           | ▁1           | ✗     |
|    10 | 12              | 17           | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | ▁1              | ▁10          | ✗     |
|    13 | ▁פעמים          | 12           | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | <pad>           | ▁1           | ✗     |
|    16 | .               | 14           | ✗     |
|    17 | .               | ,            | ✗     |
|    18 | </s>            | ▁מול         | ✗     |
|    19 | ם               | ▁יונתן       | ✗     |
|    20 | ,               | ▁ש           | ✗     |
|    21 | ות              | וסט          | ✗     |
|    22 | ינג             | רמן          | ✗     |
|    23 | .               | ▁הפועל       | ✗     |
|    24 | ▁על             | ▁חי          | ✗     |
|    25 | ר               | פה           | ✗     |
|    26 | ▁על             | ,            | ✗     |
|    27 | </s>            | ▁אבל         | ✗     |
|    28 | ▁לא             | ▁גבר         | ✗     |
|    29 | ▁אחר            | ▁עליו        | ✗     |
|    30 | ,               | ▁בשלוש       | ✗     |
|    31 | ▁שנים           | ▁המערכות     | ✗     |
|    32 | ▁האחרונות       | ▁הבאות       | ✗     |
|    33 | .               | ▁7           | ✗     |
|    34 | .               | 11           | ✗     |
|    35 | .               | ,            | ✗     |
|    36 | </s>            | ▁4           | ✗     |
|    37 | ▁פעמים          | 11           | ✗     |
|    38 | .               | ,            | ✗     |
|    39 | </s>            | ▁5           | ✗     |
|    40 | ▁ימים           | 11           | ✗     |
|    41 | .               | ▁והש         | ✗     |
|    42 | לים             | לים          | ✓     |
|    43 | ▁אותו           | ▁מה          | ✗     |
|    44 | צפון            | פך           | ✗     |
|    45 | .               | ▁34          | ✗     |
|    46 | .               | ▁בסיום       | ✗     |
|    47 | ▁המשפט          |              | ✗     |

2024-12-31 23:54:34,910 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:54:34,916 - TrainingLogger - INFO - Gradient norm: 7.9777
2024-12-31 23:54:41,636 - TrainingLogger - INFO - Step 41310, Batch metrics: Loss: 7.5052, Accuracy: 0.0825, Perplexity: 1817.3888
2024-12-31 23:54:48,639 - TrainingLogger - INFO - Step 41320, Batch metrics: Loss: 6.9564, Accuracy: 0.1294, Perplexity: 1049.8532
2024-12-31 23:54:55,844 - TrainingLogger - INFO - Step 41330, Batch metrics: Loss: 7.3176, Accuracy: 0.1053, Perplexity: 1506.6172
2024-12-31 23:55:03,445 - TrainingLogger - INFO - Step 41340, Batch metrics: Loss: 7.5774, Accuracy: 0.0643, Perplexity: 1953.5603
2024-12-31 23:55:10,430 - TrainingLogger - INFO - Step 41350, Batch metrics: Loss: 7.2224, Accuracy: 0.0939, Perplexity: 1369.8133
2024-12-31 23:55:17,150 - TrainingLogger - INFO - Step 41360, Batch metrics: Loss: 7.6884, Accuracy: 0.0702, Perplexity: 2182.8870
2024-12-31 23:55:24,049 - TrainingLogger - INFO - Step 41370, Batch metrics: Loss: 7.0853, Accuracy: 0.1202, Perplexity: 1194.2717
2024-12-31 23:55:31,014 - TrainingLogger - INFO - Step 41380, Batch metrics: Loss: 7.5033, Accuracy: 0.0613, Perplexity: 1813.9863
2024-12-31 23:55:38,793 - TrainingLogger - INFO - Step 41390, Batch metrics: Loss: 7.3047, Accuracy: 0.0881, Perplexity: 1487.3353
2024-12-31 23:55:46,695 - TrainingLogger - INFO - Step 41400, Batch metrics: Loss: 7.2790, Accuracy: 0.0866, Perplexity: 1449.5803
2024-12-31 23:55:46,695 - TrainingLogger - INFO - Step 41400, Prediction vs Actual:
2024-12-31 23:55:46,695 - TrainingLogger - INFO - Input 1: לדבריו, השותף הירדני היה אמור להגיע לישראל ולהופיע בפני בית הדין אך לא הצליחו להשיג לו ויזה בזמן
2024-12-31 23:55:46,696 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:55:46,696 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לדבריו      | ✗     |
|     1 | ▁הוא            | ,            | ✗     |
|     2 | ▁-              | ▁השותף       | ✗     |
|     3 | ▁-              | ▁הי          | ✗     |
|     4 | ב               | רד           | ✗     |
|     5 | ת               | ני           | ✗     |
|     6 | ,               | ▁היה         | ✗     |
|     7 | ▁לי             | ▁אמור        | ✗     |
|     8 | ▁להיות          | ▁להגיע       | ✗     |
|     9 | ▁לשם            | ▁לישראל      | ✗     |
|    10 | .               | ▁ול          | ✗     |
|    11 | בקר             | הופ          | ✗     |
|    12 | יע              | יע           | ✓     |
|    13 | ▁שוב            | ▁בפני        | ✗     |
|    14 | ▁כולם           | ▁בית         | ✗     |
|    15 | ▁המשפט          | ▁הדין        | ✗     |
|    16 | .               | ▁אך          | ✗     |
|    17 | ▁ורק            | ▁לא          | ✗     |
|    18 | ▁רק             | ▁הצליחו      | ✗     |
|    19 | ▁להגיע          | ▁להשיג       | ✗     |
|    20 | ▁אותו           | ▁לו          | ✗     |
|    21 | ▁את             | ▁וי          | ✗     |
|    22 | כוח             | זה           | ✗     |
|    23 | ר               | ▁בזמן        | ✗     |
|    24 | ▁האחרון         | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁האחרון         | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | .               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | .               |              | ✗     |

2024-12-31 23:55:46,696 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:55:46,701 - TrainingLogger - INFO - Gradient norm: 9.2526
2024-12-31 23:55:53,118 - TrainingLogger - INFO - Step 41410, Batch metrics: Loss: 7.3908, Accuracy: 0.0982, Perplexity: 1621.0148
2024-12-31 23:56:00,455 - TrainingLogger - INFO - Step 41420, Batch metrics: Loss: 7.3215, Accuracy: 0.0976, Perplexity: 1512.4628
2024-12-31 23:56:07,869 - TrainingLogger - INFO - Step 41430, Batch metrics: Loss: 7.5663, Accuracy: 0.0588, Perplexity: 1931.9666
2024-12-31 23:56:15,099 - TrainingLogger - INFO - Step 41440, Batch metrics: Loss: 7.4102, Accuracy: 0.0821, Perplexity: 1652.7082
2024-12-31 23:56:21,981 - TrainingLogger - INFO - Step 41450, Batch metrics: Loss: 7.2925, Accuracy: 0.0702, Perplexity: 1469.2259
2024-12-31 23:56:29,358 - TrainingLogger - INFO - Step 41460, Batch metrics: Loss: 7.3650, Accuracy: 0.0617, Perplexity: 1579.7083
2024-12-31 23:56:36,262 - TrainingLogger - INFO - Step 41470, Batch metrics: Loss: 7.0336, Accuracy: 0.0818, Perplexity: 1134.1080
2024-12-31 23:56:43,045 - TrainingLogger - INFO - Step 41480, Batch metrics: Loss: 7.4723, Accuracy: 0.0688, Perplexity: 1758.7191
2024-12-31 23:56:50,024 - TrainingLogger - INFO - Step 41490, Batch metrics: Loss: 7.4942, Accuracy: 0.0750, Perplexity: 1797.6320
2024-12-31 23:56:57,140 - TrainingLogger - INFO - Step 41500, Batch metrics: Loss: 7.6065, Accuracy: 0.0561, Perplexity: 2011.1290
2024-12-31 23:56:57,140 - TrainingLogger - INFO - Step 41500, Prediction vs Actual:
2024-12-31 23:56:57,140 - TrainingLogger - INFO - Input 1: ההתפטרות הגדולה, The Great Resignation מושג שכלכלנים טבעו משקפת כנראה חוסר שביעות רצון עמוק ממצבי העסקה קודמים
2024-12-31 23:56:57,141 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:56:57,141 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁ההת         | ✗     |
|     1 | ▁זה             | פטר          | ✗     |
|     2 | ה               | ות           | ✗     |
|     3 | ▁הראשונה        | ▁הגדולה      | ✗     |
|     4 | ▁ביותר          | ,            | ✗     |
|     5 | <pad>           | ▁The         | ✗     |
|     6 | ▁               | ▁Gr          | ✗     |
|     7 | un              | eat          | ✗     |
|     8 | ed              | ▁Re          | ✗     |
|     9 | al              | s            | ✗     |
|    10 | es              | ig           | ✗     |
|    11 | ion             | n            | ✗     |
|    12 | ,               | ation        | ✗     |
|    13 | s               | ▁מושג        | ✗     |
|    14 | ▁חדש            | ▁שכל         | ✗     |
|    15 | ל               | כל           | ✗     |
|    16 | ▁זה             | נים          | ✗     |
|    17 | ▁רבים           | ▁טבעו        | ✗     |
|    18 | ▁בעבר           | ▁משקפת       | ✗     |
|    19 | ▁את             | ▁כנראה       | ✗     |
|    20 | ▁היה            | ▁חוסר        | ✗     |
|    21 | ▁התאמה          | ▁שביעות      | ✗     |
|    22 | ה               | ▁רצון        | ✗     |
|    23 | </s>            | ▁עמוק        | ✗     |
|    24 | ▁יותר           | ▁ממצב        | ✗     |
|    25 | ▁זה             | י            | ✗     |
|    26 | ▁הבריאות        | ▁העסקה       | ✗     |
|    27 | ▁שלנו           | ▁קודמים      | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ים              | <pad>        | ✗     |
|    38 | ▁הנוכחי         | <pad>        | ✗     |
|    39 | ה               | <pad>        | ✗     |
|    40 | יה              | <pad>        | ✗     |
|    41 | ה               | <pad>        | ✗     |
|    42 | ▁המדינה         | <pad>        | ✗     |
|    43 | ה               | <pad>        | ✗     |
|    44 | ▁הנוכחי         |              | ✗     |

2024-12-31 23:56:57,141 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:56:57,146 - TrainingLogger - INFO - Gradient norm: 9.0044
2024-12-31 23:57:04,295 - TrainingLogger - INFO - Step 41510, Batch metrics: Loss: 7.1801, Accuracy: 0.0955, Perplexity: 1313.0107
2024-12-31 23:57:11,520 - TrainingLogger - INFO - Step 41520, Batch metrics: Loss: 7.4210, Accuracy: 0.0914, Perplexity: 1670.7775
2024-12-31 23:57:18,542 - TrainingLogger - INFO - Step 41530, Batch metrics: Loss: 7.8024, Accuracy: 0.0602, Perplexity: 2446.4644
2024-12-31 23:57:25,565 - TrainingLogger - INFO - Step 41540, Batch metrics: Loss: 7.0952, Accuracy: 0.1222, Perplexity: 1206.1539
2024-12-31 23:57:33,163 - TrainingLogger - INFO - Step 41550, Batch metrics: Loss: 7.5832, Accuracy: 0.0545, Perplexity: 1964.9946
2024-12-31 23:57:40,246 - TrainingLogger - INFO - Step 41560, Batch metrics: Loss: 7.4600, Accuracy: 0.0690, Perplexity: 1737.1755
2024-12-31 23:57:47,197 - TrainingLogger - INFO - Step 41570, Batch metrics: Loss: 7.8985, Accuracy: 0.0647, Perplexity: 2693.3023
2024-12-31 23:57:54,157 - TrainingLogger - INFO - Step 41580, Batch metrics: Loss: 7.1930, Accuracy: 0.0781, Perplexity: 1330.0258
2024-12-31 23:58:01,619 - TrainingLogger - INFO - Step 41590, Batch metrics: Loss: 7.1460, Accuracy: 0.0747, Perplexity: 1269.0492
2024-12-31 23:58:08,788 - TrainingLogger - INFO - Step 41600, Batch metrics: Loss: 7.4226, Accuracy: 0.0724, Perplexity: 1673.3655
2024-12-31 23:58:08,789 - TrainingLogger - INFO - Step 41600, Prediction vs Actual:
2024-12-31 23:58:08,789 - TrainingLogger - INFO - Input 1: שמעתי צעקות ולא הבנתי ממה זה
2024-12-31 23:58:08,789 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:58:08,789 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁שמעתי       | ✗     |
|     1 | ▁-              | ▁צעקות       | ✗     |
|     2 | ▁-              | ▁ולא         | ✗     |
|     3 | ▁-              | ▁הבנתי       | ✗     |
|     4 | ▁את             | ▁ממה         | ✗     |
|     5 | ▁זה             | ▁זה          | ✓     |
|     6 | ▁קשור           | <pad>        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ▁לא             | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ▁זה             | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ▁זה             | <pad>        | ✗     |
|    18 | ▁זה             | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ▁זה             | <pad>        | ✗     |
|    22 | ▁זה             | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁זה             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | ▁זה             | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2024-12-31 23:58:08,789 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:58:08,794 - TrainingLogger - INFO - Gradient norm: 7.7263
2024-12-31 23:58:15,554 - TrainingLogger - INFO - Step 41610, Batch metrics: Loss: 7.1664, Accuracy: 0.1020, Perplexity: 1295.1655
2024-12-31 23:58:22,837 - TrainingLogger - INFO - Step 41620, Batch metrics: Loss: 7.1483, Accuracy: 0.0728, Perplexity: 1271.9687
2024-12-31 23:58:30,632 - TrainingLogger - INFO - Step 41630, Batch metrics: Loss: 7.1159, Accuracy: 0.1400, Perplexity: 1231.4337
2024-12-31 23:58:37,769 - TrainingLogger - INFO - Step 41640, Batch metrics: Loss: 7.1521, Accuracy: 0.1373, Perplexity: 1276.8131
2024-12-31 23:58:44,992 - TrainingLogger - INFO - Step 41650, Batch metrics: Loss: 7.6309, Accuracy: 0.0762, Perplexity: 2060.9480
2024-12-31 23:58:52,224 - TrainingLogger - INFO - Step 41660, Batch metrics: Loss: 7.1348, Accuracy: 0.1096, Perplexity: 1254.9170
2024-12-31 23:58:59,445 - TrainingLogger - INFO - Step 41670, Batch metrics: Loss: 7.8509, Accuracy: 0.0703, Perplexity: 2568.0646
2024-12-31 23:59:06,324 - TrainingLogger - INFO - Step 41680, Batch metrics: Loss: 7.5975, Accuracy: 0.0743, Perplexity: 1993.1132
2024-12-31 23:59:13,339 - TrainingLogger - INFO - Step 41690, Batch metrics: Loss: 6.9142, Accuracy: 0.1218, Perplexity: 1006.4817
2024-12-31 23:59:21,024 - TrainingLogger - INFO - Step 41700, Batch metrics: Loss: 7.0605, Accuracy: 0.1176, Perplexity: 1165.0394
2024-12-31 23:59:21,024 - TrainingLogger - INFO - Step 41700, Prediction vs Actual:
2024-12-31 23:59:21,024 - TrainingLogger - INFO - Input 1: מדובר בירידה של 4 במספר המשרות הפנויות לעומת ינואר-מרץ
2024-12-31 23:59:21,025 - TrainingLogger - INFO - Token-wise comparison:
2024-12-31 23:59:21,025 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מדובר       | ✗     |
|     1 | .               | ▁ביריד       | ✗     |
|     2 | ה               | ה            | ✓     |
|     3 | .               | ▁של          | ✗     |
|     4 | <pad>           | ▁4           | ✗     |
|     5 | ▁פעמים          | ▁במספר       | ✗     |
|     6 | .               | ▁המ          | ✗     |
|     7 | בנים            | שרות         | ✗     |
|     8 | .               | ▁הפנוי       | ✗     |
|     9 | ות              | ות           | ✓     |
|    10 | .               | ▁לעומת       | ✗     |
|    11 | ן               | ▁ינואר       | ✗     |
|    12 | ה               | -            | ✗     |
|    13 | ה               | מר           | ✗     |
|    14 | בית             | ץ            | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ▁20             | <pad>        | ✗     |
|    33 | ▁20             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               |              | ✗     |

2024-12-31 23:59:21,025 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2024-12-31 23:59:21,030 - TrainingLogger - INFO - Gradient norm: 7.7853
2024-12-31 23:59:29,225 - TrainingLogger - INFO - Step 41710, Batch metrics: Loss: 7.3789, Accuracy: 0.1009, Perplexity: 1601.8322
2024-12-31 23:59:36,534 - TrainingLogger - INFO - Step 41720, Batch metrics: Loss: 8.0514, Accuracy: 0.0741, Perplexity: 3138.1410
2024-12-31 23:59:43,784 - TrainingLogger - INFO - Step 41730, Batch metrics: Loss: 7.1047, Accuracy: 0.0895, Perplexity: 1217.6786
2024-12-31 23:59:51,643 - TrainingLogger - INFO - Step 41740, Batch metrics: Loss: 7.2854, Accuracy: 0.0787, Perplexity: 1458.9001
2024-12-31 23:59:58,520 - TrainingLogger - INFO - Step 41750, Batch metrics: Loss: 7.6040, Accuracy: 0.0845, Perplexity: 2006.1714
2025-01-01 00:00:05,654 - TrainingLogger - INFO - Step 41760, Batch metrics: Loss: 7.1052, Accuracy: 0.0915, Perplexity: 1218.2855
2025-01-01 00:00:12,334 - TrainingLogger - INFO - Step 41770, Batch metrics: Loss: 7.7016, Accuracy: 0.0884, Perplexity: 2211.8759
2025-01-01 00:00:19,489 - TrainingLogger - INFO - Step 41780, Batch metrics: Loss: 6.7510, Accuracy: 0.1166, Perplexity: 854.9340
2025-01-01 00:00:27,357 - TrainingLogger - INFO - Step 41790, Batch metrics: Loss: 7.3582, Accuracy: 0.0671, Perplexity: 1568.9590
2025-01-01 00:00:34,627 - TrainingLogger - INFO - Step 41800, Batch metrics: Loss: 7.0610, Accuracy: 0.0977, Perplexity: 1165.5995
2025-01-01 00:00:34,627 - TrainingLogger - INFO - Step 41800, Prediction vs Actual:
2025-01-01 00:00:34,627 - TrainingLogger - INFO - Input 1: מתקפת הטילים הביאה לשיא את המתיחות בין וושינגטון לטהרן, והיו שחששו אז כי תגובות הדדיות יובילו לעימות שיצית את המזרח התיכון
2025-01-01 00:00:34,628 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:00:34,628 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מתקפת       | ✗     |
|     1 | ▁הוא            | ▁הטילים      | ✗     |
|     2 | ▁-              | ▁הביאה       | ✗     |
|     3 | ▁-              | ▁לשיא        | ✗     |
|     4 | ה               | ▁את          | ✗     |
|     5 | ▁זה             | ▁ה           | ✗     |
|     6 | חסינות          | מתי          | ✗     |
|     7 | יש              | חות          | ✗     |
|     8 | ▁שלנו           | ▁בין         | ✗     |
|     9 | ▁המדינות        | ▁וושינגטון   | ✗     |
|    10 | ▁ל              | ▁לטהר        | ✗     |
|    11 | ת               | ן            | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | <pad>           | ▁והיו        | ✗     |
|    14 | ▁להם            | ▁שחש         | ✗     |
|    15 | ים              | שו           | ✗     |
|    16 | ▁את             | ▁אז          | ✗     |
|    17 | ▁שה             | ▁כי          | ✗     |
|    18 | ור              | ▁תגובות      | ✗     |
|    19 | ▁רבות           | ▁הדדי        | ✗     |
|    20 | ות              | ות           | ✓     |
|    21 | ,               | ▁יוביל       | ✗     |
|    22 | ו               | ו            | ✓     |
|    23 | ▁ל              | ▁ל           | ✓     |
|    24 | איידס           | עימות        | ✗     |
|    25 | ים              | ▁שי          | ✗     |
|    26 | בע              | צית          | ✗     |
|    27 | ו               | ▁את          | ✗     |
|    28 | ▁עצמו           | ▁המזרח       | ✗     |
|    29 | ▁התיכון         | ▁התיכון      | ✓     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            |              | ✗     |

2025-01-01 00:00:34,628 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:00:34,633 - TrainingLogger - INFO - Gradient norm: 7.0952
2025-01-01 00:00:41,935 - TrainingLogger - INFO - Step 41810, Batch metrics: Loss: 7.5441, Accuracy: 0.0652, Perplexity: 1889.4781
2025-01-01 00:00:49,235 - TrainingLogger - INFO - Step 41820, Batch metrics: Loss: 7.3850, Accuracy: 0.0939, Perplexity: 1611.6343
2025-01-01 00:00:56,290 - TrainingLogger - INFO - Step 41830, Batch metrics: Loss: 7.2168, Accuracy: 0.0865, Perplexity: 1362.1236
2025-01-01 00:01:03,556 - TrainingLogger - INFO - Step 41840, Batch metrics: Loss: 7.1067, Accuracy: 0.0979, Perplexity: 1220.0970
2025-01-01 00:01:11,165 - TrainingLogger - INFO - Step 41850, Batch metrics: Loss: 7.2895, Accuracy: 0.0660, Perplexity: 1464.7937
2025-01-01 00:01:18,564 - TrainingLogger - INFO - Step 41860, Batch metrics: Loss: 7.0672, Accuracy: 0.1046, Perplexity: 1172.8317
2025-01-01 00:01:25,052 - TrainingLogger - INFO - Step 41870, Batch metrics: Loss: 7.2071, Accuracy: 0.0870, Perplexity: 1348.9211
2025-01-01 00:01:32,722 - TrainingLogger - INFO - Step 41880, Batch metrics: Loss: 7.0483, Accuracy: 0.0867, Perplexity: 1150.9442
2025-01-01 00:01:39,526 - TrainingLogger - INFO - Step 41890, Batch metrics: Loss: 7.4191, Accuracy: 0.0867, Perplexity: 1667.5723
2025-01-01 00:01:46,459 - TrainingLogger - INFO - Step 41900, Batch metrics: Loss: 6.9517, Accuracy: 0.0884, Perplexity: 1044.9572
2025-01-01 00:01:46,459 - TrainingLogger - INFO - Step 41900, Prediction vs Actual:
2025-01-01 00:01:46,493 - TrainingLogger - INFO - Input 1: אני קוראת לכם, חברותיי וחבריי אל תפספסו הפעם
2025-01-01 00:01:46,493 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:01:46,493 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אני         | ✗     |
|     1 | ▁אני            | ▁קוראת       | ✗     |
|     2 | ▁מחשבות         | ▁לכם         | ✗     |
|     3 | ▁את             | ,            | ✗     |
|     4 | ▁"              | ▁חברותי      | ✗     |
|     5 | ים              | י            | ✗     |
|     6 | ,               | ▁וחברי       | ✗     |
|     7 | י               | י            | ✓     |
|     8 | ,               | ▁אל          | ✗     |
|     9 | מן              | ▁תפספס       | ✗     |
|    10 | ו               | ו            | ✓     |
|    11 | ▁את             | ▁הפעם        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | ▁את             | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | ▁את             | <pad>        | ✗     |
|    21 | ▁את             | <pad>        | ✗     |
|    22 | ▁את             | <pad>        | ✗     |
|    23 | ▁את             | <pad>        | ✗     |
|    24 | ▁את             | <pad>        | ✗     |
|    25 | ▁את             | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | ▁את             | <pad>        | ✗     |
|    29 | ▁את             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁את             | <pad>        | ✗     |
|    32 | ▁את             | <pad>        | ✗     |
|    33 | ▁את             | <pad>        | ✗     |
|    34 | ▁את             |              | ✗     |

2025-01-01 00:01:46,493 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:01:46,499 - TrainingLogger - INFO - Gradient norm: 6.9043
2025-01-01 00:01:53,746 - TrainingLogger - INFO - Step 41910, Batch metrics: Loss: 7.3503, Accuracy: 0.0693, Perplexity: 1556.6268
2025-01-01 00:02:00,508 - TrainingLogger - INFO - Step 41920, Batch metrics: Loss: 7.2721, Accuracy: 0.0811, Perplexity: 1439.4996
2025-01-01 00:02:07,698 - TrainingLogger - INFO - Step 41930, Batch metrics: Loss: 7.3716, Accuracy: 0.0859, Perplexity: 1590.1543
2025-01-01 00:02:14,925 - TrainingLogger - INFO - Step 41940, Batch metrics: Loss: 7.3344, Accuracy: 0.0615, Perplexity: 1532.0698
2025-01-01 00:02:22,075 - TrainingLogger - INFO - Step 41950, Batch metrics: Loss: 7.1451, Accuracy: 0.0817, Perplexity: 1267.9182
2025-01-01 00:02:29,588 - TrainingLogger - INFO - Step 41960, Batch metrics: Loss: 6.8086, Accuracy: 0.1135, Perplexity: 905.5886
2025-01-01 00:02:36,545 - TrainingLogger - INFO - Step 41970, Batch metrics: Loss: 7.7258, Accuracy: 0.0611, Perplexity: 2265.9611
2025-01-01 00:02:44,077 - TrainingLogger - INFO - Step 41980, Batch metrics: Loss: 7.4604, Accuracy: 0.0769, Perplexity: 1737.8416
2025-01-01 00:02:51,503 - TrainingLogger - INFO - Step 41990, Batch metrics: Loss: 7.2319, Accuracy: 0.0620, Perplexity: 1382.7930
2025-01-01 00:02:58,562 - TrainingLogger - INFO - Step 42000, Batch metrics: Loss: 8.0731, Accuracy: 0.0592, Perplexity: 3207.1784
2025-01-01 00:02:58,563 - TrainingLogger - INFO - Step 42000, Prediction vs Actual:
2025-01-01 00:02:58,563 - TrainingLogger - INFO - Input 1: שלחה את המכתב ויצאה, מנופפת לשלום לכמה מכרים מקומיים
2025-01-01 00:02:58,563 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:02:58,563 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ב               | ▁שלחה        | ✗     |
|     1 | ▁-              | ▁את          | ✗     |
|     2 | ▁-              | ▁המכתב       | ✗     |
|     3 | ▁הזה            | ▁ויצא        | ✗     |
|     4 | ▁מכאן           | ה            | ✗     |
|     5 | ▁אחריו          | ,            | ✗     |
|     6 | <pad>           | ▁מנ          | ✗     |
|     7 | אל              | ופפת         | ✗     |
|     8 | ▁בו             | ▁לשלום       | ✗     |
|     9 | .               | ▁לכמה        | ✗     |
|    10 | ▁זמן            | ▁מכר         | ✗     |
|    11 | ים              | ים           | ✓     |
|    12 | ▁חדשים          | ▁מקומיים     | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2025-01-01 00:02:58,563 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:02:58,568 - TrainingLogger - INFO - Gradient norm: 8.0010
2025-01-01 00:03:06,041 - TrainingLogger - INFO - Step 42010, Batch metrics: Loss: 7.0796, Accuracy: 0.0936, Perplexity: 1187.4400
2025-01-01 00:03:14,492 - TrainingLogger - INFO - Step 42020, Batch metrics: Loss: 7.2275, Accuracy: 0.0745, Perplexity: 1376.7296
2025-01-01 00:03:21,930 - TrainingLogger - INFO - Step 42030, Batch metrics: Loss: 7.5114, Accuracy: 0.0833, Perplexity: 1828.7306
2025-01-01 00:03:29,315 - TrainingLogger - INFO - Step 42040, Batch metrics: Loss: 7.1442, Accuracy: 0.0789, Perplexity: 1266.6769
2025-01-01 00:03:36,564 - TrainingLogger - INFO - Step 42050, Batch metrics: Loss: 7.4624, Accuracy: 0.0405, Perplexity: 1741.3911
2025-01-01 00:03:43,346 - TrainingLogger - INFO - Step 42060, Batch metrics: Loss: 7.1794, Accuracy: 0.0918, Perplexity: 1312.1201
2025-01-01 00:03:50,270 - TrainingLogger - INFO - Step 42070, Batch metrics: Loss: 7.6195, Accuracy: 0.0898, Perplexity: 2037.5551
2025-01-01 00:03:57,549 - TrainingLogger - INFO - Step 42080, Batch metrics: Loss: 6.5803, Accuracy: 0.1366, Perplexity: 720.7472
2025-01-01 00:04:04,918 - TrainingLogger - INFO - Step 42090, Batch metrics: Loss: 7.1447, Accuracy: 0.0739, Perplexity: 1267.4285
2025-01-01 00:04:13,233 - TrainingLogger - INFO - Step 42100, Batch metrics: Loss: 7.0805, Accuracy: 0.0448, Perplexity: 1188.5566
2025-01-01 00:04:13,233 - TrainingLogger - INFO - Step 42100, Prediction vs Actual:
2025-01-01 00:04:13,233 - TrainingLogger - INFO - Input 1: מבצעים 20 החלפותדגשיםיש לדחוף את הרגל הכפופה לכיוון כפות הידיים, ואת כפות הידיים לכיוון הרגל הכפופה
2025-01-01 00:04:13,234 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:04:13,234 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מבצעים      | ✗     |
|     1 | ▁-              | ▁20          | ✗     |
|     2 | ▁שנה            | ▁החל         | ✗     |
|     3 | ים              | פות          | ✗     |
|     4 | .               | דג           | ✗     |
|     5 | ות              | שים          | ✗     |
|     6 | .               | יש           | ✗     |
|     7 | ה               | ▁לדחוף       | ✗     |
|     8 | ▁את             | ▁את          | ✓     |
|     9 | ▁זה             | ▁הרגל        | ✗     |
|    10 | .               | ▁ה           | ✗     |
|    11 | נוס             | כפו          | ✗     |
|    12 | יה              | פה           | ✗     |
|    13 | ▁ל              | ▁לכיוון      | ✗     |
|    14 | ▁השני           | ▁כפות        | ✗     |
|    15 | ה               | ▁הידיים      | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | <pad>           | ▁ואת         | ✗     |
|    18 | ▁זה             | ▁כפות        | ✗     |
|    19 | ▁הרגליים        | ▁הידיים      | ✗     |
|    20 | ▁שלו            | ▁לכיוון      | ✗     |
|    21 | ▁השני           | ▁הרגל        | ✗     |
|    22 | ,               | ▁ה           | ✗     |
|    23 | זווית           | כפו          | ✗     |
|    24 | יה              | פה           | ✗     |
|    25 | ▁שלו            | <pad>        | ✗     |
|    26 | ▁שלו            | <pad>        | ✗     |
|    27 | ,               |              | ✗     |

2025-01-01 00:04:13,234 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:04:13,239 - TrainingLogger - INFO - Gradient norm: 8.8092
2025-01-01 00:04:21,077 - TrainingLogger - INFO - Step 42110, Batch metrics: Loss: 7.3330, Accuracy: 0.0387, Perplexity: 1530.0220
2025-01-01 00:04:28,439 - TrainingLogger - INFO - Step 42120, Batch metrics: Loss: 7.1146, Accuracy: 0.0935, Perplexity: 1229.8164
2025-01-01 00:04:35,215 - TrainingLogger - INFO - Step 42130, Batch metrics: Loss: 6.9755, Accuracy: 0.1111, Perplexity: 1070.0504
2025-01-01 00:04:42,976 - TrainingLogger - INFO - Step 42140, Batch metrics: Loss: 7.1656, Accuracy: 0.1040, Perplexity: 1294.1407
2025-01-01 00:04:50,098 - TrainingLogger - INFO - Step 42150, Batch metrics: Loss: 7.1924, Accuracy: 0.0914, Perplexity: 1329.3321
2025-01-01 00:04:56,900 - TrainingLogger - INFO - Step 42160, Batch metrics: Loss: 7.7938, Accuracy: 0.0370, Perplexity: 2425.5804
2025-01-01 00:05:04,068 - TrainingLogger - INFO - Step 42170, Batch metrics: Loss: 7.3519, Accuracy: 0.0803, Perplexity: 1559.2120
2025-01-01 00:05:11,096 - TrainingLogger - INFO - Step 42180, Batch metrics: Loss: 7.7996, Accuracy: 0.0585, Perplexity: 2439.5169
2025-01-01 00:05:18,211 - TrainingLogger - INFO - Step 42190, Batch metrics: Loss: 7.5703, Accuracy: 0.0733, Perplexity: 1939.6344
2025-01-01 00:05:25,623 - TrainingLogger - INFO - Step 42200, Batch metrics: Loss: 7.7084, Accuracy: 0.0495, Perplexity: 2226.8834
2025-01-01 00:05:25,623 - TrainingLogger - INFO - Step 42200, Prediction vs Actual:
2025-01-01 00:05:25,623 - TrainingLogger - INFO - Input 1: מעבר צהל לנגב תוקצב ב-185 מיליון שקל וצפוי להיות מושלם כמעט במלואו בשנתיים הקרובות
2025-01-01 00:05:25,624 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:05:25,624 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מעבר        | ✗     |
|     1 | ▁-              | ▁צ           | ✗     |
|     2 | ▁-              | הל           | ✗     |
|     3 | נים             | ▁לנגב        | ✗     |
|     4 | ▁את             | ▁תו          | ✗     |
|     5 | ח               | קצב          | ✗     |
|     6 | ים              | ▁ב           | ✗     |
|     7 | -2              | -18          | ✗     |
|     8 | 5               | 5            | ✓     |
|     9 | ▁שעות           | ▁מיליון      | ✗     |
|    10 | ▁דולר           | ▁שקל         | ✗     |
|    11 | ים              | ▁ו           | ✗     |
|    12 | -               | צפוי         | ✗     |
|    13 | ים              | ▁להיות       | ✗     |
|    14 | ▁להם            | ▁מושלם       | ✗     |
|    15 | .               | ▁כמעט        | ✗     |
|    16 | ▁בכל            | ▁במלוא       | ✗     |
|    17 | ו               | ו            | ✓     |
|    18 | .               | ▁בשנתיים     | ✗     |
|    19 | ▁האחרונות       | ▁הקרובות     | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2025-01-01 00:05:25,624 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:05:25,629 - TrainingLogger - INFO - Gradient norm: 8.4776
2025-01-01 00:05:32,625 - TrainingLogger - INFO - Step 42210, Batch metrics: Loss: 7.4552, Accuracy: 0.0859, Perplexity: 1728.8746
2025-01-01 00:05:40,222 - TrainingLogger - INFO - Step 42220, Batch metrics: Loss: 7.9881, Accuracy: 0.0479, Perplexity: 2945.5629
2025-01-01 00:05:47,546 - TrainingLogger - INFO - Step 42230, Batch metrics: Loss: 7.6024, Accuracy: 0.0350, Perplexity: 2002.9301
2025-01-01 00:05:55,028 - TrainingLogger - INFO - Step 42240, Batch metrics: Loss: 7.4515, Accuracy: 0.0796, Perplexity: 1722.4489
2025-01-01 00:06:02,631 - TrainingLogger - INFO - Step 42250, Batch metrics: Loss: 7.4367, Accuracy: 0.0670, Perplexity: 1697.1758
2025-01-01 00:06:09,472 - TrainingLogger - INFO - Step 42260, Batch metrics: Loss: 7.8110, Accuracy: 0.0701, Perplexity: 2467.4894
2025-01-01 00:06:16,733 - TrainingLogger - INFO - Step 42270, Batch metrics: Loss: 7.3629, Accuracy: 0.0784, Perplexity: 1576.4658
2025-01-01 00:06:23,874 - TrainingLogger - INFO - Step 42280, Batch metrics: Loss: 7.4751, Accuracy: 0.0585, Perplexity: 1763.5764
2025-01-01 00:06:30,609 - TrainingLogger - INFO - Step 42290, Batch metrics: Loss: 7.3177, Accuracy: 0.0755, Perplexity: 1506.7358
2025-01-01 00:06:37,605 - TrainingLogger - INFO - Step 42300, Batch metrics: Loss: 6.8873, Accuracy: 0.1133, Perplexity: 979.7493
2025-01-01 00:06:37,605 - TrainingLogger - INFO - Step 42300, Prediction vs Actual:
2025-01-01 00:06:37,606 - TrainingLogger - INFO - Input 1: לא מאיימים על ראש ממשלה בהתפטרות אלא עושים אותה
2025-01-01 00:06:37,606 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:06:37,606 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | :               | ▁לא          | ✗     |
|     1 | ▁-              | ▁מאיימים     | ✗     |
|     2 | ▁-              | ▁על          | ✗     |
|     3 | ▁-              | ▁ראש         | ✗     |
|     4 | ▁-              | ▁ממשלה       | ✗     |
|     5 | ▁-              | ▁בה          | ✗     |
|     6 | חל              | ת            | ✗     |
|     7 | גלות            | פטר          | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | <pad>           | ▁אלא         | ✗     |
|    10 | ▁אם             | ▁עושים       | ✗     |
|    11 | ▁את             | ▁אותה        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | ▁זה             |              | ✗     |

2025-01-01 00:06:37,606 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:06:37,611 - TrainingLogger - INFO - Gradient norm: 8.6608
2025-01-01 00:06:45,105 - TrainingLogger - INFO - Step 42310, Batch metrics: Loss: 6.9107, Accuracy: 0.0802, Perplexity: 1002.9604
2025-01-01 00:06:52,153 - TrainingLogger - INFO - Step 42320, Batch metrics: Loss: 7.1039, Accuracy: 0.1119, Perplexity: 1216.7401
2025-01-01 00:06:59,517 - TrainingLogger - INFO - Step 42330, Batch metrics: Loss: 6.8320, Accuracy: 0.0916, Perplexity: 927.0145
2025-01-01 00:07:06,520 - TrainingLogger - INFO - Step 42340, Batch metrics: Loss: 6.7690, Accuracy: 0.0904, Perplexity: 870.4747
2025-01-01 00:07:13,525 - TrainingLogger - INFO - Step 42350, Batch metrics: Loss: 7.0020, Accuracy: 0.1294, Perplexity: 1098.8143
2025-01-01 00:07:20,225 - TrainingLogger - INFO - Step 42360, Batch metrics: Loss: 7.8560, Accuracy: 0.0606, Perplexity: 2581.1835
2025-01-01 00:07:27,928 - TrainingLogger - INFO - Step 42370, Batch metrics: Loss: 7.2770, Accuracy: 0.0857, Perplexity: 1446.6043
2025-01-01 00:07:34,757 - TrainingLogger - INFO - Step 42380, Batch metrics: Loss: 7.1496, Accuracy: 0.0935, Perplexity: 1273.6025
2025-01-01 00:07:42,038 - TrainingLogger - INFO - Step 42390, Batch metrics: Loss: 7.3204, Accuracy: 0.1022, Perplexity: 1510.8784
2025-01-01 00:07:49,382 - TrainingLogger - INFO - Step 42400, Batch metrics: Loss: 6.9819, Accuracy: 0.1241, Perplexity: 1077.0055
2025-01-01 00:07:49,383 - TrainingLogger - INFO - Step 42400, Prediction vs Actual:
2025-01-01 00:07:49,383 - TrainingLogger - INFO - Input 1: תושבת השכונה סיפרה על הליכה של שלוש שעות בין טנקים, שאחריהם אמרו להם לשוב לשכונה
2025-01-01 00:07:49,383 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:07:49,383 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁תושב        | ✗     |
|     1 | ▁-              | ת            | ✗     |
|     2 | ▁ישראל          | ▁השכונה      | ✗     |
|     3 | ▁השנייה         | ▁סיפרה       | ✗     |
|     4 | ▁ישראל          | ▁על          | ✗     |
|     5 | ▁כך             | ▁הליכה       | ✗     |
|     6 | ▁ארוכה          | ▁של          | ✗     |
|     7 | ▁               | ▁שלוש        | ✗     |
|     8 | ▁שנים           | ▁שעות        | ✗     |
|     9 | ▁ביממה          | ▁בין         | ✗     |
|    10 | ▁מדינות         | ▁טנקים       | ✗     |
|    11 | ▁שונים          | ,            | ✗     |
|    12 | <pad>           | ▁שאחרי       | ✗     |
|    13 | ה               | הם           | ✗     |
|    14 | ▁יש             | ▁אמרו        | ✗     |
|    15 | ▁"              | ▁להם         | ✗     |
|    16 | ▁את             | ▁לשוב        | ✗     |
|    17 | ▁הביתה          | ▁לשכונה      | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ▁אחרת           | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁ישראל          | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁הם             | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2025-01-01 00:07:49,383 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:07:49,388 - TrainingLogger - INFO - Gradient norm: 8.0516
2025-01-01 00:07:56,711 - TrainingLogger - INFO - Step 42410, Batch metrics: Loss: 7.5250, Accuracy: 0.0778, Perplexity: 1853.8965
2025-01-01 00:08:03,722 - TrainingLogger - INFO - Step 42420, Batch metrics: Loss: 7.5571, Accuracy: 0.0671, Perplexity: 1914.3076
2025-01-01 00:08:11,117 - TrainingLogger - INFO - Step 42430, Batch metrics: Loss: 6.8281, Accuracy: 0.0736, Perplexity: 923.4423
2025-01-01 00:08:17,986 - TrainingLogger - INFO - Step 42440, Batch metrics: Loss: 6.9618, Accuracy: 0.0846, Perplexity: 1055.5581
2025-01-01 00:08:25,473 - TrainingLogger - INFO - Step 42450, Batch metrics: Loss: 7.1601, Accuracy: 0.1033, Perplexity: 1287.0678
2025-01-01 00:08:32,477 - TrainingLogger - INFO - Step 42460, Batch metrics: Loss: 7.1239, Accuracy: 0.0676, Perplexity: 1241.2275
2025-01-01 00:08:39,908 - TrainingLogger - INFO - Step 42470, Batch metrics: Loss: 6.9710, Accuracy: 0.1111, Perplexity: 1065.2801
2025-01-01 00:08:46,896 - TrainingLogger - INFO - Step 42480, Batch metrics: Loss: 7.5959, Accuracy: 0.0765, Perplexity: 1990.0743
2025-01-01 00:08:53,984 - TrainingLogger - INFO - Step 42490, Batch metrics: Loss: 7.1970, Accuracy: 0.0941, Perplexity: 1335.3561
2025-01-01 00:09:00,789 - TrainingLogger - INFO - Step 42500, Batch metrics: Loss: 7.2383, Accuracy: 0.0811, Perplexity: 1391.7358
2025-01-01 00:09:00,789 - TrainingLogger - INFO - Step 42500, Prediction vs Actual:
2025-01-01 00:09:00,789 - TrainingLogger - INFO - Input 1: היישוב שלנו מעורבב מבחינה פוליטית, כמו כל המדינה, תיארה שוש פרידמן
2025-01-01 00:09:00,789 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:09:00,789 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היי         | ✗     |
|     1 | </s>            | שוב          | ✗     |
|     2 | </s>            | ▁שלנו        | ✗     |
|     3 | </s>            | ▁מעורבב      | ✗     |
|     4 | ים              | ▁מבחינה      | ✗     |
|     5 | ▁פוליטית        | ▁פוליטית     | ✓     |
|     6 | </s>            | ,            | ✗     |
|     7 | <pad>           | ▁כמו         | ✗     |
|     8 | ▁תמיד           | ▁כל          | ✗     |
|     9 | ▁אחד            | ▁המדינה      | ✗     |
|    10 | ▁שלנו           | ,            | ✗     |
|    11 | </s>            | ▁תיאר        | ✗     |
|    12 | ה               | ה            | ✓     |
|    13 | ▁את             | ▁ש           | ✗     |
|    14 | ...             | וש           | ✗     |
|    15 | ון              | ▁פרידמן      | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            |              | ✗     |

2025-01-01 00:09:00,789 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:09:00,794 - TrainingLogger - INFO - Gradient norm: 7.3085
2025-01-01 00:09:08,073 - TrainingLogger - INFO - Step 42510, Batch metrics: Loss: 7.3983, Accuracy: 0.0991, Perplexity: 1633.1615
2025-01-01 00:09:15,475 - TrainingLogger - INFO - Step 42520, Batch metrics: Loss: 7.4355, Accuracy: 0.0955, Perplexity: 1695.1716
2025-01-01 00:09:23,066 - TrainingLogger - INFO - Step 42530, Batch metrics: Loss: 7.5504, Accuracy: 0.0677, Perplexity: 1901.4175
2025-01-01 00:09:30,215 - TrainingLogger - INFO - Step 42540, Batch metrics: Loss: 7.6668, Accuracy: 0.0440, Perplexity: 2136.1908
2025-01-01 00:09:37,315 - TrainingLogger - INFO - Step 42550, Batch metrics: Loss: 7.6635, Accuracy: 0.0553, Perplexity: 2129.1343
2025-01-01 00:09:44,508 - TrainingLogger - INFO - Step 42560, Batch metrics: Loss: 7.5293, Accuracy: 0.0455, Perplexity: 1861.8563
2025-01-01 00:09:51,858 - TrainingLogger - INFO - Step 42570, Batch metrics: Loss: 6.7528, Accuracy: 0.1609, Perplexity: 856.4294
2025-01-01 00:09:59,059 - TrainingLogger - INFO - Step 42580, Batch metrics: Loss: 7.5792, Accuracy: 0.0598, Perplexity: 1957.1080
2025-01-01 00:10:06,157 - TrainingLogger - INFO - Step 42590, Batch metrics: Loss: 7.2000, Accuracy: 0.0955, Perplexity: 1339.4101
2025-01-01 00:10:14,188 - TrainingLogger - INFO - Step 42600, Batch metrics: Loss: 7.7085, Accuracy: 0.0803, Perplexity: 2227.1563
2025-01-01 00:10:14,188 - TrainingLogger - INFO - Step 42600, Prediction vs Actual:
2025-01-01 00:10:14,188 - TrainingLogger - INFO - Input 1: חברה שלי, דיילת, אמרה לי פעם, איזה כיף לך שאת הולכת איתו לכל האירועים הנוצצים, מספרת שרה נתניהו, צחקתי
2025-01-01 00:10:14,189 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:10:14,189 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁חברה        | ✗     |
|     1 | ▁-              | ▁שלי         | ✗     |
|     2 | חה              | ,            | ✗     |
|     3 | <pad>           | ▁דייל        | ✗     |
|     4 | י               | ת            | ✗     |
|     5 | ,               | ,            | ✓     |
|     6 | <pad>           | ▁אמרה        | ✗     |
|     7 | ▁לי             | ▁לי          | ✓     |
|     8 | ,               | ▁פעם         | ✗     |
|     9 | ▁אחת            | ,            | ✗     |
|    10 | ▁"              | ▁איזה        | ✗     |
|    11 | ▁כיף            | ▁כיף         | ✓     |
|    12 | .               | ▁לך          | ✗     |
|    13 | ,               | ▁שאת         | ✗     |
|    14 | ▁לא             | ▁הולכת       | ✗     |
|    15 | ▁לעשות          | ▁איתו        | ✗     |
|    16 | ,               | ▁לכל         | ✗     |
|    17 | ▁הרוחות         | ▁האירועים    | ✗     |
|    18 | ▁האלה           | ▁הנו         | ✗     |
|    19 | דד              | צצים         | ✗     |
|    20 | ▁האלה           | ,            | ✗     |
|    21 | </s>            | ▁מספרת       | ✗     |
|    22 | ▁לו             | ▁שרה         | ✗     |
|    23 | .               | ▁נתנ         | ✗     |
|    24 | יי              | יהו          | ✗     |
|    25 | ,               | ,            | ✓     |
|    26 | <pad>           | ▁צחקתי       | ✗     |
|    27 | ,               |              | ✗     |

2025-01-01 00:10:14,189 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:10:14,194 - TrainingLogger - INFO - Gradient norm: 9.6434
2025-01-01 00:10:21,100 - TrainingLogger - INFO - Step 42610, Batch metrics: Loss: 7.2136, Accuracy: 0.0706, Perplexity: 1357.8047
2025-01-01 00:10:28,802 - TrainingLogger - INFO - Step 42620, Batch metrics: Loss: 7.2542, Accuracy: 0.0905, Perplexity: 1413.9855
2025-01-01 00:10:35,808 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 258048
2025-01-01 00:10:35,808 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 258048

2025-01-01 00:10:35,808 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 38]), device: cuda:0
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 38]), device: cuda:0
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 41]), device: cuda:0
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 00:10:35,809 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 41]), device: cuda:0
2025-01-01 00:10:35,810 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 00:10:35,810 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 00:10:36,739 - TrainingLogger - INFO - Step 42630, Batch metrics: Loss: 7.4753, Accuracy: 0.1169, Perplexity: 1763.9372
2025-01-01 00:10:43,968 - TrainingLogger - INFO - Step 42640, Batch metrics: Loss: 7.8271, Accuracy: 0.0732, Perplexity: 2507.7107
2025-01-01 00:10:51,511 - TrainingLogger - INFO - Step 42650, Batch metrics: Loss: 7.3407, Accuracy: 0.0628, Perplexity: 1541.7434
2025-01-01 00:10:58,388 - TrainingLogger - INFO - Step 42660, Batch metrics: Loss: 7.4221, Accuracy: 0.0514, Perplexity: 1672.4984
2025-01-01 00:11:05,975 - TrainingLogger - INFO - Step 42670, Batch metrics: Loss: 7.0122, Accuracy: 0.1074, Perplexity: 1110.0590
2025-01-01 00:11:12,798 - TrainingLogger - INFO - Step 42680, Batch metrics: Loss: 7.7062, Accuracy: 0.0601, Perplexity: 2222.1154
2025-01-01 00:11:20,246 - TrainingLogger - INFO - Step 42690, Batch metrics: Loss: 7.6646, Accuracy: 0.0617, Perplexity: 2131.6292
2025-01-01 00:11:27,311 - TrainingLogger - INFO - Step 42700, Batch metrics: Loss: 7.4691, Accuracy: 0.0778, Perplexity: 1753.0784
2025-01-01 00:11:27,311 - TrainingLogger - INFO - Step 42700, Prediction vs Actual:
2025-01-01 00:11:27,311 - TrainingLogger - INFO - Input 1: לפי התביעה, אלו אמירות שמצביעות לכאורה על חריגה מהכללים הנהוגים בלחימה
2025-01-01 00:11:27,312 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:11:27,312 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁לפי         | ✗     |
|     1 | ▁-              | ▁התביעה      | ✗     |
|     2 | ▁אני            | ,            | ✗     |
|     3 | ▁-              | ▁אלו         | ✗     |
|     4 | ▁הם             | ▁אמיר        | ✗     |
|     5 | ות              | ות           | ✓     |
|     6 | ▁חדשות          | ▁ש           | ✗     |
|     7 | אינן            | מצביע        | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | ▁על             | ▁לכאורה      | ✗     |
|    10 | .               | ▁על          | ✗     |
|    11 | ▁כך             | ▁חריגה       | ✗     |
|    12 | .               | ▁מהכלל       | ✗     |
|    13 | ים              | ים           | ✓     |
|    14 | .               | ▁הנה         | ✗     |
|    15 | ונים            | וג           | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | .               | ▁ב           | ✗     |
|    18 | -               | לחימה        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | <pad>           | <pad>        | ✓     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | <pad>           | <pad>        | ✓     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | <pad>           | <pad>        | ✓     |
|    49 | <pad>           | <pad>        | ✓     |
|    50 | <pad>           | <pad>        | ✓     |
|    51 | <pad>           |              | ✗     |

2025-01-01 00:11:27,312 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:11:27,317 - TrainingLogger - INFO - Gradient norm: 8.9635
2025-01-01 00:11:34,801 - TrainingLogger - INFO - Step 42710, Batch metrics: Loss: 7.7840, Accuracy: 0.0660, Perplexity: 2401.7884
2025-01-01 00:11:41,514 - TrainingLogger - INFO - Step 42720, Batch metrics: Loss: 7.5192, Accuracy: 0.0927, Perplexity: 1843.0858
2025-01-01 00:11:48,681 - TrainingLogger - INFO - Step 42730, Batch metrics: Loss: 7.6655, Accuracy: 0.1053, Perplexity: 2133.5512
2025-01-01 00:11:55,552 - TrainingLogger - INFO - Step 42740, Batch metrics: Loss: 7.3439, Accuracy: 0.1043, Perplexity: 1546.7182
2025-01-01 00:12:02,845 - TrainingLogger - INFO - Step 42750, Batch metrics: Loss: 6.5958, Accuracy: 0.1465, Perplexity: 732.0048
2025-01-01 00:12:09,696 - TrainingLogger - INFO - Step 42760, Batch metrics: Loss: 7.3582, Accuracy: 0.0861, Perplexity: 1569.0383
2025-01-01 00:12:16,816 - TrainingLogger - INFO - Step 42770, Batch metrics: Loss: 7.8691, Accuracy: 0.0488, Perplexity: 2615.2610
2025-01-01 00:12:23,594 - TrainingLogger - INFO - Step 42780, Batch metrics: Loss: 7.3196, Accuracy: 0.0816, Perplexity: 1509.5973
2025-01-01 00:12:30,846 - TrainingLogger - INFO - Step 42790, Batch metrics: Loss: 6.9655, Accuracy: 0.1055, Perplexity: 1059.4272
2025-01-01 00:12:37,685 - TrainingLogger - INFO - Step 42800, Batch metrics: Loss: 7.5896, Accuracy: 0.0658, Perplexity: 1977.4537
2025-01-01 00:12:37,686 - TrainingLogger - INFO - Step 42800, Prediction vs Actual:
2025-01-01 00:12:37,686 - TrainingLogger - INFO - Input 1: הסיפוק הוא עצום כי הענקנו לו המון אהבה וההתנדבות הזו עשתה את ההבדל בין ילד סיעודי לילד שעלה על מסלול שיקומי
2025-01-01 00:12:37,686 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:12:37,686 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הסיפוק      | ✗     |
|     1 | ▁-              | ▁הוא         | ✗     |
|     2 | ▁-              | ▁עצום        | ✗     |
|     3 | ,               | ▁כי          | ✗     |
|     4 | ▁הוא            | ▁הענק        | ✗     |
|     5 | ים              | נו           | ✗     |
|     6 | ▁לו             | ▁לו          | ✓     |
|     7 | ▁את             | ▁המון        | ✗     |
|     8 | ▁כסף            | ▁אהבה        | ✗     |
|     9 | .               | ▁וה          | ✗     |
|    10 | שפל             | התנדב        | ✗     |
|    11 | ות              | ות           | ✓     |
|    12 | ▁שלו            | ▁הזו         | ✗     |
|    13 | ,               | ▁עשתה        | ✗     |
|    14 | ▁אותו           | ▁את          | ✗     |
|    15 | ▁אותו           | ▁ההבדל       | ✗     |
|    16 | ים              | ▁בין         | ✗     |
|    17 | ▁השאר           | ▁ילד         | ✗     |
|    18 | ▁לבן            | ▁סי          | ✗     |
|    19 | נדר             | עוד          | ✗     |
|    20 | י               | י            | ✓     |
|    21 | ,               | ▁לילד        | ✗     |
|    22 | ו               | ▁שעלה        | ✗     |
|    23 | ▁לו             | ▁על          | ✗     |
|    24 | ▁רגליו          | ▁מסלול       | ✗     |
|    25 | ו               | ▁שי          | ✗     |
|    26 | עבוד            | קומי         | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               |              | ✗     |

2025-01-01 00:12:37,686 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:12:37,691 - TrainingLogger - INFO - Gradient norm: 7.6725
2025-01-01 00:12:44,519 - TrainingLogger - INFO - Step 42810, Batch metrics: Loss: 7.0738, Accuracy: 0.0791, Perplexity: 1180.6451
2025-01-01 00:12:51,766 - TrainingLogger - INFO - Step 42820, Batch metrics: Loss: 7.1733, Accuracy: 0.0941, Perplexity: 1304.2018
2025-01-01 00:12:59,156 - TrainingLogger - INFO - Step 42830, Batch metrics: Loss: 7.2767, Accuracy: 0.0920, Perplexity: 1446.1973
2025-01-01 00:13:06,360 - TrainingLogger - INFO - Step 42840, Batch metrics: Loss: 7.5659, Accuracy: 0.0635, Perplexity: 1931.2767
2025-01-01 00:13:13,856 - TrainingLogger - INFO - Step 42850, Batch metrics: Loss: 7.2318, Accuracy: 0.0769, Perplexity: 1382.6493
2025-01-01 00:13:21,846 - TrainingLogger - INFO - Step 42860, Batch metrics: Loss: 6.9331, Accuracy: 0.1031, Perplexity: 1025.6605
2025-01-01 00:13:28,596 - TrainingLogger - INFO - Step 42870, Batch metrics: Loss: 7.6303, Accuracy: 0.0617, Perplexity: 2059.5835
2025-01-01 00:13:35,830 - TrainingLogger - INFO - Step 42880, Batch metrics: Loss: 7.2557, Accuracy: 0.0536, Perplexity: 1416.2021
2025-01-01 00:13:43,257 - TrainingLogger - INFO - Step 42890, Batch metrics: Loss: 7.2318, Accuracy: 0.1033, Perplexity: 1382.6717
2025-01-01 00:13:50,786 - TrainingLogger - INFO - Step 42900, Batch metrics: Loss: 7.4557, Accuracy: 0.0726, Perplexity: 1729.6876
2025-01-01 00:13:50,786 - TrainingLogger - INFO - Step 42900, Prediction vs Actual:
2025-01-01 00:13:50,786 - TrainingLogger - INFO - Input 1: משרד החוץ של איראן מסר כי ההתנקשות הגיעה כתוצאה מהכישלון הגדול של ישראל בעימות מול ההתנגדות בעזה
2025-01-01 00:13:50,787 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:13:50,787 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תו              | ▁משרד        | ✗     |
|     1 | ▁-              | ▁החוץ        | ✗     |
|     2 | ▁-              | ▁של          | ✗     |
|     3 | ▁היום           | ▁אי          | ✗     |
|     4 | ראן             | ראן          | ✓     |
|     5 | .               | ▁מסר         | ✗     |
|     6 | ▁-              | ▁כי          | ✗     |
|     7 | ▁הוא            | ▁ההתנקשות    | ✗     |
|     8 | ▁שלו            | ▁הגיעה       | ✗     |
|     9 | ▁לשיא           | ▁כתוצאה      | ✗     |
|    10 | ▁מכך            | ▁מה          | ✗     |
|    11 | ה               | כישלון       | ✗     |
|    12 | ▁של             | ▁הגדול       | ✗     |
|    13 | ▁ביותר          | ▁של          | ✗     |
|    14 | ▁המדינה         | ▁ישראל       | ✗     |
|    15 | .               | ▁ב           | ✗     |
|    16 | איחוד           | עימות        | ✗     |
|    17 | ים              | ▁מול         | ✗     |
|    18 | ה               | ▁ההתנגדות    | ✗     |
|    19 | ▁הגדולה         | ▁בע          | ✗     |
|    20 | "               | זה           | ✗     |
|    21 | ות              | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ה               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁ב              | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁ב              |              | ✗     |

2025-01-01 00:13:50,787 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:13:50,792 - TrainingLogger - INFO - Gradient norm: 12.8471
2025-01-01 00:13:57,657 - TrainingLogger - INFO - Step 42910, Batch metrics: Loss: 7.4927, Accuracy: 0.0968, Perplexity: 1794.9151
2025-01-01 00:14:04,657 - TrainingLogger - INFO - Step 42920, Batch metrics: Loss: 7.1111, Accuracy: 0.0884, Perplexity: 1225.5015
2025-01-01 00:14:12,243 - TrainingLogger - INFO - Step 42930, Batch metrics: Loss: 7.2038, Accuracy: 0.1024, Perplexity: 1344.5350
2025-01-01 00:14:19,646 - TrainingLogger - INFO - Step 42940, Batch metrics: Loss: 7.0265, Accuracy: 0.1069, Perplexity: 1126.0999
2025-01-01 00:14:27,022 - TrainingLogger - INFO - Step 42950, Batch metrics: Loss: 7.3717, Accuracy: 0.0864, Perplexity: 1590.3431
2025-01-01 00:14:34,068 - TrainingLogger - INFO - Step 42960, Batch metrics: Loss: 7.4301, Accuracy: 0.0682, Perplexity: 1685.9898
2025-01-01 00:14:41,398 - TrainingLogger - INFO - Step 42970, Batch metrics: Loss: 7.5357, Accuracy: 0.0530, Perplexity: 1873.7785
2025-01-01 00:14:48,611 - TrainingLogger - INFO - Step 42980, Batch metrics: Loss: 7.5836, Accuracy: 0.0543, Perplexity: 1965.7575
2025-01-01 00:14:55,835 - TrainingLogger - INFO - Step 42990, Batch metrics: Loss: 7.4323, Accuracy: 0.1019, Perplexity: 1689.6984
2025-01-01 00:15:02,960 - TrainingLogger - INFO - Step 43000, Batch metrics: Loss: 7.4130, Accuracy: 0.0748, Perplexity: 1657.3739
2025-01-01 00:15:02,960 - TrainingLogger - INFO - Step 43000, Prediction vs Actual:
2025-01-01 00:15:02,960 - TrainingLogger - INFO - Input 1: אחר כך התברר, כך נטען, שאבו טוהא אותר כמבוקש באמצעות תוכנת בינה מלאכותית לזיהוי פנים
2025-01-01 00:15:02,961 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:15:02,961 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אחר         | ✗     |
|     1 | ▁-              | ▁כך          | ✗     |
|     2 | .               | ▁התברר       | ✗     |
|     3 | ▁-              | ,            | ✗     |
|     4 | ▁זה             | ▁כך          | ✗     |
|     5 | ▁זה             | ▁נטע         | ✗     |
|     6 | ן               | ן            | ✓     |
|     7 | .               | ,            | ✗     |
|     8 | <pad>           | ▁שאב         | ✗     |
|     9 | נו              | ו            | ✗     |
|    10 | ▁אותו           | ▁טו          | ✗     |
|    11 | ה               | הא           | ✗     |
|    12 | ,               | ▁או          | ✗     |
|    13 | ▁לא             | תר           | ✗     |
|    14 | ,               | ▁כ           | ✗     |
|    15 | חוק             | מבו          | ✗     |
|    16 | ץ               | קש           | ✗     |
|    17 | ו               | ▁באמצעות     | ✗     |
|    18 | ו               | ▁תוכנת       | ✗     |
|    19 | ו               | ▁בינה        | ✗     |
|    20 | ן               | ▁מלאכותית    | ✗     |
|    21 | ו               | ▁לזיהוי      | ✗     |
|    22 | :               | ▁פנים        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            |              | ✗     |

2025-01-01 00:15:02,961 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:15:02,966 - TrainingLogger - INFO - Gradient norm: 7.7325
2025-01-01 00:15:10,041 - TrainingLogger - INFO - Step 43010, Batch metrics: Loss: 6.9310, Accuracy: 0.0833, Perplexity: 1023.4948
2025-01-01 00:15:16,962 - TrainingLogger - INFO - Step 43020, Batch metrics: Loss: 7.3309, Accuracy: 0.0787, Perplexity: 1526.7796
2025-01-01 00:15:24,157 - TrainingLogger - INFO - Step 43030, Batch metrics: Loss: 7.6886, Accuracy: 0.0677, Perplexity: 2183.2191
2025-01-01 00:15:31,123 - TrainingLogger - INFO - Step 43040, Batch metrics: Loss: 7.6263, Accuracy: 0.0250, Perplexity: 2051.4756
2025-01-01 00:15:38,826 - TrainingLogger - INFO - Step 43050, Batch metrics: Loss: 8.1715, Accuracy: 0.0531, Perplexity: 3538.5947
2025-01-01 00:15:46,155 - TrainingLogger - INFO - Step 43060, Batch metrics: Loss: 7.1102, Accuracy: 0.0877, Perplexity: 1224.3479
2025-01-01 00:15:53,265 - TrainingLogger - INFO - Step 43070, Batch metrics: Loss: 7.3399, Accuracy: 0.0693, Perplexity: 1540.4876
2025-01-01 00:16:00,417 - TrainingLogger - INFO - Step 43080, Batch metrics: Loss: 7.0616, Accuracy: 0.0961, Perplexity: 1166.3573
2025-01-01 00:16:07,372 - TrainingLogger - INFO - Step 43090, Batch metrics: Loss: 6.9587, Accuracy: 0.1078, Perplexity: 1052.3166
2025-01-01 00:16:14,547 - TrainingLogger - INFO - Step 43100, Batch metrics: Loss: 7.2585, Accuracy: 0.1045, Perplexity: 1420.0572
2025-01-01 00:16:14,548 - TrainingLogger - INFO - Step 43100, Prediction vs Actual:
2025-01-01 00:16:14,548 - TrainingLogger - INFO - Input 1: אז מצאתי אשת מקצוע בארץ שהיא גם דוברת רוסית והיא בנתה את השיטה של חיבוקי תרפי ופניתי אליה
2025-01-01 00:16:14,548 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:16:14,548 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | תה              | ▁אז          | ✗     |
|     1 | ▁-              | ▁מצאתי       | ✗     |
|     2 | ▁את             | ▁אשת         | ✗     |
|     3 | ▁ביטחון         | ▁מקצוע       | ✗     |
|     4 | ▁חדשה           | ▁בארץ        | ✗     |
|     5 | ▁ישראל          | ▁שהיא        | ✗     |
|     6 | ▁לא             | ▁גם          | ✗     |
|     7 | ▁לא             | ▁דובר        | ✗     |
|     8 | ת               | ת            | ✓     |
|     9 | ▁אמת            | ▁רוסית       | ✗     |
|    10 | .               | ▁והיא        | ✗     |
|    11 | ▁לא             | ▁ב           | ✗     |
|    12 | ורה             | נתה          | ✗     |
|    13 | ▁את             | ▁את          | ✓     |
|    14 | ▁עצמה           | ▁השיטה       | ✗     |
|    15 | .               | ▁של          | ✗     |
|    16 | ▁אמא            | ▁חיבוק       | ✗     |
|    17 | י               | י            | ✓     |
|    18 | .               | ▁תר          | ✗     |
|    19 | ה               | פי           | ✗     |
|    20 | יה              | ▁ופני        | ✗     |
|    21 | מה              | תי           | ✗     |
|    22 | ▁אליה           | ▁אליה        | ✓     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2025-01-01 00:16:14,548 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:16:14,553 - TrainingLogger - INFO - Gradient norm: 7.0608
2025-01-01 00:16:22,134 - TrainingLogger - INFO - Step 43110, Batch metrics: Loss: 7.2636, Accuracy: 0.1165, Perplexity: 1427.3251
2025-01-01 00:16:29,559 - TrainingLogger - INFO - Step 43120, Batch metrics: Loss: 7.2522, Accuracy: 0.0842, Perplexity: 1411.2729
2025-01-01 00:16:36,753 - TrainingLogger - INFO - Step 43130, Batch metrics: Loss: 6.8147, Accuracy: 0.1000, Perplexity: 911.1558
2025-01-01 00:16:45,018 - TrainingLogger - INFO - Step 43140, Batch metrics: Loss: 7.2821, Accuracy: 0.0859, Perplexity: 1454.1065
2025-01-01 00:16:52,193 - TrainingLogger - INFO - Step 43150, Batch metrics: Loss: 7.2256, Accuracy: 0.0812, Perplexity: 1374.1973
2025-01-01 00:16:59,566 - TrainingLogger - INFO - Step 43160, Batch metrics: Loss: 7.5068, Accuracy: 0.0805, Perplexity: 1820.3758
2025-01-01 00:17:06,939 - TrainingLogger - INFO - Step 43170, Batch metrics: Loss: 7.4403, Accuracy: 0.0959, Perplexity: 1703.3399
2025-01-01 00:17:14,757 - TrainingLogger - INFO - Step 43180, Batch metrics: Loss: 7.5677, Accuracy: 0.0796, Perplexity: 1934.6492
2025-01-01 00:17:21,765 - TrainingLogger - INFO - Step 43190, Batch metrics: Loss: 7.1745, Accuracy: 0.0594, Perplexity: 1305.6809
2025-01-01 00:17:29,116 - TrainingLogger - INFO - Step 43200, Batch metrics: Loss: 7.5604, Accuracy: 0.0345, Perplexity: 1920.6530
2025-01-01 00:17:29,117 - TrainingLogger - INFO - Step 43200, Prediction vs Actual:
2025-01-01 00:17:29,117 - TrainingLogger - INFO - Input 1: החוקרים העריכו כי מספרם האמיתי של העובדים בכפייה גבוה במאות אלפים
2025-01-01 00:17:29,117 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:17:29,117 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁החוקרים     | ✗     |
|     1 | ▁(              | ▁הער         | ✗     |
|     2 | ▁הוא            | יכו          | ✗     |
|     3 | ▁הוא            | ▁כי          | ✗     |
|     4 | ▁הוא            | ▁מספר        | ✗     |
|     5 | ▁שנים           | ם            | ✗     |
|     6 | ▁של             | ▁האמיתי      | ✗     |
|     7 | ▁של             | ▁של          | ✓     |
|     8 | ▁אנשים          | ▁העובדים     | ✗     |
|     9 | ▁שלנו           | ▁ב           | ✗     |
|    10 | "               | כפי          | ✗     |
|    11 | יה              | יה           | ✓     |
|    12 | ▁הוא            | ▁גבוה        | ✗     |
|    13 | ▁יותר           | ▁במאות       | ✗     |
|    14 | ▁שנים           | ▁אלפים       | ✗     |
|    15 | ▁בשנה           | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | ▁המדינה         | <pad>        | ✗     |
|    19 | ▁הם             | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | ▁הם             | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | ▁הוא            | <pad>        | ✗     |
|    26 | ▁הוא            | <pad>        | ✗     |
|    27 | ▁הוא            | <pad>        | ✗     |
|    28 | ▁הוא            | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | ▁ארצות          | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | נים             | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ים              | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | <pad>           |              | ✗     |

2025-01-01 00:17:29,117 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:17:29,122 - TrainingLogger - INFO - Gradient norm: 7.5330
2025-01-01 00:17:35,818 - TrainingLogger - INFO - Step 43210, Batch metrics: Loss: 7.4117, Accuracy: 0.0551, Perplexity: 1655.3101
2025-01-01 00:17:43,025 - TrainingLogger - INFO - Step 43220, Batch metrics: Loss: 7.4003, Accuracy: 0.0755, Perplexity: 1636.4551
2025-01-01 00:17:49,761 - TrainingLogger - INFO - Step 43230, Batch metrics: Loss: 7.6144, Accuracy: 0.0560, Perplexity: 2027.2504
2025-01-01 00:17:56,968 - TrainingLogger - INFO - Step 43240, Batch metrics: Loss: 7.6729, Accuracy: 0.0833, Perplexity: 2149.2484
2025-01-01 00:18:04,478 - TrainingLogger - INFO - Step 43250, Batch metrics: Loss: 6.7930, Accuracy: 0.0986, Perplexity: 891.5581
2025-01-01 00:18:08,617 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 229376
2025-01-01 00:18:08,617 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 229376

2025-01-01 00:18:08,617 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 32]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 32]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 42]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 42]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 33]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 33]), device: cuda:0
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 00:18:08,618 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 00:18:12,183 - TrainingLogger - INFO - Step 43260, Batch metrics: Loss: 7.3185, Accuracy: 0.0833, Perplexity: 1507.9483
2025-01-01 00:18:19,065 - TrainingLogger - INFO - Step 43270, Batch metrics: Loss: 7.8580, Accuracy: 0.0592, Perplexity: 2586.4111
2025-01-01 00:18:26,057 - TrainingLogger - INFO - Step 43280, Batch metrics: Loss: 7.2013, Accuracy: 0.1024, Perplexity: 1341.2347
2025-01-01 00:18:32,751 - TrainingLogger - INFO - Step 43290, Batch metrics: Loss: 7.5614, Accuracy: 0.1118, Perplexity: 1922.4773
2025-01-01 00:18:40,439 - TrainingLogger - INFO - Step 43300, Batch metrics: Loss: 7.9221, Accuracy: 0.0500, Perplexity: 2757.6823
2025-01-01 00:18:40,440 - TrainingLogger - INFO - Step 43300, Prediction vs Actual:
2025-01-01 00:18:40,440 - TrainingLogger - INFO - Input 1: התהליך שנוביל זה לפרק את הריכוזיות הזו אחת אחת
2025-01-01 00:18:40,440 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:18:40,440 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁אחרת           | ▁התהליך      | ✗     |
|     1 | ▁הוא            | ▁שנו         | ✗     |
|     2 | ▁הוא            | ביל          | ✗     |
|     3 | ▁הוא            | ▁זה          | ✗     |
|     4 | ה               | ▁לפרק        | ✗     |
|     5 | ▁אותו           | ▁את          | ✗     |
|     6 | ▁זה             | ▁הריכוז      | ✗     |
|     7 | ▁הגבוה          | יות          | ✗     |
|     8 | .               | ▁הזו         | ✗     |
|     9 | .               | ▁אחת         | ✗     |
|    10 | ▁ולתמיד         | ▁אחת         | ✗     |
|    11 | ▁בלבד           | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ▁מהן            | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ה               | <pad>        | ✗     |
|    16 | ▁השנייה         | <pad>        | ✗     |
|    17 | ות              | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ▁היא            | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | ▁היא            | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | ▁יותר           | <pad>        | ✗     |
|    37 | ▁היא            |              | ✗     |

2025-01-01 00:18:40,440 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:18:40,445 - TrainingLogger - INFO - Gradient norm: 9.9900
2025-01-01 00:18:47,736 - TrainingLogger - INFO - Step 43310, Batch metrics: Loss: 7.5509, Accuracy: 0.0774, Perplexity: 1902.4378
2025-01-01 00:18:54,929 - TrainingLogger - INFO - Step 43320, Batch metrics: Loss: 7.2893, Accuracy: 0.0924, Perplexity: 1464.4983
2025-01-01 00:19:01,936 - TrainingLogger - INFO - Step 43330, Batch metrics: Loss: 7.6871, Accuracy: 0.0432, Perplexity: 2179.9371
2025-01-01 00:19:09,318 - TrainingLogger - INFO - Step 43340, Batch metrics: Loss: 7.0437, Accuracy: 0.0969, Perplexity: 1145.5642
2025-01-01 00:19:16,493 - TrainingLogger - INFO - Step 43350, Batch metrics: Loss: 7.2565, Accuracy: 0.0530, Perplexity: 1417.3154
2025-01-01 00:19:23,170 - TrainingLogger - INFO - Step 43360, Batch metrics: Loss: 7.1328, Accuracy: 0.1088, Perplexity: 1252.4099
2025-01-01 00:19:30,124 - TrainingLogger - INFO - Step 43370, Batch metrics: Loss: 7.3971, Accuracy: 0.0786, Perplexity: 1631.1676
2025-01-01 00:19:37,239 - TrainingLogger - INFO - Step 43380, Batch metrics: Loss: 6.7475, Accuracy: 0.1243, Perplexity: 851.9474
2025-01-01 00:19:44,735 - TrainingLogger - INFO - Step 43390, Batch metrics: Loss: 7.2729, Accuracy: 0.0943, Perplexity: 1440.6574
2025-01-01 00:19:51,987 - TrainingLogger - INFO - Step 43400, Batch metrics: Loss: 7.2044, Accuracy: 0.0938, Perplexity: 1345.3752
2025-01-01 00:19:51,988 - TrainingLogger - INFO - Step 43400, Prediction vs Actual:
2025-01-01 00:19:51,988 - TrainingLogger - INFO - Input 1: ויש את ביבי, שעושה הכול כדי להישאר בשלטון כמה שיותר זמן שלא בניקיון דעת ממש
2025-01-01 00:19:51,988 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:19:51,988 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כמוני          | ▁ויש         | ✗     |
|     1 | ▁אני            | ▁את          | ✗     |
|     2 | ▁-              | ▁בי          | ✗     |
|     3 | ▁-              | בי           | ✗     |
|     4 | ▁-              | ,            | ✗     |
|     5 | <pad>           | ▁שעושה       | ✗     |
|     6 | ▁את             | ▁הכול        | ✗     |
|     7 | ▁כדי            | ▁כדי         | ✓     |
|     8 | ▁להגן           | ▁להישאר      | ✗     |
|     9 | ▁בחיים          | ▁ב           | ✗     |
|    10 | מתח             | שלטון        | ✗     |
|    11 | .               | ▁כמה         | ✗     |
|    12 | ▁פעמים          | ▁שיותר       | ✗     |
|    13 | ▁מהר            | ▁זמן         | ✗     |
|    14 | .               | ▁שלא         | ✗     |
|    15 | ▁יהיו           | ▁ב           | ✗     |
|    16 | כדורגל          | ניקיון       | ✗     |
|    17 | .               | ▁דעת         | ✗     |
|    18 | ▁הקהל           | ▁ממש         | ✗     |
|    19 | י               | <pad>        | ✗     |
|    20 | י               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2025-01-01 00:19:51,988 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:19:51,993 - TrainingLogger - INFO - Gradient norm: 6.5202
2025-01-01 00:19:59,019 - TrainingLogger - INFO - Step 43410, Batch metrics: Loss: 7.4325, Accuracy: 0.0895, Perplexity: 1690.0288
2025-01-01 00:20:05,930 - TrainingLogger - INFO - Step 43420, Batch metrics: Loss: 7.3045, Accuracy: 0.0795, Perplexity: 1486.9630
2025-01-01 00:20:12,779 - TrainingLogger - INFO - Step 43430, Batch metrics: Loss: 7.7334, Accuracy: 0.0352, Perplexity: 2283.2509
2025-01-01 00:20:20,143 - TrainingLogger - INFO - Step 43440, Batch metrics: Loss: 7.5474, Accuracy: 0.0854, Perplexity: 1895.8253
2025-01-01 00:20:26,740 - TrainingLogger - INFO - Step 43450, Batch metrics: Loss: 7.1657, Accuracy: 0.0927, Perplexity: 1294.2512
2025-01-01 00:20:33,863 - TrainingLogger - INFO - Step 43460, Batch metrics: Loss: 7.1118, Accuracy: 0.1106, Perplexity: 1226.3743
2025-01-01 00:20:40,661 - TrainingLogger - INFO - Step 43470, Batch metrics: Loss: 7.5927, Accuracy: 0.0403, Perplexity: 1983.7379
2025-01-01 00:20:47,838 - TrainingLogger - INFO - Step 43480, Batch metrics: Loss: 6.8786, Accuracy: 0.1377, Perplexity: 971.2908
2025-01-01 00:20:54,917 - TrainingLogger - INFO - Step 43490, Batch metrics: Loss: 7.5132, Accuracy: 0.0849, Perplexity: 1832.0691
2025-01-01 00:21:02,011 - TrainingLogger - INFO - Step 43500, Batch metrics: Loss: 7.4016, Accuracy: 0.0750, Perplexity: 1638.6453
2025-01-01 00:21:02,011 - TrainingLogger - INFO - Step 43500, Prediction vs Actual:
2025-01-01 00:21:02,011 - TrainingLogger - INFO - Input 1: אנחנו רוצים שאנשים יקבלו את ההחלטה על החיסון מבחינה רפואית אישית, ביחס לבריאותם
2025-01-01 00:21:02,012 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:21:02,012 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁כמוני          | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁רוצים       | ✗     |
|     2 | ▁-              | ▁שאנשים      | ✗     |
|     3 | ▁לא             | ▁יקבלו       | ✗     |
|     4 | ▁את             | ▁את          | ✓     |
|     5 | ▁זה             | ▁ההחלטה      | ✗     |
|     6 | ▁הזאת           | ▁על          | ✗     |
|     7 | ▁זה             | ▁החיסון      | ✗     |
|     8 | .               | ▁מבחינה      | ✗     |
|     9 | ▁רוחנית         | ▁רפואית      | ✗     |
|    10 | .               | ▁אישית       | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | </s>            | ▁ביחס        | ✗     |
|    13 | ▁ל              | ▁לבריאות     | ✗     |
|    14 | ▁עצמית          | ם            | ✗     |
|    15 | ▁אליו           | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2025-01-01 00:21:02,012 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:21:02,017 - TrainingLogger - INFO - Gradient norm: 8.2828
2025-01-01 00:21:09,387 - TrainingLogger - INFO - Step 43510, Batch metrics: Loss: 6.9486, Accuracy: 0.0941, Perplexity: 1041.7041
2025-01-01 00:21:16,519 - TrainingLogger - INFO - Step 43520, Batch metrics: Loss: 7.4436, Accuracy: 0.0738, Perplexity: 1708.9224
2025-01-01 00:21:23,341 - TrainingLogger - INFO - Step 43530, Batch metrics: Loss: 7.7486, Accuracy: 0.0630, Perplexity: 2318.3588
2025-01-01 00:21:30,138 - TrainingLogger - INFO - Step 43540, Batch metrics: Loss: 7.2044, Accuracy: 0.1067, Perplexity: 1345.2828
2025-01-01 00:21:37,554 - TrainingLogger - INFO - Step 43550, Batch metrics: Loss: 7.3191, Accuracy: 0.1000, Perplexity: 1508.9050
2025-01-01 00:21:44,581 - TrainingLogger - INFO - Step 43560, Batch metrics: Loss: 7.0818, Accuracy: 0.1195, Perplexity: 1190.0940
2025-01-01 00:21:51,384 - TrainingLogger - INFO - Step 43570, Batch metrics: Loss: 7.4280, Accuracy: 0.0591, Perplexity: 1682.4473
2025-01-01 00:21:59,305 - TrainingLogger - INFO - Step 43580, Batch metrics: Loss: 6.8879, Accuracy: 0.1280, Perplexity: 980.3086
2025-01-01 00:22:05,974 - TrainingLogger - INFO - Step 43590, Batch metrics: Loss: 7.0302, Accuracy: 0.0983, Perplexity: 1130.2798
2025-01-01 00:22:13,346 - TrainingLogger - INFO - Step 43600, Batch metrics: Loss: 7.5420, Accuracy: 0.0412, Perplexity: 1885.6178
2025-01-01 00:22:13,346 - TrainingLogger - INFO - Step 43600, Prediction vs Actual:
2025-01-01 00:22:13,346 - TrainingLogger - INFO - Input 1: צבאות פרס מקיפים את ירושלים וממתינים לשעת כושר
2025-01-01 00:22:13,347 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:22:13,347 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁צבאות       | ✗     |
|     1 | ▁-              | ▁פרס         | ✗     |
|     2 | ▁הוא            | ▁מקיפים      | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | ▁המדינה         | ▁ירושלים     | ✗     |
|     5 | ,               | ▁ומ          | ✗     |
|     6 | גלים            | מתי          | ✗     |
|     7 | נים             | נים          | ✓     |
|     8 | ▁לה             | ▁לשעת        | ✗     |
|     9 | י               | ▁כושר        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | ▁(              | <pad>        | ✗     |
|    15 | ▁(              | <pad>        | ✗     |
|    16 | ית              | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ית              | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ית              | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | ▁(              | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | ▁(              | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | ▁היא            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | <pad>           | <pad>        | ✓     |
|    44 | </s>            |              | ✗     |

2025-01-01 00:22:13,347 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:22:13,352 - TrainingLogger - INFO - Gradient norm: 7.3708
2025-01-01 00:22:21,475 - TrainingLogger - INFO - Step 43610, Batch metrics: Loss: 7.5748, Accuracy: 0.0705, Perplexity: 1948.4687
2025-01-01 00:22:29,206 - TrainingLogger - INFO - Step 43620, Batch metrics: Loss: 7.3164, Accuracy: 0.0925, Perplexity: 1504.7383
2025-01-01 00:22:36,338 - TrainingLogger - INFO - Step 43630, Batch metrics: Loss: 7.8510, Accuracy: 0.0567, Perplexity: 2568.2054
2025-01-01 00:22:43,423 - TrainingLogger - INFO - Step 43640, Batch metrics: Loss: 6.6208, Accuracy: 0.1027, Perplexity: 750.5693
2025-01-01 00:22:50,179 - TrainingLogger - INFO - Step 43650, Batch metrics: Loss: 6.9567, Accuracy: 0.1024, Perplexity: 1050.1671
2025-01-01 00:22:57,813 - TrainingLogger - INFO - Step 43660, Batch metrics: Loss: 7.0603, Accuracy: 0.1070, Perplexity: 1164.8061
2025-01-01 00:23:05,427 - TrainingLogger - INFO - Step 43670, Batch metrics: Loss: 7.3801, Accuracy: 0.0737, Perplexity: 1603.7131
2025-01-01 00:23:12,876 - TrainingLogger - INFO - Step 43680, Batch metrics: Loss: 7.6946, Accuracy: 0.0549, Perplexity: 2196.4406
2025-01-01 00:23:19,972 - TrainingLogger - INFO - Step 43690, Batch metrics: Loss: 7.4544, Accuracy: 0.0749, Perplexity: 1727.5091
2025-01-01 00:23:26,793 - TrainingLogger - INFO - Step 43700, Batch metrics: Loss: 7.2531, Accuracy: 0.1207, Perplexity: 1412.4207
2025-01-01 00:23:26,793 - TrainingLogger - INFO - Step 43700, Prediction vs Actual:
2025-01-01 00:23:26,793 - TrainingLogger - INFO - Input 1: התחלתי לעבוד אחרי שסיימתי שירות לאומי, היא מספרת
2025-01-01 00:23:26,794 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:23:26,794 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁התחלתי      | ✗     |
|     1 | ▁זה             | ▁לעבוד       | ✗     |
|     2 | ▁זה             | ▁אחרי        | ✗     |
|     3 | ▁העבודה         | ▁שסיימתי     | ✗     |
|     4 | ▁זה             | ▁שירות       | ✗     |
|     5 | ▁צבאי           | ▁לאומי       | ✗     |
|     6 | .               | ,            | ✗     |
|     7 | <pad>           | ▁היא         | ✗     |
|     8 | ▁לא             | ▁מספרת       | ✗     |
|     9 | ▁לי             | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁על             | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁לא             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ▁לא             | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | ▁לא             | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2025-01-01 00:23:26,794 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:23:26,799 - TrainingLogger - INFO - Gradient norm: 8.0739
2025-01-01 00:23:33,669 - TrainingLogger - INFO - Step 43710, Batch metrics: Loss: 6.9819, Accuracy: 0.1065, Perplexity: 1076.9326
2025-01-01 00:23:40,600 - TrainingLogger - INFO - Step 43720, Batch metrics: Loss: 7.3396, Accuracy: 0.0955, Perplexity: 1540.1144
2025-01-01 00:23:47,854 - TrainingLogger - INFO - Step 43730, Batch metrics: Loss: 6.8393, Accuracy: 0.1314, Perplexity: 933.8193
2025-01-01 00:23:55,108 - TrainingLogger - INFO - Step 43740, Batch metrics: Loss: 7.3658, Accuracy: 0.0588, Perplexity: 1580.9758
2025-01-01 00:24:02,270 - TrainingLogger - INFO - Step 43750, Batch metrics: Loss: 7.3370, Accuracy: 0.1027, Perplexity: 1536.0455
2025-01-01 00:24:09,158 - TrainingLogger - INFO - Step 43760, Batch metrics: Loss: 7.6041, Accuracy: 0.0827, Perplexity: 2006.3981
2025-01-01 00:24:16,664 - TrainingLogger - INFO - Step 43770, Batch metrics: Loss: 7.5162, Accuracy: 0.0711, Perplexity: 1837.6222
2025-01-01 00:24:24,077 - TrainingLogger - INFO - Step 43780, Batch metrics: Loss: 7.5966, Accuracy: 0.0859, Perplexity: 1991.3804
2025-01-01 00:24:31,259 - TrainingLogger - INFO - Step 43790, Batch metrics: Loss: 7.5480, Accuracy: 0.0757, Perplexity: 1896.8688
2025-01-01 00:24:38,109 - TrainingLogger - INFO - Step 43800, Batch metrics: Loss: 7.3716, Accuracy: 0.0606, Perplexity: 1590.1459
2025-01-01 00:24:38,110 - TrainingLogger - INFO - Step 43800, Prediction vs Actual:
2025-01-01 00:24:38,110 - TrainingLogger - INFO - Input 1: המסדרונות, למשל, הם יצירות בפני עצמם - כל קומה הפכה בידיו של אמן אחר לתערוכה
2025-01-01 00:24:38,110 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:24:38,110 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ה           | ✗     |
|     1 | ▁-              | מסדרונות     | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | <pad>           | ▁למשל        | ✗     |
|     4 | ,               | ,            | ✓     |
|     5 | <pad>           | ▁הם          | ✗     |
|     6 | ▁לא             | ▁יצירות      | ✗     |
|     7 | ▁של             | ▁בפני        | ✗     |
|     8 | ▁כולם           | ▁עצמם        | ✗     |
|     9 | .               | ▁-           | ✗     |
|    10 | -               | ▁כל          | ✗     |
|    11 | ▁אחד            | ▁קומה        | ✗     |
|    12 | ,               | ▁הפכה        | ✗     |
|    13 | ▁ל              | ▁בידיו       | ✗     |
|    14 | ▁של             | ▁של          | ✓     |
|    15 | ▁ישראל          | ▁אמן         | ✗     |
|    16 | .               | ▁אחר         | ✗     |
|    17 | .               | ▁ל           | ✗     |
|    18 | אימפריה         | תער          | ✗     |
|    19 | וכה             | וכה          | ✓     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁לאומי          | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2025-01-01 00:24:38,110 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:24:38,115 - TrainingLogger - INFO - Gradient norm: 7.0556
2025-01-01 00:24:45,285 - TrainingLogger - INFO - Step 43810, Batch metrics: Loss: 7.5515, Accuracy: 0.0667, Perplexity: 1903.5331
2025-01-01 00:24:52,301 - TrainingLogger - INFO - Step 43820, Batch metrics: Loss: 7.3460, Accuracy: 0.0787, Perplexity: 1549.9505
2025-01-01 00:24:59,511 - TrainingLogger - INFO - Step 43830, Batch metrics: Loss: 7.4273, Accuracy: 0.1192, Perplexity: 1681.2299
2025-01-01 00:25:06,910 - TrainingLogger - INFO - Step 43840, Batch metrics: Loss: 7.2479, Accuracy: 0.1045, Perplexity: 1405.1576
2025-01-01 00:25:13,632 - TrainingLogger - INFO - Step 43850, Batch metrics: Loss: 7.1073, Accuracy: 0.0549, Perplexity: 1220.9048
2025-01-01 00:25:21,106 - TrainingLogger - INFO - Step 43860, Batch metrics: Loss: 7.4791, Accuracy: 0.1053, Perplexity: 1770.6688
2025-01-01 00:25:28,033 - TrainingLogger - INFO - Step 43870, Batch metrics: Loss: 7.1044, Accuracy: 0.0839, Perplexity: 1217.3680
2025-01-01 00:25:35,319 - TrainingLogger - INFO - Step 43880, Batch metrics: Loss: 7.0681, Accuracy: 0.1024, Perplexity: 1173.9194
2025-01-01 00:25:42,548 - TrainingLogger - INFO - Step 43890, Batch metrics: Loss: 6.9500, Accuracy: 0.1149, Perplexity: 1043.1460
2025-01-01 00:25:50,069 - TrainingLogger - INFO - Step 43900, Batch metrics: Loss: 7.0115, Accuracy: 0.0789, Perplexity: 1109.3483
2025-01-01 00:25:50,069 - TrainingLogger - INFO - Step 43900, Prediction vs Actual:
2025-01-01 00:25:50,069 - TrainingLogger - INFO - Input 1: אנחנו בסך הכול רוצים שתהיה לנו עבודה ולהיכנס לצאת מעבר כרם שלום ביטחון ולא כל יום או יומיים לקבל הודעה שסוגרים את המקום, פעם בגלל ירי או פעם בגלל מנהרה
2025-01-01 00:25:50,070 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:25:50,070 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁בסך         | ✗     |
|     2 | ▁-              | ▁הכול        | ✗     |
|     3 | ,               | ▁רוצים       | ✗     |
|     4 | ▁לדעת           | ▁שתהיה       | ✗     |
|     5 | ▁לנו            | ▁לנו         | ✓     |
|     6 | ▁הזדמנות        | ▁עבודה       | ✗     |
|     7 | ▁טובה           | ▁ו           | ✗     |
|     8 | עבודה           | להיכנס       | ✗     |
|     9 | ▁לשם            | ▁לצאת        | ✗     |
|    10 | ▁לדרך           | ▁מעבר        | ✗     |
|    11 | ▁לבית           | ▁כ           | ✗     |
|    12 | חוק             | רם           | ✗     |
|    13 | .               | ▁שלום        | ✗     |
|    14 | .               | ▁ביטחון      | ✗     |
|    15 | .               | ▁ולא         | ✗     |
|    16 | י               | ▁כל          | ✗     |
|    17 | ▁אחד            | ▁יום         | ✗     |
|    18 | ▁ראשון          | ▁או          | ✗     |
|    19 | ▁מוות           | ▁יומיים      | ✗     |
|    20 | .               | ▁לקבל        | ✗     |
|    21 | ה               | ▁הודעה       | ✗     |
|    22 | .               | ▁שסו         | ✗     |
|    23 | עה              | גרים         | ✗     |
|    24 | ▁אותו           | ▁את          | ✗     |
|    25 | ▁זה             | ▁המקום       | ✗     |
|    26 | ▁הזה            | ,            | ✗     |
|    27 | <pad>           | ▁פעם         | ✗     |
|    28 | ▁אחת            | ▁בגלל        | ✗     |
|    29 | ▁זה             | ▁ירי         | ✗     |
|    30 | יות             | ▁או          | ✗     |
|    31 | ▁יותר           | ▁פעם         | ✗     |
|    32 | ▁אחרת           | ▁בגלל        | ✗     |
|    33 | ▁זה             | ▁מנהרה       | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ▁לא             | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2025-01-01 00:25:50,070 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:25:50,075 - TrainingLogger - INFO - Gradient norm: 7.1839
2025-01-01 00:25:57,824 - TrainingLogger - INFO - Step 43910, Batch metrics: Loss: 7.0991, Accuracy: 0.1228, Perplexity: 1210.8255
2025-01-01 00:26:05,206 - TrainingLogger - INFO - Step 43920, Batch metrics: Loss: 7.0725, Accuracy: 0.0893, Perplexity: 1179.1188
2025-01-01 00:26:12,672 - TrainingLogger - INFO - Step 43930, Batch metrics: Loss: 7.2532, Accuracy: 0.0994, Perplexity: 1412.5837
2025-01-01 00:26:19,924 - TrainingLogger - INFO - Step 43940, Batch metrics: Loss: 7.4671, Accuracy: 0.0559, Perplexity: 1749.4676
2025-01-01 00:26:27,133 - TrainingLogger - INFO - Step 43950, Batch metrics: Loss: 7.3814, Accuracy: 0.0407, Perplexity: 1605.8457
2025-01-01 00:26:34,709 - TrainingLogger - INFO - Step 43960, Batch metrics: Loss: 7.3068, Accuracy: 0.0552, Perplexity: 1490.4307
2025-01-01 00:26:42,445 - TrainingLogger - INFO - Step 43970, Batch metrics: Loss: 7.5390, Accuracy: 0.0634, Perplexity: 1880.0003
2025-01-01 00:26:49,374 - TrainingLogger - INFO - Step 43980, Batch metrics: Loss: 6.9432, Accuracy: 0.0722, Perplexity: 1036.0894
2025-01-01 00:26:56,549 - TrainingLogger - INFO - Step 43990, Batch metrics: Loss: 7.2208, Accuracy: 0.1053, Perplexity: 1367.5787
2025-01-01 00:27:03,934 - TrainingLogger - INFO - Step 44000, Batch metrics: Loss: 7.0710, Accuracy: 0.0806, Perplexity: 1177.2676
2025-01-01 00:27:03,934 - TrainingLogger - INFO - Step 44000, Prediction vs Actual:
2025-01-01 00:27:03,934 - TrainingLogger - INFO - Input 1: צילום מסך של אפליקצית אלקטור בתגובה על הפרסומים על פרצת האבטחה החמורה אמרו בליכוד כי האבטחה על פעילות האתרים תוגברה
2025-01-01 00:27:03,935 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:27:03,935 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁צילום       | ✗     |
|     1 | ▁-              | ▁מסך         | ✗     |
|     2 | ▁זה             | ▁של          | ✗     |
|     3 | ▁המדינה         | ▁אפל         | ✗     |
|     4 | ה               | יק           | ✗     |
|     5 | ת               | צית          | ✗     |
|     6 | .               | ▁אל          | ✗     |
|     7 | יפות            | קטור         | ✗     |
|     8 | ה               | ▁בתגובה      | ✗     |
|     9 | ▁ל              | ▁על          | ✗     |
|    10 | ה               | ▁ה           | ✗     |
|    11 | פס              | פרסומים      | ✗     |
|    12 | ▁שלהם           | ▁על          | ✗     |
|    13 | ▁בסיס           | ▁פרצת        | ✗     |
|    14 | ם               | ▁האבטחה      | ✗     |
|    15 | .               | ▁החמור       | ✗     |
|    16 | ת               | ה            | ✗     |
|    17 | ▁ביותר          | ▁אמרו        | ✗     |
|    18 | ▁לי             | ▁בלי         | ✗     |
|    19 | בו              | כו           | ✗     |
|    20 | ד               | ד            | ✓     |
|    21 | .               | ▁כי          | ✗     |
|    22 | ▁הוא            | ▁האבטחה      | ✗     |
|    23 | ▁הייתה          | ▁על          | ✗     |
|    24 | ה               | ▁פעילות      | ✗     |
|    25 | ו               | ▁האתר        | ✗     |
|    26 | ,               | ים           | ✗     |
|    27 | ▁שלהם           | ▁תו          | ✗     |
|    28 | פח              | גבר          | ✗     |
|    29 | ה               | ה            | ✓     |
|    30 | .               |              | ✗     |

2025-01-01 00:27:03,935 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:27:03,940 - TrainingLogger - INFO - Gradient norm: 6.8177
2025-01-01 00:27:10,905 - TrainingLogger - INFO - Step 44010, Batch metrics: Loss: 7.3623, Accuracy: 0.0796, Perplexity: 1575.5264
2025-01-01 00:27:18,560 - TrainingLogger - INFO - Step 44020, Batch metrics: Loss: 7.2124, Accuracy: 0.0636, Perplexity: 1356.1010
2025-01-01 00:27:25,831 - TrainingLogger - INFO - Step 44030, Batch metrics: Loss: 7.4515, Accuracy: 0.0570, Perplexity: 1722.4456
2025-01-01 00:27:33,244 - TrainingLogger - INFO - Step 44040, Batch metrics: Loss: 7.1854, Accuracy: 0.0833, Perplexity: 1320.0209
2025-01-01 00:27:40,432 - TrainingLogger - INFO - Step 44050, Batch metrics: Loss: 7.5555, Accuracy: 0.0760, Perplexity: 1911.1355
2025-01-01 00:27:47,646 - TrainingLogger - INFO - Step 44060, Batch metrics: Loss: 7.2410, Accuracy: 0.0800, Perplexity: 1395.4265
2025-01-01 00:27:54,589 - TrainingLogger - INFO - Step 44070, Batch metrics: Loss: 6.8372, Accuracy: 0.1458, Perplexity: 931.8675
2025-01-01 00:28:01,768 - TrainingLogger - INFO - Step 44080, Batch metrics: Loss: 7.6053, Accuracy: 0.0309, Perplexity: 2008.8191
2025-01-01 00:28:09,184 - TrainingLogger - INFO - Step 44090, Batch metrics: Loss: 7.4981, Accuracy: 0.0802, Perplexity: 1804.6677
2025-01-01 00:28:16,032 - TrainingLogger - INFO - Step 44100, Batch metrics: Loss: 6.9658, Accuracy: 0.1091, Perplexity: 1059.7965
2025-01-01 00:28:16,032 - TrainingLogger - INFO - Step 44100, Prediction vs Actual:
2025-01-01 00:28:16,033 - TrainingLogger - INFO - Input 1: אנחנו גם לא רואים שיש תוכניות למשהו אחר במידה וזה ייכשל
2025-01-01 00:28:16,033 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:28:16,033 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁גם          | ✗     |
|     2 | ▁-              | ▁לא          | ✗     |
|     3 | ,               | ▁רואים       | ✗     |
|     4 | ▁את             | ▁שיש         | ✗     |
|     5 | ▁לי             | ▁תוכניות     | ✗     |
|     6 | ▁אחרות          | ▁למשהו       | ✗     |
|     7 | ▁חדש            | ▁אחר         | ✗     |
|     8 | .               | ▁במידה       | ✗     |
|     9 | ▁הנכונה         | ▁וזה         | ✗     |
|    10 | ▁נכון           | ▁ייכשל       | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2025-01-01 00:28:16,033 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:28:16,038 - TrainingLogger - INFO - Gradient norm: 5.5931
2025-01-01 00:28:23,288 - TrainingLogger - INFO - Step 44110, Batch metrics: Loss: 6.9847, Accuracy: 0.0812, Perplexity: 1080.0119
2025-01-01 00:28:30,159 - TrainingLogger - INFO - Step 44120, Batch metrics: Loss: 7.2916, Accuracy: 0.0670, Perplexity: 1467.9325
2025-01-01 00:28:36,456 - TrainingLogger - INFO - Step 44130, Batch metrics: Loss: 7.1875, Accuracy: 0.0903, Perplexity: 1322.8110
2025-01-01 00:28:43,913 - TrainingLogger - INFO - Step 44140, Batch metrics: Loss: 7.6337, Accuracy: 0.0897, Perplexity: 2066.7583
2025-01-01 00:28:50,829 - TrainingLogger - INFO - Step 44150, Batch metrics: Loss: 7.2914, Accuracy: 0.0741, Perplexity: 1467.5819
2025-01-01 00:28:58,155 - TrainingLogger - INFO - Step 44160, Batch metrics: Loss: 7.4199, Accuracy: 0.0439, Perplexity: 1668.9071
2025-01-01 00:29:05,596 - TrainingLogger - INFO - Step 44170, Batch metrics: Loss: 7.5155, Accuracy: 0.0570, Perplexity: 1836.3162
2025-01-01 00:29:12,662 - TrainingLogger - INFO - Step 44180, Batch metrics: Loss: 7.1781, Accuracy: 0.0629, Perplexity: 1310.4106
2025-01-01 00:29:19,866 - TrainingLogger - INFO - Step 44190, Batch metrics: Loss: 7.1257, Accuracy: 0.1163, Perplexity: 1243.5497
2025-01-01 00:29:26,561 - TrainingLogger - INFO - Step 44200, Batch metrics: Loss: 7.8264, Accuracy: 0.0694, Perplexity: 2505.8962
2025-01-01 00:29:26,562 - TrainingLogger - INFO - Step 44200, Prediction vs Actual:
2025-01-01 00:29:26,562 - TrainingLogger - INFO - Input 1: כשהלחץ גובר והולך , כשהאפשרויות מצומצמות והדרכים חסומות, ייתכן שהדרמות הגדולות עוד לפנינו
2025-01-01 00:29:26,562 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:29:26,562 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁כשה         | ✗     |
|     1 | ,               | לחץ          | ✗     |
|     2 | ▁ירד            | ▁גובר        | ✗     |
|     3 | ▁טוב            | ▁והולך       | ✗     |
|     4 | .               | ▁,           | ✗     |
|     5 | <pad>           | ▁כשה         | ✗     |
|     6 | דם              | אפשרויות     | ✗     |
|     7 | ▁מוכנות         | ▁מצו         | ✗     |
|     8 | פות             | מצ           | ✗     |
|     9 | מות             | מות          | ✓     |
|    10 | ▁.              | ▁וה          | ✗     |
|    11 | חשמל            | דרכים        | ✗     |
|    12 | ▁הטובות         | ▁חס          | ✗     |
|    13 | ומות            | ומות         | ✓     |
|    14 | ▁.              | ,            | ✗     |
|    15 | </s>            | ▁ייתכן       | ✗     |
|    16 | ▁שהן            | ▁שה          | ✗     |
|    17 | זמן             | דר           | ✗     |
|    18 | נים             | מות          | ✗     |
|    19 | ▁שלנו           | ▁הגדולות     | ✗     |
|    20 | ▁ביותר          | ▁עוד         | ✗     |
|    21 | ▁יותר           | ▁לפנינו      | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ות              | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ות              | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ה               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ▁י              | <pad>        | ✗     |
|    38 | ן               | <pad>        | ✗     |
|    39 | ן               | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2025-01-01 00:29:26,562 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:29:26,567 - TrainingLogger - INFO - Gradient norm: 7.0585
2025-01-01 00:29:33,487 - TrainingLogger - INFO - Step 44210, Batch metrics: Loss: 7.5054, Accuracy: 0.0565, Perplexity: 1817.7788
2025-01-01 00:29:40,944 - TrainingLogger - INFO - Step 44220, Batch metrics: Loss: 7.6442, Accuracy: 0.0437, Perplexity: 2088.5147
2025-01-01 00:29:48,287 - TrainingLogger - INFO - Step 44230, Batch metrics: Loss: 7.3275, Accuracy: 0.0900, Perplexity: 1521.6476
2025-01-01 00:29:55,690 - TrainingLogger - INFO - Step 44240, Batch metrics: Loss: 7.2081, Accuracy: 0.0909, Perplexity: 1350.3356
2025-01-01 00:30:02,771 - TrainingLogger - INFO - Step 44250, Batch metrics: Loss: 7.2886, Accuracy: 0.0829, Perplexity: 1463.5705
2025-01-01 00:30:09,777 - TrainingLogger - INFO - Step 44260, Batch metrics: Loss: 7.5412, Accuracy: 0.0867, Perplexity: 1884.1069
2025-01-01 00:30:17,128 - TrainingLogger - INFO - Step 44270, Batch metrics: Loss: 6.9063, Accuracy: 0.0732, Perplexity: 998.4978
2025-01-01 00:30:24,812 - TrainingLogger - INFO - Step 44280, Batch metrics: Loss: 7.1604, Accuracy: 0.0629, Perplexity: 1287.4030
2025-01-01 00:30:31,597 - TrainingLogger - INFO - Step 44290, Batch metrics: Loss: 8.0284, Accuracy: 0.0067, Perplexity: 3066.8292
2025-01-01 00:30:38,499 - TrainingLogger - INFO - Step 44300, Batch metrics: Loss: 7.2876, Accuracy: 0.0926, Perplexity: 1462.0806
2025-01-01 00:30:38,500 - TrainingLogger - INFO - Step 44300, Prediction vs Actual:
2025-01-01 00:30:38,500 - TrainingLogger - INFO - Input 1: ב2 בינואר השנה, הוא חוסל בלב רובע הדאחייה בביירות, במתקפה שמיוחסת לישראל
2025-01-01 00:30:38,500 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:30:38,500 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ב           | ✗     |
|     1 | ▁-              | 2            | ✗     |
|     2 | ▁-              | ▁בינואר      | ✗     |
|     3 | ,               | ▁השנה        | ✗     |
|     4 | ▁האחרונה        | ,            | ✗     |
|     5 | <pad>           | ▁הוא         | ✗     |
|     6 | ▁אמר            | ▁חוסל        | ✗     |
|     7 | .               | ▁בלב         | ✗     |
|     8 | ▁שלם            | ▁            | ✗     |
|     9 | ים              | רובע         | ✗     |
|    10 | ▁ישראל          | ▁ה           | ✗     |
|    11 | רפובליק         | דא           | ✗     |
|    12 | טוס             | חייה         | ✗     |
|    13 | .               | ▁בבי         | ✗     |
|    14 | "               | ירות         | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | </s>            | ▁במתקפה      | ✗     |
|    17 | ,               | ▁שמ          | ✗     |
|    18 | דרום            | יוח          | ✗     |
|    19 | סת              | סת           | ✓     |
|    20 | ▁לו             | ▁לישראל      | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            |              | ✗     |

2025-01-01 00:30:38,500 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:30:38,505 - TrainingLogger - INFO - Gradient norm: 9.2735
2025-01-01 00:30:46,040 - TrainingLogger - INFO - Step 44310, Batch metrics: Loss: 7.1151, Accuracy: 0.0621, Perplexity: 1230.4247
2025-01-01 00:30:52,836 - TrainingLogger - INFO - Step 44320, Batch metrics: Loss: 7.1626, Accuracy: 0.0604, Perplexity: 1290.2644
2025-01-01 00:30:59,655 - TrainingLogger - INFO - Step 44330, Batch metrics: Loss: 7.2231, Accuracy: 0.0902, Perplexity: 1370.7595
2025-01-01 00:31:07,270 - TrainingLogger - INFO - Step 44340, Batch metrics: Loss: 7.5743, Accuracy: 0.0755, Perplexity: 1947.5668
2025-01-01 00:31:14,373 - TrainingLogger - INFO - Step 44350, Batch metrics: Loss: 7.6342, Accuracy: 0.0641, Perplexity: 2067.6385
2025-01-01 00:31:21,638 - TrainingLogger - INFO - Step 44360, Batch metrics: Loss: 7.3782, Accuracy: 0.1222, Perplexity: 1600.6793
2025-01-01 00:31:29,166 - TrainingLogger - INFO - Step 44370, Batch metrics: Loss: 7.2807, Accuracy: 0.0693, Perplexity: 1451.9898
2025-01-01 00:31:36,410 - TrainingLogger - INFO - Step 44380, Batch metrics: Loss: 6.9341, Accuracy: 0.1049, Perplexity: 1026.7297
2025-01-01 00:31:43,000 - TrainingLogger - INFO - Step 44390, Batch metrics: Loss: 7.5908, Accuracy: 0.0786, Perplexity: 1979.8917
2025-01-01 00:31:49,922 - TrainingLogger - INFO - Step 44400, Batch metrics: Loss: 7.1591, Accuracy: 0.0781, Perplexity: 1285.6944
2025-01-01 00:31:49,922 - TrainingLogger - INFO - Step 44400, Prediction vs Actual:
2025-01-01 00:31:49,922 - TrainingLogger - INFO - Input 1: ממייסדי החברה כדי לאשש את המחשבות שלנו, התחלנו להיפגש עם מנהלי שיווק של אפליקציות שונות בכדי להבין מה המטרות ומה הקשיים איתם הם מתמודדים בבורסות הדיגיטליות
2025-01-01 00:31:49,923 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:31:49,923 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁מ           | ✗     |
|     1 | ▁-              | מייסד        | ✗     |
|     2 | ▁-              | י            | ✗     |
|     3 | ▁המדינה         | ▁החברה       | ✗     |
|     4 | ▁שלי            | ▁כדי         | ✗     |
|     5 | ▁לקבל           | ▁לא          | ✗     |
|     6 | יים             | שש           | ✗     |
|     7 | ▁את             | ▁את          | ✓     |
|     8 | ▁כולם           | ▁המחשבות     | ✗     |
|     9 | ▁שלהם           | ▁שלנו        | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | </s>            | ▁התחלנו      | ✗     |
|    12 | ▁עם             | ▁להיפגש      | ✗     |
|    13 | ▁עם             | ▁עם          | ✓     |
|    14 | ▁אנשים          | ▁מנהל        | ✗     |
|    15 | י               | י            | ✓     |
|    16 | ▁ה              | ▁            | ✗     |
|    17 | פרלמנט          | שיווק        | ✗     |
|    18 | ,               | ▁של          | ✗     |
|    19 | ▁ארצות          | ▁אפל         | ✗     |
|    20 | יה              | יק           | ✗     |
|    21 | ת               | ציות         | ✗     |
|    22 | ,               | ▁שונות       | ✗     |
|    23 | ,               | ▁בכדי        | ✗     |
|    24 | ▁להגן           | ▁להבין       | ✗     |
|    25 | ▁את             | ▁מה          | ✗     |
|    26 | י               | ▁המטרות      | ✗     |
|    27 | ▁שלהם           | ▁ומה         | ✗     |
|    28 | ▁לא             | ▁הקשיים      | ✗     |
|    29 | ▁שלהם           | ▁איתם        | ✗     |
|    30 | .               | ▁הם          | ✗     |
|    31 | ▁באמת           | ▁מתמודדים    | ✗     |
|    32 | ▁עם             | ▁בבור        | ✗     |
|    33 | סה              | סות          | ✗     |
|    34 | ▁שונות          | ▁הדיג        | ✗     |
|    35 | י               | יט           | ✗     |
|    36 | ליות            | ליות         | ✓     |
|    37 | ▁שלנו           | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | <pad>           | <pad>        | ✓     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | </s>            | <pad>        | ✗     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | </s>            | <pad>        | ✗     |
|    52 | </s>            | <pad>        | ✗     |
|    53 | </s>            | <pad>        | ✗     |
|    54 | </s>            | <pad>        | ✗     |
|    55 | </s>            | <pad>        | ✗     |
|    56 | </s>            | <pad>        | ✗     |
|    57 | </s>            | <pad>        | ✗     |
|    58 | </s>            | <pad>        | ✗     |
|    59 | </s>            |              | ✗     |

2025-01-01 00:31:49,923 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:31:49,928 - TrainingLogger - INFO - Gradient norm: 8.0045
2025-01-01 00:31:56,856 - TrainingLogger - INFO - Step 44410, Batch metrics: Loss: 6.8666, Accuracy: 0.1032, Perplexity: 959.7135
2025-01-01 00:32:03,384 - TrainingLogger - INFO - Step 44420, Batch metrics: Loss: 6.9570, Accuracy: 0.1208, Perplexity: 1050.4757
2025-01-01 00:32:10,381 - TrainingLogger - INFO - Step 44430, Batch metrics: Loss: 7.4194, Accuracy: 0.0734, Perplexity: 1668.0924
2025-01-01 00:32:18,246 - TrainingLogger - INFO - Step 44440, Batch metrics: Loss: 7.8544, Accuracy: 0.0884, Perplexity: 2577.0992
2025-01-01 00:32:25,608 - TrainingLogger - INFO - Step 44450, Batch metrics: Loss: 7.7724, Accuracy: 0.0594, Perplexity: 2374.0875
2025-01-01 00:32:32,772 - TrainingLogger - INFO - Step 44460, Batch metrics: Loss: 7.7346, Accuracy: 0.0461, Perplexity: 2286.1411
2025-01-01 00:32:39,742 - TrainingLogger - INFO - Step 44470, Batch metrics: Loss: 7.1322, Accuracy: 0.1074, Perplexity: 1251.6899
2025-01-01 00:32:46,810 - TrainingLogger - INFO - Step 44480, Batch metrics: Loss: 6.8908, Accuracy: 0.0936, Perplexity: 983.1586
2025-01-01 00:32:53,744 - TrainingLogger - INFO - Step 44490, Batch metrics: Loss: 7.1734, Accuracy: 0.0945, Perplexity: 1304.3324
2025-01-01 00:33:00,921 - TrainingLogger - INFO - Step 44500, Batch metrics: Loss: 7.3759, Accuracy: 0.0645, Perplexity: 1596.9863
2025-01-01 00:33:00,922 - TrainingLogger - INFO - Step 44500, Prediction vs Actual:
2025-01-01 00:33:00,922 - TrainingLogger - INFO - Input 1: על פי החשד, עומראן יצר קשר עם הקטינים וביקש מהם סרטוני עירום של עצמם, וכן שלח להם סרטונים פורנוגרפיים בוטים שלו עצמו
2025-01-01 00:33:00,922 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:33:00,922 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁על          | ✗     |
|     1 | ▁-              | ▁פי          | ✗     |
|     2 | ▁-              | ▁ה           | ✗     |
|     3 | ▁-              | חשד          | ✗     |
|     4 | ▁הוא            | ,            | ✗     |
|     5 | ▁אני            | ▁עומר        | ✗     |
|     6 | ,               | אן           | ✗     |
|     7 | ,               | ▁יצר         | ✗     |
|     8 | ן               | ▁קשר         | ✗     |
|     9 | ▁עם             | ▁עם          | ✓     |
|    10 | ▁החברה          | ▁הקט         | ✗     |
|    11 | ר               | ינים         | ✗     |
|    12 | ▁האלה           | ▁וביקש       | ✗     |
|    13 | ו               | ▁מהם         | ✗     |
|    14 | ▁לעשות          | ▁סרט         | ✗     |
|    15 | ו               | וני          | ✗     |
|    16 | ו               | ▁עירום       | ✗     |
|    17 | .               | ▁של          | ✗     |
|    18 | <pad>           | ▁עצמם        | ✗     |
|    19 | .               | ,            | ✗     |
|    20 | <pad>           | ▁וכן         | ✗     |
|    21 | ▁הלאה           | ▁שלח         | ✗     |
|    22 | ▁אותם           | ▁להם         | ✗     |
|    23 | ▁כסף            | ▁סרט         | ✗     |
|    24 | ון              | ונים         | ✗     |
|    25 | ▁חדשים          | ▁פורנוגרפי   | ✗     |
|    26 | ים              | ים           | ✓     |
|    27 | .               | ▁ב           | ✗     |
|    28 | -               | וטים         | ✗     |
|    29 | ▁חדשים          | ▁שלו         | ✗     |
|    30 | .               | ▁עצמו        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ים              | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | .               | <pad>        | ✗     |
|    38 | ים              |              | ✗     |

2025-01-01 00:33:00,922 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:33:00,927 - TrainingLogger - INFO - Gradient norm: 8.1923
2025-01-01 00:33:08,327 - TrainingLogger - INFO - Step 44510, Batch metrics: Loss: 7.4523, Accuracy: 0.0904, Perplexity: 1723.8654
2025-01-01 00:33:15,604 - TrainingLogger - INFO - Step 44520, Batch metrics: Loss: 6.9851, Accuracy: 0.1295, Perplexity: 1080.4086
2025-01-01 00:33:22,426 - TrainingLogger - INFO - Step 44530, Batch metrics: Loss: 7.2317, Accuracy: 0.0773, Perplexity: 1382.5833
2025-01-01 00:33:29,777 - TrainingLogger - INFO - Step 44540, Batch metrics: Loss: 7.4616, Accuracy: 0.0896, Perplexity: 1739.9236
2025-01-01 00:33:36,930 - TrainingLogger - INFO - Step 44550, Batch metrics: Loss: 7.3000, Accuracy: 0.0622, Perplexity: 1480.2833
2025-01-01 00:33:44,306 - TrainingLogger - INFO - Step 44560, Batch metrics: Loss: 7.0697, Accuracy: 0.1013, Perplexity: 1175.7585
2025-01-01 00:33:51,606 - TrainingLogger - INFO - Step 44570, Batch metrics: Loss: 7.5680, Accuracy: 0.0561, Perplexity: 1935.2739
2025-01-01 00:33:58,965 - TrainingLogger - INFO - Step 44580, Batch metrics: Loss: 7.5712, Accuracy: 0.0692, Perplexity: 1941.4823
2025-01-01 00:34:05,821 - TrainingLogger - INFO - Step 44590, Batch metrics: Loss: 7.1158, Accuracy: 0.0824, Perplexity: 1231.2094
2025-01-01 00:34:12,906 - TrainingLogger - INFO - Step 44600, Batch metrics: Loss: 7.2156, Accuracy: 0.0722, Perplexity: 1360.4547
2025-01-01 00:34:12,907 - TrainingLogger - INFO - Step 44600, Prediction vs Actual:
2025-01-01 00:34:12,907 - TrainingLogger - INFO - Input 1: ורד גלילי, נערה בת 17, השאירה בבית הוריה בתל-אביב פתק שהיא נוסעת לחברה המשרת בשומרון
2025-01-01 00:34:12,907 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:34:12,907 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁ישראל          | ▁ורד         | ✗     |
|     1 | ▁הוא            | ▁ג           | ✗     |
|     2 | ▁הוא            | לילי         | ✗     |
|     3 | ▁ג              | ,            | ✗     |
|     4 | ▁כמו            | ▁נערה        | ✗     |
|     5 | ,               | ▁בת          | ✗     |
|     6 | חו              | ▁17,         | ✗     |
|     7 | ▁היא            | ▁השאירה      | ✗     |
|     8 | ▁את             | ▁בבית        | ✗     |
|     9 | ▁את             | ▁הוריה       | ✗     |
|    10 | ▁את             | ▁בת          | ✗     |
|    11 | ▁שמונה          | ל            | ✗     |
|    12 | ▁אביב           | -            | ✗     |
|    13 | ות              | אביב         | ✗     |
|    14 | י               | ▁פתק         | ✗     |
|    15 | ים              | ▁שהיא        | ✗     |
|    16 | ▁לא             | ▁נוסעת       | ✗     |
|    17 | ▁בה             | ▁לחברה       | ✗     |
|    18 | ▁חדשה           | ▁המשרת       | ✗     |
|    19 | ות              | ▁ב           | ✗     |
|    20 | פרלמנט          | שומר         | ✗     |
|    21 | ▁המדינה         | ון           | ✗     |
|    22 | ▁שלה            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁שלה            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ▁(              | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2025-01-01 00:34:12,907 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:34:12,912 - TrainingLogger - INFO - Gradient norm: 8.2491
2025-01-01 00:34:19,734 - TrainingLogger - INFO - Step 44610, Batch metrics: Loss: 7.8176, Accuracy: 0.0898, Perplexity: 2483.8533
2025-01-01 00:34:27,389 - TrainingLogger - INFO - Step 44620, Batch metrics: Loss: 7.3487, Accuracy: 0.0753, Perplexity: 1554.1037
2025-01-01 00:34:34,451 - TrainingLogger - INFO - Step 44630, Batch metrics: Loss: 7.5037, Accuracy: 0.0703, Perplexity: 1814.6896
2025-01-01 00:34:41,719 - TrainingLogger - INFO - Step 44640, Batch metrics: Loss: 7.3007, Accuracy: 0.0701, Perplexity: 1481.3488
2025-01-01 00:34:49,348 - TrainingLogger - INFO - Step 44650, Batch metrics: Loss: 7.3419, Accuracy: 0.0732, Perplexity: 1543.6369
2025-01-01 00:34:56,359 - TrainingLogger - INFO - Step 44660, Batch metrics: Loss: 7.2288, Accuracy: 0.0828, Perplexity: 1378.6334
2025-01-01 00:35:03,212 - TrainingLogger - INFO - Step 44670, Batch metrics: Loss: 7.5322, Accuracy: 0.0719, Perplexity: 1867.1382
2025-01-01 00:35:10,579 - TrainingLogger - INFO - Step 44680, Batch metrics: Loss: 7.3408, Accuracy: 0.0656, Perplexity: 1542.0133
2025-01-01 00:35:17,845 - TrainingLogger - INFO - Step 44690, Batch metrics: Loss: 6.9323, Accuracy: 0.1100, Perplexity: 1024.8202
2025-01-01 00:35:25,000 - TrainingLogger - INFO - Step 44700, Batch metrics: Loss: 7.7034, Accuracy: 0.0851, Perplexity: 2215.9128
2025-01-01 00:35:25,001 - TrainingLogger - INFO - Step 44700, Prediction vs Actual:
2025-01-01 00:35:25,001 - TrainingLogger - INFO - Input 1: התמונת פרופיל שלי של השחקן טום קרוז היא בדיחה פנימיתאולם בניגוד לטענות שהושמעו לאורך היום, בכתבה לא נאמר כלל שבעלי החשבונות הללו הם בוטים
2025-01-01 00:35:25,001 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:35:25,001 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ה           | ✗     |
|     1 | ▁הוא            | תמונת        | ✗     |
|     2 | ▁-              | ▁פרופיל      | ✗     |
|     3 | ▁הוא            | ▁שלי         | ✗     |
|     4 | .               | ▁של          | ✗     |
|     5 | ▁המדינה         | ▁השחקן       | ✗     |
|     6 | ▁הראשון         | ▁טום         | ✗     |
|     7 | ▁ג              | ▁קרוז        | ✗     |
|     8 | .               | ▁היא         | ✗     |
|     9 | ▁לא             | ▁בדיחה       | ✗     |
|    10 | ▁נהדרת          | ▁פנימית      | ✗     |
|    11 | .               | אולם         | ✗     |
|    12 | ה               | ▁בניגוד      | ✗     |
|    13 | ▁ל              | ▁לט          | ✗     |
|    14 | רי              | ענות         | ✗     |
|    15 | יו              | ▁שהו         | ✗     |
|    16 | קם              | שמע          | ✗     |
|    17 | ה               | ו            | ✗     |
|    18 | ▁ב              | ▁לאורך       | ✗     |
|    19 | ▁השנים          | ▁היום        | ✗     |
|    20 | .               | ,            | ✗     |
|    21 | <pad>           | ▁בכתב        | ✗     |
|    22 | ה               | ה            | ✓     |
|    23 | ▁זו             | ▁לא          | ✗     |
|    24 | ▁רלוונטי        | ▁נאמר        | ✗     |
|    25 | ה               | ▁כלל         | ✗     |
|    26 | ▁וכלל           | ▁שבעלי       | ✗     |
|    27 | ו               | ▁החשבונות    | ✗     |
|    28 | ▁שלו            | ▁הללו        | ✗     |
|    29 | ▁היו            | ▁הם          | ✗     |
|    30 | ▁אלה            | ▁ב           | ✗     |
|    31 | ים              | וטים         | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               |              | ✗     |

2025-01-01 00:35:25,001 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:35:25,006 - TrainingLogger - INFO - Gradient norm: 7.0558
2025-01-01 00:35:31,906 - TrainingLogger - INFO - Step 44710, Batch metrics: Loss: 7.8645, Accuracy: 0.0408, Perplexity: 2603.1254
2025-01-01 00:35:39,159 - TrainingLogger - INFO - Step 44720, Batch metrics: Loss: 7.9518, Accuracy: 0.0452, Perplexity: 2840.6751
2025-01-01 00:35:46,320 - TrainingLogger - INFO - Step 44730, Batch metrics: Loss: 7.2317, Accuracy: 0.0676, Perplexity: 1382.6354
2025-01-01 00:35:53,722 - TrainingLogger - INFO - Step 44740, Batch metrics: Loss: 7.8726, Accuracy: 0.0483, Perplexity: 2624.3290
2025-01-01 00:36:00,732 - TrainingLogger - INFO - Step 44750, Batch metrics: Loss: 7.5157, Accuracy: 0.0711, Perplexity: 1836.6165
2025-01-01 00:36:07,963 - TrainingLogger - INFO - Step 44760, Batch metrics: Loss: 7.2501, Accuracy: 0.0921, Perplexity: 1408.1861
2025-01-01 00:36:14,848 - TrainingLogger - INFO - Step 44770, Batch metrics: Loss: 7.3411, Accuracy: 0.1146, Perplexity: 1542.3912
2025-01-01 00:36:21,917 - TrainingLogger - INFO - Step 44780, Batch metrics: Loss: 7.8251, Accuracy: 0.0562, Perplexity: 2502.7150
2025-01-01 00:36:29,413 - TrainingLogger - INFO - Step 44790, Batch metrics: Loss: 7.8973, Accuracy: 0.0793, Perplexity: 2689.9781
2025-01-01 00:36:36,764 - TrainingLogger - INFO - Step 44800, Batch metrics: Loss: 7.4719, Accuracy: 0.0729, Perplexity: 1757.9486
2025-01-01 00:36:36,764 - TrainingLogger - INFO - Step 44800, Prediction vs Actual:
2025-01-01 00:36:36,764 - TrainingLogger - INFO - Input 1: אני אמרתי את זה גם לעולם כשהייתי שר החוץ שחררו את עזה מחמאס
2025-01-01 00:36:36,765 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:36:36,765 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אני         | ✗     |
|     1 | ▁בעצמי          | ▁אמרתי       | ✗     |
|     2 | ▁לך             | ▁את          | ✗     |
|     3 | ▁זה             | ▁זה          | ✓     |
|     4 | .               | ▁גם          | ✗     |
|     5 | ▁ככה            | ▁לעולם       | ✗     |
|     6 | ▁לא             | ▁כשהייתי     | ✗     |
|     7 | ▁בן             | ▁שר          | ✗     |
|     8 | .               | ▁החוץ        | ✗     |
|     9 | ▁שלי            | ▁שחררו       | ✗     |
|    10 | ▁אותי           | ▁את          | ✗     |
|    11 | ▁זה             | ▁עזה         | ✗     |
|    12 | </s>            | ▁מח          | ✗     |
|    13 | ת               | מ            | ✗     |
|    14 | אס              | אס           | ✓     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2025-01-01 00:36:36,765 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:36:36,770 - TrainingLogger - INFO - Gradient norm: 8.9673
2025-01-01 00:36:43,605 - TrainingLogger - INFO - Step 44810, Batch metrics: Loss: 7.3899, Accuracy: 0.0606, Perplexity: 1619.5476
2025-01-01 00:36:50,939 - TrainingLogger - INFO - Step 44820, Batch metrics: Loss: 6.6324, Accuracy: 0.0966, Perplexity: 759.3237
2025-01-01 00:36:58,393 - TrainingLogger - INFO - Step 44830, Batch metrics: Loss: 7.2693, Accuracy: 0.0828, Perplexity: 1435.5048
2025-01-01 00:37:05,329 - TrainingLogger - INFO - Step 44840, Batch metrics: Loss: 7.3837, Accuracy: 0.0940, Perplexity: 1609.5492
2025-01-01 00:37:12,382 - TrainingLogger - INFO - Step 44850, Batch metrics: Loss: 7.5044, Accuracy: 0.0886, Perplexity: 1816.0219
2025-01-01 00:37:19,479 - TrainingLogger - INFO - Step 44860, Batch metrics: Loss: 7.5940, Accuracy: 0.0574, Perplexity: 1986.3067
2025-01-01 00:37:26,639 - TrainingLogger - INFO - Step 44870, Batch metrics: Loss: 7.4427, Accuracy: 0.0719, Perplexity: 1707.3268
2025-01-01 00:37:34,286 - TrainingLogger - INFO - Step 44880, Batch metrics: Loss: 7.2054, Accuracy: 0.0814, Perplexity: 1346.6974
2025-01-01 00:37:41,439 - TrainingLogger - INFO - Step 44890, Batch metrics: Loss: 7.6381, Accuracy: 0.0743, Perplexity: 2075.7449
2025-01-01 00:37:48,518 - TrainingLogger - INFO - Step 44900, Batch metrics: Loss: 7.0335, Accuracy: 0.0936, Perplexity: 1133.9885
2025-01-01 00:37:48,518 - TrainingLogger - INFO - Step 44900, Prediction vs Actual:
2025-01-01 00:37:48,518 - TrainingLogger - INFO - Input 1: בחודש נובמבר, לאחר שסער דבק בדרישתו לעריכת פריימריז לראשות הרשימה, סיכם נתניהו עם יור מרכז הליכוד חיים כץ כי יתקיימו בחירות לראשות הליכוד
2025-01-01 00:37:48,519 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:37:48,519 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בחודש       | ✗     |
|     1 | ▁-              | ▁נובמבר      | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | ▁אני            | ▁לאחר        | ✗     |
|     4 | ▁מכן            | ▁שס          | ✗     |
|     5 | עד              | ער           | ✗     |
|     6 | ▁את             | ▁דבק         | ✗     |
|     7 | ה               | ▁בדר         | ✗     |
|     8 | מה              | יש           | ✗     |
|     9 | ת               | תו           | ✗     |
|    10 | ▁האחרונה        | ▁לערי        | ✗     |
|    11 | כה              | כת           | ✗     |
|    12 | ▁בית            | ▁פריי        | ✗     |
|    13 | ה               | מר           | ✗     |
|    14 | ,               | יז           | ✗     |
|    15 | ,               | ▁לראש        | ✗     |
|    16 | ון              | ות           | ✗     |
|    17 | יה              | ▁הרשימה      | ✗     |
|    18 | ▁שלו            | ,            | ✗     |
|    19 | </s>            | ▁סי          | ✗     |
|    20 | ומה             | כם           | ✗     |
|    21 | ▁את             | ▁נתנ         | ✗     |
|    22 | יה              | יהו          | ✗     |
|    23 | ▁ב              | ▁עם          | ✗     |
|    24 | ▁כל             | ▁י           | ✗     |
|    25 | ון              | ור           | ✗     |
|    26 | נט              | ▁מרכז        | ✗     |
|    27 | ▁המדינה         | ▁הלי         | ✗     |
|    28 | כות             | כו           | ✗     |
|    29 | ד               | ד            | ✓     |
|    30 | .               | ▁חיים        | ✗     |
|    31 | .               | ▁כ           | ✗     |
|    32 | חוק             | ץ            | ✗     |
|    33 | ר               | ▁כי          | ✗     |
|    34 | ו               | ▁י           | ✗     |
|    35 | וטה             | תקיימו       | ✗     |
|    36 | ▁ימים           | ▁בחירות      | ✗     |
|    37 | ו               | ▁לראש        | ✗     |
|    38 | ון              | ות           | ✗     |
|    39 | ▁הממשלה         | ▁הלי         | ✗     |
|    40 | כות             | כו           | ✗     |
|    41 | ד               | ד            | ✓     |
|    42 | .               |              | ✗     |

2025-01-01 00:37:48,519 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:37:48,524 - TrainingLogger - INFO - Gradient norm: 7.4309
2025-01-01 00:37:55,856 - TrainingLogger - INFO - Step 44910, Batch metrics: Loss: 7.8827, Accuracy: 0.0301, Perplexity: 2651.0319
2025-01-01 00:38:02,931 - TrainingLogger - INFO - Step 44920, Batch metrics: Loss: 7.3658, Accuracy: 0.0876, Perplexity: 1580.9637
2025-01-01 00:38:10,419 - TrainingLogger - INFO - Step 44930, Batch metrics: Loss: 7.3551, Accuracy: 0.0825, Perplexity: 1564.2029
2025-01-01 00:38:17,539 - TrainingLogger - INFO - Step 44940, Batch metrics: Loss: 7.3850, Accuracy: 0.0897, Perplexity: 1611.5744
2025-01-01 00:38:25,115 - TrainingLogger - INFO - Step 44950, Batch metrics: Loss: 7.2142, Accuracy: 0.0734, Perplexity: 1358.5955
2025-01-01 00:38:32,169 - TrainingLogger - INFO - Step 44960, Batch metrics: Loss: 7.8198, Accuracy: 0.0725, Perplexity: 2489.4606
2025-01-01 00:38:39,480 - TrainingLogger - INFO - Step 44970, Batch metrics: Loss: 7.0635, Accuracy: 0.0774, Perplexity: 1168.5462
2025-01-01 00:38:46,312 - TrainingLogger - INFO - Step 44980, Batch metrics: Loss: 7.2760, Accuracy: 0.0676, Perplexity: 1445.2426
2025-01-01 00:38:53,172 - TrainingLogger - INFO - Step 44990, Batch metrics: Loss: 7.4584, Accuracy: 0.0687, Perplexity: 1734.4242
2025-01-01 00:39:00,628 - TrainingLogger - INFO - Step 45000, Batch metrics: Loss: 7.4812, Accuracy: 0.0583, Perplexity: 1774.4021
2025-01-01 00:39:00,629 - TrainingLogger - INFO - Step 45000, Prediction vs Actual:
2025-01-01 00:39:00,629 - TrainingLogger - INFO - Input 1: מתי?בתאריכים 2912-3012 בכל שעות היום מ-700-2000 ברביעי וחמישי ה-2712 וה-2812 ולפירוק בשעות הערב במוצאי שבת ב- 3012
2025-01-01 00:39:00,630 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:39:00,630 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מתי         | ✗     |
|     1 | ▁אני            | ?            | ✗     |
|     2 | </s>            | בת           | ✗     |
|     3 | ▁הוא            | ארי          | ✗     |
|     4 | זה              | כים          | ✗     |
|     5 | :               | ▁29          | ✗     |
|     6 | :               | 12           | ✗     |
|     7 | .               | -30          | ✗     |
|     8 | ה               | 12           | ✗     |
|     9 | .               | ▁בכל         | ✗     |
|    10 | ▁יום            | ▁שעות        | ✗     |
|    11 | ▁העבודה         | ▁היום        | ✗     |
|    12 | .               | ▁מ           | ✗     |
|    13 | ועצת            | -            | ✗     |
|    14 | 29              | 700          | ✗     |
|    15 | ▁שנות           | -2           | ✗     |
|    16 | .               | 000          | ✗     |
|    17 | .               | ▁ברביע       | ✗     |
|    18 | ים              | י            | ✗     |
|    19 | ▁השני           | ▁ו           | ✗     |
|    20 | נבחר            | חמישי        | ✗     |
|    21 | ת               | ▁ה           | ✗     |
|    22 | -               | -            | ✓     |
|    23 | 31              | 27           | ✗     |
|    24 | ▁במרץ           | 12           | ✗     |
|    25 | ה               | ▁וה          | ✗     |
|    26 | שלישי           | -            | ✗     |
|    27 | 01              | 28           | ✗     |
|    28 | ▁במרץ           | 12           | ✗     |
|    29 | ,               | ▁ולפי        | ✗     |
|    30 | ו               | רוק          | ✗     |
|    31 | ר               | ▁בשעות       | ✗     |
|    32 | ▁הקרובות        | ▁הערב        | ✗     |
|    33 | ▁האחרונות       | ▁במוצא       | ✗     |
|    34 | ו               | י            | ✗     |
|    35 | ▁הלילה          | ▁שבת         | ✗     |
|    36 | ון              | ▁ב           | ✗     |
|    37 | -19             | -            | ✗     |
|    38 | 01              | ▁30          | ✗     |
|    39 | ▁בערב           | 12           | ✗     |
|    40 | ▁בנובמבר        | <pad>        | ✗     |
|    41 | ▁האחרונות       | <pad>        | ✗     |
|    42 | ה               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ▁הקרובות        | <pad>        | ✗     |
|    46 | ▁ה              | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | ון              | <pad>        | ✗     |
|    49 | ▁היום           | <pad>        | ✗     |
|    50 | ▁בבוקר          |              | ✗     |

2025-01-01 00:39:00,630 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:39:00,635 - TrainingLogger - INFO - Gradient norm: 8.7415
2025-01-01 00:39:07,815 - TrainingLogger - INFO - Step 45010, Batch metrics: Loss: 6.9213, Accuracy: 0.0634, Perplexity: 1013.6629
2025-01-01 00:39:14,586 - TrainingLogger - INFO - Step 45020, Batch metrics: Loss: 7.3774, Accuracy: 0.0875, Perplexity: 1599.4471
2025-01-01 00:39:22,237 - TrainingLogger - INFO - Step 45030, Batch metrics: Loss: 7.3639, Accuracy: 0.0798, Perplexity: 1578.0520
2025-01-01 00:39:29,692 - TrainingLogger - INFO - Step 45040, Batch metrics: Loss: 7.2606, Accuracy: 0.0741, Perplexity: 1423.1496
2025-01-01 00:39:36,895 - TrainingLogger - INFO - Step 45050, Batch metrics: Loss: 6.6782, Accuracy: 0.1284, Perplexity: 794.9119
2025-01-01 00:39:44,363 - TrainingLogger - INFO - Step 45060, Batch metrics: Loss: 7.0444, Accuracy: 0.0843, Perplexity: 1146.4456
2025-01-01 00:39:52,046 - TrainingLogger - INFO - Step 45070, Batch metrics: Loss: 7.2162, Accuracy: 0.1067, Perplexity: 1361.2568
2025-01-01 00:39:59,379 - TrainingLogger - INFO - Step 45080, Batch metrics: Loss: 7.3075, Accuracy: 0.0737, Perplexity: 1491.5142
2025-01-01 00:40:06,736 - TrainingLogger - INFO - Step 45090, Batch metrics: Loss: 7.7381, Accuracy: 0.0909, Perplexity: 2294.1030
2025-01-01 00:40:14,258 - TrainingLogger - INFO - Step 45100, Batch metrics: Loss: 7.3348, Accuracy: 0.0486, Perplexity: 1532.7223
2025-01-01 00:40:14,258 - TrainingLogger - INFO - Step 45100, Prediction vs Actual:
2025-01-01 00:40:14,259 - TrainingLogger - INFO - Input 1: ישפצו את המעון בעשרות מיליונים לכבוד בנט ונתניהו יחזור למעון משופץ ומפואר כמו שמגיע לו
2025-01-01 00:40:14,259 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:40:14,259 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁יש          | ✗     |
|     1 | ▁הוא            | פצ           | ✗     |
|     2 | ▁-              | ו            | ✗     |
|     3 | ▁הוא            | ▁את          | ✗     |
|     4 | ▁-              | ▁ה           | ✗     |
|     5 | נטל             | מעון         | ✗     |
|     6 | ▁הזה            | ▁בעשר        | ✗     |
|     7 | ה               | ות           | ✗     |
|     8 | ▁השנים          | ▁מיליונים    | ✗     |
|     9 | ▁בלבד           | ▁לכבוד       | ✗     |
|    10 | ו               | ▁בנט         | ✗     |
|    11 | ים              | ▁ונת         | ✗     |
|    12 | '               | ניה          | ✗     |
|    13 | ▁האחרונה        | ו            | ✗     |
|    14 | ▁לו             | ▁יחזור       | ✗     |
|    15 | ▁הביתה          | ▁ל           | ✗     |
|    16 | מוטב            | מעון         | ✗     |
|    17 | .               | ▁משו         | ✗     |
|    18 | עבד             | פץ           | ✗     |
|    19 | .               | ▁ומ          | ✗     |
|    20 | חוק             | פו           | ✗     |
|    21 | אר              | אר           | ✓     |
|    22 | .               | ▁כמו         | ✗     |
|    23 | ▁שצריך          | ▁שמגיע       | ✗     |
|    24 | ה               | ▁לו          | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | .               | <pad>        | ✗     |
|    32 | ▁"              | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | ▁מדינות         | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | </s>            |              | ✗     |

2025-01-01 00:40:14,259 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:40:14,264 - TrainingLogger - INFO - Gradient norm: 6.8583
2025-01-01 00:40:21,000 - TrainingLogger - INFO - Step 45110, Batch metrics: Loss: 7.0882, Accuracy: 0.0769, Perplexity: 1197.7277
2025-01-01 00:40:28,460 - TrainingLogger - INFO - Step 45120, Batch metrics: Loss: 7.6014, Accuracy: 0.0707, Perplexity: 2000.9665
2025-01-01 00:40:35,899 - TrainingLogger - INFO - Step 45130, Batch metrics: Loss: 7.4976, Accuracy: 0.1250, Perplexity: 1803.6758
2025-01-01 00:40:43,267 - TrainingLogger - INFO - Step 45140, Batch metrics: Loss: 7.4001, Accuracy: 0.0505, Perplexity: 1636.1820
2025-01-01 00:40:50,990 - TrainingLogger - INFO - Step 45150, Batch metrics: Loss: 7.6100, Accuracy: 0.0737, Perplexity: 2018.1966
2025-01-01 00:40:58,317 - TrainingLogger - INFO - Step 45160, Batch metrics: Loss: 7.3557, Accuracy: 0.0866, Perplexity: 1565.0818
2025-01-01 00:41:05,098 - TrainingLogger - INFO - Step 45170, Batch metrics: Loss: 7.3503, Accuracy: 0.0606, Perplexity: 1556.6892
2025-01-01 00:41:12,736 - TrainingLogger - INFO - Step 45180, Batch metrics: Loss: 7.6292, Accuracy: 0.0756, Perplexity: 2057.4201
2025-01-01 00:41:20,047 - TrainingLogger - INFO - Step 45190, Batch metrics: Loss: 7.5926, Accuracy: 0.0719, Perplexity: 1983.3709
2025-01-01 00:41:27,020 - TrainingLogger - INFO - Step 45200, Batch metrics: Loss: 7.8166, Accuracy: 0.0786, Perplexity: 2481.4490
2025-01-01 00:41:27,021 - TrainingLogger - INFO - Step 45200, Prediction vs Actual:
2025-01-01 00:41:27,021 - TrainingLogger - INFO - Input 1: מהפשקוויל זועקות כותרות דמיוניות מעיתוני ה-18 בספטמבר - באחת מהן דיווח על ניצחון כחול לבן ובשנייה על קדנציה נוספת לנתניהו והחרדים
2025-01-01 00:41:27,021 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:41:27,021 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מה          | ✗     |
|     1 | ?               | פש           | ✗     |
|     2 | לים             | ק            | ✗     |
|     3 | ▁-              | וויל         | ✗     |
|     4 | ה               | ▁זועק        | ✗     |
|     5 | ת               | ות           | ✗     |
|     6 | יי              | ▁כותרות      | ✗     |
|     7 | ▁חדשות          | ▁דמיוני      | ✗     |
|     8 | ות              | ות           | ✓     |
|     9 | ,               | ▁מעי         | ✗     |
|    10 | ינות            | ת            | ✗     |
|    11 | ות              | וני          | ✗     |
|    12 | ו               | ▁ה           | ✗     |
|    13 | "               | -18          | ✗     |
|    14 | 1               | ▁בספטמבר     | ✗     |
|    15 | ▁19             | ▁-           | ✗     |
|    16 | -               | ▁באחת        | ✗     |
|    17 | ▁מה             | ▁מהן         | ✗     |
|    18 | ▁יש             | ▁דיווח       | ✗     |
|    19 | ות              | ▁על          | ✗     |
|    20 | ▁כך             | ▁ניצחון      | ✗     |
|    21 | ,               | ▁כחול        | ✗     |
|    22 | </s>            | ▁לבן         | ✗     |
|    23 | ▁אדם            | ▁וב          | ✗     |
|    24 | גדול            | שנייה        | ✗     |
|    25 | .               | ▁על          | ✗     |
|    26 | ▁כך             | ▁קד          | ✗     |
|    27 | ות              | נצ           | ✗     |
|    28 | יה              | יה           | ✓     |
|    29 | .               | ▁נוספת       | ✗     |
|    30 | .               | ▁לנ          | ✗     |
|    31 | "               | תני          | ✗     |
|    32 | נים             | הו           | ✗     |
|    33 | ות              | ▁והח         | ✗     |
|    34 | מה              | רד           | ✗     |
|    35 | מה              | ים           | ✗     |
|    36 | .               |              | ✗     |

2025-01-01 00:41:27,021 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:41:27,026 - TrainingLogger - INFO - Gradient norm: 9.2185
2025-01-01 00:41:33,950 - TrainingLogger - INFO - Step 45210, Batch metrics: Loss: 7.1965, Accuracy: 0.0704, Perplexity: 1334.6896
2025-01-01 00:41:40,997 - TrainingLogger - INFO - Step 45220, Batch metrics: Loss: 7.3772, Accuracy: 0.0718, Perplexity: 1599.1558
2025-01-01 00:41:47,762 - TrainingLogger - INFO - Step 45230, Batch metrics: Loss: 7.4711, Accuracy: 0.0778, Perplexity: 1756.5300
2025-01-01 00:41:54,819 - TrainingLogger - INFO - Step 45240, Batch metrics: Loss: 7.7605, Accuracy: 0.0710, Perplexity: 2346.1824
2025-01-01 00:42:01,538 - TrainingLogger - INFO - Step 45250, Batch metrics: Loss: 7.1105, Accuracy: 0.0870, Perplexity: 1224.7760
2025-01-01 00:42:07,997 - TrainingLogger - INFO - Step 45260, Batch metrics: Loss: 7.3630, Accuracy: 0.0894, Perplexity: 1576.5695
2025-01-01 00:42:15,290 - TrainingLogger - INFO - Step 45270, Batch metrics: Loss: 7.3286, Accuracy: 0.0659, Perplexity: 1523.2680
2025-01-01 00:42:22,441 - TrainingLogger - INFO - Step 45280, Batch metrics: Loss: 7.3797, Accuracy: 0.1034, Perplexity: 1603.0441
2025-01-01 00:42:29,528 - TrainingLogger - INFO - Step 45290, Batch metrics: Loss: 7.1794, Accuracy: 0.0769, Perplexity: 1312.1051
2025-01-01 00:42:36,586 - TrainingLogger - INFO - Step 45300, Batch metrics: Loss: 6.9835, Accuracy: 0.1111, Perplexity: 1078.7247
2025-01-01 00:42:36,587 - TrainingLogger - INFO - Step 45300, Prediction vs Actual:
2025-01-01 00:42:36,587 - TrainingLogger - INFO - Input 1: ישראל בינתיים עוד נהנית מתמיכה חזקה יחסית בסקרי דעת הקהל בארהב ובמערב, אך התמיכה הולכת ויורדת ומתמקדת בעיקר בקהלים שמרנים, גברים ומבוגרים
2025-01-01 00:42:36,588 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:42:36,588 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ישראל       | ✗     |
|     1 | ▁(              | ▁בינתיים     | ✗     |
|     2 | .               | ▁עוד         | ✗     |
|     3 | ▁אחת            | ▁נהנית       | ✗     |
|     4 | ▁ממנה           | ▁מ           | ✗     |
|     5 | בושה            | תמיכה        | ✗     |
|     6 | ▁זו             | ▁חזקה        | ✗     |
|     7 | </s>            | ▁יחסית       | ✗     |
|     8 | ▁ל              | ▁בס          | ✗     |
|     9 | וריה            | קרי          | ✗     |
|    10 | נט              | ▁דעת         | ✗     |
|    11 | ▁רבים           | ▁הקהל        | ✗     |
|    12 | .               | ▁בארה        | ✗     |
|    13 | "               | ב            | ✗     |
|    14 | .               | ▁וב          | ✗     |
|    15 | בחירות          | מערב         | ✗     |
|    16 | ה               | ,            | ✗     |
|    17 | </s>            | ▁אך          | ✗     |
|    18 | ▁ורק            | ▁התמיכה      | ✗     |
|    19 | ▁הגדולה         | ▁הולכת       | ✗     |
|    20 | ▁להשתנות        | ▁ויורד       | ✗     |
|    21 | ת               | ת            | ✓     |
|    22 | ▁על             | ▁ומת         | ✗     |
|    23 | משכת            | מקד          | ✗     |
|    24 | ת               | ת            | ✓     |
|    25 | ▁גם             | ▁בעיקר       | ✗     |
|    26 | ה               | ▁בקהל        | ✗     |
|    27 | .               | ים           | ✗     |
|    28 | ▁אחרים          | ▁שמר         | ✗     |
|    29 | ים              | נים          | ✗     |
|    30 | ▁חיים           | ,            | ✗     |
|    31 | </s>            | ▁גברים       | ✗     |
|    32 | ▁רבים           | ▁ו           | ✗     |
|    33 | בנים            | מבוגרים      | ✗     |
|    34 | ▁רבים           | <pad>        | ✗     |
|    35 | ▁אחרים          | <pad>        | ✗     |
|    36 | ▁רבים           | <pad>        | ✗     |
|    37 | ▁צעירים         | <pad>        | ✗     |
|    38 | ▁רבים           | <pad>        | ✗     |
|    39 | ▁רבים           | <pad>        | ✗     |
|    40 | ▁אחרים          | <pad>        | ✗     |
|    41 | ▁אחרים          | <pad>        | ✗     |
|    42 | ▁רבים           |              | ✗     |

2025-01-01 00:42:36,588 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:42:36,593 - TrainingLogger - INFO - Gradient norm: 6.7111
2025-01-01 00:42:43,430 - TrainingLogger - INFO - Step 45310, Batch metrics: Loss: 7.5709, Accuracy: 0.0542, Perplexity: 1940.9603
2025-01-01 00:42:50,565 - TrainingLogger - INFO - Step 45320, Batch metrics: Loss: 6.9894, Accuracy: 0.1173, Perplexity: 1085.0619
2025-01-01 00:42:57,937 - TrainingLogger - INFO - Step 45330, Batch metrics: Loss: 7.3751, Accuracy: 0.0904, Perplexity: 1595.8034
2025-01-01 00:43:05,083 - TrainingLogger - INFO - Step 45340, Batch metrics: Loss: 7.1199, Accuracy: 0.0889, Perplexity: 1236.3884
2025-01-01 00:43:12,097 - TrainingLogger - INFO - Step 45350, Batch metrics: Loss: 6.8109, Accuracy: 0.1319, Perplexity: 907.6464
2025-01-01 00:43:19,532 - TrainingLogger - INFO - Step 45360, Batch metrics: Loss: 7.5753, Accuracy: 0.0649, Perplexity: 1949.3506
2025-01-01 00:43:26,647 - TrainingLogger - INFO - Step 45370, Batch metrics: Loss: 7.4129, Accuracy: 0.0722, Perplexity: 1657.2569
2025-01-01 00:43:33,949 - TrainingLogger - INFO - Step 45380, Batch metrics: Loss: 7.3581, Accuracy: 0.0924, Perplexity: 1568.7847
2025-01-01 00:43:41,525 - TrainingLogger - INFO - Step 45390, Batch metrics: Loss: 7.2222, Accuracy: 0.0944, Perplexity: 1369.5469
2025-01-01 00:43:48,742 - TrainingLogger - INFO - Step 45400, Batch metrics: Loss: 7.4804, Accuracy: 0.0787, Perplexity: 1773.0100
2025-01-01 00:43:48,742 - TrainingLogger - INFO - Step 45400, Prediction vs Actual:
2025-01-01 00:43:48,742 - TrainingLogger - INFO - Input 1: יברקן ישמש כסגן השר וכממונה על שילוב יוצאי אתיופיה
2025-01-01 00:43:48,743 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:43:48,743 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁י           | ✗     |
|     1 | ▁               | ברק          | ✗     |
|     2 | ▁הוא            | ן            | ✗     |
|     3 | ▁הוא            | ▁ישמש        | ✗     |
|     4 | ▁-              | ▁כ           | ✗     |
|     5 | חוק             | סגן          | ✗     |
|     6 | ▁הנשיא          | ▁השר         | ✗     |
|     7 | ה               | ▁וכ          | ✗     |
|     8 | נשיא            | מ            | ✗     |
|     9 | טבח             | מונה         | ✗     |
|    10 | ▁עליו           | ▁על          | ✗     |
|    11 | ▁המדינה         | ▁שילוב       | ✗     |
|    12 | ▁של             | ▁יוצא        | ✗     |
|    13 | ▁מן             | י            | ✗     |
|    14 | ▁צבא            | ▁את          | ✗     |
|    15 | ר               | יופי         | ✗     |
|    16 | ו               | ה            | ✗     |
|    17 | ▁של             | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ▁ישראל          | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ▁הצבא           | <pad>        | ✗     |
|    26 | ה               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁זה             | <pad>        | ✗     |
|    29 | ו               | <pad>        | ✗     |
|    30 | ▁המדינה         | <pad>        | ✗     |
|    31 | ר               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ▁המדינה         | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ▁המדינה         | <pad>        | ✗     |
|    36 | ▁הצבא           | <pad>        | ✗     |
|    37 | ▁הצבא           | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | ▁עד             | <pad>        | ✗     |
|    41 | ר               |              | ✗     |

2025-01-01 00:43:48,743 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:43:48,748 - TrainingLogger - INFO - Gradient norm: 6.1404
2025-01-01 00:43:55,381 - TrainingLogger - INFO - Step 45410, Batch metrics: Loss: 7.3436, Accuracy: 0.0904, Perplexity: 1546.2971
2025-01-01 00:44:02,523 - TrainingLogger - INFO - Step 45420, Batch metrics: Loss: 7.3426, Accuracy: 0.0385, Perplexity: 1544.7311
2025-01-01 00:44:10,016 - TrainingLogger - INFO - Step 45430, Batch metrics: Loss: 7.4776, Accuracy: 0.0599, Perplexity: 1768.0458
2025-01-01 00:44:17,245 - TrainingLogger - INFO - Step 45440, Batch metrics: Loss: 7.5186, Accuracy: 0.0993, Perplexity: 1841.9252
2025-01-01 00:44:24,487 - TrainingLogger - INFO - Step 45450, Batch metrics: Loss: 6.8542, Accuracy: 0.1100, Perplexity: 947.8408
2025-01-01 00:44:32,203 - TrainingLogger - INFO - Step 45460, Batch metrics: Loss: 7.0691, Accuracy: 0.0942, Perplexity: 1175.0999
2025-01-01 00:44:39,448 - TrainingLogger - INFO - Step 45470, Batch metrics: Loss: 7.1581, Accuracy: 0.0762, Perplexity: 1284.5075
2025-01-01 00:44:46,418 - TrainingLogger - INFO - Step 45480, Batch metrics: Loss: 7.5724, Accuracy: 0.0769, Perplexity: 1943.7175
2025-01-01 00:44:53,478 - TrainingLogger - INFO - Step 45490, Batch metrics: Loss: 7.2208, Accuracy: 0.0699, Perplexity: 1367.5376
2025-01-01 00:45:00,335 - TrainingLogger - INFO - Step 45500, Batch metrics: Loss: 7.1955, Accuracy: 0.0769, Perplexity: 1333.4612
2025-01-01 00:45:00,335 - TrainingLogger - INFO - Step 45500, Prediction vs Actual:
2025-01-01 00:45:00,335 - TrainingLogger - INFO - Input 1: גם עם רהמ בנט קבענו פגישה שבועית על עניינים כלכליים, הצהיר
2025-01-01 00:45:00,335 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:45:00,336 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁גם          | ✗     |
|     1 | ▁כן             | ▁עם          | ✗     |
|     2 | ▁-              | ▁ר           | ✗     |
|     3 | ▁-              | המ           | ✗     |
|     4 | ▁-              | ▁בנט         | ✗     |
|     5 | .               | ▁קבענו       | ✗     |
|     6 | ▁את             | ▁פגישה       | ✗     |
|     7 | ▁רשמית          | ▁שבוע        | ✗     |
|     8 | ת               | ית           | ✗     |
|     9 | ,               | ▁על          | ✗     |
|    10 | ▁כל             | ▁עניינים     | ✗     |
|    11 | ▁רבים           | ▁כלכליים     | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁הצהיר       | ✗     |
|    14 | ו               | <pad>        | ✗     |
|    15 | ו               | <pad>        | ✗     |
|    16 | ה               | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ה               | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ▁על             | <pad>        | ✗     |
|    22 | ▁מוקדם          | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ▁על             | <pad>        | ✗     |
|    26 | ▁חדש            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ▁על             | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | ▁על             | <pad>        | ✗     |
|    32 | ▁על             | <pad>        | ✗     |
|    33 | ▁זו             | <pad>        | ✗     |
|    34 | ▁חדש            | <pad>        | ✗     |
|    35 | </s>            |              | ✗     |

2025-01-01 00:45:00,336 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:45:00,341 - TrainingLogger - INFO - Gradient norm: 9.5693
2025-01-01 00:45:07,094 - TrainingLogger - INFO - Step 45510, Batch metrics: Loss: 7.3911, Accuracy: 0.0863, Perplexity: 1621.4539
2025-01-01 00:45:13,820 - TrainingLogger - INFO - Step 45520, Batch metrics: Loss: 7.0215, Accuracy: 0.0878, Perplexity: 1120.4827
2025-01-01 00:45:21,161 - TrainingLogger - INFO - Step 45530, Batch metrics: Loss: 6.9090, Accuracy: 0.1314, Perplexity: 1001.2850
2025-01-01 00:45:28,673 - TrainingLogger - INFO - Step 45540, Batch metrics: Loss: 7.7513, Accuracy: 0.0613, Perplexity: 2324.4923
2025-01-01 00:45:36,070 - TrainingLogger - INFO - Step 45550, Batch metrics: Loss: 7.3877, Accuracy: 0.0909, Perplexity: 1616.0253
2025-01-01 00:45:43,193 - TrainingLogger - INFO - Step 45560, Batch metrics: Loss: 7.1272, Accuracy: 0.0909, Perplexity: 1245.3923
2025-01-01 00:45:50,074 - TrainingLogger - INFO - Step 45570, Batch metrics: Loss: 7.3939, Accuracy: 0.1092, Perplexity: 1625.9871
2025-01-01 00:45:57,379 - TrainingLogger - INFO - Step 45580, Batch metrics: Loss: 7.3610, Accuracy: 0.0923, Perplexity: 1573.4258
2025-01-01 00:46:04,485 - TrainingLogger - INFO - Step 45590, Batch metrics: Loss: 7.2397, Accuracy: 0.1098, Perplexity: 1393.7161
2025-01-01 00:46:12,121 - TrainingLogger - INFO - Step 45600, Batch metrics: Loss: 7.0264, Accuracy: 0.0972, Perplexity: 1125.9307
2025-01-01 00:46:12,122 - TrainingLogger - INFO - Step 45600, Prediction vs Actual:
2025-01-01 00:46:12,155 - TrainingLogger - INFO - Input 1: הדבר הטוב ביותר ליריבינו משמאל היא שמירת ההנהגה הנוכחית, הם מפחדים מהיום שבו גדעון סער יזכה לעמוד בראש הליכוד
2025-01-01 00:46:12,156 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:46:12,156 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הדבר        | ✗     |
|     1 | ▁"              | ▁הטוב        | ✗     |
|     2 | ▁-              | ▁ביותר       | ✗     |
|     3 | ▁בעולם          | ▁לי          | ✗     |
|     4 | יב              | רי           | ✗     |
|     5 | .               | בינו         | ✗     |
|     6 | .               | ▁משמאל       | ✗     |
|     7 | י               | ▁היא         | ✗     |
|     8 | ▁לא             | ▁שמירת       | ✗     |
|     9 | ו               | ▁הה          | ✗     |
|    10 | ון              | נהג          | ✗     |
|    11 | ה               | ה            | ✓     |
|    12 | ▁השחורה         | ▁הנוכחית     | ✗     |
|    13 | ▁שלו            | ,            | ✗     |
|    14 | <pad>           | ▁הם          | ✗     |
|    15 | ▁לא             | ▁מפחדים      | ✗     |
|    16 | ▁מה             | ▁מהיום       | ✗     |
|    17 | ▁והלאה          | ▁שבו         | ✗     |
|    18 | ▁הם             | ▁גדעון       | ✗     |
|    19 | ▁היה            | ▁סע          | ✗     |
|    20 | ר               | ר            | ✓     |
|    21 | .               | ▁יזכה        | ✗     |
|    22 | ▁ב              | ▁לעמוד       | ✗     |
|    23 | ▁על             | ▁בראש        | ✗     |
|    24 | ▁הממשלה         | ▁הלי         | ✗     |
|    25 | ווי             | כו           | ✗     |
|    26 | ד               | ד            | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | ▁הנוכחי         | <pad>        | ✗     |
|    36 | ▁(              | <pad>        | ✗     |
|    37 | ▁בראש           | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | ,               |              | ✗     |

2025-01-01 00:46:12,156 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:46:12,161 - TrainingLogger - INFO - Gradient norm: 8.1982
2025-01-01 00:46:19,374 - TrainingLogger - INFO - Step 45610, Batch metrics: Loss: 7.4300, Accuracy: 0.0857, Perplexity: 1685.8555
2025-01-01 00:46:26,678 - TrainingLogger - INFO - Step 45620, Batch metrics: Loss: 6.9803, Accuracy: 0.0608, Perplexity: 1075.2526
2025-01-01 00:46:33,663 - TrainingLogger - INFO - Step 45630, Batch metrics: Loss: 7.2244, Accuracy: 0.0787, Perplexity: 1372.4691
2025-01-01 00:46:41,456 - TrainingLogger - INFO - Step 45640, Batch metrics: Loss: 7.2894, Accuracy: 0.0862, Perplexity: 1464.6785
2025-01-01 00:46:48,652 - TrainingLogger - INFO - Step 45650, Batch metrics: Loss: 7.6167, Accuracy: 0.0691, Perplexity: 2031.9277
2025-01-01 00:46:55,604 - TrainingLogger - INFO - Step 45660, Batch metrics: Loss: 7.0581, Accuracy: 0.1024, Perplexity: 1162.2068
2025-01-01 00:47:03,000 - TrainingLogger - INFO - Step 45670, Batch metrics: Loss: 7.6277, Accuracy: 0.0634, Perplexity: 2054.2194
2025-01-01 00:47:10,002 - TrainingLogger - INFO - Step 45680, Batch metrics: Loss: 7.8709, Accuracy: 0.0585, Perplexity: 2619.8704
2025-01-01 00:47:18,337 - TrainingLogger - INFO - Step 45690, Batch metrics: Loss: 7.6720, Accuracy: 0.0534, Perplexity: 2147.4086
2025-01-01 00:47:25,806 - TrainingLogger - INFO - Step 45700, Batch metrics: Loss: 7.1680, Accuracy: 0.0806, Perplexity: 1297.2602
2025-01-01 00:47:25,806 - TrainingLogger - INFO - Step 45700, Prediction vs Actual:
2025-01-01 00:47:25,806 - TrainingLogger - INFO - Input 1: אחת מהן דורשת למנוע מנשיא המדינה את הטלת הרכבת הממשלה על נתניהו
2025-01-01 00:47:25,807 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:47:25,807 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | בית             | ▁אחת         | ✗     |
|     1 | ▁-              | ▁מהן         | ✗     |
|     2 | ▁לא             | ▁דורשת       | ✗     |
|     3 | ▁להיות          | ▁למנוע       | ✗     |
|     4 | ▁את             | ▁מ           | ✗     |
|     5 | לתת             | נשיא         | ✗     |
|     6 | ה               | ▁המדינה      | ✗     |
|     7 | .               | ▁את          | ✗     |
|     8 | ▁זה             | ▁הטלת        | ✗     |
|     9 | ▁הזאת           | ▁הרכבת       | ✗     |
|    10 | .               | ▁הממשלה      | ✗     |
|    11 | .               | ▁על          | ✗     |
|    12 | ה               | ▁נתנ         | ✗     |
|    13 | יה              | יהו          | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | יה              | <pad>        | ✗     |
|    16 | יה              | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | יה              | <pad>        | ✗     |
|    20 | יה              | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | יה              | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | יה              | <pad>        | ✗     |
|    25 | ית              | <pad>        | ✗     |
|    26 | ו               | <pad>        | ✗     |
|    27 | ית              | <pad>        | ✗     |
|    28 | יה              | <pad>        | ✗     |
|    29 | ית              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | יה              | <pad>        | ✗     |
|    32 | ית              | <pad>        | ✗     |
|    33 | ית              |              | ✗     |

2025-01-01 00:47:25,807 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:47:25,812 - TrainingLogger - INFO - Gradient norm: 7.9345
2025-01-01 00:47:33,135 - TrainingLogger - INFO - Step 45710, Batch metrics: Loss: 7.6804, Accuracy: 0.0603, Perplexity: 2165.4515
2025-01-01 00:47:40,412 - TrainingLogger - INFO - Step 45720, Batch metrics: Loss: 7.1569, Accuracy: 0.0863, Perplexity: 1282.9539
2025-01-01 00:47:48,156 - TrainingLogger - INFO - Step 45730, Batch metrics: Loss: 7.5092, Accuracy: 0.0331, Perplexity: 1824.6916
2025-01-01 00:47:55,970 - TrainingLogger - INFO - Step 45740, Batch metrics: Loss: 6.5842, Accuracy: 0.1152, Perplexity: 723.5695
2025-01-01 00:48:02,685 - TrainingLogger - INFO - Step 45750, Batch metrics: Loss: 7.8124, Accuracy: 0.0950, Perplexity: 2471.1442
2025-01-01 00:48:09,549 - TrainingLogger - INFO - Step 45760, Batch metrics: Loss: 7.6048, Accuracy: 0.0736, Perplexity: 2007.8615
2025-01-01 00:48:16,893 - TrainingLogger - INFO - Step 45770, Batch metrics: Loss: 7.3867, Accuracy: 0.0802, Perplexity: 1614.3039
2025-01-01 00:48:24,060 - TrainingLogger - INFO - Step 45780, Batch metrics: Loss: 7.4071, Accuracy: 0.0843, Perplexity: 1647.6235
2025-01-01 00:48:30,911 - TrainingLogger - INFO - Step 45790, Batch metrics: Loss: 7.6610, Accuracy: 0.1006, Perplexity: 2123.8231
2025-01-01 00:48:38,162 - TrainingLogger - INFO - Step 45800, Batch metrics: Loss: 7.7475, Accuracy: 0.0490, Perplexity: 2315.6806
2025-01-01 00:48:38,162 - TrainingLogger - INFO - Step 45800, Prediction vs Actual:
2025-01-01 00:48:38,162 - TrainingLogger - INFO - Input 1: במנהרות הלחימה צהל כמעט שלא נוגע בשלב זה, אך הוא השמיד בחאן יונס כ-20 קמ של מנהרות אסטרטגיות
2025-01-01 00:48:38,163 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:48:38,163 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁ב           | ✗     |
|     1 | ▁-              | מנה          | ✗     |
|     2 | ▁-              | רות          | ✗     |
|     3 | ▁-              | ▁הלחימה      | ✗     |
|     4 | ▁היא            | ▁צ           | ✗     |
|     5 | צה              | הל           | ✗     |
|     6 | פים             | ▁כמעט        | ✗     |
|     7 | ▁לא             | ▁שלא         | ✗     |
|     8 | ▁היה            | ▁נוגע        | ✗     |
|     9 | ת               | ▁בשלב        | ✗     |
|    10 | ▁הזה            | ▁זה          | ✗     |
|    11 | ,               | ,            | ✓     |
|    12 | ▁נכון           | ▁אך          | ✗     |
|    13 | ▁לא             | ▁הוא         | ✗     |
|    14 | ▁לא             | ▁השמיד       | ✗     |
|    15 | ▁את             | ▁בח          | ✗     |
|    16 | ק               | אן           | ✗     |
|    17 | ▁את             | ▁י           | ✗     |
|    18 | ון              | ונס          | ✗     |
|    19 | ▁את             | ▁כ           | ✗     |
|    20 | נשיא            | -20          | ✗     |
|    21 | ▁שנים           | ▁קמ          | ✗     |
|    22 | "               | ▁של          | ✗     |
|    23 | ▁כל             | ▁מנהר        | ✗     |
|    24 | ות              | ות           | ✓     |
|    25 | .               | ▁אסטרטגי     | ✗     |
|    26 | ות              | ות           | ✓     |
|    27 | .               | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ות              | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ות              | <pad>        | ✗     |
|    34 | ות              | <pad>        | ✗     |
|    35 | ות              |              | ✗     |

2025-01-01 00:48:38,163 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:48:38,168 - TrainingLogger - INFO - Gradient norm: 11.5560
2025-01-01 00:48:45,384 - TrainingLogger - INFO - Step 45810, Batch metrics: Loss: 7.8740, Accuracy: 0.0569, Perplexity: 2627.9392
2025-01-01 00:48:53,196 - TrainingLogger - INFO - Step 45820, Batch metrics: Loss: 7.4756, Accuracy: 0.0913, Perplexity: 1764.4092
2025-01-01 00:49:00,317 - TrainingLogger - INFO - Step 45830, Batch metrics: Loss: 7.6305, Accuracy: 0.0714, Perplexity: 2060.1276
2025-01-01 00:49:07,073 - TrainingLogger - INFO - Step 45840, Batch metrics: Loss: 7.7131, Accuracy: 0.0690, Perplexity: 2237.5252
2025-01-01 00:49:14,335 - TrainingLogger - INFO - Step 45850, Batch metrics: Loss: 7.3028, Accuracy: 0.0714, Perplexity: 1484.4162
2025-01-01 00:49:22,056 - TrainingLogger - INFO - Step 45860, Batch metrics: Loss: 7.2685, Accuracy: 0.0819, Perplexity: 1434.3642
2025-01-01 00:49:29,299 - TrainingLogger - INFO - Step 45870, Batch metrics: Loss: 7.8287, Accuracy: 0.0566, Perplexity: 2511.7437
2025-01-01 00:49:36,415 - TrainingLogger - INFO - Step 45880, Batch metrics: Loss: 7.6059, Accuracy: 0.0926, Perplexity: 2010.0053
2025-01-01 00:49:43,666 - TrainingLogger - INFO - Step 45890, Batch metrics: Loss: 7.6877, Accuracy: 0.0606, Perplexity: 2181.3804
2025-01-01 00:49:50,619 - TrainingLogger - INFO - Step 45900, Batch metrics: Loss: 7.2797, Accuracy: 0.0809, Perplexity: 1450.5995
2025-01-01 00:49:50,620 - TrainingLogger - INFO - Step 45900, Prediction vs Actual:
2025-01-01 00:49:50,620 - TrainingLogger - INFO - Input 1: עם זאת, היישוב נמצא במקום ה-19 בארץ במספר המתפקדים לליכוד
2025-01-01 00:49:50,620 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:49:50,620 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עם          | ✗     |
|     1 | .               | ▁זאת         | ✗     |
|     2 | ,               | ,            | ✓     |
|     3 | ▁לא             | ▁היי         | ✗     |
|     4 | ,               | שוב          | ✗     |
|     5 | ים              | ▁נמצא        | ✗     |
|     6 | ▁שם             | ▁במקום       | ✗     |
|     7 | ▁אחר            | ▁ה           | ✗     |
|     8 | הישרדות         | -19          | ✗     |
|     9 | ▁בו             | ▁בארץ        | ✗     |
|    10 | ,               | ▁במספר       | ✗     |
|    11 | ה               | ▁המת         | ✗     |
|    12 | ים              | פקד          | ✗     |
|    13 | ים              | ים           | ✓     |
|    14 | ,               | ▁ללי         | ✗     |
|    15 | גה              | כו           | ✗     |
|    16 | ד               | ד            | ✓     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | ים              |              | ✗     |

2025-01-01 00:49:50,620 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:49:50,625 - TrainingLogger - INFO - Gradient norm: 7.4610
2025-01-01 00:49:57,823 - TrainingLogger - INFO - Step 45910, Batch metrics: Loss: 7.2187, Accuracy: 0.0828, Perplexity: 1364.7605
2025-01-01 00:50:04,758 - TrainingLogger - INFO - Step 45920, Batch metrics: Loss: 7.3683, Accuracy: 0.0766, Perplexity: 1584.9809
2025-01-01 00:50:12,021 - TrainingLogger - INFO - Step 45930, Batch metrics: Loss: 7.3129, Accuracy: 0.0714, Perplexity: 1499.5189
2025-01-01 00:50:19,045 - TrainingLogger - INFO - Step 45940, Batch metrics: Loss: 7.4669, Accuracy: 0.1026, Perplexity: 1749.1272
2025-01-01 00:50:26,016 - TrainingLogger - INFO - Step 45950, Batch metrics: Loss: 7.6640, Accuracy: 0.0400, Perplexity: 2130.3590
2025-01-01 00:50:33,048 - TrainingLogger - INFO - Step 45960, Batch metrics: Loss: 7.5307, Accuracy: 0.0850, Perplexity: 1864.4043
2025-01-01 00:50:40,062 - TrainingLogger - INFO - Step 45970, Batch metrics: Loss: 7.9144, Accuracy: 0.0891, Perplexity: 2736.4436
2025-01-01 00:50:47,222 - TrainingLogger - INFO - Step 45980, Batch metrics: Loss: 7.5909, Accuracy: 0.0759, Perplexity: 1980.0550
2025-01-01 00:50:54,350 - TrainingLogger - INFO - Step 45990, Batch metrics: Loss: 7.4907, Accuracy: 0.0948, Perplexity: 1791.3154
2025-01-01 00:51:01,420 - TrainingLogger - INFO - Step 46000, Batch metrics: Loss: 7.6175, Accuracy: 0.0818, Perplexity: 2033.4892
2025-01-01 00:51:01,420 - TrainingLogger - INFO - Step 46000, Prediction vs Actual:
2025-01-01 00:51:01,421 - TrainingLogger - INFO - Input 1: שמונה ימים לאחר מכן, הודיע ספיר אין כוונה לבטל הקלות במיסים על ידי מיסים חדשים
2025-01-01 00:51:01,421 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:51:01,421 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שמונה       | ✗     |
|     1 | ▁-              | ▁ימים        | ✗     |
|     2 | ▁-              | ▁לאחר        | ✗     |
|     3 | ▁מכן            | ▁מכן         | ✓     |
|     4 | ,               | ,            | ✓     |
|     5 | ▁אני            | ▁הודיע       | ✗     |
|     6 | ה               | ▁ספיר        | ✗     |
|     7 | ת               | ▁אין         | ✗     |
|     8 | ▁לי             | ▁כוונה       | ✗     |
|     9 | ▁לעשות          | ▁לבטל        | ✗     |
|    10 | ▁את             | ▁הקל         | ✗     |
|    11 | דה              | ות           | ✗     |
|    12 | .               | ▁במי         | ✗     |
|    13 | סה              | סים          | ✗     |
|    14 | ▁אלה            | ▁על          | ✗     |
|    15 | ▁תנאי           | ▁ידי         | ✗     |
|    16 | ▁הממשלה         | ▁מיסים       | ✗     |
|    17 | .               | ▁חדשים       | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ים              | <pad>        | ✗     |
|    33 | ם               | <pad>        | ✗     |
|    34 | ים              | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁אחרים          | <pad>        | ✗     |
|    39 | ה               | <pad>        | ✗     |
|    40 | יים             | <pad>        | ✗     |
|    41 | ▁המדינה         |              | ✗     |

2025-01-01 00:51:01,421 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:51:01,426 - TrainingLogger - INFO - Gradient norm: 8.9784
2025-01-01 00:51:08,592 - TrainingLogger - INFO - Step 46010, Batch metrics: Loss: 7.9843, Accuracy: 0.0506, Perplexity: 2934.6124
2025-01-01 00:51:15,746 - TrainingLogger - INFO - Step 46020, Batch metrics: Loss: 7.5838, Accuracy: 0.0844, Perplexity: 1965.9984
2025-01-01 00:51:22,675 - TrainingLogger - INFO - Step 46030, Batch metrics: Loss: 7.8903, Accuracy: 0.0621, Perplexity: 2671.2790
2025-01-01 00:51:29,769 - TrainingLogger - INFO - Step 46040, Batch metrics: Loss: 7.0806, Accuracy: 0.0621, Perplexity: 1188.6291
2025-01-01 00:51:36,815 - TrainingLogger - INFO - Step 46050, Batch metrics: Loss: 7.5499, Accuracy: 0.0855, Perplexity: 1900.4984
2025-01-01 00:51:44,151 - TrainingLogger - INFO - Step 46060, Batch metrics: Loss: 7.5088, Accuracy: 0.0621, Perplexity: 1824.0035
2025-01-01 00:51:51,386 - TrainingLogger - INFO - Step 46070, Batch metrics: Loss: 7.3870, Accuracy: 0.0938, Perplexity: 1614.8898
2025-01-01 00:51:59,109 - TrainingLogger - INFO - Step 46080, Batch metrics: Loss: 7.1670, Accuracy: 0.0680, Perplexity: 1295.9062
2025-01-01 00:52:06,082 - TrainingLogger - INFO - Step 46090, Batch metrics: Loss: 7.7056, Accuracy: 0.0927, Perplexity: 2220.6547
2025-01-01 00:52:13,451 - TrainingLogger - INFO - Step 46100, Batch metrics: Loss: 7.7560, Accuracy: 0.0640, Perplexity: 2335.4748
2025-01-01 00:52:13,452 - TrainingLogger - INFO - Step 46100, Prediction vs Actual:
2025-01-01 00:52:13,452 - TrainingLogger - INFO - Input 1: בטרם נמסרה תגובתה של לשכת רהמ לזעם המשפחות, גורמים בכירים בישראל אמרו כי אנחנו מחכים לתשובה סביב משא ומתן שהתנהל מאחורי הקלעים
2025-01-01 00:52:13,452 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:52:13,452 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁בטרם        | ✗     |
|     1 | ▁-              | ▁נמסר        | ✗     |
|     2 | ▁לי             | ה            | ✗     |
|     3 | ▁לי             | ▁תגובת       | ✗     |
|     4 | ו               | ה            | ✗     |
|     5 | ▁האחרונה        | ▁של          | ✗     |
|     6 | ▁המדינה         | ▁לשכת        | ✗     |
|     7 | ו               | ▁ר           | ✗     |
|     8 | אק              | המ           | ✗     |
|     9 | בורג            | ▁ל           | ✗     |
|    10 | רה              | זעם          | ✗     |
|    11 | ▁לא             | ▁המשפחות     | ✗     |
|    12 | ▁שלו            | ,            | ✗     |
|    13 | <pad>           | ▁גורמים      | ✗     |
|    14 | ▁אלה            | ▁בכיר        | ✗     |
|    15 | ים              | ים           | ✓     |
|    16 | ,               | ▁בישראל      | ✗     |
|    17 | ,               | ▁אמרו        | ✗     |
|    18 | ▁לי             | ▁כי          | ✗     |
|    19 | ▁הם             | ▁אנחנו       | ✗     |
|    20 | ▁לא             | ▁מחכים       | ✗     |
|    21 | ▁להם            | ▁לתשובה      | ✗     |
|    22 | .               | ▁סביב        | ✗     |
|    23 | ת               | ▁משא         | ✗     |
|    24 | ור              | ▁ומתן        | ✗     |
|    25 | ▁נוסף           | ▁שה          | ✗     |
|    26 | ות              | תנהל         | ✗     |
|    27 | ות              | ▁מאחורי      | ✗     |
|    28 | ה               | ▁הקלעים      | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ם               | <pad>        | ✗     |
|    32 | ות              | <pad>        | ✗     |
|    33 | יהם             | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ▁המדינה         |              | ✗     |

2025-01-01 00:52:13,452 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:52:13,457 - TrainingLogger - INFO - Gradient norm: 8.2248
2025-01-01 00:52:20,726 - TrainingLogger - INFO - Step 46110, Batch metrics: Loss: 7.3209, Accuracy: 0.0843, Perplexity: 1511.6170
2025-01-01 00:52:27,901 - TrainingLogger - INFO - Step 46120, Batch metrics: Loss: 8.1249, Accuracy: 0.0458, Perplexity: 3377.5845
2025-01-01 00:52:35,222 - TrainingLogger - INFO - Step 46130, Batch metrics: Loss: 7.1499, Accuracy: 0.0925, Perplexity: 1274.0362
2025-01-01 00:52:42,084 - TrainingLogger - INFO - Step 46140, Batch metrics: Loss: 7.5930, Accuracy: 0.1053, Perplexity: 1984.3197
2025-01-01 00:52:49,405 - TrainingLogger - INFO - Step 46150, Batch metrics: Loss: 7.7519, Accuracy: 0.0556, Perplexity: 2325.9625
2025-01-01 00:52:56,690 - TrainingLogger - INFO - Step 46160, Batch metrics: Loss: 7.7520, Accuracy: 0.0743, Perplexity: 2326.2199
2025-01-01 00:53:03,948 - TrainingLogger - INFO - Step 46170, Batch metrics: Loss: 7.5579, Accuracy: 0.0726, Perplexity: 1915.7540
2025-01-01 00:53:11,456 - TrainingLogger - INFO - Step 46180, Batch metrics: Loss: 8.2028, Accuracy: 0.0375, Perplexity: 3651.1585
2025-01-01 00:53:18,664 - TrainingLogger - INFO - Step 46190, Batch metrics: Loss: 7.7168, Accuracy: 0.0759, Perplexity: 2245.7685
2025-01-01 00:53:26,223 - TrainingLogger - INFO - Step 46200, Batch metrics: Loss: 6.8591, Accuracy: 0.0975, Perplexity: 952.4730
2025-01-01 00:53:26,224 - TrainingLogger - INFO - Step 46200, Prediction vs Actual:
2025-01-01 00:53:26,224 - TrainingLogger - INFO - Input 1: הציבור הערבי הפנים שאין לה השפעה על קבלת ההחלטות, וחרף 15 המנדטים שלה, היא לא מצליחה למנוע את חקיקה גזענית, הריסות הבתים נמשכות, הפשיעה מתעצמת ואיכות החיים מידרדרת
2025-01-01 00:53:26,224 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:53:26,224 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הציבור      | ✗     |
|     1 | ▁הוא            | ▁הערב        | ✗     |
|     2 | ▁-              | י            | ✗     |
|     3 | ▁הטוב           | ▁הפנים       | ✗     |
|     4 | ▁שלי            | ▁שאין        | ✗     |
|     5 | ▁לו             | ▁לה          | ✗     |
|     6 | ▁זמן            | ▁השפעה       | ✗     |
|     7 | ▁עליו           | ▁על          | ✗     |
|     8 | ▁העולם          | ▁קבלת        | ✗     |
|     9 | ▁הדין           | ▁ההחלטות     | ✗     |
|    10 | ▁היום           | ,            | ✗     |
|    11 | <pad>           | ▁ו           | ✗     |
|    12 | ...             | חרף          | ✗     |
|    13 | ▁זאת            | ▁15          | ✗     |
|    14 | ▁מיליון         | ▁המ          | ✗     |
|    15 | שאלות           | נדט          | ✗     |
|    16 | ים              | ים           | ✓     |
|    17 | ▁האחרונים       | ▁שלה         | ✗     |
|    18 | .               | ,            | ✗     |
|    19 | <pad>           | ▁היא         | ✗     |
|    20 | ▁לא             | ▁לא          | ✓     |
|    21 | ▁עונה           | ▁מצליחה      | ✗     |
|    22 | ▁להתמודד        | ▁למנוע       | ✗     |
|    23 | ▁ממנה           | ▁את          | ✗     |
|    24 | ▁זה             | ▁חק          | ✗     |
|    25 | יפות            | יקה          | ✗     |
|    26 | .               | ▁גזעני       | ✗     |
|    27 | ת               | ת            | ✓     |
|    28 | .               | ,            | ✗     |
|    29 | <pad>           | ▁הרי         | ✗     |
|    30 | ת               | סות          | ✗     |
|    31 | ה               | ▁הבתים       | ✗     |
|    32 | ▁שלה            | ▁נמשכו       | ✗     |
|    33 | ת               | ת            | ✓     |
|    34 | ▁עד             | ,            | ✗     |
|    35 | <pad>           | ▁ה           | ✗     |
|    36 | יק              | פש           | ✗     |
|    37 | יעה             | יעה          | ✓     |
|    38 | ▁הראשונה        | ▁מת          | ✗     |
|    39 | גלות            | עצמת         | ✗     |
|    40 | ם               | ▁ו           | ✗     |
|    41 | עידה            | איכות        | ✗     |
|    42 | ית              | ▁החיים       | ✗     |
|    43 | .               | ▁מי          | ✗     |
|    44 | ר               | דרדר         | ✗     |
|    45 | ת               | ת            | ✓     |
|    46 | ▁ל              |              | ✗     |

2025-01-01 00:53:26,225 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:53:26,230 - TrainingLogger - INFO - Gradient norm: 7.5830
2025-01-01 00:53:33,039 - TrainingLogger - INFO - Step 46210, Batch metrics: Loss: 7.6350, Accuracy: 0.0417, Perplexity: 2069.4406
2025-01-01 00:53:40,426 - TrainingLogger - INFO - Step 46220, Batch metrics: Loss: 7.8668, Accuracy: 0.0585, Perplexity: 2609.1053
2025-01-01 00:53:47,525 - TrainingLogger - INFO - Step 46230, Batch metrics: Loss: 7.6186, Accuracy: 0.0485, Perplexity: 2035.6556
2025-01-01 00:53:54,763 - TrainingLogger - INFO - Step 46240, Batch metrics: Loss: 7.1611, Accuracy: 0.1162, Perplexity: 1288.3555
2025-01-01 00:54:02,334 - TrainingLogger - INFO - Step 46250, Batch metrics: Loss: 7.5677, Accuracy: 0.0764, Perplexity: 1934.7129
2025-01-01 00:54:09,311 - TrainingLogger - INFO - Step 46260, Batch metrics: Loss: 7.5318, Accuracy: 0.0615, Perplexity: 1866.3718
2025-01-01 00:54:16,312 - TrainingLogger - INFO - Step 46270, Batch metrics: Loss: 7.2086, Accuracy: 0.0774, Perplexity: 1351.0466
2025-01-01 00:54:23,814 - TrainingLogger - INFO - Step 46280, Batch metrics: Loss: 7.1934, Accuracy: 0.0824, Perplexity: 1330.6220
2025-01-01 00:54:30,737 - TrainingLogger - INFO - Step 46290, Batch metrics: Loss: 7.2023, Accuracy: 0.0657, Perplexity: 1342.4568
2025-01-01 00:54:38,498 - TrainingLogger - INFO - Step 46300, Batch metrics: Loss: 7.9489, Accuracy: 0.0737, Perplexity: 2832.3353
2025-01-01 00:54:38,499 - TrainingLogger - INFO - Step 46300, Prediction vs Actual:
2025-01-01 00:54:38,499 - TrainingLogger - INFO - Input 1: כשנפתחו דלתות המטוס, אחרי הנחיתה במרוקו, נכנסו אליו שני גברים לבושים בהידור ושאלו איפה מסיה שיפר? ירדתי איתם מהמטוס בלי לעבור דרך ביקורת הגבולות
2025-01-01 00:54:38,499 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:54:38,499 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כש          | ✗     |
|     1 | ▁-              | נפתח         | ✗     |
|     2 | ▁-              | ו            | ✗     |
|     3 | ▁-              | ▁דלתות       | ✗     |
|     4 | ▁-              | ▁המטוס       | ✗     |
|     5 | ▁-              | ,            | ✗     |
|     6 | ▁אני            | ▁אחרי        | ✗     |
|     7 | ▁זה             | ▁הנחיתה      | ✗     |
|     8 | ▁-              | ▁במר         | ✗     |
|     9 | בית             | וקו          | ✗     |
|    10 | ,               | ,            | ✓     |
|    11 | ▁הוא            | ▁נכנסו       | ✗     |
|    12 | ▁לשם            | ▁אליו        | ✗     |
|    13 | .               | ▁שני         | ✗     |
|    14 | ▁אנשים          | ▁גברים       | ✗     |
|    15 | ,               | ▁לבושים      | ✗     |
|    16 | ▁כמו            | ▁בה          | ✗     |
|    17 | ת               | י            | ✗     |
|    18 | פר              | דור          | ✗     |
|    19 | ,               | ▁ושאל        | ✗     |
|    20 | ו               | ו            | ✓     |
|    21 | ▁אותם           | ▁איפה        | ✗     |
|    22 | ▁הוא            | ▁מס          | ✗     |
|    23 | ד               | יה           | ✗     |
|    24 | ם               | ▁שיפר        | ✗     |
|    25 | ו               | ?            | ✗     |
|    26 | ם               | ▁ירדתי       | ✗     |
|    27 | ▁מזה            | ▁איתם        | ✗     |
|    28 | .               | ▁מהמטוס      | ✗     |
|    29 | .               | ▁בלי         | ✗     |
|    30 | ▁הפסקה          | ▁לעבור       | ✗     |
|    31 | .               | ▁דרך         | ✗     |
|    32 | ▁הדלת           | ▁ביקורת      | ✗     |
|    33 | .               | ▁הגבולות     | ✗     |
|    34 | .               |              | ✗     |

2025-01-01 00:54:38,500 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:54:38,505 - TrainingLogger - INFO - Gradient norm: 8.0319
2025-01-01 00:54:45,633 - TrainingLogger - INFO - Step 46310, Batch metrics: Loss: 7.8486, Accuracy: 0.0964, Perplexity: 2562.0700
2025-01-01 00:54:52,730 - TrainingLogger - INFO - Step 46320, Batch metrics: Loss: 7.1677, Accuracy: 0.0714, Perplexity: 1296.8674
2025-01-01 00:54:59,887 - TrainingLogger - INFO - Step 46330, Batch metrics: Loss: 7.7488, Accuracy: 0.0486, Perplexity: 2318.8231
2025-01-01 00:55:06,813 - TrainingLogger - INFO - Step 46340, Batch metrics: Loss: 7.7734, Accuracy: 0.0466, Perplexity: 2376.5227
2025-01-01 00:55:14,012 - TrainingLogger - INFO - Step 46350, Batch metrics: Loss: 7.2731, Accuracy: 0.0592, Perplexity: 1441.0490
2025-01-01 00:55:21,552 - TrainingLogger - INFO - Step 46360, Batch metrics: Loss: 7.6330, Accuracy: 0.1111, Perplexity: 2065.2274
2025-01-01 00:55:28,776 - TrainingLogger - INFO - Step 46370, Batch metrics: Loss: 7.4991, Accuracy: 0.0541, Perplexity: 1806.3293
2025-01-01 00:55:35,958 - TrainingLogger - INFO - Step 46380, Batch metrics: Loss: 7.4974, Accuracy: 0.0849, Perplexity: 1803.2793
2025-01-01 00:55:43,436 - TrainingLogger - INFO - Step 46390, Batch metrics: Loss: 7.7813, Accuracy: 0.0844, Perplexity: 2395.5000
2025-01-01 00:55:50,251 - TrainingLogger - INFO - Step 46400, Batch metrics: Loss: 7.6630, Accuracy: 0.1012, Perplexity: 2128.1700
2025-01-01 00:55:50,251 - TrainingLogger - INFO - Step 46400, Prediction vs Actual:
2025-01-01 00:55:50,251 - TrainingLogger - INFO - Input 1: הוא עדיין מתייחס לעצמו כראש ממשלה? לא
2025-01-01 00:55:50,252 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:55:50,252 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הוא         | ✗     |
|     1 | ▁הוא            | ▁עדיין       | ✗     |
|     2 | ▁לא             | ▁מתייחס      | ✗     |
|     3 | ▁לזה            | ▁לעצמו       | ✗     |
|     4 | </s>            | ▁כראש        | ✗     |
|     5 | ▁שלו            | ▁ממשלה       | ✗     |
|     6 | </s>            | ?            | ✗     |
|     7 | </s>            | ▁לא          | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁זה             | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2025-01-01 00:55:50,252 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:55:50,257 - TrainingLogger - INFO - Gradient norm: 10.9321
2025-01-01 00:55:57,451 - TrainingLogger - INFO - Step 46410, Batch metrics: Loss: 6.9211, Accuracy: 0.1190, Perplexity: 1013.3860
2025-01-01 00:56:04,797 - TrainingLogger - INFO - Step 46420, Batch metrics: Loss: 7.8255, Accuracy: 0.0443, Perplexity: 2503.7176
2025-01-01 00:56:12,006 - TrainingLogger - INFO - Step 46430, Batch metrics: Loss: 7.1135, Accuracy: 0.1024, Perplexity: 1228.3858
2025-01-01 00:56:19,056 - TrainingLogger - INFO - Step 46440, Batch metrics: Loss: 7.2285, Accuracy: 0.0963, Perplexity: 1378.1720
2025-01-01 00:56:26,271 - TrainingLogger - INFO - Step 46450, Batch metrics: Loss: 7.9669, Accuracy: 0.0648, Perplexity: 2883.8824
2025-01-01 00:56:33,105 - TrainingLogger - INFO - Step 46460, Batch metrics: Loss: 7.5118, Accuracy: 0.0778, Perplexity: 1829.4999
2025-01-01 00:56:40,219 - TrainingLogger - INFO - Step 46470, Batch metrics: Loss: 7.4189, Accuracy: 0.0690, Perplexity: 1667.2670
2025-01-01 00:56:47,834 - TrainingLogger - INFO - Step 46480, Batch metrics: Loss: 7.1201, Accuracy: 0.0988, Perplexity: 1236.5252
2025-01-01 00:56:54,704 - TrainingLogger - INFO - Step 46490, Batch metrics: Loss: 7.7190, Accuracy: 0.0933, Perplexity: 2250.6506
2025-01-01 00:57:01,559 - TrainingLogger - INFO - Step 46500, Batch metrics: Loss: 7.5537, Accuracy: 0.0860, Perplexity: 1907.7339
2025-01-01 00:57:01,560 - TrainingLogger - INFO - Step 46500, Prediction vs Actual:
2025-01-01 00:57:01,560 - TrainingLogger - INFO - Input 1: הוא פנה לשר הביטחון יואב גלנט אתה שותק כבר 11 שבועות, הריכוך הוא לא ריכוך, הכול זה ספין הכול שקרים
2025-01-01 00:57:01,560 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:57:01,560 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁הוא         | ✗     |
|     1 | ▁-              | ▁פנה         | ✗     |
|     2 | ▁-              | ▁לשר         | ✗     |
|     3 | ▁-              | ▁הביטחון     | ✗     |
|     4 | ▁הלאומי         | ▁יואב        | ✗     |
|     5 | .               | ▁גל          | ✗     |
|     6 | אוס             | נט           | ✗     |
|     7 | .               | ▁אתה         | ✗     |
|     8 | ▁יודע           | ▁שותק        | ✗     |
|     9 | .               | ▁כבר         | ✗     |
|    10 | ת               | ▁11          | ✗     |
|    11 | ▁שנים           | ▁שבועות      | ✗     |
|    12 | ,               | ,            | ✓     |
|    13 | ▁לא             | ▁הר          | ✗     |
|    14 | פ               | יכוך         | ✗     |
|    15 | .               | ▁הוא         | ✗     |
|    16 | ▁לא             | ▁לא          | ✓     |
|    17 | ▁הוגן           | ▁ר           | ✗     |
|    18 | ה               | יכוך         | ✗     |
|    19 | ▁אותי           | ,            | ✗     |
|    20 | ▁הוא            | ▁הכול        | ✗     |
|    21 | ▁היה            | ▁זה          | ✗     |
|    22 | ▁לא             | ▁ספי         | ✗     |
|    23 | ק               | ן            | ✗     |
|    24 | .               | ▁הכול        | ✗     |
|    25 | .               | ▁שקרים       | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | נס              | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2025-01-01 00:57:01,561 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:57:01,565 - TrainingLogger - INFO - Gradient norm: 10.2666
2025-01-01 00:57:09,287 - TrainingLogger - INFO - Step 46510, Batch metrics: Loss: 7.3478, Accuracy: 0.0995, Perplexity: 1552.8096
2025-01-01 00:57:16,746 - TrainingLogger - INFO - Step 46520, Batch metrics: Loss: 7.3451, Accuracy: 0.0918, Perplexity: 1548.5890
2025-01-01 00:57:24,132 - TrainingLogger - INFO - Step 46530, Batch metrics: Loss: 7.4785, Accuracy: 0.0506, Perplexity: 1769.5420
2025-01-01 00:57:30,952 - TrainingLogger - INFO - Step 46540, Batch metrics: Loss: 7.2441, Accuracy: 0.0701, Perplexity: 1399.8637
2025-01-01 00:57:37,874 - TrainingLogger - INFO - Step 46550, Batch metrics: Loss: 7.4861, Accuracy: 0.0520, Perplexity: 1783.1367
2025-01-01 00:57:45,389 - TrainingLogger - INFO - Step 46560, Batch metrics: Loss: 7.2533, Accuracy: 0.0809, Perplexity: 1412.7400
2025-01-01 00:57:52,338 - TrainingLogger - INFO - Step 46570, Batch metrics: Loss: 7.6110, Accuracy: 0.0851, Perplexity: 2020.3813
2025-01-01 00:57:59,960 - TrainingLogger - INFO - Step 46580, Batch metrics: Loss: 7.4266, Accuracy: 0.0672, Perplexity: 1680.0887
2025-01-01 00:58:06,694 - TrainingLogger - INFO - Step 46590, Batch metrics: Loss: 7.6772, Accuracy: 0.0929, Perplexity: 2158.4785
2025-01-01 00:58:13,267 - TrainingLogger - INFO - Step 46600, Batch metrics: Loss: 7.8453, Accuracy: 0.0915, Perplexity: 2553.6116
2025-01-01 00:58:13,268 - TrainingLogger - INFO - Step 46600, Prediction vs Actual:
2025-01-01 00:58:13,268 - TrainingLogger - INFO - Input 1: הכוכב הבאצילום אוהד רומנו עוד מוסיף ספקטור בתביעתו כי הוא פנה לטמירה ירדני בעלת טדי הפקות, רב והציע לה רעיון לפורמט טלוויזיוני חדש בשם המשוררים
2025-01-01 00:58:13,268 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:58:13,268 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁הכוכב       | ✗     |
|     1 | ▁הזה            | ▁הבא         | ✗     |
|     2 | ▁לא             | צילום        | ✗     |
|     3 | .               | ▁אוהד        | ✗     |
|     4 | :               | ▁רומ         | ✗     |
|     5 | ה               | נו           | ✗     |
|     6 | ב               | ▁עוד         | ✗     |
|     7 | ▁אחד            | ▁מוסיף       | ✗     |
|     8 | :               | ▁ספק         | ✗     |
|     9 | .               | טור          | ✗     |
|    10 | ה               | ▁בת          | ✗     |
|    11 | עוד             | ביע          | ✗     |
|    12 | ת               | תו           | ✗     |
|    13 | ▁של             | ▁כי          | ✗     |
|    14 | ▁הוא            | ▁הוא         | ✓     |
|    15 | ▁לא             | ▁פנה         | ✗     |
|    16 | ▁אליו           | ▁לט          | ✗     |
|    17 | מי              | מירה         | ✗     |
|    18 | ▁זו             | ▁ירד         | ✗     |
|    19 | ת               | ני           | ✗     |
|    20 | ר               | ▁בעלת        | ✗     |
|    21 | ון              | ▁טדי         | ✗     |
|    22 | ונות            | ▁הפק         | ✗     |
|    23 | ה               | ות           | ✗     |
|    24 | ▁רבים           | ,            | ✗     |
|    25 | </s>            | ▁רב          | ✗     |
|    26 | נו              | ▁והציע       | ✗     |
|    27 | ו               | ▁לה          | ✗     |
|    28 | מש              | ▁רעיון       | ✗     |
|    29 | ▁חדש            | ▁ל           | ✗     |
|    30 | סקר             | פורמט        | ✗     |
|    31 | ▁זה             | ▁טל          | ✗     |
|    32 | וויזי           | וויזי        | ✓     |
|    33 | וני             | וני          | ✓     |
|    34 | ▁חדש            | ▁חדש         | ✓     |
|    35 | נית             | ▁בשם         | ✗     |
|    36 | ▁"              | ▁המשורר      | ✗     |
|    37 | ים              | ים           | ✓     |
|    38 | .               |              | ✗     |

2025-01-01 00:58:13,268 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:58:13,273 - TrainingLogger - INFO - Gradient norm: 8.6694
2025-01-01 00:58:20,551 - TrainingLogger - INFO - Step 46610, Batch metrics: Loss: 7.3871, Accuracy: 0.0588, Perplexity: 1615.0261
2025-01-01 00:58:27,745 - TrainingLogger - INFO - Step 46620, Batch metrics: Loss: 7.3198, Accuracy: 0.0968, Perplexity: 1509.9025
2025-01-01 00:58:34,318 - TrainingLogger - INFO - Step 46630, Batch metrics: Loss: 7.4696, Accuracy: 0.0757, Perplexity: 1753.9187
2025-01-01 00:58:41,192 - TrainingLogger - INFO - Step 46640, Batch metrics: Loss: 7.3445, Accuracy: 0.0933, Perplexity: 1547.7378
2025-01-01 00:58:48,252 - TrainingLogger - INFO - Step 46650, Batch metrics: Loss: 7.6312, Accuracy: 0.0936, Perplexity: 2061.6223
2025-01-01 00:58:55,547 - TrainingLogger - INFO - Step 46660, Batch metrics: Loss: 7.1087, Accuracy: 0.0762, Perplexity: 1222.5225
2025-01-01 00:59:02,619 - TrainingLogger - INFO - Step 46670, Batch metrics: Loss: 7.1990, Accuracy: 0.1136, Perplexity: 1338.1046
2025-01-01 00:59:09,783 - TrainingLogger - INFO - Step 46680, Batch metrics: Loss: 7.6617, Accuracy: 0.0759, Perplexity: 2125.3751
2025-01-01 00:59:17,349 - TrainingLogger - INFO - Step 46690, Batch metrics: Loss: 6.7699, Accuracy: 0.1358, Perplexity: 871.2250
2025-01-01 00:59:24,363 - TrainingLogger - INFO - Step 46700, Batch metrics: Loss: 7.4408, Accuracy: 0.0719, Perplexity: 1704.0938
2025-01-01 00:59:24,363 - TrainingLogger - INFO - Step 46700, Prediction vs Actual:
2025-01-01 00:59:24,363 - TrainingLogger - INFO - Input 1: מתיקי שוחד נגד ביבי יצאה הפרת אמונים
2025-01-01 00:59:24,364 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 00:59:24,364 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁מתי         | ✗     |
|     1 | ▁הוא            | קי           | ✗     |
|     2 | נו              | ▁שוחד        | ✗     |
|     3 | ▁-              | ▁נגד         | ✗     |
|     4 | ▁-              | ▁בי          | ✗     |
|     5 | שוב             | בי           | ✗     |
|     6 | ,               | ▁יצאה        | ✗     |
|     7 | ▁לאור           | ▁הפרת        | ✗     |
|     8 | י               | ▁אמונים      | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ות              | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ,               |              | ✗     |

2025-01-01 00:59:24,364 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 00:59:24,369 - TrainingLogger - INFO - Gradient norm: 9.6986
2025-01-01 00:59:31,829 - TrainingLogger - INFO - Step 46710, Batch metrics: Loss: 7.6359, Accuracy: 0.0437, Perplexity: 2071.1534
2025-01-01 00:59:38,713 - TrainingLogger - INFO - Step 46720, Batch metrics: Loss: 7.6535, Accuracy: 0.0726, Perplexity: 2108.1094
2025-01-01 00:59:46,022 - TrainingLogger - INFO - Step 46730, Batch metrics: Loss: 7.5184, Accuracy: 0.0882, Perplexity: 1841.6916
2025-01-01 00:59:53,098 - TrainingLogger - INFO - Step 46740, Batch metrics: Loss: 7.1181, Accuracy: 0.0752, Perplexity: 1234.1266
2025-01-01 01:00:00,421 - TrainingLogger - INFO - Step 46750, Batch metrics: Loss: 7.1339, Accuracy: 0.0855, Perplexity: 1253.8171
2025-01-01 01:00:07,758 - TrainingLogger - INFO - Step 46760, Batch metrics: Loss: 7.6462, Accuracy: 0.0743, Perplexity: 2092.6108
2025-01-01 01:00:14,769 - TrainingLogger - INFO - Step 46770, Batch metrics: Loss: 7.2010, Accuracy: 0.0611, Perplexity: 1340.7143
2025-01-01 01:00:22,286 - TrainingLogger - INFO - Step 46780, Batch metrics: Loss: 7.2109, Accuracy: 0.0915, Perplexity: 1354.1489
2025-01-01 01:00:29,595 - TrainingLogger - INFO - Step 46790, Batch metrics: Loss: 7.4710, Accuracy: 0.0464, Perplexity: 1756.4429
2025-01-01 01:00:36,576 - TrainingLogger - INFO - Step 46800, Batch metrics: Loss: 7.3364, Accuracy: 0.0681, Perplexity: 1535.1712
2025-01-01 01:00:36,576 - TrainingLogger - INFO - Step 46800, Prediction vs Actual:
2025-01-01 01:00:36,576 - TrainingLogger - INFO - Input 1: עם זאת, טרם נקבע תאריך ממשי לפריימריז
2025-01-01 01:00:36,577 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:00:36,577 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁עם          | ✗     |
|     1 | ▁-              | ▁זאת         | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | ▁זה             | ▁טר          | ✗     |
|     4 | ם               | ם            | ✓     |
|     5 | .               | ▁נקבע        | ✗     |
|     6 | ה               | ▁תאריך       | ✗     |
|     7 | .               | ▁ממש         | ✗     |
|     8 | .               | י            | ✗     |
|     9 | .               | ▁לפר         | ✗     |
|    10 | פור             | יימר         | ✗     |
|    11 | .               | יז           | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ב               | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ▁עד             | <pad>        | ✗     |
|    21 | ▁העבודה         | <pad>        | ✗     |
|    22 | ▁חדש            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁חדש            | <pad>        | ✗     |
|    25 | ▁חדש            | <pad>        | ✗     |
|    26 | ▁חדש            | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁חדש            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | ▁חדש            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | .               | <pad>        | ✗     |
|    40 | ▁עד             | <pad>        | ✗     |
|    41 | ▁חדש            | <pad>        | ✗     |
|    42 | ▁חדש            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | .               | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | :               | <pad>        | ✗     |
|    48 | </s>            |              | ✗     |

2025-01-01 01:00:36,577 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:00:36,582 - TrainingLogger - INFO - Gradient norm: 9.0683
2025-01-01 01:00:43,807 - TrainingLogger - INFO - Step 46810, Batch metrics: Loss: 7.6579, Accuracy: 0.0722, Perplexity: 2117.3626
2025-01-01 01:00:50,771 - TrainingLogger - INFO - Step 46820, Batch metrics: Loss: 7.4878, Accuracy: 0.0909, Perplexity: 1786.0904
2025-01-01 01:00:57,799 - TrainingLogger - INFO - Step 46830, Batch metrics: Loss: 7.6973, Accuracy: 0.0729, Perplexity: 2202.3818
2025-01-01 01:01:04,739 - TrainingLogger - INFO - Step 46840, Batch metrics: Loss: 7.7569, Accuracy: 0.0548, Perplexity: 2337.7455
2025-01-01 01:01:11,998 - TrainingLogger - INFO - Step 46850, Batch metrics: Loss: 7.1824, Accuracy: 0.0787, Perplexity: 1316.1085
2025-01-01 01:01:19,086 - TrainingLogger - INFO - Step 46860, Batch metrics: Loss: 7.5756, Accuracy: 0.0773, Perplexity: 1949.9902
2025-01-01 01:01:26,369 - TrainingLogger - INFO - Step 46870, Batch metrics: Loss: 7.1828, Accuracy: 0.0843, Perplexity: 1316.5265
2025-01-01 01:01:33,503 - TrainingLogger - INFO - Step 46880, Batch metrics: Loss: 7.3030, Accuracy: 0.0529, Perplexity: 1484.7538
2025-01-01 01:01:40,856 - TrainingLogger - INFO - Step 46890, Batch metrics: Loss: 7.3876, Accuracy: 0.0736, Perplexity: 1615.8396
2025-01-01 01:01:47,667 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 179200
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 179200

2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 25]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 25]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 28]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_2 min: 13, max: 151643
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 28]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 26]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 26]), device: cuda:0
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:01:47,668 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:01:49,067 - TrainingLogger - INFO - Step 46900, Batch metrics: Loss: 7.2549, Accuracy: 0.0874, Perplexity: 1415.0700
2025-01-01 01:01:49,068 - TrainingLogger - INFO - Step 46900, Prediction vs Actual:
2025-01-01 01:01:49,068 - TrainingLogger - INFO - Input 1: זה לא סוד, אני נפגשתי עם רהמ וראשי ההתיישבות השבוע, רהמ שיתף אותם שעדיין אין הסכמה ואין הבנה מה בעצם המתווה שהולכים עליו
2025-01-01 01:01:49,068 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:01:49,068 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁זה          | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ▁-              | ▁סוד         | ✗     |
|     3 | ר               | ,            | ✗     |
|     4 | ▁נכון           | ▁אני         | ✗     |
|     5 | ▁לא             | ▁נפגשתי      | ✗     |
|     6 | ▁עם             | ▁עם          | ✓     |
|     7 | ▁מישהו          | ▁ר           | ✗     |
|     8 | ן               | המ           | ✗     |
|     9 | אס              | ▁וראש        | ✗     |
|    10 | ▁שלי            | י            | ✗     |
|    11 | .               | ▁ה           | ✗     |
|    12 | "               | התיישב       | ✗     |
|    13 | ות              | ות           | ✓     |
|    14 | ▁שלהם           | ▁השבוע       | ✗     |
|    15 | ה               | ,            | ✗     |
|    16 | </s>            | ▁ר           | ✗     |
|    17 | ה               | המ           | ✗     |
|    18 | אס              | ▁שית         | ✗     |
|    19 | ף               | ף            | ✓     |
|    20 | ▁אותי           | ▁אותם        | ✗     |
|    21 | ▁שוב            | ▁שעדיין      | ✗     |
|    22 | ▁לא             | ▁אין         | ✗     |
|    23 | ▁להם            | ▁הסכמה       | ✗     |
|    24 | <pad>           | ▁ואין        | ✗     |
|    25 | ▁להם            | ▁הבנה        | ✗     |
|    26 | .               | ▁מה          | ✗     |
|    27 | ▁לעשות          | ▁בעצם        | ✗     |
|    28 | י               | ▁המת         | ✗     |
|    29 | מקד             | ווה          | ✗     |
|    30 | ם               | ▁שהולכים     | ✗     |
|    31 | ▁אליהם          | ▁עליו        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               |              | ✗     |

2025-01-01 01:01:49,068 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:01:49,073 - TrainingLogger - INFO - Gradient norm: 7.9126
2025-01-01 01:01:56,140 - TrainingLogger - INFO - Step 46910, Batch metrics: Loss: 7.7257, Accuracy: 0.0483, Perplexity: 2265.7417
2025-01-01 01:02:03,440 - TrainingLogger - INFO - Step 46920, Batch metrics: Loss: 7.7680, Accuracy: 0.0904, Perplexity: 2363.7687
2025-01-01 01:02:10,388 - TrainingLogger - INFO - Step 46930, Batch metrics: Loss: 7.5794, Accuracy: 0.0779, Perplexity: 1957.4011
2025-01-01 01:02:17,580 - TrainingLogger - INFO - Step 46940, Batch metrics: Loss: 7.3341, Accuracy: 0.0856, Perplexity: 1531.6432
2025-01-01 01:02:24,926 - TrainingLogger - INFO - Step 46950, Batch metrics: Loss: 7.1271, Accuracy: 0.1042, Perplexity: 1245.2248
2025-01-01 01:02:32,441 - TrainingLogger - INFO - Step 46960, Batch metrics: Loss: 7.2213, Accuracy: 0.0837, Perplexity: 1368.3014
2025-01-01 01:02:40,224 - TrainingLogger - INFO - Step 46970, Batch metrics: Loss: 7.5868, Accuracy: 0.0625, Perplexity: 1972.0609
2025-01-01 01:02:47,327 - TrainingLogger - INFO - Step 46980, Batch metrics: Loss: 7.6222, Accuracy: 0.0600, Perplexity: 2043.0909
2025-01-01 01:02:54,639 - TrainingLogger - INFO - Step 46990, Batch metrics: Loss: 7.6359, Accuracy: 0.0788, Perplexity: 2071.2670
2025-01-01 01:03:02,128 - TrainingLogger - INFO - Step 47000, Batch metrics: Loss: 7.7819, Accuracy: 0.0865, Perplexity: 2396.7591
2025-01-01 01:03:02,128 - TrainingLogger - INFO - Step 47000, Prediction vs Actual:
2025-01-01 01:03:02,128 - TrainingLogger - INFO - Input 1: אעשה את המיטב, נתגבר על כך
2025-01-01 01:03:02,129 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:03:02,129 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | א               | ▁אעשה        | ✗     |
|     1 | כם              | ▁את          | ✗     |
|     2 | ו               | ▁המיטב       | ✗     |
|     3 | י               | ,            | ✗     |
|     4 | </s>            | ▁נת          | ✗     |
|     5 | יר              | גבר          | ✗     |
|     6 | ▁על             | ▁על          | ✓     |
|     7 | ▁המצב           | ▁כך          | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ר               | <pad>        | ✗     |
|    14 | ה               | <pad>        | ✗     |
|    15 | ה               | <pad>        | ✗     |
|    16 | יות             | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ום              | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ר               | <pad>        | ✗     |
|    22 | ▁עלינו          | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | ר               | <pad>        | ✗     |
|    25 | יות             | <pad>        | ✗     |
|    26 | יות             | <pad>        | ✗     |
|    27 | ▁על             | <pad>        | ✗     |
|    28 | יות             | <pad>        | ✗     |
|    29 | ▁עצמו           | <pad>        | ✗     |
|    30 | יות             | <pad>        | ✗     |
|    31 | ים              | <pad>        | ✗     |
|    32 | ר               | <pad>        | ✗     |
|    33 | ▁על             | <pad>        | ✗     |
|    34 | ר               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁על             | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | ▁על             | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ▁על             | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | ▁על             | <pad>        | ✗     |
|    48 | ▁על             | <pad>        | ✗     |
|    49 | ▁על             |              | ✗     |

2025-01-01 01:03:02,129 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:03:02,134 - TrainingLogger - INFO - Gradient norm: 12.2897
2025-01-01 01:03:09,175 - TrainingLogger - INFO - Step 47010, Batch metrics: Loss: 7.5591, Accuracy: 0.0747, Perplexity: 1918.1955
2025-01-01 01:03:16,165 - TrainingLogger - INFO - Step 47020, Batch metrics: Loss: 7.4958, Accuracy: 0.0677, Perplexity: 1800.5204
2025-01-01 01:03:23,470 - TrainingLogger - INFO - Step 47030, Batch metrics: Loss: 7.4101, Accuracy: 0.0693, Perplexity: 1652.5734
2025-01-01 01:03:30,500 - TrainingLogger - INFO - Step 47040, Batch metrics: Loss: 7.2641, Accuracy: 0.0842, Perplexity: 1428.1639
2025-01-01 01:03:37,878 - TrainingLogger - INFO - Step 47050, Batch metrics: Loss: 7.4433, Accuracy: 0.0838, Perplexity: 1708.3969
2025-01-01 01:03:45,479 - TrainingLogger - INFO - Step 47060, Batch metrics: Loss: 7.6222, Accuracy: 0.0773, Perplexity: 2043.0188
2025-01-01 01:03:52,401 - TrainingLogger - INFO - Step 47070, Batch metrics: Loss: 7.1518, Accuracy: 0.0848, Perplexity: 1276.3724
2025-01-01 01:03:59,889 - TrainingLogger - INFO - Step 47080, Batch metrics: Loss: 8.1297, Accuracy: 0.0500, Perplexity: 3393.9421
2025-01-01 01:04:07,398 - TrainingLogger - INFO - Step 47090, Batch metrics: Loss: 7.1834, Accuracy: 0.0833, Perplexity: 1317.3404
2025-01-01 01:04:14,920 - TrainingLogger - INFO - Step 47100, Batch metrics: Loss: 7.7552, Accuracy: 0.0593, Perplexity: 2333.7036
2025-01-01 01:04:14,920 - TrainingLogger - INFO - Step 47100, Prediction vs Actual:
2025-01-01 01:04:14,920 - TrainingLogger - INFO - Input 1: חצי מהקבינט שלו איבד אמון בנתניהו, ושלא נדבר על רוב מוחלט של אזרחי מדינת ישראל
2025-01-01 01:04:14,921 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:04:14,921 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁חצי         | ✗     |
|     1 | ▁-              | ▁מה          | ✗     |
|     2 | ?               | ק            | ✗     |
|     3 | ?               | בי           | ✗     |
|     4 | נט              | נט           | ✓     |
|     5 | ים              | ▁שלו         | ✗     |
|     6 | ?               | ▁איבד        | ✗     |
|     7 | ▁את             | ▁אמון        | ✗     |
|     8 | .               | ▁בנ          | ✗     |
|     9 | רות             | תני          | ✗     |
|    10 | ו               | הו           | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | ▁הוא            | ▁ושלא        | ✗     |
|    13 | ▁נראה           | ▁נדבר        | ✗     |
|    14 | ▁על             | ▁על          | ✓     |
|    15 | ▁זה             | ▁רוב         | ✗     |
|    16 | ו               | ▁מוחלט       | ✗     |
|    17 | ,               | ▁של          | ✗     |
|    18 | ▁אנשים          | ▁אזרחי       | ✗     |
|    19 | ▁המדינה         | ▁מדינת       | ✗     |
|    20 | ▁ישראל          | ▁ישראל       | ✓     |
|    21 | .               |              | ✗     |

2025-01-01 01:04:14,921 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:04:14,926 - TrainingLogger - INFO - Gradient norm: 9.4912
2025-01-01 01:04:21,933 - TrainingLogger - INFO - Step 47110, Batch metrics: Loss: 6.8250, Accuracy: 0.1328, Perplexity: 920.5938
2025-01-01 01:04:29,551 - TrainingLogger - INFO - Step 47120, Batch metrics: Loss: 7.6520, Accuracy: 0.0926, Perplexity: 2104.9182
2025-01-01 01:04:36,812 - TrainingLogger - INFO - Step 47130, Batch metrics: Loss: 7.2354, Accuracy: 0.0459, Perplexity: 1387.6511
2025-01-01 01:04:44,219 - TrainingLogger - INFO - Step 47140, Batch metrics: Loss: 7.5839, Accuracy: 0.0481, Perplexity: 1966.2112
2025-01-01 01:04:51,253 - TrainingLogger - INFO - Step 47150, Batch metrics: Loss: 8.0192, Accuracy: 0.0479, Perplexity: 3038.7319
2025-01-01 01:04:58,388 - TrainingLogger - INFO - Step 47160, Batch metrics: Loss: 7.7731, Accuracy: 0.0566, Perplexity: 2375.7295
2025-01-01 01:05:05,641 - TrainingLogger - INFO - Step 47170, Batch metrics: Loss: 7.1230, Accuracy: 0.0899, Perplexity: 1240.1578
2025-01-01 01:05:12,830 - TrainingLogger - INFO - Step 47180, Batch metrics: Loss: 7.7174, Accuracy: 0.0629, Perplexity: 2247.0389
2025-01-01 01:05:20,097 - TrainingLogger - INFO - Step 47190, Batch metrics: Loss: 7.3372, Accuracy: 0.0874, Perplexity: 1536.4520
2025-01-01 01:05:27,066 - TrainingLogger - INFO - Step 47200, Batch metrics: Loss: 7.2348, Accuracy: 0.0800, Perplexity: 1386.7965
2025-01-01 01:05:27,066 - TrainingLogger - INFO - Step 47200, Prediction vs Actual:
2025-01-01 01:05:27,066 - TrainingLogger - INFO - Input 1: כך מסר הגורם המשפטי לסוכנות הידיעות הצרפתית
2025-01-01 01:05:27,066 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:05:27,066 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁כך          | ✗     |
|     1 | ▁כל             | ▁מסר         | ✗     |
|     2 | ▁-              | ▁הגורם       | ✗     |
|     3 | ▁לכך            | ▁המשפט       | ✗     |
|     4 | י               | י            | ✓     |
|     5 | ▁הזה            | ▁לסוכנות     | ✗     |
|     6 | ▁זו             | ▁היד         | ✗     |
|     7 | נית             | י            | ✗     |
|     8 | ונית            | עות          | ✗     |
|     9 | ▁שלנו           | ▁הצרפתית     | ✗     |
|    10 | ▁שלנו           | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | ות              | <pad>        | ✗     |
|    14 | יות             | <pad>        | ✗     |
|    15 | יות             | <pad>        | ✗     |
|    16 | ית              | <pad>        | ✗     |
|    17 | יות             | <pad>        | ✗     |
|    18 | ות              | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ות              | <pad>        | ✗     |
|    21 | יות             | <pad>        | ✗     |
|    22 | ות              | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | ות              | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ה               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ה               |              | ✗     |

2025-01-01 01:05:27,066 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:05:27,071 - TrainingLogger - INFO - Gradient norm: 9.1921
2025-01-01 01:05:34,612 - TrainingLogger - INFO - Step 47210, Batch metrics: Loss: 7.5532, Accuracy: 0.0815, Perplexity: 1906.9108
2025-01-01 01:05:41,966 - TrainingLogger - INFO - Step 47220, Batch metrics: Loss: 7.7741, Accuracy: 0.0667, Perplexity: 2378.1743
2025-01-01 01:05:49,091 - TrainingLogger - INFO - Step 47230, Batch metrics: Loss: 8.0653, Accuracy: 0.0473, Perplexity: 3182.0409
2025-01-01 01:05:56,389 - TrainingLogger - INFO - Step 47240, Batch metrics: Loss: 7.5462, Accuracy: 0.0735, Perplexity: 1893.4745
2025-01-01 01:06:03,136 - TrainingLogger - INFO - Step 47250, Batch metrics: Loss: 7.5944, Accuracy: 0.0867, Perplexity: 1987.0390
2025-01-01 01:06:10,002 - TrainingLogger - INFO - Step 47260, Batch metrics: Loss: 7.8619, Accuracy: 0.0645, Perplexity: 2596.4795
2025-01-01 01:06:17,544 - TrainingLogger - INFO - Step 47270, Batch metrics: Loss: 7.3264, Accuracy: 0.0936, Perplexity: 1519.8659
2025-01-01 01:06:24,618 - TrainingLogger - INFO - Step 47280, Batch metrics: Loss: 7.0794, Accuracy: 0.1261, Perplexity: 1187.2719
2025-01-01 01:06:31,530 - TrainingLogger - INFO - Step 47290, Batch metrics: Loss: 7.0860, Accuracy: 0.0864, Perplexity: 1195.0710
2025-01-01 01:06:37,450 - TrainingLogger - ERROR - Error during forward pass: CUDA out of memory. Tried to allocate 64.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 33.00 MiB is free. Including non-PyTorch memory, this process has 15.66 GiB memory in use. Of the allocated memory 14.68 GiB is allocated by PyTorch, and 737.96 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-01-01 01:06:37,450 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 175, in forward
    x = self.custom_encoder2(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 769, in forward
    layer_outputs = encoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 303, in forward
    hidden_states, attn_weights, _ = self.self_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 218, in forward
    attn_weights = attn_weights.view(bsz, self.num_heads, tgt_len, src_len) + attention_mask
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 33.00 MiB is free. Including non-PyTorch memory, this process has 15.66 GiB memory in use. Of the allocated memory 14.68 GiB is allocated by PyTorch, and 737.96 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-01-01 01:06:37,450 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([8, 510]), device: cuda:0
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - input_ids_2 min: 6, max: 151643
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([8, 510]), device: cuda:0
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:06:37,453 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:06:37,454 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 01:06:37,454 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:06:37,454 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:06:37,454 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:06:40,804 - TrainingLogger - INFO - Step 47300, Batch metrics: Loss: 8.1759, Accuracy: 0.0588, Perplexity: 3554.1251
2025-01-01 01:06:40,804 - TrainingLogger - INFO - Step 47300, Prediction vs Actual:
2025-01-01 01:06:40,804 - TrainingLogger - INFO - Input 1: בעקבות כך נאלץ ראש הממשלה בנימין נתניהו לפטר אותו מהממשלה
2025-01-01 01:06:40,804 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:06:40,804 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בעקבות      | ✗     |
|     1 | ▁-              | ▁כך          | ✗     |
|     2 | ▁-              | ▁            | ✗     |
|     3 | ▁-              | נאלץ         | ✗     |
|     4 | ▁לעשות          | ▁ראש         | ✗     |
|     5 | ▁בראש           | ▁הממשלה      | ✗     |
|     6 | :               | ▁בני         | ✗     |
|     7 | חוש             | מין          | ✗     |
|     8 | ▁זה             | ▁נתנ         | ✗     |
|     9 | ת               | יהו          | ✗     |
|    10 | סקי             | ▁לפטר        | ✗     |
|    11 | ▁אותו           | ▁אותו        | ✓     |
|    12 | .               | ▁מ           | ✗     |
|    13 | מקומות          | הממשלה       | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ה               | <pad>        | ✗     |
|    16 | ה               | <pad>        | ✗     |
|    17 | ▁               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ▁לא             | <pad>        | ✗     |
|    20 | <pad>           | <pad>        | ✓     |
|    21 | ה               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ה               |              | ✗     |

2025-01-01 01:06:40,804 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:06:40,809 - TrainingLogger - INFO - Gradient norm: 10.7152
2025-01-01 01:06:47,874 - TrainingLogger - INFO - Step 47310, Batch metrics: Loss: 7.4240, Accuracy: 0.0710, Perplexity: 1675.6763
2025-01-01 01:06:55,110 - TrainingLogger - INFO - Step 47320, Batch metrics: Loss: 7.8122, Accuracy: 0.0654, Perplexity: 2470.4668
2025-01-01 01:07:01,979 - TrainingLogger - INFO - Step 47330, Batch metrics: Loss: 8.0241, Accuracy: 0.0989, Perplexity: 3053.6203
2025-01-01 01:07:09,220 - TrainingLogger - INFO - Step 47340, Batch metrics: Loss: 7.5994, Accuracy: 0.0815, Perplexity: 1996.9098
2025-01-01 01:07:16,290 - TrainingLogger - INFO - Step 47350, Batch metrics: Loss: 6.8902, Accuracy: 0.0915, Perplexity: 982.5915
2025-01-01 01:07:23,016 - TrainingLogger - INFO - Step 47360, Batch metrics: Loss: 7.5616, Accuracy: 0.1119, Perplexity: 1922.9174
2025-01-01 01:07:30,799 - TrainingLogger - INFO - Step 47370, Batch metrics: Loss: 7.4610, Accuracy: 0.0669, Perplexity: 1738.9233
2025-01-01 01:07:37,779 - TrainingLogger - INFO - Step 47380, Batch metrics: Loss: 7.0751, Accuracy: 0.0933, Perplexity: 1182.1363
2025-01-01 01:07:44,507 - TrainingLogger - INFO - Step 47390, Batch metrics: Loss: 7.5668, Accuracy: 0.0584, Perplexity: 1932.9636
2025-01-01 01:07:51,943 - TrainingLogger - INFO - Step 47400, Batch metrics: Loss: 7.3292, Accuracy: 0.0798, Perplexity: 1524.2365
2025-01-01 01:07:51,944 - TrainingLogger - INFO - Step 47400, Prediction vs Actual:
2025-01-01 01:07:51,944 - TrainingLogger - INFO - Input 1: אם לא היינו נמצאים בעימות עם העולם הערבי, ומאיימים במהלכים שאני שמח שכרגע שמנו בצד, אז אפשר לשנות
2025-01-01 01:07:51,944 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:07:51,944 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אם          | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ▁-              | ▁היינו       | ✗     |
|     3 | ▁צריכים         | ▁נמצאים      | ✗     |
|     4 | ▁-              | ▁ב           | ✗     |
|     5 | ים              | עימות        | ✗     |
|     6 | ים              | ▁עם          | ✗     |
|     7 | ▁זה             | ▁העולם       | ✗     |
|     8 | ▁הזה            | ▁הערב        | ✗     |
|     9 | ון              | י            | ✗     |
|    10 | .               | ,            | ✗     |
|    11 | <pad>           | ▁ומ          | ✗     |
|    12 | יש              | איי          | ✗     |
|    13 | ם               | מים          | ✗     |
|    14 | ▁לו             | ▁במה         | ✗     |
|    15 | ם               | ל            | ✗     |
|    16 | כים             | כים          | ✓     |
|    17 | ▁אלה            | ▁שאני        | ✗     |
|    18 | ▁לא             | ▁שמח         | ✗     |
|    19 | ▁לקבל           | ▁שכרגע       | ✗     |
|    20 | ▁לא             | ▁שמנו        | ✗     |
|    21 | ,               | ▁בצד         | ✗     |
|    22 | ▁שלהם           | ,            | ✗     |
|    23 | </s>            | ▁אז          | ✗     |
|    24 | ▁הם             | ▁אפשר        | ✗     |
|    25 | ▁להם            | ▁לשנות       | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | ▁את             | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁זה             | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁את             | <pad>        | ✗     |
|    33 | .               |              | ✗     |

2025-01-01 01:07:51,944 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:07:51,949 - TrainingLogger - INFO - Gradient norm: 8.0567
2025-01-01 01:07:59,339 - TrainingLogger - INFO - Step 47410, Batch metrics: Loss: 7.4150, Accuracy: 0.0630, Perplexity: 1660.7645
2025-01-01 01:08:06,282 - TrainingLogger - INFO - Step 47420, Batch metrics: Loss: 7.3038, Accuracy: 0.0938, Perplexity: 1485.8913
2025-01-01 01:08:13,542 - TrainingLogger - INFO - Step 47430, Batch metrics: Loss: 7.8405, Accuracy: 0.0493, Perplexity: 2541.4955
2025-01-01 01:08:20,643 - TrainingLogger - INFO - Step 47440, Batch metrics: Loss: 7.4538, Accuracy: 0.0688, Perplexity: 1726.4699
2025-01-01 01:08:27,742 - TrainingLogger - INFO - Step 47450, Batch metrics: Loss: 7.6313, Accuracy: 0.0615, Perplexity: 2061.7442
2025-01-01 01:08:35,524 - TrainingLogger - INFO - Step 47460, Batch metrics: Loss: 7.7755, Accuracy: 0.0776, Perplexity: 2381.4868
2025-01-01 01:08:42,707 - TrainingLogger - INFO - Step 47470, Batch metrics: Loss: 6.8282, Accuracy: 0.1192, Perplexity: 923.5238
2025-01-01 01:08:50,024 - TrainingLogger - INFO - Step 47480, Batch metrics: Loss: 7.6900, Accuracy: 0.0651, Perplexity: 2186.3007
2025-01-01 01:08:57,431 - TrainingLogger - INFO - Step 47490, Batch metrics: Loss: 7.0661, Accuracy: 0.0851, Perplexity: 1171.5254
2025-01-01 01:09:04,635 - TrainingLogger - INFO - Step 47500, Batch metrics: Loss: 7.3853, Accuracy: 0.0719, Perplexity: 1612.1193
2025-01-01 01:09:04,636 - TrainingLogger - INFO - Step 47500, Prediction vs Actual:
2025-01-01 01:09:04,636 - TrainingLogger - INFO - Input 1: מכונני המדינה היהודית רצו בבניית מוקד אינטלקטואלי ומדעי עולמי כאנשים פרקטיים, הם גם שמחו בהצלחת העוזי
2025-01-01 01:09:04,636 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:09:04,636 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁מ           | ✗     |
|     1 | ▁-              | כו           | ✗     |
|     2 | ד               | נני          | ✗     |
|     3 | ו               | ▁המדינה      | ✗     |
|     4 | :               | ▁היהודית     | ✗     |
|     5 | ▁של             | ▁רצו         | ✗     |
|     6 | ד               | ▁בבניית      | ✗     |
|     7 | ם               | ▁מוקד        | ✗     |
|     8 | ים              | ▁אינטלקטואלי | ✗     |
|     9 | ,               | ▁ו           | ✗     |
|    10 | חשמל            | מדע          | ✗     |
|    11 | ים              | י            | ✗     |
|    12 | ▁המדינה         | ▁עולמי       | ✗     |
|    13 | ה               | ▁כאנשים      | ✗     |
|    14 | ▁בעלי           | ▁פרק         | ✗     |
|    15 | יים             | טיים         | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | </s>            | ▁הם          | ✗     |
|    18 | ▁אמרו           | ▁גם          | ✗     |
|    19 | ▁עשו            | ▁שמח         | ✗     |
|    20 | ו               | ו            | ✓     |
|    21 | ▁בכך            | ▁ב           | ✗     |
|    22 | מתן             | הצלחת        | ✗     |
|    23 | ם               | ▁העו         | ✗     |
|    24 | קץ              | זי           | ✗     |
|    25 | ה               |              | ✗     |

2025-01-01 01:09:04,636 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:09:04,641 - TrainingLogger - INFO - Gradient norm: 9.5278
2025-01-01 01:09:11,693 - TrainingLogger - INFO - Step 47510, Batch metrics: Loss: 7.2512, Accuracy: 0.0506, Perplexity: 1409.8496
2025-01-01 01:09:18,475 - TrainingLogger - INFO - Step 47520, Batch metrics: Loss: 7.5408, Accuracy: 0.0611, Perplexity: 1883.3578
2025-01-01 01:09:25,708 - TrainingLogger - INFO - Step 47530, Batch metrics: Loss: 8.0990, Accuracy: 0.0759, Perplexity: 3291.1344
2025-01-01 01:09:33,221 - TrainingLogger - INFO - Step 47540, Batch metrics: Loss: 7.2699, Accuracy: 0.0897, Perplexity: 1436.4675
2025-01-01 01:09:40,585 - TrainingLogger - INFO - Step 47550, Batch metrics: Loss: 7.4966, Accuracy: 0.0853, Perplexity: 1801.9539
2025-01-01 01:09:47,616 - TrainingLogger - INFO - Step 47560, Batch metrics: Loss: 7.4822, Accuracy: 0.0853, Perplexity: 1776.2010
2025-01-01 01:09:54,837 - TrainingLogger - INFO - Step 47570, Batch metrics: Loss: 7.6820, Accuracy: 0.0743, Perplexity: 2168.9268
2025-01-01 01:10:02,232 - TrainingLogger - INFO - Step 47580, Batch metrics: Loss: 7.4552, Accuracy: 0.0840, Perplexity: 1728.7847
2025-01-01 01:10:09,450 - TrainingLogger - INFO - Step 47590, Batch metrics: Loss: 7.7101, Accuracy: 0.0664, Perplexity: 2230.7944
2025-01-01 01:10:17,096 - TrainingLogger - INFO - Step 47600, Batch metrics: Loss: 7.8053, Accuracy: 0.0815, Perplexity: 2453.6704
2025-01-01 01:10:17,096 - TrainingLogger - INFO - Step 47600, Prediction vs Actual:
2025-01-01 01:10:17,096 - TrainingLogger - INFO - Input 1: צריך לקיים דיונים בבתי המשפט בשקט
2025-01-01 01:10:17,097 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:10:17,097 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁צריך        | ✗     |
|     1 | </s>            | ▁לקיים       | ✗     |
|     2 | ▁עם             | ▁די          | ✗     |
|     3 | ה               | ונים         | ✗     |
|     4 | ▁חדשים          | ▁בבתי        | ✗     |
|     5 | ▁המשפט          | ▁המשפט       | ✓     |
|     6 | </s>            | ▁בשקט        | ✗     |
|     7 | </s>            | <pad>        | ✗     |
|     8 | </s>            | <pad>        | ✗     |
|     9 | </s>            | <pad>        | ✗     |
|    10 | </s>            | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | </s>            | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | </s>            |              | ✗     |

2025-01-01 01:10:17,097 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:10:17,102 - TrainingLogger - INFO - Gradient norm: 8.7751
2025-01-01 01:10:24,195 - TrainingLogger - INFO - Step 47610, Batch metrics: Loss: 7.4123, Accuracy: 0.0895, Perplexity: 1656.2275
2025-01-01 01:10:30,730 - TrainingLogger - INFO - Step 47620, Batch metrics: Loss: 7.4967, Accuracy: 0.0265, Perplexity: 1802.0132
2025-01-01 01:10:37,624 - TrainingLogger - INFO - Step 47630, Batch metrics: Loss: 7.3210, Accuracy: 0.0722, Perplexity: 1511.7093
2025-01-01 01:10:45,616 - TrainingLogger - INFO - Step 47640, Batch metrics: Loss: 6.9680, Accuracy: 0.0885, Perplexity: 1062.0614
2025-01-01 01:10:52,308 - TrainingLogger - INFO - Step 47650, Batch metrics: Loss: 7.6168, Accuracy: 0.0776, Perplexity: 2031.9703
2025-01-01 01:10:59,428 - TrainingLogger - INFO - Step 47660, Batch metrics: Loss: 7.7835, Accuracy: 0.0325, Perplexity: 2400.5736
2025-01-01 01:11:06,658 - TrainingLogger - INFO - Step 47670, Batch metrics: Loss: 7.9748, Accuracy: 0.0867, Perplexity: 2906.7061
2025-01-01 01:11:13,603 - TrainingLogger - INFO - Step 47680, Batch metrics: Loss: 7.8864, Accuracy: 0.0376, Perplexity: 2660.7480
2025-01-01 01:11:20,920 - TrainingLogger - INFO - Step 47690, Batch metrics: Loss: 6.9709, Accuracy: 0.0872, Perplexity: 1065.2125
2025-01-01 01:11:28,338 - TrainingLogger - INFO - Step 47700, Batch metrics: Loss: 7.2458, Accuracy: 0.0857, Perplexity: 1402.1832
2025-01-01 01:11:28,338 - TrainingLogger - INFO - Step 47700, Prediction vs Actual:
2025-01-01 01:11:28,338 - TrainingLogger - INFO - Input 1: יש עודף ביקוש אל מול ההיצע, בעיקר בצפון ולכן הם יכולים להשתבץ בדרום
2025-01-01 01:11:28,339 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:11:28,339 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁יש          | ✗     |
|     1 | ▁-              | ▁עודף        | ✗     |
|     2 | ▁כסף            | ▁            | ✗     |
|     3 | ▁-              | ביקוש        | ✗     |
|     4 | ▁זה             | ▁אל          | ✗     |
|     5 | -               | ▁מול         | ✗     |
|     6 | ▁כל             | ▁ההי         | ✗     |
|     7 | ר               | צע           | ✗     |
|     8 | ים              | ,            | ✗     |
|     9 | ▁אבל            | ▁בעיקר       | ✗     |
|    10 | ו               | ▁בצפון       | ✗     |
|    11 | ▁המדינה         | ▁ולכן        | ✗     |
|    12 | ,               | ▁הם          | ✗     |
|    13 | ▁לא             | ▁יכולים      | ✗     |
|    14 | ▁להיות          | ▁להשת        | ✗     |
|    15 | גר              | בץ           | ✗     |
|    16 | .               | ▁בדרום       | ✗     |
|    17 | ▁אפריקה         | <pad>        | ✗     |
|    18 | ▁אפריקה         | <pad>        | ✗     |
|    19 | ▁המדינה         | <pad>        | ✗     |
|    20 | ▁               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ▁המדינה         | <pad>        | ✗     |
|    23 | ▁ל              | <pad>        | ✗     |
|    24 | ▁עם             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ▁העיר           | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | .               | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | ▁אל             | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               |              | ✗     |

2025-01-01 01:11:28,339 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:11:28,344 - TrainingLogger - INFO - Gradient norm: 9.6584
2025-01-01 01:11:35,488 - TrainingLogger - INFO - Step 47710, Batch metrics: Loss: 7.4487, Accuracy: 0.0904, Perplexity: 1717.5763
2025-01-01 01:11:43,086 - TrainingLogger - INFO - Step 47720, Batch metrics: Loss: 7.5989, Accuracy: 0.1011, Perplexity: 1995.9150
2025-01-01 01:11:50,385 - TrainingLogger - INFO - Step 47730, Batch metrics: Loss: 7.1851, Accuracy: 0.1491, Perplexity: 1319.6729
2025-01-01 01:11:57,182 - TrainingLogger - INFO - Step 47740, Batch metrics: Loss: 7.3119, Accuracy: 0.0909, Perplexity: 1497.9859
2025-01-01 01:12:04,120 - TrainingLogger - INFO - Step 47750, Batch metrics: Loss: 7.5606, Accuracy: 0.0670, Perplexity: 1920.9818
2025-01-01 01:12:11,400 - TrainingLogger - INFO - Step 47760, Batch metrics: Loss: 8.0345, Accuracy: 0.0403, Perplexity: 3085.5519
2025-01-01 01:12:18,407 - TrainingLogger - INFO - Step 47770, Batch metrics: Loss: 7.8501, Accuracy: 0.0809, Perplexity: 2565.9690
2025-01-01 01:12:25,578 - TrainingLogger - INFO - Step 47780, Batch metrics: Loss: 8.0880, Accuracy: 0.0682, Perplexity: 3255.1624
2025-01-01 01:12:33,227 - TrainingLogger - INFO - Step 47790, Batch metrics: Loss: 7.4129, Accuracy: 0.0409, Perplexity: 1657.3004
2025-01-01 01:12:40,057 - TrainingLogger - INFO - Step 47800, Batch metrics: Loss: 7.6186, Accuracy: 0.0750, Perplexity: 2035.7526
2025-01-01 01:12:40,057 - TrainingLogger - INFO - Step 47800, Prediction vs Actual:
2025-01-01 01:12:40,057 - TrainingLogger - INFO - Input 1: על פניו, אפשר לומר שקטאר היא המדינה שהכי מחוברת לרעים
2025-01-01 01:12:40,057 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:12:40,057 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁על          | ✗     |
|     1 | ▁-              | ▁פניו        | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | ▁זה             | ▁אפשר        | ✗     |
|     4 | ▁לומר           | ▁לומר        | ✓     |
|     5 | ,               | ▁שקט         | ✗     |
|     6 | .               | אר           | ✗     |
|     7 | ה               | ▁היא         | ✗     |
|     8 | ▁לא             | ▁המדינה      | ✗     |
|     9 | ▁היחידה         | ▁שהכי        | ✗     |
|    10 | ▁טובה           | ▁מחוברת      | ✗     |
|    11 | ▁ל              | ▁לרע         | ✗     |
|    12 | ות              | ים           | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | יים             | <pad>        | ✗     |
|    16 | תה              | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁המדינה         | <pad>        | ✗     |
|    22 | ים              | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ▁המדינה         | <pad>        | ✗     |
|    25 | ▁המדינה         | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁המדינה         | <pad>        | ✗     |
|    28 | ▁ב              | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ▁המדינה         | <pad>        | ✗     |
|    31 | ▁המדינה         | <pad>        | ✗     |
|    32 | ▁המדינה         | <pad>        | ✗     |
|    33 | ▁של             |              | ✗     |

2025-01-01 01:12:40,057 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:12:40,062 - TrainingLogger - INFO - Gradient norm: 8.4989
2025-01-01 01:12:47,279 - TrainingLogger - INFO - Step 47810, Batch metrics: Loss: 7.4677, Accuracy: 0.0797, Perplexity: 1750.5974
2025-01-01 01:12:54,236 - TrainingLogger - INFO - Step 47820, Batch metrics: Loss: 7.8479, Accuracy: 0.0704, Perplexity: 2560.3248
2025-01-01 01:13:01,262 - TrainingLogger - INFO - Step 47830, Batch metrics: Loss: 7.3314, Accuracy: 0.0714, Perplexity: 1527.4997
2025-01-01 01:13:07,803 - TrainingLogger - INFO - Step 47840, Batch metrics: Loss: 7.6452, Accuracy: 0.0577, Perplexity: 2090.5672
2025-01-01 01:13:14,981 - TrainingLogger - INFO - Step 47850, Batch metrics: Loss: 7.2558, Accuracy: 0.1097, Perplexity: 1416.2466
2025-01-01 01:13:22,149 - TrainingLogger - INFO - Step 47860, Batch metrics: Loss: 7.2577, Accuracy: 0.0848, Perplexity: 1418.9579
2025-01-01 01:13:28,920 - TrainingLogger - INFO - Step 47870, Batch metrics: Loss: 7.7148, Accuracy: 0.0424, Perplexity: 2241.3459
2025-01-01 01:13:36,591 - TrainingLogger - INFO - Step 47880, Batch metrics: Loss: 7.4307, Accuracy: 0.0946, Perplexity: 1686.9073
2025-01-01 01:13:43,844 - TrainingLogger - INFO - Step 47890, Batch metrics: Loss: 7.3015, Accuracy: 0.0802, Perplexity: 1482.5706
2025-01-01 01:13:51,024 - TrainingLogger - INFO - Step 47900, Batch metrics: Loss: 7.1958, Accuracy: 0.1049, Perplexity: 1333.7690
2025-01-01 01:13:51,025 - TrainingLogger - INFO - Step 47900, Prediction vs Actual:
2025-01-01 01:13:51,025 - TrainingLogger - INFO - Input 1: נצביע נגד הניסיון לדחות את התקציב מ-25 לאוגוסט, כי מה שמדינת ישראל זקוקה לו זה תקציב ולא דחיות, אמר ליברמן
2025-01-01 01:13:51,025 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:13:51,025 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הזה            | ▁נ           | ✗     |
|     1 | ▁ד              | צביע         | ✗     |
|     2 | ▁               | ▁נגד         | ✗     |
|     3 | ▁-              | ▁הניסיון     | ✗     |
|     4 | .               | ▁לדחות       | ✗     |
|     5 | ▁את             | ▁את          | ✓     |
|     6 | ▁זה             | ▁התקציב      | ✗     |
|     7 | .               | ▁מ           | ✗     |
|     8 | ובה             | -25          | ✗     |
|     9 | ▁ל              | ▁ל           | ✓     |
|    10 | ִ               | אוגוסט       | ✗     |
|    11 | .               | ,            | ✗     |
|    12 | ▁נכון           | ▁כי          | ✗     |
|    13 | ▁אנחנו          | ▁מה          | ✗     |
|    14 | ▁לעשות          | ▁ש           | ✗     |
|    15 | הופך            | מדינת        | ✗     |
|    16 | נו              | ▁ישראל       | ✗     |
|    17 | ,               | ▁זקוקה       | ✗     |
|    18 | ▁לו             | ▁לו          | ✓     |
|    19 | .               | ▁זה          | ✗     |
|    20 | ה               | ▁תקציב       | ✗     |
|    21 | ▁טוב            | ▁ולא         | ✗     |
|    22 | ▁יותר           | ▁ד           | ✗     |
|    23 | מה              | חיות         | ✗     |
|    24 | .               | ,            | ✗     |
|    25 | <pad>           | ▁אמר         | ✗     |
|    26 | ▁לי             | ▁לי          | ✓     |
|    27 | :               | ברמן         | ✗     |
|    28 | :               | <pad>        | ✗     |
|    29 | י               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ה               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | :               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            |              | ✗     |

2025-01-01 01:13:51,025 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:13:51,030 - TrainingLogger - INFO - Gradient norm: 7.1669
2025-01-01 01:13:58,604 - TrainingLogger - INFO - Step 47910, Batch metrics: Loss: 7.5101, Accuracy: 0.0700, Perplexity: 1826.4055
2025-01-01 01:14:05,439 - TrainingLogger - INFO - Step 47920, Batch metrics: Loss: 7.3510, Accuracy: 0.0691, Perplexity: 1557.7295
2025-01-01 01:14:11,836 - TrainingLogger - INFO - Step 47930, Batch metrics: Loss: 7.7725, Accuracy: 0.0684, Perplexity: 2374.4656
2025-01-01 01:14:19,080 - TrainingLogger - INFO - Step 47940, Batch metrics: Loss: 6.9454, Accuracy: 0.0972, Perplexity: 1038.3769
2025-01-01 01:14:26,262 - TrainingLogger - INFO - Step 47950, Batch metrics: Loss: 7.5296, Accuracy: 0.0706, Perplexity: 1862.2763
2025-01-01 01:14:32,838 - TrainingLogger - INFO - Step 47960, Batch metrics: Loss: 7.2652, Accuracy: 0.0878, Perplexity: 1429.7310
2025-01-01 01:14:39,780 - TrainingLogger - INFO - Step 47970, Batch metrics: Loss: 7.7950, Accuracy: 0.0550, Perplexity: 2428.3740
2025-01-01 01:14:46,401 - TrainingLogger - INFO - Step 47980, Batch metrics: Loss: 7.7055, Accuracy: 0.1049, Perplexity: 2220.5075
2025-01-01 01:14:53,093 - TrainingLogger - INFO - Step 47990, Batch metrics: Loss: 6.9742, Accuracy: 0.0985, Perplexity: 1068.6736
2025-01-01 01:15:00,092 - TrainingLogger - INFO - Step 48000, Batch metrics: Loss: 7.4498, Accuracy: 0.1136, Perplexity: 1719.5979
2025-01-01 01:15:00,092 - TrainingLogger - INFO - Step 48000, Prediction vs Actual:
2025-01-01 01:15:00,092 - TrainingLogger - INFO - Input 1: את ראשי האופוזיציה מציעים לשים באזיקים, לצידו של היועמש לשעבר אביחי מנדלבליט
2025-01-01 01:15:00,093 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:15:00,093 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ם               | ▁את          | ✗     |
|     1 | ▁הוא            | ▁ראשי        | ✗     |
|     2 | ם               | ▁האו         | ✗     |
|     3 | ,               | פוז          | ✗     |
|     4 | י               | י            | ✓     |
|     5 | אני             | ציה          | ✗     |
|     6 | .               | ▁מציעים      | ✗     |
|     7 | ▁לו             | ▁לשים        | ✗     |
|     8 | ▁לב             | ▁באזיקים     | ✗     |
|     9 | <pad>           | ,            | ✗     |
|    10 | <pad>           | ▁לצידו       | ✗     |
|    11 | ▁של             | ▁של          | ✓     |
|    12 | ▁בית            | ▁היו         | ✗     |
|    13 | רים             | ע            | ✗     |
|    14 | ▁האחרון         | מש           | ✗     |
|    15 | .               | ▁לשעבר       | ✗     |
|    16 | .               | ▁אבי         | ✗     |
|    17 | ר               | חי           | ✗     |
|    18 | .               | ▁מנד         | ✗     |
|    19 | ואר             | לב           | ✗     |
|    20 | ו               | ליט          | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | י               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | י               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2025-01-01 01:15:00,093 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:15:00,098 - TrainingLogger - INFO - Gradient norm: 8.7144
2025-01-01 01:15:07,682 - TrainingLogger - INFO - Step 48010, Batch metrics: Loss: 7.4624, Accuracy: 0.1050, Perplexity: 1741.2972
2025-01-01 01:15:14,496 - TrainingLogger - INFO - Step 48020, Batch metrics: Loss: 7.2781, Accuracy: 0.0794, Perplexity: 1448.1813
2025-01-01 01:15:21,751 - TrainingLogger - INFO - Step 48030, Batch metrics: Loss: 7.6889, Accuracy: 0.0664, Perplexity: 2183.8865
2025-01-01 01:15:28,433 - TrainingLogger - INFO - Step 48040, Batch metrics: Loss: 7.3742, Accuracy: 0.1045, Perplexity: 1594.3385
2025-01-01 01:15:35,697 - TrainingLogger - INFO - Step 48050, Batch metrics: Loss: 7.3125, Accuracy: 0.0847, Perplexity: 1498.9191
2025-01-01 01:15:42,306 - TrainingLogger - INFO - Step 48060, Batch metrics: Loss: 7.5066, Accuracy: 0.0654, Perplexity: 1820.0686
2025-01-01 01:15:49,393 - TrainingLogger - INFO - Step 48070, Batch metrics: Loss: 7.2787, Accuracy: 0.0710, Perplexity: 1449.1083
2025-01-01 01:15:56,566 - TrainingLogger - INFO - Step 48080, Batch metrics: Loss: 7.7664, Accuracy: 0.0556, Perplexity: 2359.9238
2025-01-01 01:16:03,789 - TrainingLogger - INFO - Step 48090, Batch metrics: Loss: 7.1323, Accuracy: 0.0662, Perplexity: 1251.8123
2025-01-01 01:16:10,871 - TrainingLogger - INFO - Step 48100, Batch metrics: Loss: 6.9989, Accuracy: 0.1043, Perplexity: 1095.3789
2025-01-01 01:16:10,871 - TrainingLogger - INFO - Step 48100, Prediction vs Actual:
2025-01-01 01:16:10,871 - TrainingLogger - INFO - Input 1: רק רצינו להגיד חשוב לנו האבחון כל יום, ולכל דבר ביום יום של ילדה ללא פתרון
2025-01-01 01:16:10,871 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:16:10,871 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁רק          | ✗     |
|     1 | </s>            | ▁רצינו       | ✗     |
|     2 | ▁-              | ▁להגיד       | ✗     |
|     3 | ▁את             | ▁חשוב        | ✗     |
|     4 | ▁יותר           | ▁לנו         | ✗     |
|     5 | .               | ▁ה           | ✗     |
|     6 | המשך            | אבחון        | ✗     |
|     7 | ▁הזה            | ▁כל          | ✗     |
|     8 | ▁כך             | ▁יום         | ✗     |
|     9 | .               | ,            | ✗     |
|    10 | ▁לא             | ▁ולכל        | ✗     |
|    11 | ▁אחד            | ▁דבר         | ✗     |
|    12 | ▁אחר            | ▁ביום        | ✗     |
|    13 | ▁שעבר           | ▁יום         | ✗     |
|    14 | ▁אחר            | ▁של          | ✗     |
|    15 | ▁היום           | ▁ילדה        | ✗     |
|    16 | ▁אחרת           | ▁ללא         | ✗     |
|    17 | ▁עבודה          | ▁פתרון       | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁זה             | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | ▁זה             | <pad>        | ✗     |
|    27 | ▁זה             | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | </s>            |              | ✗     |

2025-01-01 01:16:10,871 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:16:10,876 - TrainingLogger - INFO - Gradient norm: 9.1288
2025-01-01 01:16:18,049 - TrainingLogger - INFO - Step 48110, Batch metrics: Loss: 6.8044, Accuracy: 0.0898, Perplexity: 901.7644
2025-01-01 01:16:25,784 - TrainingLogger - INFO - Step 48120, Batch metrics: Loss: 7.4362, Accuracy: 0.0762, Perplexity: 1696.2446
2025-01-01 01:16:32,497 - TrainingLogger - INFO - Step 48130, Batch metrics: Loss: 7.5205, Accuracy: 0.0673, Perplexity: 1845.5667
2025-01-01 01:16:39,786 - TrainingLogger - INFO - Step 48140, Batch metrics: Loss: 7.1784, Accuracy: 0.0960, Perplexity: 1310.8306
2025-01-01 01:16:47,299 - TrainingLogger - INFO - Step 48150, Batch metrics: Loss: 7.4000, Accuracy: 0.0510, Perplexity: 1636.0306
2025-01-01 01:16:54,554 - TrainingLogger - INFO - Step 48160, Batch metrics: Loss: 7.3665, Accuracy: 0.0942, Perplexity: 1582.0316
2025-01-01 01:17:01,861 - TrainingLogger - INFO - Step 48170, Batch metrics: Loss: 7.5714, Accuracy: 0.0828, Perplexity: 1941.7786
2025-01-01 01:17:09,605 - TrainingLogger - INFO - Step 48180, Batch metrics: Loss: 7.1247, Accuracy: 0.0732, Perplexity: 1242.3081
2025-01-01 01:17:16,618 - TrainingLogger - INFO - Step 48190, Batch metrics: Loss: 7.2322, Accuracy: 0.0939, Perplexity: 1383.2065
2025-01-01 01:17:24,121 - TrainingLogger - INFO - Step 48200, Batch metrics: Loss: 7.5075, Accuracy: 0.0924, Perplexity: 1821.6505
2025-01-01 01:17:24,122 - TrainingLogger - INFO - Step 48200, Prediction vs Actual:
2025-01-01 01:17:24,122 - TrainingLogger - INFO - Input 1: בכיר בקרן החירום של האום לילדים UNICEF הזהיר כי כעת, מוצרים חיוניים כמו מזון ותרופות הולכים ואוזלים באופן מסוכן, וההתפתחויות האחרונות במלחמה מאיימות להחמיר את המשבר ההומניטרי החמור ממילא
2025-01-01 01:17:24,123 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:17:24,123 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁בכיר        | ✗     |
|     1 | ▁-              | ▁ב           | ✗     |
|     2 | ▁-              | קרן          | ✗     |
|     3 | ▁-              | ▁החירום      | ✗     |
|     4 | ▁-              | ▁של          | ✗     |
|     5 | ▁המשפחה         | ▁האו         | ✗     |
|     6 | "               | ם            | ✗     |
|     7 | ,               | ▁לילדים      | ✗     |
|     8 | ▁אחרים          | ▁            | ✗     |
|     9 | טכנולוגי        | UN           | ✗     |
|    10 | D               | I            | ✗     |
|    11 | 1               | CE           | ✗     |
|    12 | F               | F            | ✓     |
|    13 | נט              | ▁הזהיר       | ✗     |
|    14 | ו               | ▁כי          | ✗     |
|    15 | ון              | ▁כעת         | ✗     |
|    16 | ▁הם             | ,            | ✗     |
|    17 | <pad>           | ▁מוצרים      | ✗     |
|    18 | ▁חדשים          | ▁חיוניים     | ✗     |
|    19 | ▁מאוד           | ▁כמו         | ✗     |
|    20 | ▁זה             | ▁מזון        | ✗     |
|    21 | ▁צבאי           | ▁ו           | ✗     |
|    22 | תרופות          | תרופות       | ✓     |
|    23 | ,               | ▁הולכים      | ✗     |
|    24 | ▁יחד            | ▁ואוזל       | ✗     |
|    25 | ים              | ים           | ✓     |
|    26 | ,               | ▁באופן       | ✗     |
|    27 | ▁קבוע           | ▁מסוכן       | ✗     |
|    28 | ,               | ,            | ✓     |
|    29 | <pad>           | ▁וה          | ✗     |
|    30 | ה               | התפתחויות    | ✗     |
|    31 | ▁שלהם           | ▁האחרונות    | ✗     |
|    32 | ▁שלנו           | ▁במלחמה      | ✗     |
|    33 | ,               | ▁מאי         | ✗     |
|    34 | ימות            | ימות         | ✓     |
|    35 | .               | ▁להחמיר      | ✗     |
|    36 | ות              | ▁את          | ✗     |
|    37 | ▁המצב           | ▁המשבר       | ✗     |
|    38 | ים              | ▁הה          | ✗     |
|    39 | חל              | ומני         | ✗     |
|    40 | טרי             | טרי          | ✓     |
|    41 | ת               | ▁החמור       | ✗     |
|    42 | ה               | ▁ממילא       | ✗     |
|    43 | .               | <pad>        | ✗     |
|    44 | .               | <pad>        | ✗     |
|    45 | ו               | <pad>        | ✗     |
|    46 | ות              |              | ✗     |

2025-01-01 01:17:24,123 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:17:24,128 - TrainingLogger - INFO - Gradient norm: 9.8617
2025-01-01 01:17:31,746 - TrainingLogger - INFO - Step 48210, Batch metrics: Loss: 7.5017, Accuracy: 0.0704, Perplexity: 1811.1298
2025-01-01 01:17:39,504 - TrainingLogger - INFO - Step 48220, Batch metrics: Loss: 7.2652, Accuracy: 0.0833, Perplexity: 1429.6970
2025-01-01 01:17:46,428 - TrainingLogger - INFO - Step 48230, Batch metrics: Loss: 7.8053, Accuracy: 0.0615, Perplexity: 2453.4843
2025-01-01 01:17:53,932 - TrainingLogger - INFO - Step 48240, Batch metrics: Loss: 7.4997, Accuracy: 0.0941, Perplexity: 1807.5761
2025-01-01 01:18:00,829 - TrainingLogger - INFO - Step 48250, Batch metrics: Loss: 7.8871, Accuracy: 0.0777, Perplexity: 2662.7470
2025-01-01 01:18:08,046 - TrainingLogger - INFO - Step 48260, Batch metrics: Loss: 7.2584, Accuracy: 0.1176, Perplexity: 1420.0274
2025-01-01 01:18:14,984 - TrainingLogger - INFO - Step 48270, Batch metrics: Loss: 7.1982, Accuracy: 0.0754, Perplexity: 1337.0267
2025-01-01 01:18:22,493 - TrainingLogger - INFO - Step 48280, Batch metrics: Loss: 7.5813, Accuracy: 0.0905, Perplexity: 1961.1334
2025-01-01 01:18:30,168 - TrainingLogger - INFO - Step 48290, Batch metrics: Loss: 7.7118, Accuracy: 0.0761, Perplexity: 2234.4641
2025-01-01 01:18:37,473 - TrainingLogger - INFO - Step 48300, Batch metrics: Loss: 7.5375, Accuracy: 0.0667, Perplexity: 1877.0882
2025-01-01 01:18:37,473 - TrainingLogger - INFO - Step 48300, Prediction vs Actual:
2025-01-01 01:18:37,473 - TrainingLogger - INFO - Input 1: ימינה ימינה אינה דוגלת בכפייה
2025-01-01 01:18:37,474 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:18:37,474 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | א               | ▁ימינה       | ✗     |
|     1 | ▁-              | ▁ימינה       | ✗     |
|     2 | ▁ול             | ▁אינה        | ✗     |
|     3 | ▁-              | ▁דוגל        | ✗     |
|     4 | ת               | ת            | ✓     |
|     5 | ר               | ▁ב           | ✗     |
|     6 | יט              | כפי          | ✗     |
|     7 | יה              | יה           | ✓     |
|     8 | ▁זו             | <pad>        | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ▁שחורה          | <pad>        | ✗     |
|    14 | ▁שחורה          | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ▁ראשונה         | <pad>        | ✗     |
|    18 | ▁שחורה          | <pad>        | ✗     |
|    19 | ▁שחורה          | <pad>        | ✗     |
|    20 | ה               | <pad>        | ✗     |
|    21 | ▁(              | <pad>        | ✗     |
|    22 | ון              | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | ▁חדשה           | <pad>        | ✗     |
|    25 | ▁קטנה           | <pad>        | ✗     |
|    26 | ית              | <pad>        | ✗     |
|    27 | ▁קטנה           | <pad>        | ✗     |
|    28 | ▁זו             | <pad>        | ✗     |
|    29 | ▁השמש           | <pad>        | ✗     |
|    30 | ▁השמש           | <pad>        | ✗     |
|    31 | ▁קטנה           | <pad>        | ✗     |
|    32 | ▁השמש           | <pad>        | ✗     |
|    33 | בית             | <pad>        | ✗     |
|    34 | ▁חדשה           | <pad>        | ✗     |
|    35 | ▁               | <pad>        | ✗     |
|    36 | אק              | <pad>        | ✗     |
|    37 | ר               | <pad>        | ✗     |
|    38 | ▁זו             | <pad>        | ✗     |
|    39 | יה              | <pad>        | ✗     |
|    40 | ר               |              | ✗     |

2025-01-01 01:18:37,474 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:18:37,479 - TrainingLogger - INFO - Gradient norm: 8.0845
2025-01-01 01:18:44,744 - TrainingLogger - INFO - Step 48310, Batch metrics: Loss: 7.3817, Accuracy: 0.0793, Perplexity: 1606.3359
2025-01-01 01:18:52,305 - TrainingLogger - INFO - Step 48320, Batch metrics: Loss: 7.6886, Accuracy: 0.0825, Perplexity: 2183.3263
2025-01-01 01:18:59,821 - TrainingLogger - INFO - Step 48330, Batch metrics: Loss: 7.6844, Accuracy: 0.0787, Perplexity: 2174.2638
2025-01-01 01:19:07,335 - TrainingLogger - INFO - Step 48340, Batch metrics: Loss: 7.3698, Accuracy: 0.0813, Perplexity: 1587.2801
2025-01-01 01:19:14,574 - TrainingLogger - INFO - Step 48350, Batch metrics: Loss: 7.1323, Accuracy: 0.1106, Perplexity: 1251.7394
2025-01-01 01:19:21,205 - TrainingLogger - INFO - Step 48360, Batch metrics: Loss: 7.9827, Accuracy: 0.0500, Perplexity: 2929.7467
2025-01-01 01:19:28,172 - TrainingLogger - INFO - Step 48370, Batch metrics: Loss: 7.5988, Accuracy: 0.0758, Perplexity: 1995.7875
2025-01-01 01:19:34,827 - TrainingLogger - INFO - Step 48380, Batch metrics: Loss: 7.9088, Accuracy: 0.0625, Perplexity: 2721.1014
2025-01-01 01:19:42,194 - TrainingLogger - INFO - Step 48390, Batch metrics: Loss: 7.7068, Accuracy: 0.0417, Perplexity: 2223.4774
2025-01-01 01:19:48,916 - TrainingLogger - INFO - Step 48400, Batch metrics: Loss: 6.9136, Accuracy: 0.0843, Perplexity: 1005.8234
2025-01-01 01:19:48,916 - TrainingLogger - INFO - Step 48400, Prediction vs Actual:
2025-01-01 01:19:48,916 - TrainingLogger - INFO - Input 1: המיקס הזה של העובדים הוא אנשי שטראוס
2025-01-01 01:19:48,917 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:19:48,917 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | נים             | ▁המ          | ✗     |
|     1 | ▁               | יקס          | ✗     |
|     2 | מ               | ▁הזה         | ✗     |
|     3 | ב               | ▁של          | ✗     |
|     4 | ▁המדינה         | ▁העובדים     | ✗     |
|     5 | .               | ▁הוא         | ✗     |
|     6 | ▁זה             | ▁אנשי        | ✗     |
|     7 | ▁צבא            | ▁שטר         | ✗     |
|     8 | ן               | אוס          | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               |              | ✗     |

2025-01-01 01:19:48,917 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:19:48,922 - TrainingLogger - INFO - Gradient norm: 11.2258
2025-01-01 01:19:56,160 - TrainingLogger - INFO - Step 48410, Batch metrics: Loss: 7.3972, Accuracy: 0.0851, Perplexity: 1631.4235
2025-01-01 01:20:02,818 - TrainingLogger - INFO - Step 48420, Batch metrics: Loss: 7.8744, Accuracy: 0.0612, Perplexity: 2628.9958
2025-01-01 01:20:09,835 - TrainingLogger - INFO - Step 48430, Batch metrics: Loss: 7.5018, Accuracy: 0.0864, Perplexity: 1811.2947
2025-01-01 01:20:16,852 - TrainingLogger - INFO - Step 48440, Batch metrics: Loss: 7.7064, Accuracy: 0.0414, Perplexity: 2222.5382
2025-01-01 01:20:24,054 - TrainingLogger - INFO - Step 48450, Batch metrics: Loss: 7.4657, Accuracy: 0.0617, Perplexity: 1747.0342
2025-01-01 01:20:31,025 - TrainingLogger - INFO - Step 48460, Batch metrics: Loss: 7.6995, Accuracy: 0.0787, Perplexity: 2207.3443
2025-01-01 01:20:38,541 - TrainingLogger - INFO - Step 48470, Batch metrics: Loss: 7.0780, Accuracy: 0.0703, Perplexity: 1185.6516
2025-01-01 01:20:45,897 - TrainingLogger - INFO - Step 48480, Batch metrics: Loss: 7.5949, Accuracy: 0.0469, Perplexity: 1987.9953
2025-01-01 01:20:53,272 - TrainingLogger - INFO - Step 48490, Batch metrics: Loss: 7.8243, Accuracy: 0.0685, Perplexity: 2500.6513
2025-01-01 01:21:00,636 - TrainingLogger - INFO - Step 48500, Batch metrics: Loss: 7.7700, Accuracy: 0.0760, Perplexity: 2368.4080
2025-01-01 01:21:00,636 - TrainingLogger - INFO - Step 48500, Prediction vs Actual:
2025-01-01 01:21:00,636 - TrainingLogger - INFO - Input 1: שר המשפטים סער מכין תזכיר חוק שימנע מנאשם בפלילים להרכיב ממשלה
2025-01-01 01:21:00,637 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:21:00,637 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁שר          | ✗     |
|     1 | ▁-              | ▁המשפטים     | ✗     |
|     2 | ▁-              | ▁סע          | ✗     |
|     3 | ▁-              | ר            | ✗     |
|     4 | ר               | ▁מכין        | ✗     |
|     5 | ▁-              | ▁תזכיר       | ✗     |
|     6 | ▁-              | ▁חוק         | ✗     |
|     7 | ▁זה             | ▁שי          | ✗     |
|     8 | אמר             | מנע          | ✗     |
|     9 | ▁את             | ▁מ           | ✗     |
|    10 | ▁זה             | נאשם         | ✗     |
|    11 | ▁זה             | ▁בפל         | ✗     |
|    12 | ה               | ילים         | ✗     |
|    13 | ▁רבים           | ▁להרכיב      | ✗     |
|    14 | ▁את             | ▁ממשלה       | ✗     |
|    15 | ▁זו             | <pad>        | ✗     |
|    16 | <pad>           | <pad>        | ✓     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | ▁עם             | <pad>        | ✗     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | ית              | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | ית              | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ית              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ה               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | ם               | <pad>        | ✗     |
|    35 | ים              | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ▁לא             | <pad>        | ✗     |
|    38 | ▁זה             | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ית              | <pad>        | ✗     |
|    41 | ה               | <pad>        | ✗     |
|    42 | ית              | <pad>        | ✗     |
|    43 | ה               | <pad>        | ✗     |
|    44 | ▁המדינה         | <pad>        | ✗     |
|    45 | <pad>           | <pad>        | ✓     |
|    46 | ▁זה             | <pad>        | ✗     |
|    47 | ו               |              | ✗     |

2025-01-01 01:21:00,637 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:21:00,642 - TrainingLogger - INFO - Gradient norm: 8.8568
2025-01-01 01:21:07,742 - TrainingLogger - INFO - Step 48510, Batch metrics: Loss: 7.9356, Accuracy: 0.0736, Perplexity: 2794.9014
2025-01-01 01:21:14,711 - TrainingLogger - INFO - Step 48520, Batch metrics: Loss: 8.0987, Accuracy: 0.0616, Perplexity: 3290.1866
2025-01-01 01:21:21,553 - TrainingLogger - INFO - Step 48530, Batch metrics: Loss: 7.8012, Accuracy: 0.0615, Perplexity: 2443.4612
2025-01-01 01:21:28,647 - TrainingLogger - INFO - Step 48540, Batch metrics: Loss: 7.1181, Accuracy: 0.0909, Perplexity: 1234.1177
2025-01-01 01:21:36,247 - TrainingLogger - INFO - Step 48550, Batch metrics: Loss: 7.2784, Accuracy: 0.0939, Perplexity: 1448.6813
2025-01-01 01:21:42,800 - TrainingLogger - INFO - Step 48560, Batch metrics: Loss: 7.5387, Accuracy: 0.0818, Perplexity: 1879.3738
2025-01-01 01:21:50,130 - TrainingLogger - INFO - Step 48570, Batch metrics: Loss: 7.2378, Accuracy: 0.1006, Perplexity: 1391.0869
2025-01-01 01:21:57,001 - TrainingLogger - INFO - Step 48580, Batch metrics: Loss: 7.4586, Accuracy: 0.1010, Perplexity: 1734.7906
2025-01-01 01:22:04,012 - TrainingLogger - INFO - Step 48590, Batch metrics: Loss: 7.5818, Accuracy: 0.0714, Perplexity: 1962.1698
2025-01-01 01:22:11,105 - TrainingLogger - INFO - Step 48600, Batch metrics: Loss: 7.2154, Accuracy: 0.0876, Perplexity: 1360.2439
2025-01-01 01:22:11,106 - TrainingLogger - INFO - Step 48600, Prediction vs Actual:
2025-01-01 01:22:11,106 - TrainingLogger - INFO - Input 1: זה מקומם שהדמוקרטים לא סומכים על חברי המפלגה שלהם שלא יביכו בני משפחה של קורבנות שנלקחו כבני ערובה על-ידי טרוריסטים של חמאס, טען
2025-01-01 01:22:11,107 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:22:11,107 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁זה          | ✗     |
|     1 | ▁לא             | ▁מקומם       | ✗     |
|     2 | ▁לא             | ▁שה          | ✗     |
|     3 | מש              | דמוקרט       | ✗     |
|     4 | ית              | ים           | ✗     |
|     5 | ▁לא             | ▁לא          | ✓     |
|     6 | ▁היו            | ▁סומכ        | ✗     |
|     7 | ים              | ים           | ✓     |
|     8 | ▁עליהם          | ▁על          | ✗     |
|     9 | ▁עצמם           | ▁חברי        | ✗     |
|    10 | ה               | ▁המפלגה      | ✗     |
|    11 | ▁שלנו           | ▁שלהם        | ✗     |
|    12 | .               | ▁שלא         | ✗     |
|    13 | ▁היו            | ▁יב          | ✗     |
|    14 | דו              | יכו          | ✗     |
|    15 | ▁אותם           | ▁בני         | ✗     |
|    16 | ▁ישראל          | ▁משפחה       | ✗     |
|    17 | .               | ▁של          | ✗     |
|    18 | ▁אנשים          | ▁קורבנות     | ✗     |
|    19 | ,               | ▁שנלקח       | ✗     |
|    20 | ו               | ו            | ✓     |
|    21 | ▁על             | ▁כבני        | ✗     |
|    22 | ▁אדם            | ▁ערובה       | ✗     |
|    23 | .               | ▁על          | ✗     |
|    24 | ▁ידי            | -            | ✗     |
|    25 | ידי             | ידי          | ✓     |
|    26 | ▁מדינה          | ▁טרוריסטים   | ✗     |
|    27 | .               | ▁של          | ✗     |
|    28 | ▁אנשים          | ▁ח           | ✗     |
|    29 | ומים            | מ            | ✗     |
|    30 | אס              | אס           | ✓     |
|    31 | ים              | ,            | ✗     |
|    32 | </s>            | ▁טען         | ✗     |
|    33 | ▁כי             | <pad>        | ✗     |
|    34 | ▁שהם            | <pad>        | ✗     |
|    35 | ▁שהם            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ▁שהם            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ים              | <pad>        | ✗     |
|    40 | ים              | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            |              | ✗     |

2025-01-01 01:22:11,107 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:22:11,111 - TrainingLogger - INFO - Gradient norm: 11.5647
2025-01-01 01:22:18,014 - TrainingLogger - INFO - Step 48610, Batch metrics: Loss: 7.9871, Accuracy: 0.0309, Perplexity: 2942.6457
2025-01-01 01:22:25,125 - TrainingLogger - INFO - Step 48620, Batch metrics: Loss: 7.9544, Accuracy: 0.0441, Perplexity: 2848.0072
2025-01-01 01:22:32,619 - TrainingLogger - INFO - Step 48630, Batch metrics: Loss: 6.8453, Accuracy: 0.0989, Perplexity: 939.4288
2025-01-01 01:22:39,834 - TrainingLogger - INFO - Step 48640, Batch metrics: Loss: 7.2581, Accuracy: 0.0985, Perplexity: 1419.5724
2025-01-01 01:22:46,574 - TrainingLogger - INFO - Step 48650, Batch metrics: Loss: 7.4149, Accuracy: 0.0979, Perplexity: 1660.5769
2025-01-01 01:22:53,823 - TrainingLogger - INFO - Step 48660, Batch metrics: Loss: 7.3452, Accuracy: 0.1159, Perplexity: 1548.7817
2025-01-01 01:23:00,951 - TrainingLogger - INFO - Step 48670, Batch metrics: Loss: 7.4885, Accuracy: 0.0774, Perplexity: 1787.4289
2025-01-01 01:23:08,117 - TrainingLogger - INFO - Step 48680, Batch metrics: Loss: 6.8114, Accuracy: 0.1407, Perplexity: 908.1794
2025-01-01 01:23:15,810 - TrainingLogger - INFO - Step 48690, Batch metrics: Loss: 7.4639, Accuracy: 0.0451, Perplexity: 1743.9105
2025-01-01 01:23:22,749 - TrainingLogger - INFO - Step 48700, Batch metrics: Loss: 7.7532, Accuracy: 0.0652, Perplexity: 2328.9013
2025-01-01 01:23:22,749 - TrainingLogger - INFO - Step 48700, Prediction vs Actual:
2025-01-01 01:23:22,749 - TrainingLogger - INFO - Input 1: עטיפת הספר לכל מי שרוצה לשפר את עצמו ואת הזוגיות שלו
2025-01-01 01:23:22,750 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:23:22,750 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | א               | ▁ע           | ✗     |
|     1 | ר               | טיפת         | ✗     |
|     2 | ▁-              | ▁הספר        | ✗     |
|     3 | ▁-              | ▁לכל         | ✗     |
|     4 | ▁-              | ▁מי          | ✗     |
|     5 | ▁שאתה           | ▁שרוצה       | ✗     |
|     6 | ▁-              | ▁לשפר        | ✗     |
|     7 | ▁את             | ▁את          | ✓     |
|     8 | ▁זה             | ▁עצמו        | ✗     |
|     9 | .               | ▁ואת         | ✗     |
|    10 | ▁זה             | ▁הזוג        | ✗     |
|    11 | ▁הוא            | יות          | ✗     |
|    12 | ▁אני            | ▁שלו         | ✗     |
|    13 | ▁-              | <pad>        | ✗     |
|    14 | ▁זה             | <pad>        | ✗     |
|    15 | ב               | <pad>        | ✗     |
|    16 | ה               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ▁הוא            | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ▁זה             | <pad>        | ✗     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | ,               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | ▁לא             | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | ,               | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | <pad>           |              | ✗     |

2025-01-01 01:23:22,750 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:23:22,755 - TrainingLogger - INFO - Gradient norm: 14.0964
2025-01-01 01:23:30,257 - TrainingLogger - INFO - Step 48710, Batch metrics: Loss: 7.4544, Accuracy: 0.1118, Perplexity: 1727.3798
2025-01-01 01:23:37,134 - TrainingLogger - INFO - Step 48720, Batch metrics: Loss: 7.6353, Accuracy: 0.0658, Perplexity: 2070.0732
2025-01-01 01:23:44,156 - TrainingLogger - INFO - Step 48730, Batch metrics: Loss: 7.5426, Accuracy: 0.0806, Perplexity: 1886.7096
2025-01-01 01:23:51,650 - TrainingLogger - INFO - Step 48740, Batch metrics: Loss: 7.5856, Accuracy: 0.0448, Perplexity: 1969.7152
2025-01-01 01:23:58,635 - TrainingLogger - INFO - Step 48750, Batch metrics: Loss: 7.5242, Accuracy: 0.0679, Perplexity: 1852.3952
2025-01-01 01:24:05,841 - TrainingLogger - INFO - Step 48760, Batch metrics: Loss: 7.5828, Accuracy: 0.0547, Perplexity: 1964.1843
2025-01-01 01:24:12,800 - TrainingLogger - INFO - Step 48770, Batch metrics: Loss: 7.3693, Accuracy: 0.0726, Perplexity: 1586.4485
2025-01-01 01:24:19,785 - TrainingLogger - INFO - Step 48780, Batch metrics: Loss: 8.0915, Accuracy: 0.0408, Perplexity: 3266.5878
2025-01-01 01:24:27,466 - TrainingLogger - INFO - Step 48790, Batch metrics: Loss: 7.4748, Accuracy: 0.0621, Perplexity: 1763.0013
2025-01-01 01:24:34,592 - TrainingLogger - INFO - Step 48800, Batch metrics: Loss: 7.5710, Accuracy: 0.0704, Perplexity: 1941.1380
2025-01-01 01:24:34,592 - TrainingLogger - INFO - Step 48800, Prediction vs Actual:
2025-01-01 01:24:34,592 - TrainingLogger - INFO - Input 1: לארהב אגב יש מטרה נוספת במזרח התיכון, והיא להביא לסיום מלחמת האזרחים בתימן
2025-01-01 01:24:34,593 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:24:34,593 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לארה        | ✗     |
|     1 | ▁ול             | ב            | ✗     |
|     2 | .               | ▁אגב         | ✗     |
|     3 | יה              | ▁יש          | ✗     |
|     4 | ▁לנו            | ▁מטרה        | ✗     |
|     5 | ▁לכך            | ▁נוספת       | ✗     |
|     6 | .               | ▁במזרח       | ✗     |
|     7 | ▁התיכון         | ▁התיכון      | ✓     |
|     8 | .               | ,            | ✗     |
|     9 | ▁לא             | ▁והיא        | ✗     |
|    10 | ▁לא             | ▁להביא       | ✗     |
|    11 | ▁את             | ▁לסיום       | ✗     |
|    12 | ▁את             | ▁מלחמת       | ✗     |
|    13 | ▁העולם          | ▁האזרחים     | ✗     |
|    14 | .               | ▁בתי         | ✗     |
|    15 | ר               | מן           | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ▁הזה            | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               |              | ✗     |

2025-01-01 01:24:34,593 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:24:34,598 - TrainingLogger - INFO - Gradient norm: 11.0068
2025-01-01 01:24:41,623 - TrainingLogger - INFO - Step 48810, Batch metrics: Loss: 7.0350, Accuracy: 0.0933, Perplexity: 1135.7072
2025-01-01 01:24:48,647 - TrainingLogger - INFO - Step 48820, Batch metrics: Loss: 7.4255, Accuracy: 0.0738, Perplexity: 1678.1895
2025-01-01 01:24:56,011 - TrainingLogger - INFO - Step 48830, Batch metrics: Loss: 7.4254, Accuracy: 0.0765, Perplexity: 1678.0311
2025-01-01 01:25:03,469 - TrainingLogger - INFO - Step 48840, Batch metrics: Loss: 7.2732, Accuracy: 0.0682, Perplexity: 1441.2249
2025-01-01 01:25:10,989 - TrainingLogger - INFO - Step 48850, Batch metrics: Loss: 7.3887, Accuracy: 0.0758, Perplexity: 1617.6404
2025-01-01 01:25:17,767 - TrainingLogger - INFO - Step 48860, Batch metrics: Loss: 7.2864, Accuracy: 0.1013, Perplexity: 1460.2559
2025-01-01 01:25:24,829 - TrainingLogger - INFO - Step 48870, Batch metrics: Loss: 7.3744, Accuracy: 0.0448, Perplexity: 1594.5574
2025-01-01 01:25:32,262 - TrainingLogger - INFO - Step 48880, Batch metrics: Loss: 7.9120, Accuracy: 0.0878, Perplexity: 2729.8803
2025-01-01 01:25:39,508 - TrainingLogger - INFO - Step 48890, Batch metrics: Loss: 7.6197, Accuracy: 0.0707, Perplexity: 2037.9914
2025-01-01 01:25:46,970 - TrainingLogger - INFO - Step 48900, Batch metrics: Loss: 7.3900, Accuracy: 0.0813, Perplexity: 1619.7576
2025-01-01 01:25:46,970 - TrainingLogger - INFO - Step 48900, Prediction vs Actual:
2025-01-01 01:25:46,970 - TrainingLogger - INFO - Input 1: פקידים בכירים אמרו ל-ynet עם אישור התוכנית בקבינט ב-2019 כי המהלך אושר לאחר שנבדק שהוא אינו פוגע בביטחון המדינה ובצורכי צהל, וגם לא באינטרסים של המתנחלים
2025-01-01 01:25:46,971 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:25:46,971 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁פקיד        | ✗     |
|     1 | ▁-              | ים           | ✗     |
|     2 | ▁-              | ▁בכיר        | ✗     |
|     3 | ▁-              | ים           | ✗     |
|     4 | ▁-              | ▁אמרו        | ✗     |
|     5 | ▁-              | ▁ל           | ✗     |
|     6 | ?               | -            | ✗     |
|     7 | B               | yn           | ✗     |
|     8 | ן               | et           | ✗     |
|     9 | ים              | ▁עם          | ✗     |
|    10 | ▁הזמן           | ▁אישור       | ✗     |
|    11 | ים              | ▁התוכנית     | ✗     |
|    12 | <pad>           | ▁בק          | ✗     |
|    13 | "               | בי           | ✗     |
|    14 | נט              | נט           | ✓     |
|    15 | ים              | ▁ב           | ✗     |
|    16 | "               | -20          | ✗     |
|    17 | ▁במאי           | 19           | ✗     |
|    18 | ,               | ▁כי          | ✗     |
|    19 | ▁הוא            | ▁המהלך       | ✗     |
|    20 | ▁שלו            | ▁אושר        | ✗     |
|    21 | ה               | ▁לאחר        | ✗     |
|    22 | ▁שנה            | ▁שנ          | ✗     |
|    23 | ונה             | בדק          | ✗     |
|    24 | ה               | ▁שהוא        | ✗     |
|    25 | ▁לא             | ▁אינו        | ✗     |
|    26 | ▁קיים           | ▁פוגע        | ✗     |
|    27 | ▁בו             | ▁בביטחון     | ✗     |
|    28 | ,               | ▁המדינה      | ✗     |
|    29 | י               | ▁וב          | ✗     |
|    30 | צבא             | צור          | ✗     |
|    31 | ף               | כי           | ✗     |
|    32 | ו               | ▁צ           | ✗     |
|    33 | '               | הל           | ✗     |
|    34 | "               | ,            | ✗     |
|    35 | <pad>           | ▁וגם         | ✗     |
|    36 | ▁לא             | ▁לא          | ✓     |
|    37 | ▁היה            | ▁ב           | ✗     |
|    38 | שלטון           | אינטרסים     | ✗     |
|    39 | ▁שלו            | ▁של          | ✗     |
|    40 | ▁המדינה         | ▁המת         | ✗     |
|    41 | גור             | נחל          | ✗     |
|    42 | ים              | ים           | ✓     |
|    43 | ▁שלו            |              | ✗     |

2025-01-01 01:25:46,971 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:25:46,976 - TrainingLogger - INFO - Gradient norm: 7.3842
2025-01-01 01:25:54,156 - TrainingLogger - INFO - Step 48910, Batch metrics: Loss: 7.4237, Accuracy: 0.0816, Perplexity: 1675.2864
2025-01-01 01:26:00,821 - TrainingLogger - INFO - Step 48920, Batch metrics: Loss: 7.8290, Accuracy: 0.0705, Perplexity: 2512.4289
2025-01-01 01:26:07,336 - TrainingLogger - INFO - Step 48930, Batch metrics: Loss: 7.6003, Accuracy: 0.0982, Perplexity: 1998.7055
2025-01-01 01:26:14,440 - TrainingLogger - INFO - Step 48940, Batch metrics: Loss: 7.4381, Accuracy: 0.0952, Perplexity: 1699.4765
2025-01-01 01:26:21,748 - TrainingLogger - INFO - Step 48950, Batch metrics: Loss: 7.3608, Accuracy: 0.1077, Perplexity: 1573.0942
2025-01-01 01:26:29,014 - TrainingLogger - INFO - Step 48960, Batch metrics: Loss: 7.9015, Accuracy: 0.0526, Perplexity: 2701.3190
2025-01-01 01:26:36,059 - TrainingLogger - INFO - Step 48970, Batch metrics: Loss: 7.5629, Accuracy: 0.0581, Perplexity: 1925.5076
2025-01-01 01:26:43,325 - TrainingLogger - INFO - Step 48980, Batch metrics: Loss: 7.8309, Accuracy: 0.0502, Perplexity: 2517.2423
2025-01-01 01:26:50,207 - TrainingLogger - INFO - Step 48990, Batch metrics: Loss: 7.4494, Accuracy: 0.0759, Perplexity: 1718.7536
2025-01-01 01:26:57,946 - TrainingLogger - INFO - Step 49000, Batch metrics: Loss: 7.6586, Accuracy: 0.0580, Perplexity: 2118.8342
2025-01-01 01:26:57,947 - TrainingLogger - INFO - Step 49000, Prediction vs Actual:
2025-01-01 01:26:57,947 - TrainingLogger - INFO - Input 1: זמן הנסיעה שווה כסףצילום שאטרסטוק התיקון לסעיף שיטות עבודה ניידות בניהול הממשל נכנס לתוקף ב-1 בינואר 2020 ותקף לכל עובדי הממשל
2025-01-01 01:26:57,948 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:26:57,948 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁המדינה         | ▁זמן         | ✗     |
|     1 | ▁-              | ▁הנסיעה      | ✗     |
|     2 | ▁-              | ▁שווה        | ✗     |
|     3 | ▁-              | ▁כסף         | ✗     |
|     4 | ?               | צילום        | ✗     |
|     5 | ▁-              | ▁ש           | ✗     |
|     6 | ...             | אטר          | ✗     |
|     7 | ף               | סטוק         | ✗     |
|     8 | ו               | ▁התיקון      | ✗     |
|     9 | ▁החמישי         | ▁ל           | ✗     |
|    10 | "               | סעיף         | ✗     |
|    11 | ▁הזה            | ▁שיטות       | ✗     |
|    12 | יו              | ▁עבודה       | ✗     |
|    13 | .               | ▁נייד        | ✗     |
|    14 | ות              | ות           | ✓     |
|    15 | .               | ▁בניהול      | ✗     |
|    16 | ▁החברה          | ▁הממשל       | ✗     |
|    17 | ים              | ▁נכנס        | ✗     |
|    18 | ▁ל              | ▁ל           | ✓     |
|    19 | תוקף            | תוקף         | ✓     |
|    20 | .               | ▁ב           | ✗     |
|    21 | -               | -1           | ✗     |
|    22 | ▁במרץ           | ▁בינואר      | ✗     |
|    23 | ▁19             | ▁20          | ✗     |
|    24 | 11              | 20           | ✗     |
|    25 | .               | ▁ו           | ✗     |
|    26 | -               | תקף          | ✗     |
|    27 | ▁אותו           | ▁לכל         | ✗     |
|    28 | ▁עבר            | ▁עובדי       | ✗     |
|    29 | ו               | ▁הממשל       | ✗     |
|    30 | ▁הכללי          | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ▁עד             | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | ▁את             | <pad>        | ✗     |
|    41 | ▁את             | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | .               |              | ✗     |

2025-01-01 01:26:57,948 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:26:57,953 - TrainingLogger - INFO - Gradient norm: 11.8844
2025-01-01 01:27:05,852 - TrainingLogger - INFO - Step 49010, Batch metrics: Loss: 7.8043, Accuracy: 0.0809, Perplexity: 2451.1328
2025-01-01 01:27:13,220 - TrainingLogger - INFO - Step 49020, Batch metrics: Loss: 7.6110, Accuracy: 0.0838, Perplexity: 2020.2310
2025-01-01 01:27:19,968 - TrainingLogger - INFO - Step 49030, Batch metrics: Loss: 7.5392, Accuracy: 0.0932, Perplexity: 1880.2621
2025-01-01 01:27:27,515 - TrainingLogger - INFO - Step 49040, Batch metrics: Loss: 7.8376, Accuracy: 0.0584, Perplexity: 2534.0752
2025-01-01 01:27:34,322 - TrainingLogger - INFO - Step 49050, Batch metrics: Loss: 7.4369, Accuracy: 0.0645, Perplexity: 1697.5538
2025-01-01 01:27:41,363 - TrainingLogger - INFO - Step 49060, Batch metrics: Loss: 7.1397, Accuracy: 0.0995, Perplexity: 1261.0782
2025-01-01 01:27:48,024 - TrainingLogger - INFO - Step 49070, Batch metrics: Loss: 7.7966, Accuracy: 0.0791, Perplexity: 2432.2759
2025-01-01 01:27:55,326 - TrainingLogger - INFO - Step 49080, Batch metrics: Loss: 7.3570, Accuracy: 0.0751, Perplexity: 1567.1257
2025-01-01 01:28:02,454 - TrainingLogger - INFO - Step 49090, Batch metrics: Loss: 7.3894, Accuracy: 0.0591, Perplexity: 1618.6667
2025-01-01 01:28:09,839 - TrainingLogger - INFO - Step 49100, Batch metrics: Loss: 7.4617, Accuracy: 0.0815, Perplexity: 1740.0580
2025-01-01 01:28:09,839 - TrainingLogger - INFO - Step 49100, Prediction vs Actual:
2025-01-01 01:28:09,839 - TrainingLogger - INFO - Input 1: הפרקליט, מצדו, ענה זה לא נכון
2025-01-01 01:28:09,839 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:28:09,839 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הפרקליט     | ✗     |
|     1 | ▁המדינה         | ,            | ✗     |
|     2 | ▁ארה            | ▁מצד         | ✗     |
|     3 | ▁השני           | ו            | ✗     |
|     4 | ▁הוא            | ,            | ✗     |
|     5 | ▁הוא            | ▁ענה         | ✗     |
|     6 | ▁על             | ▁זה          | ✗     |
|     7 | ▁על             | ▁לא          | ✗     |
|     8 | ▁נכון           | ▁נכון        | ✓     |
|     9 | ▁על             | <pad>        | ✗     |
|    10 | ▁בשל            | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | ▁על             | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | ▁על             | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ,               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ▁על             | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁על             | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | ▁הוא            | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ▁על             | <pad>        | ✗     |
|    30 | ▁על             | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | ,               | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | ▁הוא            | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ▁הוא            |              | ✗     |

2025-01-01 01:28:09,840 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:28:09,845 - TrainingLogger - INFO - Gradient norm: 7.4633
2025-01-01 01:28:16,811 - TrainingLogger - INFO - Step 49110, Batch metrics: Loss: 7.1928, Accuracy: 0.0930, Perplexity: 1329.8761
2025-01-01 01:28:17,600 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 293888
2025-01-01 01:28:17,600 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 293888

2025-01-01 01:28:17,600 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 41]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 41]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 39]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 39]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 110]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 110]), device: cuda:0
2025-01-01 01:28:17,601 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:28:17,602 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:28:24,450 - TrainingLogger - INFO - Step 49120, Batch metrics: Loss: 7.1966, Accuracy: 0.1123, Perplexity: 1334.8513
2025-01-01 01:28:31,346 - TrainingLogger - INFO - Step 49130, Batch metrics: Loss: 7.6310, Accuracy: 0.0289, Perplexity: 2061.1259
2025-01-01 01:28:38,556 - TrainingLogger - INFO - Step 49140, Batch metrics: Loss: 7.0987, Accuracy: 0.0739, Perplexity: 1210.3632
2025-01-01 01:28:45,075 - TrainingLogger - INFO - Step 49150, Batch metrics: Loss: 7.2990, Accuracy: 0.0853, Perplexity: 1478.7841
2025-01-01 01:28:52,165 - TrainingLogger - INFO - Step 49160, Batch metrics: Loss: 8.2764, Accuracy: 0.0791, Perplexity: 3930.0230
2025-01-01 01:29:00,019 - TrainingLogger - INFO - Step 49170, Batch metrics: Loss: 7.5569, Accuracy: 0.0688, Perplexity: 1913.8403
2025-01-01 01:29:06,797 - TrainingLogger - INFO - Step 49180, Batch metrics: Loss: 7.7560, Accuracy: 0.0561, Perplexity: 2335.5060
2025-01-01 01:29:13,968 - TrainingLogger - INFO - Step 49190, Batch metrics: Loss: 7.3734, Accuracy: 0.0862, Perplexity: 1593.1028
2025-01-01 01:29:20,709 - TrainingLogger - INFO - Step 49200, Batch metrics: Loss: 7.5194, Accuracy: 0.0774, Perplexity: 1843.4673
2025-01-01 01:29:20,709 - TrainingLogger - INFO - Step 49200, Prediction vs Actual:
2025-01-01 01:29:20,709 - TrainingLogger - INFO - Input 1: זה נחגג על ידי ראש ממשלת ישראל כהישג
2025-01-01 01:29:20,710 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:29:20,710 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁זה          | ✗     |
|     1 | ▁-              | ▁נח          | ✗     |
|     2 | ▁-              | ג            | ✗     |
|     3 | ג               | ג            | ✓     |
|     4 | ים              | ▁על          | ✗     |
|     5 | ▁כל             | ▁ידי         | ✗     |
|     6 | <pad>           | ▁ראש         | ✗     |
|     7 | ▁העיר           | ▁ממשלת       | ✗     |
|     8 | ו               | ▁ישראל       | ✗     |
|     9 | ה               | ▁כ           | ✗     |
|    10 | רוז             | הישג         | ✗     |
|    11 | ▁צבאי           | <pad>        | ✗     |
|    12 | ▁צבאי           | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | ▁הדין           | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ה               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | י               | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ,               | <pad>        | ✗     |
|    24 | ו               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | ות              | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ▁ישראל          | <pad>        | ✗     |
|    29 | ים              | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ,               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | ▁ישראל          | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ▁ישראל          | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | ,               | <pad>        | ✗     |
|    44 | ה               | <pad>        | ✗     |
|    45 | ה               | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | </s>            |              | ✗     |

2025-01-01 01:29:20,710 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:29:20,715 - TrainingLogger - INFO - Gradient norm: 11.2638
2025-01-01 01:29:27,248 - TrainingLogger - INFO - Step 49210, Batch metrics: Loss: 7.6412, Accuracy: 0.0798, Perplexity: 2082.2680
2025-01-01 01:29:34,217 - TrainingLogger - INFO - Step 49220, Batch metrics: Loss: 7.4450, Accuracy: 0.0903, Perplexity: 1711.2554
2025-01-01 01:29:42,242 - TrainingLogger - INFO - Step 49230, Batch metrics: Loss: 7.0268, Accuracy: 0.0870, Perplexity: 1126.4479
2025-01-01 01:29:50,216 - TrainingLogger - INFO - Step 49240, Batch metrics: Loss: 7.3477, Accuracy: 0.0864, Perplexity: 1552.5986
2025-01-01 01:29:57,812 - TrainingLogger - INFO - Step 49250, Batch metrics: Loss: 7.4490, Accuracy: 0.0625, Perplexity: 1718.1038
2025-01-01 01:30:05,389 - TrainingLogger - INFO - Step 49260, Batch metrics: Loss: 7.5779, Accuracy: 0.0429, Perplexity: 1954.4408
2025-01-01 01:30:12,662 - TrainingLogger - INFO - Step 49270, Batch metrics: Loss: 7.7656, Accuracy: 0.0460, Perplexity: 2358.1094
2025-01-01 01:30:18,958 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 258048
2025-01-01 01:30:18,958 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 258048

2025-01-01 01:30:18,958 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 42]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 42]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 40]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 40]), device: cuda:0
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:30:18,959 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:30:20,243 - TrainingLogger - INFO - Step 49280, Batch metrics: Loss: 7.4474, Accuracy: 0.0815, Perplexity: 1715.3975
2025-01-01 01:30:27,808 - TrainingLogger - INFO - Step 49290, Batch metrics: Loss: 7.4591, Accuracy: 0.0376, Perplexity: 1735.5816
2025-01-01 01:30:35,154 - TrainingLogger - INFO - Step 49300, Batch metrics: Loss: 7.4680, Accuracy: 0.0806, Perplexity: 1751.1585
2025-01-01 01:30:35,155 - TrainingLogger - INFO - Step 49300, Prediction vs Actual:
2025-01-01 01:30:35,155 - TrainingLogger - INFO - Input 1: מוקדם יותר תקף יור האופוזיציה, חכ יאיר לפיד, את הקיצוץ הרוחבי
2025-01-01 01:30:35,156 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:30:35,156 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ון              | ▁מוקדם       | ✗     |
|     1 | ▁בבוקר          | ▁יותר        | ✗     |
|     2 | ▁בבוקר          | ▁תקף         | ✗     |
|     3 | ,               | ▁י           | ✗     |
|     4 | .               | ור           | ✗     |
|     5 | ▁ק              | ▁האו         | ✗     |
|     6 | וז              | פוז          | ✗     |
|     7 | יה              | י            | ✗     |
|     8 | צה              | ציה          | ✗     |
|     9 | ▁שלי            | ,            | ✗     |
|    10 | ▁היא            | ▁ח           | ✗     |
|    11 | סון             | כ            | ✗     |
|    12 | מי              | ▁יאיר        | ✗     |
|    13 | ,               | ▁לפי         | ✗     |
|    14 | ר               | ד            | ✗     |
|    15 | .               | ,            | ✗     |
|    16 | <pad>           | ▁את          | ✗     |
|    17 | ר               | ▁הקי         | ✗     |
|    18 | ק               | צוץ          | ✗     |
|    19 | ▁הזה            | ▁הרוח        | ✗     |
|    20 | בי              | בי           | ✓     |
|    21 | ים              | <pad>        | ✗     |
|    22 | ▁שלי            | <pad>        | ✗     |
|    23 | י               | <pad>        | ✗     |
|    24 | ד               | <pad>        | ✗     |
|    25 | ד               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ה               | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ד               | <pad>        | ✗     |
|    40 | ,               | <pad>        | ✗     |
|    41 | ,               | <pad>        | ✗     |
|    42 | י               | <pad>        | ✗     |
|    43 | ד               | <pad>        | ✗     |
|    44 | י               | <pad>        | ✗     |
|    45 | ני              | <pad>        | ✗     |
|    46 | ,               | <pad>        | ✗     |
|    47 | ד               | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | י               | <pad>        | ✗     |
|    50 | </s>            | <pad>        | ✗     |
|    51 | </s>            | <pad>        | ✗     |
|    52 | ת               | <pad>        | ✗     |
|    53 | ▁את             | <pad>        | ✗     |
|    54 | ד               | <pad>        | ✗     |
|    55 | ד               |              | ✗     |

2025-01-01 01:30:35,156 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:30:35,161 - TrainingLogger - INFO - Gradient norm: 11.4915
2025-01-01 01:30:42,563 - TrainingLogger - INFO - Step 49310, Batch metrics: Loss: 7.4938, Accuracy: 0.0846, Perplexity: 1796.9129
2025-01-01 01:30:49,876 - TrainingLogger - INFO - Step 49320, Batch metrics: Loss: 7.7092, Accuracy: 0.0656, Perplexity: 2228.8508
2025-01-01 01:30:57,190 - TrainingLogger - INFO - Step 49330, Batch metrics: Loss: 8.2632, Accuracy: 0.0569, Perplexity: 3878.5808
2025-01-01 01:31:04,906 - TrainingLogger - INFO - Step 49340, Batch metrics: Loss: 7.1935, Accuracy: 0.0821, Perplexity: 1330.8067
2025-01-01 01:31:11,585 - TrainingLogger - INFO - Step 49350, Batch metrics: Loss: 7.3143, Accuracy: 0.0498, Perplexity: 1501.6411
2025-01-01 01:31:18,670 - TrainingLogger - INFO - Step 49360, Batch metrics: Loss: 7.5039, Accuracy: 0.0838, Perplexity: 1815.0600
2025-01-01 01:31:25,938 - TrainingLogger - INFO - Step 49370, Batch metrics: Loss: 7.7042, Accuracy: 0.0476, Perplexity: 2217.5321
2025-01-01 01:31:33,319 - TrainingLogger - INFO - Step 49380, Batch metrics: Loss: 7.7760, Accuracy: 0.0785, Perplexity: 2382.8033
2025-01-01 01:31:39,851 - TrainingLogger - INFO - Step 49390, Batch metrics: Loss: 8.2387, Accuracy: 0.0438, Perplexity: 3784.4652
2025-01-01 01:31:47,538 - TrainingLogger - INFO - Step 49400, Batch metrics: Loss: 7.7924, Accuracy: 0.0741, Perplexity: 2422.1107
2025-01-01 01:31:47,538 - TrainingLogger - INFO - Step 49400, Prediction vs Actual:
2025-01-01 01:31:47,538 - TrainingLogger - INFO - Input 1: ככה גדלנו וככה למדנו לשמור על חיינו בארצות המוצא
2025-01-01 01:31:47,539 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:31:47,539 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁לא             | ▁ככה         | ✗     |
|     1 | ▁-              | ▁גדלנו       | ✗     |
|     2 | ▁על             | ▁וככה        | ✗     |
|     3 | ▁-              | ▁למדנו       | ✗     |
|     4 | ▁-              | ▁לשמור       | ✗     |
|     5 | ▁על             | ▁על          | ✓     |
|     6 | ▁זה             | ▁חיינו       | ✗     |
|     7 | .               | ▁בארצות      | ✗     |
|     8 | ▁הברית          | ▁המוצא       | ✗     |
|     9 | ▁שלנו           | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | ים              | <pad>        | ✗     |
|    13 | ות              | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ▁על             | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ▁עלינו          | <pad>        | ✗     |
|    19 | ▁על             | <pad>        | ✗     |
|    20 | ▁עלינו          | <pad>        | ✗     |
|    21 | ות              | <pad>        | ✗     |
|    22 | ▁על             | <pad>        | ✗     |
|    23 | ▁על             | <pad>        | ✗     |
|    24 | ות              | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁על             | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ▁עלינו          |              | ✗     |

2025-01-01 01:31:47,539 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:31:47,544 - TrainingLogger - INFO - Gradient norm: 7.9714
2025-01-01 01:31:54,844 - TrainingLogger - INFO - Step 49410, Batch metrics: Loss: 7.2715, Accuracy: 0.0897, Perplexity: 1438.7098
2025-01-01 01:32:02,154 - TrainingLogger - INFO - Step 49420, Batch metrics: Loss: 7.8465, Accuracy: 0.0685, Perplexity: 2556.8100
2025-01-01 01:32:08,972 - TrainingLogger - INFO - Step 49430, Batch metrics: Loss: 7.6830, Accuracy: 0.0714, Perplexity: 2171.0542
2025-01-01 01:32:16,339 - TrainingLogger - INFO - Step 49440, Batch metrics: Loss: 7.4195, Accuracy: 0.0731, Perplexity: 1668.1672
2025-01-01 01:32:23,153 - TrainingLogger - INFO - Step 49450, Batch metrics: Loss: 7.4847, Accuracy: 0.0678, Perplexity: 1780.5809
2025-01-01 01:32:30,278 - TrainingLogger - INFO - Step 49460, Batch metrics: Loss: 7.1880, Accuracy: 0.1047, Perplexity: 1323.4678
2025-01-01 01:32:37,754 - TrainingLogger - INFO - Step 49470, Batch metrics: Loss: 7.5642, Accuracy: 0.0405, Perplexity: 1927.8834
2025-01-01 01:32:44,989 - TrainingLogger - INFO - Step 49480, Batch metrics: Loss: 7.7288, Accuracy: 0.1080, Perplexity: 2272.9724
2025-01-01 01:32:52,103 - TrainingLogger - INFO - Step 49490, Batch metrics: Loss: 7.3716, Accuracy: 0.0854, Perplexity: 1590.2089
2025-01-01 01:32:59,519 - TrainingLogger - INFO - Step 49500, Batch metrics: Loss: 7.4798, Accuracy: 0.0633, Perplexity: 1771.8242
2025-01-01 01:32:59,520 - TrainingLogger - INFO - Step 49500, Prediction vs Actual:
2025-01-01 01:32:59,520 - TrainingLogger - INFO - Input 1: לדברי גנץ, מרבית הפרטים בהסכם כבר סוכמו, אולם עדיין ישנן מחלוקות מהותיות בדרך להסכם בינו לבין נתניהו
2025-01-01 01:32:59,520 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:32:59,520 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁לדברי       | ✗     |
|     1 | ▁(              | ▁ג           | ✗     |
|     2 | ▁הוא            | נץ           | ✗     |
|     3 | ▁הוא            | ,            | ✗     |
|     4 | ▁אני            | ▁מרבית       | ✗     |
|     5 | ▁-              | ▁הפרטים      | ✗     |
|     6 | ▁הם             | ▁ב           | ✗     |
|     7 | ▁הם             | הסכם         | ✗     |
|     8 | ▁זה             | ▁כבר         | ✗     |
|     9 | ▁היו            | ▁סו          | ✗     |
|    10 | ו               | כמו          | ✗     |
|    11 | ת               | ,            | ✗     |
|    12 | ▁הם             | ▁אולם        | ✗     |
|    13 | ▁הם             | ▁עדיין       | ✗     |
|    14 | ▁לא             | ▁ישנן        | ✗     |
|    15 | ▁דרכים          | ▁            | ✗     |
|    16 | התחייבויות      | מחלוקות      | ✗     |
|    17 | ▁כאלה           | ▁מה          | ✗     |
|    18 | גרים            | ות           | ✗     |
|    19 | יות             | יות          | ✓     |
|    20 | ▁אחרות          | ▁בדרך        | ✗     |
|    21 | ▁זו             | ▁ל           | ✗     |
|    22 | מדינות          | הסכם         | ✗     |
|    23 | ▁זה             | ▁ב           | ✗     |
|    24 | ות              | ינו          | ✗     |
|    25 | ▁לבין           | ▁לבין        | ✓     |
|    26 | ▁אחרים          | ▁נתנ         | ✗     |
|    27 | אל              | יהו          | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | א               | <pad>        | ✗     |
|    30 | </s>            |              | ✗     |

2025-01-01 01:32:59,520 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:32:59,525 - TrainingLogger - INFO - Gradient norm: 10.7472
2025-01-01 01:33:06,689 - TrainingLogger - INFO - Step 49510, Batch metrics: Loss: 7.0300, Accuracy: 0.1006, Perplexity: 1129.9953
2025-01-01 01:33:13,798 - TrainingLogger - INFO - Step 49520, Batch metrics: Loss: 7.7354, Accuracy: 0.0613, Perplexity: 2287.9143
2025-01-01 01:33:20,826 - TrainingLogger - INFO - Step 49530, Batch metrics: Loss: 7.1091, Accuracy: 0.0909, Perplexity: 1223.0613
2025-01-01 01:33:28,293 - TrainingLogger - INFO - Step 49540, Batch metrics: Loss: 7.1370, Accuracy: 0.0945, Perplexity: 1257.5941
2025-01-01 01:33:35,203 - TrainingLogger - INFO - Step 49550, Batch metrics: Loss: 7.2497, Accuracy: 0.0829, Perplexity: 1407.6712
2025-01-01 01:33:42,392 - TrainingLogger - INFO - Step 49560, Batch metrics: Loss: 7.7166, Accuracy: 0.0676, Perplexity: 2245.2332
2025-01-01 01:33:49,319 - TrainingLogger - INFO - Step 49570, Batch metrics: Loss: 7.3891, Accuracy: 0.0571, Perplexity: 1618.3248
2025-01-01 01:33:56,422 - TrainingLogger - INFO - Step 49580, Batch metrics: Loss: 7.7442, Accuracy: 0.0820, Perplexity: 2308.0852
2025-01-01 01:34:02,958 - TrainingLogger - INFO - Step 49590, Batch metrics: Loss: 7.5584, Accuracy: 0.0723, Perplexity: 1916.8716
2025-01-01 01:34:10,140 - TrainingLogger - INFO - Step 49600, Batch metrics: Loss: 6.5801, Accuracy: 0.1214, Perplexity: 720.5991
2025-01-01 01:34:10,140 - TrainingLogger - INFO - Step 49600, Prediction vs Actual:
2025-01-01 01:34:10,140 - TrainingLogger - INFO - Input 1: לנשים אחרות כרתו את הרגליים, אמרה וציינה כי במקרה של קורבנות רבים, שנפגעו בצורה הקשה ביותר, היה קושי של ממש בהבאתם לקבורה כמקובל - עטופים בתכריכים
2025-01-01 01:34:10,141 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:34:10,141 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁לנשים       | ✗     |
|     1 | ▁ולי            | ▁אחרות       | ✗     |
|     2 | .               | ▁כרת         | ✗     |
|     3 | ות              | ו            | ✗     |
|     4 | .               | ▁את          | ✗     |
|     5 | ▁זה             | ▁הרגליים     | ✗     |
|     6 | ▁שלהן           | ,            | ✗     |
|     7 | <pad>           | ▁אמרה        | ✗     |
|     8 | ,               | ▁וצ          | ✗     |
|     9 | רי              | יינה         | ✗     |
|    10 | ,               | ▁כי          | ✗     |
|    11 | ▁היא            | ▁במקרה       | ✗     |
|    12 | ▁הטוב           | ▁של          | ✗     |
|    13 | ▁מלחמה          | ▁קורבנות     | ✗     |
|    14 | ,               | ▁רבים        | ✗     |
|    15 | </s>            | ,            | ✗     |
|    16 | </s>            | ▁שנפגע       | ✗     |
|    17 | ו               | ו            | ✓     |
|    18 | ▁מה             | ▁בצורה       | ✗     |
|    19 | ▁זו             | ▁הקשה        | ✗     |
|    20 | ▁יותר           | ▁ביותר       | ✗     |
|    21 | .               | ,            | ✗     |
|    22 | </s>            | ▁היה         | ✗     |
|    23 | ▁להם            | ▁קושי        | ✗     |
|    24 | ▁גדול           | ▁של          | ✗     |
|    25 | ▁מלחמה          | ▁ממש         | ✗     |
|    26 | </s>            | ▁ב           | ✗     |
|    27 | דין             | הבאת         | ✗     |
|    28 | ם               | ם            | ✓     |
|    29 | ▁של             | ▁לקבור       | ✗     |
|    30 | ה               | ה            | ✓     |
|    31 | .               | ▁כ           | ✗     |
|    32 | "               | מקובל        | ✗     |
|    33 | ת               | ▁-           | ✗     |
|    34 | -               | ▁עטופ        | ✗     |
|    35 | ה               | ים           | ✗     |
|    36 | ▁אחרים          | ▁בת          | ✗     |
|    37 | לם              | כריכים       | ✗     |
|    38 | .               |              | ✗     |

2025-01-01 01:34:10,141 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:34:10,146 - TrainingLogger - INFO - Gradient norm: 7.6307
2025-01-01 01:34:16,839 - TrainingLogger - INFO - Step 49610, Batch metrics: Loss: 7.9200, Accuracy: 0.0795, Perplexity: 2751.7463
2025-01-01 01:34:23,582 - TrainingLogger - INFO - Step 49620, Batch metrics: Loss: 7.4100, Accuracy: 0.0984, Perplexity: 1652.4616
2025-01-01 01:34:30,943 - TrainingLogger - INFO - Step 49630, Batch metrics: Loss: 7.3426, Accuracy: 0.0874, Perplexity: 1544.7650
2025-01-01 01:34:37,575 - TrainingLogger - INFO - Step 49640, Batch metrics: Loss: 7.8433, Accuracy: 0.0429, Perplexity: 2548.5354
2025-01-01 01:34:44,560 - TrainingLogger - INFO - Step 49650, Batch metrics: Loss: 7.3201, Accuracy: 0.1038, Perplexity: 1510.4210
2025-01-01 01:34:51,790 - TrainingLogger - INFO - Step 49660, Batch metrics: Loss: 7.6912, Accuracy: 0.0656, Perplexity: 2189.1047
2025-01-01 01:34:59,269 - TrainingLogger - INFO - Step 49670, Batch metrics: Loss: 7.3580, Accuracy: 0.0583, Perplexity: 1568.6972
2025-01-01 01:35:06,368 - TrainingLogger - INFO - Step 49680, Batch metrics: Loss: 7.5988, Accuracy: 0.1040, Perplexity: 1995.8541
2025-01-01 01:35:13,167 - TrainingLogger - INFO - Step 49690, Batch metrics: Loss: 7.3925, Accuracy: 0.0745, Perplexity: 1623.7681
2025-01-01 01:35:20,703 - TrainingLogger - INFO - Step 49700, Batch metrics: Loss: 7.6650, Accuracy: 0.0849, Perplexity: 2132.4283
2025-01-01 01:35:20,703 - TrainingLogger - INFO - Step 49700, Prediction vs Actual:
2025-01-01 01:35:20,703 - TrainingLogger - INFO - Input 1: לכן מדינות רבות קבעו לאחרונה הסדרים שנועדו לקדם איסוף וניתוח רצוף של נתוני שכר בצורה מגדרית לצד שקיפות בשכר העובדים, כך שייחשפו כל ההטיות המגדריות או האפליה על רקע מגדרי
2025-01-01 01:35:20,704 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:35:20,704 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁לכן         | ✗     |
|     1 | ▁-              | ▁מדינות      | ✗     |
|     2 | ▁-              | ▁רבות        | ✗     |
|     3 | ,               | ▁קבע         | ✗     |
|     4 | ה               | ו            | ✗     |
|     5 | ,               | ▁לאחרונה     | ✗     |
|     6 | ,               | ▁הסדר        | ✗     |
|     7 | ה               | ים           | ✗     |
|     8 | ▁האלה           | ▁שנועדו      | ✗     |
|     9 | ▁לצאת           | ▁לקדם        | ✗     |
|    10 | ▁את             | ▁איסוף       | ✗     |
|    11 | ▁כספים          | ▁ו           | ✗     |
|    12 | כספים           | ניתוח        | ✗     |
|    13 | ים              | ▁רצו         | ✗     |
|    14 | פים             | ף            | ✗     |
|    15 | .               | ▁של          | ✗     |
|    16 | ▁כל             | ▁נתוני       | ✗     |
|    17 | ▁המשפחה         | ▁שכר         | ✗     |
|    18 | ות              | ▁בצורה       | ✗     |
|    19 | ▁זו             | ▁מגדר        | ✗     |
|    20 | ית              | ית           | ✓     |
|    21 | .               | ▁לצד         | ✗     |
|    22 | ה               | ▁שק          | ✗     |
|    23 | יפות            | יפות         | ✓     |
|    24 | ,               | ▁בשכר        | ✗     |
|    25 | ם               | ▁העובדים     | ✗     |
|    26 | .               | ,            | ✗     |
|    27 | </s>            | ▁כך          | ✗     |
|    28 | ▁גם             | ▁שיי         | ✗     |
|    29 | בחר             | חש           | ✗     |
|    30 | לו              | פו           | ✗     |
|    31 | ▁להם            | ▁כל          | ✗     |
|    32 | ▁אלה            | ▁הה          | ✗     |
|    33 | ון              | טיות         | ✗     |
|    34 | ▁שלהם           | ▁המ          | ✗     |
|    35 | עצמות           | גדר          | ✗     |
|    36 | ות              | יות          | ✗     |
|    37 | ▁שלהם           | ▁או          | ✗     |
|    38 | ▁לא             | ▁האפל        | ✗     |
|    39 | ה               | יה           | ✗     |
|    40 | .               | ▁על          | ✗     |
|    41 | ▁פני            | ▁רקע         | ✗     |
|    42 | ▁כלכלי          | ▁מגדר        | ✗     |
|    43 | ▁הרגיל          | י            | ✗     |
|    44 | .               |              | ✗     |

2025-01-01 01:35:20,704 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:35:20,709 - TrainingLogger - INFO - Gradient norm: 10.0524
2025-01-01 01:35:28,038 - TrainingLogger - INFO - Step 49710, Batch metrics: Loss: 7.6942, Accuracy: 0.0532, Perplexity: 2195.5663
2025-01-01 01:35:34,719 - TrainingLogger - INFO - Step 49720, Batch metrics: Loss: 7.4629, Accuracy: 0.0662, Perplexity: 1742.2291
2025-01-01 01:35:41,545 - TrainingLogger - INFO - Step 49730, Batch metrics: Loss: 7.1139, Accuracy: 0.0794, Perplexity: 1228.9817
2025-01-01 01:35:48,550 - TrainingLogger - INFO - Step 49740, Batch metrics: Loss: 8.1220, Accuracy: 0.0374, Perplexity: 3367.6041
2025-01-01 01:35:55,238 - TrainingLogger - INFO - Step 49750, Batch metrics: Loss: 7.1435, Accuracy: 0.0741, Perplexity: 1265.8020
2025-01-01 01:36:02,425 - TrainingLogger - INFO - Step 49760, Batch metrics: Loss: 7.8385, Accuracy: 0.0828, Perplexity: 2536.4664
2025-01-01 01:36:09,492 - TrainingLogger - INFO - Step 49770, Batch metrics: Loss: 7.6067, Accuracy: 0.0870, Perplexity: 2011.6613
2025-01-01 01:36:16,598 - TrainingLogger - INFO - Step 49780, Batch metrics: Loss: 7.4629, Accuracy: 0.0837, Perplexity: 1742.1626
2025-01-01 01:36:22,838 - TrainingLogger - INFO - Step 49790, Batch metrics: Loss: 7.4420, Accuracy: 0.0946, Perplexity: 1706.0760
2025-01-01 01:36:29,562 - TrainingLogger - INFO - Step 49800, Batch metrics: Loss: 8.0965, Accuracy: 0.0395, Perplexity: 3282.8869
2025-01-01 01:36:29,562 - TrainingLogger - INFO - Step 49800, Prediction vs Actual:
2025-01-01 01:36:29,562 - TrainingLogger - INFO - Input 1: עבור פעולת הגיהוץ גובה הסולק מבית העסק עמלת סליקה, אותה הוא חולק עם המנפיק - הגוף האחראי על הוצאת הכרטיס בנק או אחת מחברות כרטיסי האשראי
2025-01-01 01:36:29,563 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:36:29,563 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁עבור        | ✗     |
|     1 | ▁זה             | ▁פעולת       | ✗     |
|     2 | ▁-              | ▁הג          | ✗     |
|     3 | י               | יה           | ✗     |
|     4 | ▁לא             | וץ           | ✗     |
|     5 | ▁הזה            | ▁גובה        | ✗     |
|     6 | ו               | ▁ה           | ✗     |
|     7 | -               | סולק         | ✗     |
|     8 | ות              | ▁מבית        | ✗     |
|     9 | ▁המשפט          | ▁העסק        | ✗     |
|    10 | י               | ▁עמל         | ✗     |
|    11 | ה               | ת            | ✗     |
|    12 | ▁על             | ▁ס           | ✗     |
|    13 | ה               | ליקה         | ✗     |
|    14 | .               | ,            | ✗     |
|    15 | <pad>           | ▁אותה        | ✗     |
|    16 | ▁כמות           | ▁הוא         | ✗     |
|    17 | ▁אמר            | ▁חולק        | ✗     |
|    18 | ▁עליו           | ▁עם          | ✗     |
|    19 | ▁ישראל          | ▁המנ         | ✗     |
|    20 | יה              | פיק          | ✗     |
|    21 | ים              | ▁-           | ✗     |
|    22 | <pad>           | ▁הגוף        | ✗     |
|    23 | ▁שלו            | ▁האחראי      | ✗     |
|    24 | ▁עליו           | ▁על          | ✗     |
|    25 | ▁ה              | ▁הוצאת       | ✗     |
|    26 | ו               | ▁הכרטיס      | ✗     |
|    27 | .               | ▁בנק         | ✗     |
|    28 | .               | ▁או          | ✗     |
|    29 | ט               | ▁אחת         | ✗     |
|    30 | ,               | ▁מחבר        | ✗     |
|    31 | ו               | ות           | ✗     |
|    32 | יו              | ▁כרטיסי      | ✗     |
|    33 | ו               | ▁האשראי      | ✗     |
|    34 | ▁שלו            |              | ✗     |

2025-01-01 01:36:29,563 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:36:29,568 - TrainingLogger - INFO - Gradient norm: 7.6187
2025-01-01 01:36:36,563 - TrainingLogger - INFO - Step 49810, Batch metrics: Loss: 7.9294, Accuracy: 0.0476, Perplexity: 2777.7172
2025-01-01 01:36:43,566 - TrainingLogger - INFO - Step 49820, Batch metrics: Loss: 8.0455, Accuracy: 0.0534, Perplexity: 3119.6050
2025-01-01 01:36:50,945 - TrainingLogger - INFO - Step 49830, Batch metrics: Loss: 8.0085, Accuracy: 0.0523, Perplexity: 3006.4675
2025-01-01 01:36:58,006 - TrainingLogger - INFO - Step 49840, Batch metrics: Loss: 6.9023, Accuracy: 0.1353, Perplexity: 994.5666
2025-01-01 01:37:05,208 - TrainingLogger - INFO - Step 49850, Batch metrics: Loss: 7.1909, Accuracy: 0.0838, Perplexity: 1327.3388
2025-01-01 01:37:12,622 - TrainingLogger - INFO - Step 49860, Batch metrics: Loss: 7.4886, Accuracy: 0.0809, Perplexity: 1787.5951
2025-01-01 01:37:19,795 - TrainingLogger - INFO - Step 49870, Batch metrics: Loss: 7.4279, Accuracy: 0.0674, Perplexity: 1682.3502
2025-01-01 01:37:27,127 - TrainingLogger - INFO - Step 49880, Batch metrics: Loss: 7.3860, Accuracy: 0.0741, Perplexity: 1613.2513
2025-01-01 01:37:34,532 - TrainingLogger - INFO - Step 49890, Batch metrics: Loss: 7.3871, Accuracy: 0.0595, Perplexity: 1615.0639
2025-01-01 01:37:41,677 - TrainingLogger - INFO - Step 49900, Batch metrics: Loss: 8.3466, Accuracy: 0.0422, Perplexity: 4216.0017
2025-01-01 01:37:41,678 - TrainingLogger - INFO - Step 49900, Prediction vs Actual:
2025-01-01 01:37:41,678 - TrainingLogger - INFO - Input 1: לאחר שזיהית את המצב שבו אתה נמצא, הגיע הזמן לבחון את התחושה לגבי היריב
2025-01-01 01:37:41,678 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:37:41,679 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ת               | ▁לאחר        | ✗     |
|     1 | ▁-              | ▁ש           | ✗     |
|     2 | ...             | זיה          | ✗     |
|     3 | ▁-              | ית           | ✗     |
|     4 | ם               | ▁את          | ✗     |
|     5 | ▁זה             | ▁המצב        | ✗     |
|     6 | ה               | ▁שבו         | ✗     |
|     7 | ▁היא            | ▁אתה         | ✗     |
|     8 | ▁יודע           | ▁נמצא        | ✗     |
|     9 | ▁שם             | ,            | ✗     |
|    10 | ▁נכון           | ▁הגיע        | ✗     |
|    11 | ▁לכאן           | ▁הזמן        | ✗     |
|    12 | .               | ▁לבחון       | ✗     |
|    13 | ▁את             | ▁את          | ✓     |
|    14 | ▁זה             | ▁התחושה      | ✗     |
|    15 | ▁הזאת           | ▁לגבי        | ✗     |
|    16 | ▁זה             | ▁היריב       | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | ,               | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | ,               | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | .               | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | ▁לא             | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | <pad>           | <pad>        | ✓     |
|    43 | .               | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | ל               | <pad>        | ✗     |
|    47 | .               | <pad>        | ✗     |
|    48 | </s>            | <pad>        | ✗     |
|    49 | ית              | <pad>        | ✗     |
|    50 | .               |              | ✗     |

2025-01-01 01:37:41,679 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:37:41,683 - TrainingLogger - INFO - Gradient norm: 7.8105
2025-01-01 01:37:48,768 - TrainingLogger - INFO - Step 49910, Batch metrics: Loss: 7.9301, Accuracy: 0.0687, Perplexity: 2779.7497
2025-01-01 01:37:55,312 - TrainingLogger - INFO - Step 49920, Batch metrics: Loss: 7.4845, Accuracy: 0.0575, Perplexity: 1780.2346
2025-01-01 01:38:03,465 - TrainingLogger - INFO - Step 49930, Batch metrics: Loss: 7.3683, Accuracy: 0.0684, Perplexity: 1584.9378
2025-01-01 01:38:10,402 - TrainingLogger - INFO - Step 49940, Batch metrics: Loss: 7.6547, Accuracy: 0.0659, Perplexity: 2110.4680
2025-01-01 01:38:17,530 - TrainingLogger - INFO - Step 49950, Batch metrics: Loss: 7.1861, Accuracy: 0.0823, Perplexity: 1320.9642
2025-01-01 01:38:24,716 - TrainingLogger - INFO - Step 49960, Batch metrics: Loss: 7.9750, Accuracy: 0.0692, Perplexity: 2907.3118
2025-01-01 01:38:31,958 - TrainingLogger - INFO - Step 49970, Batch metrics: Loss: 7.2082, Accuracy: 0.0600, Perplexity: 1350.4689
2025-01-01 01:38:38,801 - TrainingLogger - INFO - Step 49980, Batch metrics: Loss: 6.9915, Accuracy: 0.0980, Perplexity: 1087.3807
2025-01-01 01:38:45,783 - TrainingLogger - INFO - Step 49990, Batch metrics: Loss: 7.6564, Accuracy: 0.0723, Perplexity: 2114.1302
2025-01-01 01:38:53,118 - TrainingLogger - INFO - Step 50000, Batch metrics: Loss: 7.5190, Accuracy: 0.0647, Perplexity: 1842.7211
2025-01-01 01:38:53,119 - TrainingLogger - INFO - Step 50000, Prediction vs Actual:
2025-01-01 01:38:53,119 - TrainingLogger - INFO - Input 1: במהלך השבוע, החליט יור ישראל ביתנו ליברמן לקדם את יוזמת החוק שפורסמה לראשונה ב-ynet, שבמרכזה - מניעת יכולתו של חבר כנסת שמואשם בפלילים לכהן כראש ממשלה
2025-01-01 01:38:53,120 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:38:53,120 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁במהלך       | ✗     |
|     1 | ▁-              | ▁השבוע       | ✗     |
|     2 | ▁-              | ,            | ✗     |
|     3 | ▁אני            | ▁החליט       | ✗     |
|     4 | ▁להיות          | ▁י           | ✗     |
|     5 | או              | ור           | ✗     |
|     6 | נט              | ▁ישראל       | ✗     |
|     7 | ,               | ▁ביתנו       | ✗     |
|     8 | ס               | ▁לי          | ✗     |
|     9 | י               | ברמן         | ✗     |
|    10 | ,               | ▁לקדם        | ✗     |
|    11 | ▁את             | ▁את          | ✓     |
|    12 | ▁זה             | ▁יוז         | ✗     |
|    13 | מת              | מת           | ✓     |
|    14 | ▁ה              | ▁החוק        | ✗     |
|    15 | .               | ▁ש           | ✗     |
|    16 | נטל             | פור          | ✗     |
|    17 | מה              | ס            | ✗     |
|    18 | מה              | מה           | ✓     |
|    19 | ▁לו             | ▁לראשונה     | ✗     |
|    20 | .               | ▁ב           | ✗     |
|    21 | שלטון           | -            | ✗     |
|    22 | M               | yn           | ✗     |
|    23 | יה              | et           | ✗     |
|    24 | ה               | ,            | ✗     |
|    25 | <pad>           | ▁שב          | ✗     |
|    26 | די              | מרכז         | ✗     |
|    27 | ה               | ה            | ✓     |
|    28 | ▁של             | ▁-           | ✗     |
|    29 | <pad>           | ▁מניע        | ✗     |
|    30 | ת               | ת            | ✓     |
|    31 | ▁ה              | ▁יכולתו      | ✗     |
|    32 | ▁של             | ▁של          | ✓     |
|    33 | ▁המדינה         | ▁חבר         | ✗     |
|    34 | ▁המושבעים       | ▁כנס         | ✗     |
|    35 | ת               | ת            | ✓     |
|    36 | .               | ▁שמו         | ✗     |
|    37 | צה              | אשם          | ✗     |
|    38 | ▁ב              | ▁בפל         | ✗     |
|    39 | אה              | ילים         | ✗     |
|    40 | ▁רבים           | ▁לכה         | ✗     |
|    41 | ון              | ן            | ✗     |
|    42 | ▁ב              | ▁כראש        | ✗     |
|    43 | ▁הממשלה         | ▁ממשלה       | ✗     |
|    44 | .               |              | ✗     |

2025-01-01 01:38:53,120 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:38:53,125 - TrainingLogger - INFO - Gradient norm: 9.2797
2025-01-01 01:39:00,654 - TrainingLogger - INFO - Step 50010, Batch metrics: Loss: 7.8408, Accuracy: 0.0800, Perplexity: 2542.3428
2025-01-01 01:39:08,078 - TrainingLogger - INFO - Step 50020, Batch metrics: Loss: 7.7759, Accuracy: 0.0773, Perplexity: 2382.4590
2025-01-01 01:39:15,408 - TrainingLogger - INFO - Step 50030, Batch metrics: Loss: 8.0378, Accuracy: 0.0625, Perplexity: 3095.6645
2025-01-01 01:39:22,740 - TrainingLogger - INFO - Step 50040, Batch metrics: Loss: 7.4379, Accuracy: 0.1000, Perplexity: 1699.2091
2025-01-01 01:39:30,085 - TrainingLogger - INFO - Step 50050, Batch metrics: Loss: 7.6765, Accuracy: 0.0964, Perplexity: 2156.9567
2025-01-01 01:39:37,630 - TrainingLogger - INFO - Step 50060, Batch metrics: Loss: 6.9506, Accuracy: 0.0958, Perplexity: 1043.7685
2025-01-01 01:39:44,876 - TrainingLogger - INFO - Step 50070, Batch metrics: Loss: 7.0007, Accuracy: 0.0765, Perplexity: 1097.4455
2025-01-01 01:39:51,797 - TrainingLogger - INFO - Step 50080, Batch metrics: Loss: 7.8055, Accuracy: 0.1146, Perplexity: 2454.0506
2025-01-01 01:39:59,051 - TrainingLogger - INFO - Step 50090, Batch metrics: Loss: 7.3924, Accuracy: 0.0647, Perplexity: 1623.5644
2025-01-01 01:40:06,670 - TrainingLogger - INFO - Step 50100, Batch metrics: Loss: 7.3256, Accuracy: 0.0846, Perplexity: 1518.7568
2025-01-01 01:40:06,670 - TrainingLogger - INFO - Step 50100, Prediction vs Actual:
2025-01-01 01:40:06,670 - TrainingLogger - INFO - Input 1: היכולת הרטורית והשכנוע, וגם ההבנה של איך להציג דברים בפני בית המשפט
2025-01-01 01:40:06,671 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:40:06,671 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁היכולת      | ✗     |
|     1 | ▁הוא            | ▁הר          | ✗     |
|     2 | ▁אני            | טורי         | ✗     |
|     3 | ▁-              | ת            | ✗     |
|     4 | ▁-              | ▁וה          | ✗     |
|     5 | ות              | שכנוע        | ✗     |
|     6 | ים              | ,            | ✗     |
|     7 | ▁לא             | ▁וגם         | ✗     |
|     8 | ▁לא             | ▁ההבנה       | ✗     |
|     9 | ▁שלנו           | ▁של          | ✗     |
|    10 | ▁המדינה         | ▁איך         | ✗     |
|    11 | ▁זה             | ▁להציג       | ✗     |
|    12 | ▁את             | ▁דברים       | ✗     |
|    13 | ▁כאלה           | ▁בפני        | ✗     |
|    14 | ▁העם            | ▁בית         | ✗     |
|    15 | ▁המשפט          | ▁המשפט       | ✓     |
|    16 | .               | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | י               | <pad>        | ✗     |
|    19 | י               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ▁לא             | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ית              | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | ▁לא             | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | ה               | <pad>        | ✗     |
|    39 | ה               | <pad>        | ✗     |
|    40 | </s>            |              | ✗     |

2025-01-01 01:40:06,671 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:40:06,676 - TrainingLogger - INFO - Gradient norm: 10.1058
2025-01-01 01:40:14,206 - TrainingLogger - INFO - Step 50110, Batch metrics: Loss: 7.0575, Accuracy: 0.0919, Perplexity: 1161.4838
2025-01-01 01:40:22,078 - TrainingLogger - INFO - Step 50120, Batch metrics: Loss: 7.7148, Accuracy: 0.0909, Perplexity: 2241.3342
2025-01-01 01:40:29,542 - TrainingLogger - INFO - Step 50130, Batch metrics: Loss: 7.1702, Accuracy: 0.0765, Perplexity: 1300.1565
2025-01-01 01:40:36,628 - TrainingLogger - INFO - Step 50140, Batch metrics: Loss: 7.8598, Accuracy: 0.0833, Perplexity: 2590.9573
2025-01-01 01:40:43,508 - TrainingLogger - INFO - Step 50150, Batch metrics: Loss: 7.3865, Accuracy: 0.0596, Perplexity: 1613.9814
2025-01-01 01:40:50,762 - TrainingLogger - INFO - Step 50160, Batch metrics: Loss: 7.3235, Accuracy: 0.1056, Perplexity: 1515.5324
2025-01-01 01:40:57,734 - TrainingLogger - INFO - Step 50170, Batch metrics: Loss: 7.1357, Accuracy: 0.0923, Perplexity: 1256.0162
2025-01-01 01:41:05,146 - TrainingLogger - INFO - Step 50180, Batch metrics: Loss: 7.5700, Accuracy: 0.0866, Perplexity: 1939.1425
2025-01-01 01:41:12,249 - TrainingLogger - INFO - Step 50190, Batch metrics: Loss: 7.1388, Accuracy: 0.0448, Perplexity: 1259.9200
2025-01-01 01:41:19,679 - TrainingLogger - INFO - Step 50200, Batch metrics: Loss: 7.3839, Accuracy: 0.1024, Perplexity: 1609.8762
2025-01-01 01:41:19,679 - TrainingLogger - INFO - Step 50200, Prediction vs Actual:
2025-01-01 01:41:19,679 - TrainingLogger - INFO - Input 1: ברשות השופטת אמרו בתגובה כי מדובר בלא יותר מספין תקשורתי
2025-01-01 01:41:19,680 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:41:19,680 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁הקודמת         | ▁ברשות       | ✗     |
|     1 | ▁אה             | ▁השופט       | ✗     |
|     2 | ▁-              | ת            | ✗     |
|     3 | ▁-              | ▁אמרו        | ✗     |
|     4 | ▁-              | ▁בתגובה      | ✗     |
|     5 | ▁-              | ▁כי          | ✗     |
|     6 | ▁הוא            | ▁מדובר       | ✗     |
|     7 | ▁ב              | ▁בלא         | ✗     |
|     8 | י               | ▁יותר        | ✗     |
|     9 | ▁מזה            | ▁מס          | ✗     |
|    10 | פי              | פין          | ✗     |
|    11 | ▁אחד            | ▁תקשורת      | ✗     |
|    12 | י               | י            | ✓     |
|    13 | .               | <pad>        | ✗     |
|    14 | ,               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | י               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ,               | <pad>        | ✗     |
|    20 | ▁זה             | <pad>        | ✗     |
|    21 | ▁זה             | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | ה               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ▁ב              | <pad>        | ✗     |
|    30 | יה              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁זה             | <pad>        | ✗     |
|    33 | ה               | <pad>        | ✗     |
|    34 | ה               | <pad>        | ✗     |
|    35 | ה               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            |              | ✗     |

2025-01-01 01:41:19,680 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:41:19,685 - TrainingLogger - INFO - Gradient norm: 7.6573
2025-01-01 01:41:26,893 - TrainingLogger - INFO - Step 50210, Batch metrics: Loss: 7.5810, Accuracy: 0.0663, Perplexity: 1960.5331
2025-01-01 01:41:34,617 - TrainingLogger - INFO - Step 50220, Batch metrics: Loss: 7.7785, Accuracy: 0.0700, Perplexity: 2388.6938
2025-01-01 01:41:42,712 - TrainingLogger - INFO - Step 50230, Batch metrics: Loss: 7.2442, Accuracy: 0.0796, Perplexity: 1399.8977
2025-01-01 01:41:49,928 - TrainingLogger - INFO - Step 50240, Batch metrics: Loss: 7.5307, Accuracy: 0.0637, Perplexity: 1864.4194
2025-01-01 01:41:57,086 - TrainingLogger - INFO - Step 50250, Batch metrics: Loss: 7.4765, Accuracy: 0.0645, Perplexity: 1766.0084
2025-01-01 01:42:04,046 - TrainingLogger - INFO - Step 50260, Batch metrics: Loss: 7.5030, Accuracy: 0.0680, Perplexity: 1813.4890
2025-01-01 01:42:10,952 - TrainingLogger - INFO - Step 50270, Batch metrics: Loss: 7.3913, Accuracy: 0.1055, Perplexity: 1621.7438
2025-01-01 01:42:18,716 - TrainingLogger - INFO - Step 50280, Batch metrics: Loss: 7.5076, Accuracy: 0.0681, Perplexity: 1821.8000
2025-01-01 01:42:25,930 - TrainingLogger - INFO - Step 50290, Batch metrics: Loss: 7.7569, Accuracy: 0.0604, Perplexity: 2337.5705
2025-01-01 01:42:32,867 - TrainingLogger - INFO - Step 50300, Batch metrics: Loss: 7.1489, Accuracy: 0.0920, Perplexity: 1272.7356
2025-01-01 01:42:32,868 - TrainingLogger - INFO - Step 50300, Prediction vs Actual:
2025-01-01 01:42:32,868 - TrainingLogger - INFO - Input 1: כשאריק שרון היה ראש ממשלה הוא אמר לי, אתה יכול לתת לי עצה? אני עומד לקבל מהמלך עבדאללה סוס במתנה
2025-01-01 01:42:32,868 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:42:32,868 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁כש          | ✗     |
|     1 | ,               | אריק         | ✗     |
|     2 | ▁-              | ▁שרון        | ✗     |
|     3 | ▁-              | ▁היה         | ✗     |
|     4 | ▁לו             | ▁ראש         | ✗     |
|     5 | ▁העיר           | ▁ממשלה       | ✗     |
|     6 | .               | ▁הוא         | ✗     |
|     7 | ▁היה            | ▁אמר         | ✗     |
|     8 | ▁לי             | ▁לי          | ✓     |
|     9 | ▁שהוא           | ,            | ✗     |
|    10 | ▁"              | ▁אתה         | ✗     |
|    11 | ▁יודע           | ▁יכול        | ✗     |
|    12 | ▁ללכת           | ▁לתת         | ✗     |
|    13 | ▁לי             | ▁לי          | ✓     |
|    14 | ▁קצת            | ▁עצה         | ✗     |
|    15 | ▁טובה           | ?            | ✗     |
|    16 | .               | ▁אני         | ✗     |
|    17 | ▁לא             | ▁עומד        | ✗     |
|    18 | ▁לתת            | ▁לקבל        | ✗     |
|    19 | ▁את             | ▁מה          | ✗     |
|    20 | ▁לעשות          | מלך          | ✗     |
|    21 | <pad>           | ▁עבד         | ✗     |
|    22 | ות              | אל           | ✗     |
|    23 | .               | לה           | ✗     |
|    24 | .               | ▁סוס         | ✗     |
|    25 | ון              | ▁במתנה       | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               |              | ✗     |

2025-01-01 01:42:32,868 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:42:32,873 - TrainingLogger - INFO - Gradient norm: 10.4011
2025-01-01 01:42:40,176 - TrainingLogger - INFO - Step 50310, Batch metrics: Loss: 7.2207, Accuracy: 0.1218, Perplexity: 1367.4789
2025-01-01 01:42:47,452 - TrainingLogger - INFO - Step 50320, Batch metrics: Loss: 6.9308, Accuracy: 0.1215, Perplexity: 1023.3459
2025-01-01 01:42:55,031 - TrainingLogger - INFO - Step 50330, Batch metrics: Loss: 7.6481, Accuracy: 0.0765, Perplexity: 2096.5920
2025-01-01 01:43:01,949 - TrainingLogger - INFO - Step 50340, Batch metrics: Loss: 7.6889, Accuracy: 0.0751, Perplexity: 2184.0386
2025-01-01 01:43:09,324 - TrainingLogger - INFO - Step 50350, Batch metrics: Loss: 7.3102, Accuracy: 0.0914, Perplexity: 1495.5208
2025-01-01 01:43:16,377 - TrainingLogger - INFO - Step 50360, Batch metrics: Loss: 7.4105, Accuracy: 0.0734, Perplexity: 1653.3025
2025-01-01 01:43:24,064 - TrainingLogger - INFO - Step 50370, Batch metrics: Loss: 7.3199, Accuracy: 0.0769, Perplexity: 1510.0761
2025-01-01 01:43:31,515 - TrainingLogger - INFO - Step 50380, Batch metrics: Loss: 7.6310, Accuracy: 0.0828, Perplexity: 2061.2085
2025-01-01 01:43:38,195 - TrainingLogger - INFO - Step 50390, Batch metrics: Loss: 7.5952, Accuracy: 0.1071, Perplexity: 1988.5736
2025-01-01 01:43:45,325 - TrainingLogger - INFO - Step 50400, Batch metrics: Loss: 6.7799, Accuracy: 0.1377, Perplexity: 879.9644
2025-01-01 01:43:45,325 - TrainingLogger - INFO - Step 50400, Prediction vs Actual:
2025-01-01 01:43:45,325 - TrainingLogger - INFO - Input 1: אולי עם מדינות באפריקה אבל לא עם מדינות במפרץ
2025-01-01 01:43:45,326 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:43:45,326 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁אולי        | ✗     |
|     1 | ▁יותר           | ▁עם          | ✗     |
|     2 | .               | ▁מדינות      | ✗     |
|     3 | ▁-              | ▁באפריקה     | ✗     |
|     4 | .               | ▁אבל         | ✗     |
|     5 | ▁גם             | ▁לא          | ✗     |
|     6 | ▁מספיק          | ▁עם          | ✗     |
|     7 | ▁זה             | ▁מדינות      | ✗     |
|     8 | ▁אחרות          | ▁במפרץ       | ✗     |
|     9 | ,               | <pad>        | ✗     |
|    10 | ▁אחרות          | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | יות             | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | יות             | <pad>        | ✗     |
|    15 | יות             | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ▁אחרות          | <pad>        | ✗     |
|    19 | ▁אחרות          | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁אחרות          | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | ▁אחרות          | <pad>        | ✗     |
|    24 | </s>            | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | .               | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ▁אחרות          | <pad>        | ✗     |
|    35 | ▁אחרות          | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | <pad>           | <pad>        | ✓     |
|    40 | יות             | <pad>        | ✗     |
|    41 | <pad>           | <pad>        | ✓     |
|    42 | ▁אחרות          | <pad>        | ✗     |
|    43 | ▁אחרות          | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | ▁אחרות          |              | ✗     |

2025-01-01 01:43:45,326 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:43:45,331 - TrainingLogger - INFO - Gradient norm: 7.3447
2025-01-01 01:43:52,638 - TrainingLogger - INFO - Step 50410, Batch metrics: Loss: 7.0642, Accuracy: 0.1056, Perplexity: 1169.3583
2025-01-01 01:44:00,175 - TrainingLogger - INFO - Step 50420, Batch metrics: Loss: 7.6368, Accuracy: 0.0710, Perplexity: 2073.0900
2025-01-01 01:44:07,460 - TrainingLogger - INFO - Step 50430, Batch metrics: Loss: 7.1483, Accuracy: 0.0990, Perplexity: 1272.0021
2025-01-01 01:44:14,460 - TrainingLogger - INFO - Step 50440, Batch metrics: Loss: 7.1979, Accuracy: 0.1118, Perplexity: 1336.6028
2025-01-01 01:44:21,920 - TrainingLogger - INFO - Step 50450, Batch metrics: Loss: 7.6387, Accuracy: 0.0882, Perplexity: 2077.1103
2025-01-01 01:44:29,167 - TrainingLogger - INFO - Step 50460, Batch metrics: Loss: 7.3507, Accuracy: 0.1117, Perplexity: 1557.2883
2025-01-01 01:44:36,121 - TrainingLogger - INFO - Step 50470, Batch metrics: Loss: 7.5880, Accuracy: 0.0261, Perplexity: 1974.4207
2025-01-01 01:44:43,749 - TrainingLogger - INFO - Step 50480, Batch metrics: Loss: 7.4278, Accuracy: 0.0824, Perplexity: 1682.1553
2025-01-01 01:44:50,797 - TrainingLogger - INFO - Step 50490, Batch metrics: Loss: 7.8169, Accuracy: 0.0649, Perplexity: 2482.0868
2025-01-01 01:44:57,934 - TrainingLogger - INFO - Step 50500, Batch metrics: Loss: 7.1741, Accuracy: 0.0787, Perplexity: 1305.2371
2025-01-01 01:44:57,935 - TrainingLogger - INFO - Step 50500, Prediction vs Actual:
2025-01-01 01:44:57,935 - TrainingLogger - INFO - Input 1: וודאו כי יש להם תחומי אחריות קבועים ומשמעותיים בבית
2025-01-01 01:44:57,936 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:44:57,936 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁וודא        | ✗     |
|     1 | ה               | ו            | ✗     |
|     2 | ▁לא             | ▁כי          | ✗     |
|     3 | ▁הם             | ▁יש          | ✗     |
|     4 | ▁להם            | ▁להם         | ✓     |
|     5 | ▁עוד            | ▁תחומי       | ✗     |
|     6 | ▁אחריות         | ▁אחריות      | ✓     |
|     7 | ▁אחרים          | ▁קבועים      | ✗     |
|     8 | ,               | ▁ו           | ✗     |
|     9 | ציבור           | משמעות       | ✗     |
|    10 | יים             | יים          | ✓     |
|    11 | ▁יותר           | ▁בבית        | ✗     |
|    12 | ▁המשפט          | <pad>        | ✗     |
|    13 | ם               | <pad>        | ✗     |
|    14 | ם               | <pad>        | ✗     |
|    15 | ▁הם             | <pad>        | ✗     |
|    16 | ▁הלבן           | <pad>        | ✗     |
|    17 | ם               | <pad>        | ✗     |
|    18 | ▁המשפט          | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | ▁הם             | <pad>        | ✗     |
|    21 | ם               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁חולים          | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁הזה            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | ,               | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | ,               | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ▁הם             | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | .               | <pad>        | ✗     |
|    47 | </s>            | <pad>        | ✗     |
|    48 | <pad>           |              | ✗     |

2025-01-01 01:44:57,936 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:44:57,941 - TrainingLogger - INFO - Gradient norm: 10.3734
2025-01-01 01:45:04,809 - TrainingLogger - INFO - Step 50510, Batch metrics: Loss: 7.6276, Accuracy: 0.0726, Perplexity: 2054.1626
2025-01-01 01:45:11,478 - TrainingLogger - INFO - Step 50520, Batch metrics: Loss: 7.8393, Accuracy: 0.0588, Perplexity: 2538.3272
2025-01-01 01:45:19,200 - TrainingLogger - INFO - Step 50530, Batch metrics: Loss: 7.8245, Accuracy: 0.0884, Perplexity: 2501.1295
2025-01-01 01:45:26,091 - TrainingLogger - INFO - Step 50540, Batch metrics: Loss: 7.9867, Accuracy: 0.0641, Perplexity: 2941.5178
2025-01-01 01:45:33,531 - TrainingLogger - INFO - Step 50550, Batch metrics: Loss: 7.3569, Accuracy: 0.0984, Perplexity: 1567.0136
2025-01-01 01:45:40,873 - TrainingLogger - INFO - Step 50560, Batch metrics: Loss: 7.8318, Accuracy: 0.0394, Perplexity: 2519.3618
2025-01-01 01:45:48,401 - TrainingLogger - INFO - Step 50570, Batch metrics: Loss: 7.1637, Accuracy: 0.1128, Perplexity: 1291.7049
2025-01-01 01:45:55,221 - TrainingLogger - INFO - Step 50580, Batch metrics: Loss: 7.4309, Accuracy: 0.0607, Perplexity: 1687.3779
2025-01-01 01:46:02,689 - TrainingLogger - INFO - Step 50590, Batch metrics: Loss: 7.7658, Accuracy: 0.0805, Perplexity: 2358.6188
2025-01-01 01:46:09,620 - TrainingLogger - INFO - Step 50600, Batch metrics: Loss: 7.0876, Accuracy: 0.0990, Perplexity: 1197.0814
2025-01-01 01:46:09,620 - TrainingLogger - INFO - Step 50600, Prediction vs Actual:
2025-01-01 01:46:09,620 - TrainingLogger - INFO - Input 1: המסרים כן מחלחלים, גם שלה ובעיקר שלנו
2025-01-01 01:46:09,621 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:46:09,621 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁המסר        | ✗     |
|     1 | ▁-              | ים           | ✗     |
|     2 | ▁-              | ▁כן          | ✗     |
|     3 | ▁-              | ▁מ           | ✗     |
|     4 | ▁-              | חלחל         | ✗     |
|     5 | ▁-              | ים           | ✗     |
|     6 | ▁רבים           | ,            | ✗     |
|     7 | ▁הוא            | ▁גם          | ✗     |
|     8 | ▁אני            | ▁שלה         | ✗     |
|     9 | ,               | ▁ו           | ✗     |
|    10 | שלך             | בעיקר        | ✗     |
|    11 | ו               | ▁שלנו        | ✗     |
|    12 | ▁לא             | <pad>        | ✗     |
|    13 | ▁לא             | <pad>        | ✗     |
|    14 | ▁לא             | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | ▁לא             | <pad>        | ✗     |
|    17 | ▁לא             | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ▁זה             | <pad>        | ✗     |
|    29 | ▁הוא            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ▁זה             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            | <pad>        | ✗     |
|    39 | ▁לא             | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | </s>            | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | ▁לא             | <pad>        | ✗     |
|    45 | </s>            |              | ✗     |

2025-01-01 01:46:09,621 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:46:09,626 - TrainingLogger - INFO - Gradient norm: 10.4002
2025-01-01 01:46:16,441 - TrainingLogger - INFO - Step 50610, Batch metrics: Loss: 7.6020, Accuracy: 0.0417, Perplexity: 2002.2569
2025-01-01 01:46:23,644 - TrainingLogger - INFO - Step 50620, Batch metrics: Loss: 7.4461, Accuracy: 0.0561, Perplexity: 1713.1120
2025-01-01 01:46:31,157 - TrainingLogger - INFO - Step 50630, Batch metrics: Loss: 7.6338, Accuracy: 0.0800, Perplexity: 2066.7977
2025-01-01 01:46:38,436 - TrainingLogger - INFO - Step 50640, Batch metrics: Loss: 7.3919, Accuracy: 0.0881, Perplexity: 1622.8632
2025-01-01 01:46:45,049 - TrainingLogger - INFO - Step 50650, Batch metrics: Loss: 7.9223, Accuracy: 0.1189, Perplexity: 2758.1083
2025-01-01 01:46:51,863 - TrainingLogger - INFO - Step 50660, Batch metrics: Loss: 7.2449, Accuracy: 0.0611, Perplexity: 1400.9735
2025-01-01 01:46:59,270 - TrainingLogger - INFO - Step 50670, Batch metrics: Loss: 7.7152, Accuracy: 0.0608, Perplexity: 2242.0824
2025-01-01 01:47:06,645 - TrainingLogger - INFO - Step 50680, Batch metrics: Loss: 7.0065, Accuracy: 0.0880, Perplexity: 1103.7532
2025-01-01 01:47:13,533 - TrainingLogger - INFO - Step 50690, Batch metrics: Loss: 7.3546, Accuracy: 0.0966, Perplexity: 1563.3864
2025-01-01 01:47:20,836 - TrainingLogger - INFO - Step 50700, Batch metrics: Loss: 7.4980, Accuracy: 0.0563, Perplexity: 1804.5033
2025-01-01 01:47:20,836 - TrainingLogger - INFO - Step 50700, Prediction vs Actual:
2025-01-01 01:47:20,836 - TrainingLogger - INFO - Input 1: במה הם אוכלים? צלחות מפלסטיק, שנלקחות מהם בתום הארוחה
2025-01-01 01:47:20,837 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:47:20,837 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁במה         | ✗     |
|     1 | ה               | ▁הם          | ✗     |
|     2 | ▁קיימים         | ▁אוכלים      | ✗     |
|     3 | ▁טוב            | ?            | ✗     |
|     4 | </s>            | ▁צלחות       | ✗     |
|     5 | </s>            | ▁מפלסטיק     | ✗     |
|     6 | ,               | ,            | ✓     |
|     7 | ▁הם             | ▁שנלקח       | ✗     |
|     8 | ו               | ות           | ✗     |
|     9 | ▁מה             | ▁מהם         | ✗     |
|    10 | .               | ▁בתום        | ✗     |
|    11 | ▁לב             | ▁הארוחה      | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ▁שלהם           | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁שלהם           | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁שלהם           | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ▁שלהם           | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | </s>            |              | ✗     |

2025-01-01 01:47:20,837 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:47:20,842 - TrainingLogger - INFO - Gradient norm: 9.9552
2025-01-01 01:47:28,048 - TrainingLogger - INFO - Step 50710, Batch metrics: Loss: 6.8946, Accuracy: 0.1148, Perplexity: 986.9270
2025-01-01 01:47:34,974 - TrainingLogger - INFO - Step 50720, Batch metrics: Loss: 7.1545, Accuracy: 0.0938, Perplexity: 1279.8298
2025-01-01 01:47:42,043 - TrainingLogger - INFO - Step 50730, Batch metrics: Loss: 7.3600, Accuracy: 0.0837, Perplexity: 1571.8143
2025-01-01 01:47:49,167 - TrainingLogger - INFO - Step 50740, Batch metrics: Loss: 7.4921, Accuracy: 0.0613, Perplexity: 1793.8797
2025-01-01 01:47:56,393 - TrainingLogger - INFO - Step 50750, Batch metrics: Loss: 7.7207, Accuracy: 0.0652, Perplexity: 2254.5593
2025-01-01 01:48:03,221 - TrainingLogger - INFO - Step 50760, Batch metrics: Loss: 7.7518, Accuracy: 0.0551, Perplexity: 2325.7252
2025-01-01 01:48:11,030 - TrainingLogger - INFO - Step 50770, Batch metrics: Loss: 7.6933, Accuracy: 0.0619, Perplexity: 2193.5958
2025-01-01 01:48:18,049 - TrainingLogger - INFO - Step 50780, Batch metrics: Loss: 7.6009, Accuracy: 0.0812, Perplexity: 1999.9058
2025-01-01 01:48:24,945 - TrainingLogger - INFO - Step 50790, Batch metrics: Loss: 7.4224, Accuracy: 0.0739, Perplexity: 1673.1094
2025-01-01 01:48:32,513 - TrainingLogger - INFO - Step 50800, Batch metrics: Loss: 7.7496, Accuracy: 0.1016, Perplexity: 2320.7135
2025-01-01 01:48:32,513 - TrainingLogger - INFO - Step 50800, Prediction vs Actual:
2025-01-01 01:48:32,513 - TrainingLogger - INFO - Input 1: ההתנדבות כוללת העברת הפעלה חברתית בכל תחום שמתאים למתנדבים ולגילאי המתמודדים - חיות, משחק, אומנות, מוסיקה, חידון, שירה בציבור, משחק וכדומה
2025-01-01 01:48:32,514 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:48:32,514 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁ה           | ✗     |
|     1 | ▁הוא            | התנדב        | ✗     |
|     2 | ▁הוא            | ות           | ✗     |
|     3 | ▁אני            | ▁כוללת       | ✗     |
|     4 | ▁-              | ▁העברת       | ✗     |
|     5 | ▁-              | ▁הפעלה       | ✗     |
|     6 | ▁זו             | ▁חברתית      | ✗     |
|     7 | ,               | ▁בכל         | ✗     |
|     8 | ▁מקרה           | ▁תחום        | ✗     |
|     9 | ,               | ▁שמתאים      | ✗     |
|    10 | ▁לה             | ▁ל           | ✗     |
|    11 | תביעה           | מתנדב        | ✗     |
|    12 | ים              | ים           | ✓     |
|    13 | ▁שלנו           | ▁ול          | ✗     |
|    14 | בית             | גיל          | ✗     |
|    15 | י               | אי           | ✗     |
|    16 | ה               | ▁המתמודד     | ✗     |
|    17 | ים              | ים           | ✓     |
|    18 | ▁האחרים         | ▁-           | ✗     |
|    19 | <pad>           | ▁חיות        | ✗     |
|    20 | ▁מחמד           | ,            | ✗     |
|    21 | <pad>           | ▁משחק        | ✗     |
|    22 | ים              | ,            | ✗     |
|    23 | <pad>           | ▁אומנות      | ✗     |
|    24 | ,               | ,            | ✓     |
|    25 | <pad>           | ▁מוסיקה      | ✗     |
|    26 | ,               | ,            | ✓     |
|    27 | ▁בית            | ▁חי          | ✗     |
|    28 | ר               | דון          | ✗     |
|    29 | ,               | ,            | ✓     |
|    30 | ▁"              | ▁שירה        | ✗     |
|    31 | ,               | ▁בציבור      | ✗     |
|    32 | ,               | ,            | ✓     |
|    33 | <pad>           | ▁משחק        | ✗     |
|    34 | ות              | ▁וכדומה      | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | ,               | <pad>        | ✗     |
|    37 | ,               | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | ,               | <pad>        | ✗     |
|    40 | ▁לא             | <pad>        | ✗     |
|    41 | <pad>           |              | ✗     |

2025-01-01 01:48:32,514 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:48:32,519 - TrainingLogger - INFO - Gradient norm: 22.4661
2025-01-01 01:48:39,513 - TrainingLogger - INFO - Step 50810, Batch metrics: Loss: 7.2574, Accuracy: 0.0789, Perplexity: 1418.5980
2025-01-01 01:48:46,280 - TrainingLogger - INFO - Step 50820, Batch metrics: Loss: 7.4643, Accuracy: 0.0331, Perplexity: 1744.6724
2025-01-01 01:48:53,103 - TrainingLogger - INFO - Step 50830, Batch metrics: Loss: 7.8527, Accuracy: 0.0927, Perplexity: 2572.7724
2025-01-01 01:49:00,192 - TrainingLogger - INFO - Step 50840, Batch metrics: Loss: 7.4370, Accuracy: 0.0733, Perplexity: 1697.6323
2025-01-01 01:49:07,215 - TrainingLogger - INFO - Step 50850, Batch metrics: Loss: 7.5495, Accuracy: 0.0357, Perplexity: 1899.8143
2025-01-01 01:49:14,752 - TrainingLogger - INFO - Step 50860, Batch metrics: Loss: 7.3082, Accuracy: 0.0693, Perplexity: 1492.5287
2025-01-01 01:49:21,640 - TrainingLogger - INFO - Step 50870, Batch metrics: Loss: 7.4978, Accuracy: 0.0909, Perplexity: 1804.1592
2025-01-01 01:49:28,817 - TrainingLogger - INFO - Step 50880, Batch metrics: Loss: 7.5268, Accuracy: 0.0539, Perplexity: 1857.0799
2025-01-01 01:49:36,215 - TrainingLogger - INFO - Step 50890, Batch metrics: Loss: 7.2086, Accuracy: 0.0964, Perplexity: 1351.0363
2025-01-01 01:49:42,900 - TrainingLogger - INFO - Step 50900, Batch metrics: Loss: 7.8169, Accuracy: 0.0698, Perplexity: 2482.2679
2025-01-01 01:49:42,900 - TrainingLogger - INFO - Step 50900, Prediction vs Actual:
2025-01-01 01:49:42,900 - TrainingLogger - INFO - Input 1: הציבור לא מבין את גודל הסכנה
2025-01-01 01:49:42,900 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:49:42,900 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הציבור      | ✗     |
|     1 | ▁-              | ▁לא          | ✗     |
|     2 | ,               | ▁מבין        | ✗     |
|     3 | ▁מה             | ▁את          | ✗     |
|     4 | ▁זה             | ▁גודל        | ✗     |
|     5 | ו               | ▁הסכנה       | ✗     |
|     6 | ▁הזאת           | <pad>        | ✗     |
|     7 | ,               | <pad>        | ✗     |
|     8 | ,               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | ▁היא            | <pad>        | ✗     |
|    11 | ,               | <pad>        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | ה               | <pad>        | ✗     |
|    15 | ▁כל             | <pad>        | ✗     |
|    16 | ה               | <pad>        | ✗     |
|    17 | </s>            | <pad>        | ✗     |
|    18 | ▁מה             | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | ה               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ,               | <pad>        | ✗     |
|    30 | ה               | <pad>        | ✗     |
|    31 | ▁מה             | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁ה              | <pad>        | ✗     |
|    34 | ▁הבעיות         | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | ▁מה             | <pad>        | ✗     |
|    38 | .               |              | ✗     |

2025-01-01 01:49:42,900 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:49:42,905 - TrainingLogger - INFO - Gradient norm: 9.2491
2025-01-01 01:49:50,340 - TrainingLogger - INFO - Step 50910, Batch metrics: Loss: 7.2998, Accuracy: 0.0722, Perplexity: 1479.9995
2025-01-01 01:49:57,745 - TrainingLogger - INFO - Step 50920, Batch metrics: Loss: 7.7303, Accuracy: 0.1028, Perplexity: 2276.1818
2025-01-01 01:50:04,607 - TrainingLogger - INFO - Step 50930, Batch metrics: Loss: 7.9944, Accuracy: 0.0217, Perplexity: 2964.1742
2025-01-01 01:50:12,164 - TrainingLogger - INFO - Step 50940, Batch metrics: Loss: 7.5997, Accuracy: 0.0727, Perplexity: 1997.5203
2025-01-01 01:50:19,065 - TrainingLogger - INFO - Step 50950, Batch metrics: Loss: 7.4299, Accuracy: 0.0582, Perplexity: 1685.6513
2025-01-01 01:50:26,723 - TrainingLogger - INFO - Step 50960, Batch metrics: Loss: 7.8040, Accuracy: 0.0629, Perplexity: 2450.4141
2025-01-01 01:50:34,547 - TrainingLogger - INFO - Step 50970, Batch metrics: Loss: 7.3426, Accuracy: 0.1063, Perplexity: 1544.7149
2025-01-01 01:50:41,545 - TrainingLogger - INFO - Step 50980, Batch metrics: Loss: 7.2174, Accuracy: 0.0745, Perplexity: 1362.9598
2025-01-01 01:50:48,266 - TrainingLogger - INFO - Step 50990, Batch metrics: Loss: 7.3585, Accuracy: 0.0690, Perplexity: 1569.4454
2025-01-01 01:50:55,521 - TrainingLogger - INFO - Step 51000, Batch metrics: Loss: 7.7289, Accuracy: 0.0941, Perplexity: 2273.0971
2025-01-01 01:50:55,521 - TrainingLogger - INFO - Step 51000, Prediction vs Actual:
2025-01-01 01:50:55,521 - TrainingLogger - INFO - Input 1: צריך לאפשר לראש הממשלה לטפל בקורונה
2025-01-01 01:50:55,522 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:50:55,522 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁צריך        | ✗     |
|     1 | ▁עוד            | ▁לאפשר       | ✗     |
|     2 | ▁-              | ▁לראש        | ✗     |
|     3 | ו               | ▁הממשלה      | ✗     |
|     4 | ,               | ▁לטפל        | ✗     |
|     5 | ▁בזה            | ▁בקור        | ✗     |
|     6 | ות              | ונה          | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | ב               | <pad>        | ✗     |
|    11 | ▁לא             | <pad>        | ✗     |
|    12 | ▁זה             | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | </s>            | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | </s>            | <pad>        | ✗     |
|    19 | ▁גם             | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | ▁לא             | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | ▁זה             | <pad>        | ✗     |
|    32 | <pad>           | <pad>        | ✓     |
|    33 | <pad>           | <pad>        | ✓     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ▁לא             | <pad>        | ✗     |
|    39 | .               | <pad>        | ✗     |
|    40 | .               | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | .               | <pad>        | ✗     |
|    43 | .               |              | ✗     |

2025-01-01 01:50:55,522 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:50:55,527 - TrainingLogger - INFO - Gradient norm: 8.2839
2025-01-01 01:51:02,443 - TrainingLogger - INFO - Step 51010, Batch metrics: Loss: 7.4188, Accuracy: 0.0670, Perplexity: 1666.9935
2025-01-01 01:51:09,762 - TrainingLogger - INFO - Step 51020, Batch metrics: Loss: 7.3754, Accuracy: 0.0830, Perplexity: 1596.2722
2025-01-01 01:51:17,373 - TrainingLogger - INFO - Step 51030, Batch metrics: Loss: 7.2095, Accuracy: 0.0950, Perplexity: 1352.2719
2025-01-01 01:51:24,646 - TrainingLogger - INFO - Step 51040, Batch metrics: Loss: 7.2754, Accuracy: 0.0719, Perplexity: 1444.2691
2025-01-01 01:51:32,282 - TrainingLogger - INFO - Step 51050, Batch metrics: Loss: 7.4262, Accuracy: 0.0984, Perplexity: 1679.3903
2025-01-01 01:51:39,769 - TrainingLogger - INFO - Step 51060, Batch metrics: Loss: 7.6038, Accuracy: 0.0697, Perplexity: 2005.8423
2025-01-01 01:51:46,675 - TrainingLogger - INFO - Step 51070, Batch metrics: Loss: 7.2317, Accuracy: 0.0920, Perplexity: 1382.5873
2025-01-01 01:51:53,664 - TrainingLogger - INFO - Step 51080, Batch metrics: Loss: 7.5084, Accuracy: 0.0995, Perplexity: 1823.2521
2025-01-01 01:52:00,556 - TrainingLogger - INFO - Step 51090, Batch metrics: Loss: 7.5983, Accuracy: 0.0392, Perplexity: 1994.8085
2025-01-01 01:52:07,930 - TrainingLogger - INFO - Step 51100, Batch metrics: Loss: 7.7287, Accuracy: 0.0882, Perplexity: 2272.5844
2025-01-01 01:52:07,931 - TrainingLogger - INFO - Step 51100, Prediction vs Actual:
2025-01-01 01:52:07,931 - TrainingLogger - INFO - Input 1: המסמך שהכין יוסי כהן כלל למיטב זכרוני שרטוט חיצים לסימון מועדי החלפת הצוללות בעתיד
2025-01-01 01:52:07,931 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:52:07,931 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁זה             | ▁המסמך       | ✗     |
|     1 | ▁-              | ▁שה          | ✗     |
|     2 | ▁-              | כין          | ✗     |
|     3 | ▁לי             | ▁יו          | ✗     |
|     4 | ?               | סי           | ✗     |
|     5 | כות             | ▁כהן         | ✗     |
|     6 | ?               | ▁כלל         | ✗     |
|     7 | ▁לא             | ▁למיטב       | ✗     |
|     8 | ו               | ▁זכר         | ✗     |
|     9 | ו               | וני          | ✗     |
|    10 | נו              | ▁שר          | ✗     |
|    11 | רה              | טוט          | ✗     |
|    12 | ים              | ▁            | ✗     |
|    13 | ים              | חיצים        | ✗     |
|    14 | ,               | ▁ל           | ✗     |
|    15 | ים              | סימון        | ✗     |
|    16 | ▁זה             | ▁מועד        | ✗     |
|    17 | פים             | י            | ✗     |
|    18 | ▁ה              | ▁החלפת       | ✗     |
|    19 | ם               | ▁ה           | ✗     |
|    20 | "               | צוללות       | ✗     |
|    21 | ▁שלו            | ▁בעתיד       | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | <pad>           | <pad>        | ✓     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | ות              | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | ות              | <pad>        | ✗     |
|    37 | .               | <pad>        | ✗     |
|    38 | ות              | <pad>        | ✗     |
|    39 | </s>            | <pad>        | ✗     |
|    40 | </s>            | <pad>        | ✗     |
|    41 | .               | <pad>        | ✗     |
|    42 | </s>            | <pad>        | ✗     |
|    43 | </s>            | <pad>        | ✗     |
|    44 | </s>            | <pad>        | ✗     |
|    45 | </s>            | <pad>        | ✗     |
|    46 | </s>            | <pad>        | ✗     |
|    47 | .               |              | ✗     |

2025-01-01 01:52:07,931 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:52:07,936 - TrainingLogger - INFO - Gradient norm: 8.3692
2025-01-01 01:52:14,883 - TrainingLogger - INFO - Step 51110, Batch metrics: Loss: 7.5945, Accuracy: 0.0719, Perplexity: 1987.1821
2025-01-01 01:52:21,615 - TrainingLogger - INFO - Step 51120, Batch metrics: Loss: 7.5121, Accuracy: 0.0536, Perplexity: 1830.1316
2025-01-01 01:52:28,395 - TrainingLogger - INFO - Step 51130, Batch metrics: Loss: 7.2559, Accuracy: 0.0765, Perplexity: 1416.4459
2025-01-01 01:52:35,806 - TrainingLogger - INFO - Step 51140, Batch metrics: Loss: 7.4281, Accuracy: 0.0629, Perplexity: 1682.6872
2025-01-01 01:52:42,941 - TrainingLogger - INFO - Step 51150, Batch metrics: Loss: 7.1862, Accuracy: 0.0806, Perplexity: 1321.0763
2025-01-01 01:52:50,389 - TrainingLogger - INFO - Step 51160, Batch metrics: Loss: 7.4517, Accuracy: 0.0909, Perplexity: 1722.7676
2025-01-01 01:52:57,115 - TrainingLogger - INFO - Step 51170, Batch metrics: Loss: 7.7752, Accuracy: 0.0881, Perplexity: 2380.8214
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 215040
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 215040

2025-01-01 01:52:59,979 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 30]), device: cuda:0
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 30]), device: cuda:0
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:52:59,979 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 25]), device: cuda:0
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 25]), device: cuda:0
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 30]), device: cuda:0
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - input_ids_3 min: 1, max: 65838
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 30]), device: cuda:0
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:52:59,980 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:53:05,377 - TrainingLogger - INFO - Step 51180, Batch metrics: Loss: 7.3033, Accuracy: 0.1055, Perplexity: 1485.2537
2025-01-01 01:53:12,551 - TrainingLogger - INFO - Step 51190, Batch metrics: Loss: 7.8609, Accuracy: 0.0608, Perplexity: 2593.9464
2025-01-01 01:53:19,824 - TrainingLogger - INFO - Step 51200, Batch metrics: Loss: 7.2583, Accuracy: 0.0789, Perplexity: 1419.8703
2025-01-01 01:53:19,824 - TrainingLogger - INFO - Step 51200, Prediction vs Actual:
2025-01-01 01:53:19,824 - TrainingLogger - INFO - Input 1: הבוקר פתחנו את היום הבינלאומי לזכויות אנשים עם מוגבלות
2025-01-01 01:53:19,824 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:53:19,824 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁הבוקר       | ✗     |
|     1 | ▁-              | ▁פתח         | ✗     |
|     2 | ו               | נו           | ✗     |
|     3 | ▁את             | ▁את          | ✓     |
|     4 | ▁הדלת           | ▁היום        | ✗     |
|     5 | ▁הזה            | ▁הבינלאומי   | ✗     |
|     6 | .               | ▁לזכויות     | ✗     |
|     7 | ינו             | ▁אנשים       | ✗     |
|     8 | .               | ▁עם          | ✗     |
|     9 | ▁ילדים          | ▁מוגבל       | ✗     |
|    10 | ויות            | ות           | ✗     |
|    11 | ▁גדולות         | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | יות             | <pad>        | ✗     |
|    16 | ות              | <pad>        | ✗     |
|    17 | ▁גבוהה          | <pad>        | ✗     |
|    18 | ▁ב              | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁אחרות          | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | ות              | <pad>        | ✗     |
|    24 | יות             | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | ות              | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            |              | ✗     |

2025-01-01 01:53:19,824 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:53:19,829 - TrainingLogger - INFO - Gradient norm: 7.7829
2025-01-01 01:53:27,014 - TrainingLogger - INFO - Step 51210, Batch metrics: Loss: 7.2329, Accuracy: 0.0916, Perplexity: 1384.2925
2025-01-01 01:53:27,952 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 358400
2025-01-01 01:53:27,952 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 358400

2025-01-01 01:53:27,952 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 50]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - input_ids_1 min: 11, max: 60268
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 50]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 70]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 70]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 49]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 49]), device: cuda:0
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:53:27,954 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:53:35,707 - TrainingLogger - INFO - Step 51220, Batch metrics: Loss: 8.0368, Accuracy: 0.0680, Perplexity: 3092.7992
2025-01-01 01:53:43,118 - TrainingLogger - INFO - Step 51230, Batch metrics: Loss: 7.3667, Accuracy: 0.0809, Perplexity: 1582.3258
2025-01-01 01:53:49,029 - TrainingLogger - ERROR - Error during forward pass: shape '[7, -1, 16, 56]' is invalid for input of size 258048
2025-01-01 01:53:49,029 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 144, in forward
    x = self.custom_decoder1(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 995, in forward
    layer_outputs = decoder_layer(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 424, in forward
    hidden_states, cross_attn_weights, cross_attn_present_key_value = self.encoder_attn(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 176, in forward
    key_states = self._shape(self.k_proj(key_value_states), -1, bsz)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 141, in _shape
    return tensor.view(bsz, seq_len, self.num_heads, self.head_dim).transpose(1, 2).contiguous()
RuntimeError: shape '[7, -1, 16, 56]' is invalid for input of size 258048

2025-01-01 01:53:49,029 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:53:49,030 - TrainingLogger - ERROR - input_ids_1 min: 13, max: 60268
2025-01-01 01:53:49,030 - TrainingLogger - ERROR - attention_mask_1 shape: torch.Size([8, 36]), device: cuda:0
2025-01-01 01:53:49,030 - TrainingLogger - ERROR - attention_mask_1 min: 0, max: 1
2025-01-01 01:53:49,030 - TrainingLogger - ERROR - input_ids_2 shape: torch.Size([7, 50]), device: cuda:0
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - input_ids_2 min: 11, max: 151643
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - attention_mask_2 shape: torch.Size([7, 50]), device: cuda:0
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - attention_mask_2 min: 0, max: 1
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - input_ids_3 shape: torch.Size([8, 38]), device: cuda:0
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - input_ids_3 min: 3, max: 65838
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - attention_mask_3 shape: torch.Size([8, 38]), device: cuda:0
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - attention_mask_3 min: 0, max: 1
2025-01-01 01:53:49,031 - TrainingLogger - ERROR - Skipping this batch due to error.
2025-01-01 01:53:51,093 - TrainingLogger - INFO - Step 51240, Batch metrics: Loss: 7.6507, Accuracy: 0.0993, Perplexity: 2102.1288
2025-01-01 01:53:58,297 - TrainingLogger - INFO - Step 51250, Batch metrics: Loss: 7.4645, Accuracy: 0.1084, Perplexity: 1744.9070
2025-01-01 01:54:05,390 - TrainingLogger - INFO - Step 51260, Batch metrics: Loss: 7.3116, Accuracy: 0.0736, Perplexity: 1497.5581
2025-01-01 01:54:12,982 - TrainingLogger - INFO - Step 51270, Batch metrics: Loss: 7.4916, Accuracy: 0.0632, Perplexity: 1792.9442
2025-01-01 01:54:19,803 - TrainingLogger - INFO - Step 51280, Batch metrics: Loss: 7.8248, Accuracy: 0.0470, Perplexity: 2501.9418
2025-01-01 01:54:27,047 - TrainingLogger - INFO - Step 51290, Batch metrics: Loss: 7.8625, Accuracy: 0.0606, Perplexity: 2597.9396
2025-01-01 01:54:34,241 - TrainingLogger - INFO - Step 51300, Batch metrics: Loss: 7.2356, Accuracy: 0.0783, Perplexity: 1387.9390
2025-01-01 01:54:34,241 - TrainingLogger - INFO - Step 51300, Prediction vs Actual:
2025-01-01 01:54:34,241 - TrainingLogger - INFO - Input 1: כל מי שיושב בוועדה חייב לשבת בדיונים מהתחלה ועד הסוף, ומי שיישב יגבש את עמדתו באופן עצמאי
2025-01-01 01:54:34,241 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:54:34,241 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁כל          | ✗     |
|     1 | ▁-              | ▁מי          | ✗     |
|     2 | ▁לא             | ▁שיושב       | ✗     |
|     3 | ▁-              | ▁בוועד       | ✗     |
|     4 | ▁הוא            | ה            | ✗     |
|     5 | ▁הראשונה        | ▁חייב        | ✗     |
|     6 | ▁להיות          | ▁לשבת        | ✗     |
|     7 | .               | ▁בדיוני      | ✗     |
|     8 | ת               | ם            | ✗     |
|     9 | ▁חדשים          | ▁מהתחלה      | ✗     |
|    10 | .               | ▁ועד         | ✗     |
|    11 | ה               | ▁הסוף        | ✗     |
|    12 | .               | ,            | ✗     |
|    13 | <pad>           | ▁ומי         | ✗     |
|    14 | ▁יודע           | ▁שיי         | ✗     |
|    15 | לך              | שב           | ✗     |
|    16 | ▁את             | ▁י           | ✗     |
|    17 | יסורים          | ג            | ✗     |
|    18 | אל              | בש           | ✗     |
|    19 | ▁את             | ▁את          | ✓     |
|    20 | ▁זה             | ▁עמדת        | ✗     |
|    21 | ו               | ו            | ✓     |
|    22 | ,               | ▁באופן       | ✗     |
|    23 | ▁רשמי           | ▁עצמאי       | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               |              | ✗     |

2025-01-01 01:54:34,242 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:54:34,247 - TrainingLogger - INFO - Gradient norm: 6.2705
2025-01-01 01:54:41,635 - TrainingLogger - INFO - Step 51310, Batch metrics: Loss: 7.4566, Accuracy: 0.0638, Perplexity: 1731.3165
2025-01-01 01:54:48,492 - TrainingLogger - INFO - Step 51320, Batch metrics: Loss: 7.6567, Accuracy: 0.0621, Perplexity: 2114.6747
2025-01-01 01:54:55,761 - TrainingLogger - INFO - Step 51330, Batch metrics: Loss: 7.3163, Accuracy: 0.0963, Perplexity: 1504.5540
2025-01-01 01:55:02,977 - TrainingLogger - INFO - Step 51340, Batch metrics: Loss: 7.2572, Accuracy: 0.0921, Perplexity: 1418.2910
2025-01-01 01:55:10,542 - TrainingLogger - INFO - Step 51350, Batch metrics: Loss: 7.5699, Accuracy: 0.0741, Perplexity: 1938.9058
2025-01-01 01:55:17,948 - TrainingLogger - INFO - Step 51360, Batch metrics: Loss: 7.3340, Accuracy: 0.0948, Perplexity: 1531.5132
2025-01-01 01:55:25,233 - TrainingLogger - INFO - Step 51370, Batch metrics: Loss: 7.7869, Accuracy: 0.0654, Perplexity: 2408.8812
2025-01-01 01:55:32,563 - TrainingLogger - INFO - Step 51380, Batch metrics: Loss: 6.8534, Accuracy: 0.1304, Perplexity: 947.0831
2025-01-01 01:55:39,616 - TrainingLogger - INFO - Step 51390, Batch metrics: Loss: 7.5667, Accuracy: 0.0653, Perplexity: 1932.7194
2025-01-01 01:55:46,851 - TrainingLogger - INFO - Step 51400, Batch metrics: Loss: 7.7166, Accuracy: 0.0458, Perplexity: 2245.2546
2025-01-01 01:55:46,851 - TrainingLogger - INFO - Step 51400, Prediction vs Actual:
2025-01-01 01:55:46,851 - TrainingLogger - INFO - Input 1: בישראל הוחלט לחכות עם הפגיעה בו עד שיהיה ברור אם הוא נמצא עם דף
2025-01-01 01:55:46,851 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:55:46,851 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ,               | ▁בישראל      | ✗     |
|     1 | ▁-              | ▁הוחלט       | ✗     |
|     2 | ▁זה             | ▁לחכות       | ✗     |
|     3 | ▁עד             | ▁עם          | ✗     |
|     4 | ▁הזמן           | ▁הפגיעה      | ✗     |
|     5 | ▁ב              | ▁בו          | ✗     |
|     6 | יל              | ▁עד          | ✗     |
|     7 | ▁היום           | ▁שיהיה       | ✗     |
|     8 | ▁מוכן           | ▁ברור        | ✗     |
|     9 | ▁מאליו          | ▁אם          | ✗     |
|    10 | ▁זה             | ▁הוא         | ✗     |
|    11 | ▁היה            | ▁נמצא        | ✗     |
|    12 | ▁ב              | ▁עם          | ✗     |
|    13 | ▁מישהו          | ▁דף          | ✗     |
|    14 | ▁חדש            | <pad>        | ✗     |
|    15 | ▁חדש            | <pad>        | ✗     |
|    16 | ▁חדש            | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | ▁או             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | ,               | <pad>        | ✗     |
|    23 | ▁לא             | <pad>        | ✗     |
|    24 | ▁לא             | <pad>        | ✗     |
|    25 | </s>            |              | ✗     |

2025-01-01 01:55:46,851 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:55:46,856 - TrainingLogger - INFO - Gradient norm: 9.3824
2025-01-01 01:55:54,108 - TrainingLogger - INFO - Step 51410, Batch metrics: Loss: 6.7243, Accuracy: 0.0930, Perplexity: 832.4184
2025-01-01 01:56:00,964 - TrainingLogger - INFO - Step 51420, Batch metrics: Loss: 6.6913, Accuracy: 0.1146, Perplexity: 805.3623
2025-01-01 01:56:08,544 - TrainingLogger - INFO - Step 51430, Batch metrics: Loss: 6.8194, Accuracy: 0.0732, Perplexity: 915.4433
2025-01-01 01:56:15,132 - TrainingLogger - INFO - Step 51440, Batch metrics: Loss: 7.4779, Accuracy: 0.0751, Perplexity: 1768.5576
2025-01-01 01:56:22,523 - TrainingLogger - INFO - Step 51450, Batch metrics: Loss: 7.7137, Accuracy: 0.0806, Perplexity: 2238.9105
2025-01-01 01:56:29,908 - TrainingLogger - INFO - Step 51460, Batch metrics: Loss: 7.7755, Accuracy: 0.0535, Perplexity: 2381.5458
2025-01-01 01:56:36,949 - TrainingLogger - INFO - Step 51470, Batch metrics: Loss: 7.5283, Accuracy: 0.0651, Perplexity: 1859.8767
2025-01-01 01:56:43,645 - TrainingLogger - INFO - Step 51480, Batch metrics: Loss: 7.1878, Accuracy: 0.0721, Perplexity: 1323.1655
2025-01-01 01:56:50,627 - TrainingLogger - INFO - Step 51490, Batch metrics: Loss: 7.4066, Accuracy: 0.0663, Perplexity: 1646.8828
2025-01-01 01:56:57,735 - TrainingLogger - INFO - Step 51500, Batch metrics: Loss: 7.1494, Accuracy: 0.1151, Perplexity: 1273.3712
2025-01-01 01:56:57,735 - TrainingLogger - INFO - Step 51500, Prediction vs Actual:
2025-01-01 01:56:57,735 - TrainingLogger - INFO - Input 1: הציבור בישראל לא מתעניין במי אמר מה במפלגת העבודה
2025-01-01 01:56:57,735 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:56:57,735 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הציבור      | ✗     |
|     1 | ▁-              | ▁בישראל      | ✗     |
|     2 | ,               | ▁לא          | ✗     |
|     3 | ▁מעט            | ▁מתעניין     | ✗     |
|     4 | ▁בזה            | ▁במי         | ✗     |
|     5 | לא              | ▁אמר         | ✗     |
|     6 | ▁לי             | ▁מה          | ✗     |
|     7 | ▁קורה           | ▁ב           | ✗     |
|     8 | יז              | מפלגת        | ✗     |
|     9 | ו               | ▁העבודה      | ✗     |
|    10 | ▁שלו            | <pad>        | ✗     |
|    11 | ית              | <pad>        | ✗     |
|    12 | ▁שלנו           | <pad>        | ✗     |
|    13 | ▁זה             | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | ▁שלנו           | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ,               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | ▁לעשות          | <pad>        | ✗     |
|    25 | ▁שלו            | <pad>        | ✗     |
|    26 | ▁לא             | <pad>        | ✗     |
|    27 | ▁הזה            | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | ▁לא             | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            |              | ✗     |

2025-01-01 01:56:57,735 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:56:57,740 - TrainingLogger - INFO - Gradient norm: 7.4204
2025-01-01 01:57:04,936 - TrainingLogger - INFO - Step 51510, Batch metrics: Loss: 7.4107, Accuracy: 0.0931, Perplexity: 1653.5690
2025-01-01 01:57:12,123 - TrainingLogger - INFO - Step 51520, Batch metrics: Loss: 7.6984, Accuracy: 0.0400, Perplexity: 2204.7113
2025-01-01 01:57:19,876 - TrainingLogger - INFO - Step 51530, Batch metrics: Loss: 7.3337, Accuracy: 0.0918, Perplexity: 1530.9992
2025-01-01 01:57:26,810 - TrainingLogger - INFO - Step 51540, Batch metrics: Loss: 7.3732, Accuracy: 0.0325, Perplexity: 1592.7990
2025-01-01 01:57:34,199 - TrainingLogger - INFO - Step 51550, Batch metrics: Loss: 7.3108, Accuracy: 0.0667, Perplexity: 1496.2997
2025-01-01 01:57:41,122 - TrainingLogger - INFO - Step 51560, Batch metrics: Loss: 7.2350, Accuracy: 0.0920, Perplexity: 1387.1239
2025-01-01 01:57:48,583 - TrainingLogger - INFO - Step 51570, Batch metrics: Loss: 7.3718, Accuracy: 0.0730, Perplexity: 1590.4258
2025-01-01 01:57:56,141 - TrainingLogger - INFO - Step 51580, Batch metrics: Loss: 8.0164, Accuracy: 0.0773, Perplexity: 3030.3827
2025-01-01 01:58:03,150 - TrainingLogger - INFO - Step 51590, Batch metrics: Loss: 7.5922, Accuracy: 0.0657, Perplexity: 1982.6381
2025-01-01 01:58:10,406 - TrainingLogger - INFO - Step 51600, Batch metrics: Loss: 7.2948, Accuracy: 0.0769, Perplexity: 1472.6214
2025-01-01 01:58:10,406 - TrainingLogger - INFO - Step 51600, Prediction vs Actual:
2025-01-01 01:58:10,406 - TrainingLogger - INFO - Input 1: בשנה וחצי האלה אנחנו מנסים באמצעים לא מסכני חיים להחזיר את השקט
2025-01-01 01:58:10,406 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:58:10,406 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁בשנה        | ✗     |
|     1 | ▁-              | ▁וחצי        | ✗     |
|     2 | ▁-              | ▁האלה        | ✗     |
|     3 | ▁-              | ▁אנחנו       | ✗     |
|     4 | ▁צריכים         | ▁מנסים       | ✗     |
|     5 | ▁למצוא          | ▁באמצע       | ✗     |
|     6 | ▁הלילה          | ים           | ✗     |
|     7 | ▁חדשים          | ▁לא          | ✗     |
|     8 | ▁טובים          | ▁מס          | ✗     |
|     9 | כנים            | כני          | ✗     |
|    10 | ים              | ▁חיים        | ✗     |
|    11 | ▁חדשים          | ▁להחזיר      | ✗     |
|    12 | ▁את             | ▁את          | ✓     |
|    13 | ▁זה             | ▁השקט        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | <pad>           | <pad>        | ✓     |
|    20 | ▁זה             | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | </s>            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | <pad>           |              | ✗     |

2025-01-01 01:58:10,407 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:58:10,412 - TrainingLogger - INFO - Gradient norm: 6.7767
2025-01-01 01:58:17,153 - TrainingLogger - INFO - Step 51610, Batch metrics: Loss: 7.2959, Accuracy: 0.0904, Perplexity: 1474.1923
2025-01-01 01:58:24,393 - TrainingLogger - INFO - Step 51620, Batch metrics: Loss: 7.7563, Accuracy: 0.0424, Perplexity: 2336.2489
2025-01-01 01:58:31,789 - TrainingLogger - INFO - Step 51630, Batch metrics: Loss: 7.3895, Accuracy: 0.0833, Perplexity: 1618.8311
2025-01-01 01:58:38,827 - TrainingLogger - INFO - Step 51640, Batch metrics: Loss: 7.3799, Accuracy: 0.0622, Perplexity: 1603.5074
2025-01-01 01:58:46,174 - TrainingLogger - INFO - Step 51650, Batch metrics: Loss: 7.6987, Accuracy: 0.0756, Perplexity: 2205.3769
2025-01-01 01:58:53,091 - TrainingLogger - INFO - Step 51660, Batch metrics: Loss: 7.2360, Accuracy: 0.1145, Perplexity: 1388.5818
2025-01-01 01:59:00,468 - TrainingLogger - INFO - Step 51670, Batch metrics: Loss: 7.3630, Accuracy: 0.0707, Perplexity: 1576.5989
2025-01-01 01:59:07,636 - TrainingLogger - INFO - Step 51680, Batch metrics: Loss: 7.3004, Accuracy: 0.0769, Perplexity: 1480.8756
2025-01-01 01:59:14,618 - TrainingLogger - INFO - Step 51690, Batch metrics: Loss: 7.5699, Accuracy: 0.0852, Perplexity: 1939.0019
2025-01-01 01:59:21,754 - TrainingLogger - INFO - Step 51700, Batch metrics: Loss: 7.5288, Accuracy: 0.0339, Perplexity: 1860.8978
2025-01-01 01:59:21,754 - TrainingLogger - INFO - Step 51700, Prediction vs Actual:
2025-01-01 01:59:21,754 - TrainingLogger - INFO - Input 1: מי שמכיר אותי יודע שזה לא אני
2025-01-01 01:59:21,754 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 01:59:21,754 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מי          | ✗     |
|     1 | ▁-              | ▁שמכיר       | ✗     |
|     2 | ▁את             | ▁אותי        | ✗     |
|     3 | .               | ▁יודע        | ✗     |
|     4 | ▁מה             | ▁שזה         | ✗     |
|     5 | ▁לא             | ▁לא          | ✓     |
|     6 | ▁היה            | ▁אני         | ✗     |
|     7 | .               | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | .               | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | .               | <pad>        | ✗     |
|    14 | .               | <pad>        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | .               | <pad>        | ✗     |
|    26 | .               | <pad>        | ✗     |
|    27 | .               | <pad>        | ✗     |
|    28 | .               | <pad>        | ✗     |
|    29 | .               | <pad>        | ✗     |
|    30 | .               | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | .               | <pad>        | ✗     |
|    33 | .               | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | .               | <pad>        | ✗     |
|    37 | .               |              | ✗     |

2025-01-01 01:59:21,755 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 01:59:21,760 - TrainingLogger - INFO - Gradient norm: 11.1017
2025-01-01 01:59:28,995 - TrainingLogger - INFO - Step 51710, Batch metrics: Loss: 7.1840, Accuracy: 0.0654, Perplexity: 1318.1076
2025-01-01 01:59:36,144 - TrainingLogger - INFO - Step 51720, Batch metrics: Loss: 7.4761, Accuracy: 0.0718, Perplexity: 1765.4283
2025-01-01 01:59:43,405 - TrainingLogger - INFO - Step 51730, Batch metrics: Loss: 7.6596, Accuracy: 0.0424, Perplexity: 2120.8730
2025-01-01 01:59:50,759 - TrainingLogger - INFO - Step 51740, Batch metrics: Loss: 7.5067, Accuracy: 0.0739, Perplexity: 1820.1146
2025-01-01 01:59:58,498 - TrainingLogger - INFO - Step 51750, Batch metrics: Loss: 7.3355, Accuracy: 0.0750, Perplexity: 1533.7634
2025-01-01 02:00:05,755 - TrainingLogger - INFO - Step 51760, Batch metrics: Loss: 7.2660, Accuracy: 0.0812, Perplexity: 1430.8557
2025-01-01 02:00:13,487 - TrainingLogger - INFO - Step 51770, Batch metrics: Loss: 7.3713, Accuracy: 0.0808, Perplexity: 1589.7729
2025-01-01 02:00:19,952 - TrainingLogger - INFO - Step 51780, Batch metrics: Loss: 7.8589, Accuracy: 0.0583, Perplexity: 2588.6826
2025-01-01 02:00:27,022 - TrainingLogger - INFO - Step 51790, Batch metrics: Loss: 7.4223, Accuracy: 0.0719, Perplexity: 1672.8781
2025-01-01 02:00:33,936 - TrainingLogger - INFO - Step 51800, Batch metrics: Loss: 7.6223, Accuracy: 0.0469, Perplexity: 2043.2867
2025-01-01 02:00:33,937 - TrainingLogger - INFO - Step 51800, Prediction vs Actual:
2025-01-01 02:00:33,970 - TrainingLogger - INFO - Input 1: אולי הניתוק הסמלי המשמעותי ביותר של תורמים יהודים היה של קרן וקסנר מאוניברסיטת הרווארד
2025-01-01 02:00:33,971 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:00:33,971 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁של             | ▁אולי        | ✗     |
|     1 | ▁-              | ▁ה           | ✗     |
|     2 | ▁-              | נית          | ✗     |
|     3 | ן               | וק           | ✗     |
|     4 | ▁-              | ▁הסמלי       | ✗     |
|     5 | ת               | ▁המשמעות     | ✗     |
|     6 | ית              | י            | ✗     |
|     7 | ▁של             | ▁ביותר       | ✗     |
|     8 | ▁של             | ▁של          | ✓     |
|     9 | ▁המדינה         | ▁תורמים      | ✗     |
|    10 | ▁חדשים          | ▁יהודים      | ✗     |
|    11 | ▁חדשים          | ▁היה         | ✗     |
|    12 | ▁קשה            | ▁של          | ✗     |
|    13 | ▁המשפחה         | ▁קרן         | ✗     |
|    14 | ▁הטלוויזיה      | ▁ו           | ✗     |
|    15 | יז              | קס           | ✗     |
|    16 | ידה             | נר           | ✗     |
|    17 | א               | ▁מ           | ✗     |
|    18 | ון              | אוניברסיטת   | ✗     |
|    19 | ▁קליפורניה      | ▁הרווארד     | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | ,               | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ה               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ים              |              | ✗     |

2025-01-01 02:00:33,971 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:00:33,977 - TrainingLogger - INFO - Gradient norm: 8.5074
2025-01-01 02:00:40,788 - TrainingLogger - INFO - Step 51810, Batch metrics: Loss: 6.9752, Accuracy: 0.0741, Perplexity: 1069.8034
2025-01-01 02:00:48,158 - TrainingLogger - INFO - Step 51820, Batch metrics: Loss: 7.2951, Accuracy: 0.0704, Perplexity: 1473.0189
2025-01-01 02:00:55,290 - TrainingLogger - INFO - Step 51830, Batch metrics: Loss: 7.6646, Accuracy: 0.0636, Perplexity: 2131.6201
2025-01-01 02:01:03,023 - TrainingLogger - INFO - Step 51840, Batch metrics: Loss: 7.0608, Accuracy: 0.1270, Perplexity: 1165.4022
2025-01-01 02:01:10,045 - TrainingLogger - INFO - Step 51850, Batch metrics: Loss: 7.6834, Accuracy: 0.0866, Perplexity: 2172.0752
2025-01-01 02:01:17,167 - TrainingLogger - INFO - Step 51860, Batch metrics: Loss: 7.7080, Accuracy: 0.0779, Perplexity: 2225.9852
2025-01-01 02:01:24,505 - TrainingLogger - INFO - Step 51870, Batch metrics: Loss: 8.1135, Accuracy: 0.0395, Perplexity: 3339.4094
2025-01-01 02:01:30,867 - TrainingLogger - INFO - Step 51880, Batch metrics: Loss: 7.2383, Accuracy: 0.0484, Perplexity: 1391.7484
2025-01-01 02:01:37,868 - TrainingLogger - INFO - Step 51890, Batch metrics: Loss: 7.4475, Accuracy: 0.1084, Perplexity: 1715.6134
2025-01-01 02:01:44,530 - TrainingLogger - INFO - Step 51900, Batch metrics: Loss: 7.5361, Accuracy: 0.0656, Perplexity: 1874.5140
2025-01-01 02:01:44,530 - TrainingLogger - INFO - Step 51900, Prediction vs Actual:
2025-01-01 02:01:44,530 - TrainingLogger - INFO - Input 1: היא הייתה בבידוד ממעוד החשיפה
2025-01-01 02:01:44,531 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:01:44,531 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁היא         | ✗     |
|     1 | ▁-              | ▁הייתה       | ✗     |
|     2 | ▁-              | ▁בבידוד      | ✗     |
|     3 | ,               | ▁ממ          | ✗     |
|     4 | אס              | עוד          | ✗     |
|     5 | ה               | ▁ה           | ✗     |
|     6 | -               | חשיפה        | ✗     |
|     7 | ▁שלו            | <pad>        | ✗     |
|     8 | .               | <pad>        | ✗     |
|     9 | ▁שלו            | <pad>        | ✗     |
|    10 | .               | <pad>        | ✗     |
|    11 | ▁שנח            | <pad>        | ✗     |
|    12 | ווה             | <pad>        | ✗     |
|    13 | "               | <pad>        | ✗     |
|    14 | "               | <pad>        | ✗     |
|    15 | ה               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | ה               | <pad>        | ✗     |
|    19 | ▁המדינה         | <pad>        | ✗     |
|    20 | ▁שלה            | <pad>        | ✗     |
|    21 | ית              | <pad>        | ✗     |
|    22 | ה               | <pad>        | ✗     |
|    23 | ▁ל              | <pad>        | ✗     |
|    24 | ה               | <pad>        | ✗     |
|    25 | ▁אותה           | <pad>        | ✗     |
|    26 | ?               | <pad>        | ✗     |
|    27 | ית              | <pad>        | ✗     |
|    28 | ית              | <pad>        | ✗     |
|    29 | ית              | <pad>        | ✗     |
|    30 | ▁היא            | <pad>        | ✗     |
|    31 | ▁היא            | <pad>        | ✗     |
|    32 | ▁היא            | <pad>        | ✗     |
|    33 | ▁שלו            | <pad>        | ✗     |
|    34 | ▁היא            | <pad>        | ✗     |
|    35 | ,               | <pad>        | ✗     |
|    36 | נים             | <pad>        | ✗     |
|    37 | ▁היא            | <pad>        | ✗     |
|    38 | ▁שלו            | <pad>        | ✗     |
|    39 | ▁היא            |              | ✗     |

2025-01-01 02:01:44,531 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:01:44,536 - TrainingLogger - INFO - Gradient norm: 8.6772
2025-01-01 02:01:51,915 - TrainingLogger - INFO - Step 51910, Batch metrics: Loss: 7.4893, Accuracy: 0.0526, Perplexity: 1788.7198
2025-01-01 02:01:58,845 - TrainingLogger - INFO - Step 51920, Batch metrics: Loss: 7.7383, Accuracy: 0.0643, Perplexity: 2294.6456
2025-01-01 02:02:05,781 - TrainingLogger - INFO - Step 51930, Batch metrics: Loss: 7.9389, Accuracy: 0.0429, Perplexity: 2804.1350
2025-01-01 02:02:13,342 - TrainingLogger - INFO - Step 51940, Batch metrics: Loss: 7.7019, Accuracy: 0.0811, Perplexity: 2212.4962
2025-01-01 02:02:20,841 - TrainingLogger - INFO - Step 51950, Batch metrics: Loss: 6.9966, Accuracy: 0.0984, Perplexity: 1092.8877
2025-01-01 02:02:28,562 - TrainingLogger - INFO - Step 51960, Batch metrics: Loss: 7.1349, Accuracy: 0.0599, Perplexity: 1255.0619
2025-01-01 02:02:35,845 - TrainingLogger - INFO - Step 51970, Batch metrics: Loss: 7.1846, Accuracy: 0.1138, Perplexity: 1319.0161
2025-01-01 02:02:43,083 - TrainingLogger - INFO - Step 51980, Batch metrics: Loss: 7.1256, Accuracy: 0.1093, Perplexity: 1243.4341
2025-01-01 02:02:50,972 - TrainingLogger - INFO - Step 51990, Batch metrics: Loss: 7.3434, Accuracy: 0.0863, Perplexity: 1545.9764
2025-01-01 02:02:58,217 - TrainingLogger - INFO - Step 52000, Batch metrics: Loss: 7.3394, Accuracy: 0.0625, Perplexity: 1539.7216
2025-01-01 02:02:58,217 - TrainingLogger - INFO - Step 52000, Prediction vs Actual:
2025-01-01 02:02:58,217 - TrainingLogger - INFO - Input 1: לפי התוצאות החלקיות הוא מגיע למקום הרביעי בלבד עם 154
2025-01-01 02:02:58,217 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:02:58,217 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ▁השני           | ▁לפי         | ✗     |
|     1 | ה               | ▁התוצאות     | ✗     |
|     2 | ,               | ▁החלק        | ✗     |
|     3 | ▁השני           | יות          | ✗     |
|     4 | ▁על             | ▁הוא         | ✗     |
|     5 | ▁רק             | ▁מגיע        | ✗     |
|     6 | ▁גם             | ▁למקום       | ✗     |
|     7 | ▁בטוח           | ▁הרביעי      | ✗     |
|     8 | ,               | ▁בלבד        | ✗     |
|     9 | ,               | ▁עם          | ✗     |
|    10 | ▁העד            | ▁15          | ✗     |
|    11 | ▁נקודות         | 4            | ✗     |
|    12 | ▁נקודות         | <pad>        | ✗     |
|    13 | ים              | <pad>        | ✗     |
|    14 | ים              | <pad>        | ✗     |
|    15 | ים              | <pad>        | ✗     |
|    16 | ים              | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | ים              | <pad>        | ✗     |
|    19 | ים              | <pad>        | ✗     |
|    20 | ים              | <pad>        | ✗     |
|    21 | ים              | <pad>        | ✗     |
|    22 | ות              | <pad>        | ✗     |
|    23 | ים              | <pad>        | ✗     |
|    24 | ים              | <pad>        | ✗     |
|    25 | ות              | <pad>        | ✗     |
|    26 | ים              | <pad>        | ✗     |
|    27 | ים              | <pad>        | ✗     |
|    28 | ות              | <pad>        | ✗     |
|    29 | ות              |              | ✗     |

2025-01-01 02:02:58,218 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:02:58,222 - TrainingLogger - INFO - Gradient norm: 9.6815
2025-01-01 02:03:05,448 - TrainingLogger - INFO - Step 52010, Batch metrics: Loss: 8.3885, Accuracy: 0.0422, Perplexity: 4396.4290
2025-01-01 02:03:12,629 - TrainingLogger - INFO - Step 52020, Batch metrics: Loss: 7.0777, Accuracy: 0.1228, Perplexity: 1185.1999
2025-01-01 02:03:19,465 - TrainingLogger - INFO - Step 52030, Batch metrics: Loss: 7.1004, Accuracy: 0.0783, Perplexity: 1212.4456
2025-01-01 02:03:26,799 - TrainingLogger - INFO - Step 52040, Batch metrics: Loss: 7.0986, Accuracy: 0.1023, Perplexity: 1210.2835
2025-01-01 02:03:34,015 - TrainingLogger - INFO - Step 52050, Batch metrics: Loss: 7.1374, Accuracy: 0.0751, Perplexity: 1258.1465
2025-01-01 02:03:41,273 - TrainingLogger - INFO - Step 52060, Batch metrics: Loss: 7.0572, Accuracy: 0.0851, Perplexity: 1161.2114
2025-01-01 02:03:48,453 - TrainingLogger - INFO - Step 52070, Batch metrics: Loss: 7.5265, Accuracy: 0.0710, Perplexity: 1856.5106
2025-01-01 02:03:56,156 - TrainingLogger - INFO - Step 52080, Batch metrics: Loss: 7.2064, Accuracy: 0.0945, Perplexity: 1347.9797
2025-01-01 02:04:03,280 - TrainingLogger - INFO - Step 52090, Batch metrics: Loss: 7.7145, Accuracy: 0.0495, Perplexity: 2240.5349
2025-01-01 02:04:09,971 - TrainingLogger - INFO - Step 52100, Batch metrics: Loss: 7.5848, Accuracy: 0.1104, Perplexity: 1968.1004
2025-01-01 02:04:09,971 - TrainingLogger - INFO - Step 52100, Prediction vs Actual:
2025-01-01 02:04:09,971 - TrainingLogger - INFO - Input 1: נולדתי בברקלי בקליפורניה, ואני כרגע חי בירושלים בישראל
2025-01-01 02:04:09,972 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:04:09,972 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁נולדתי      | ✗     |
|     1 | ▁-              | ▁בבר         | ✗     |
|     2 | ▁-              | קלי          | ✗     |
|     3 | ו               | ▁בקליפורניה  | ✗     |
|     4 | ,               | ,            | ✓     |
|     5 | ▁צרפת           | ▁ואני        | ✗     |
|     6 | ▁חושב           | ▁כרגע        | ✗     |
|     7 | ▁כאן            | ▁חי          | ✗     |
|     8 | ר               | ▁בירושלים    | ✗     |
|     9 | .               | ▁בישראל      | ✗     |
|    10 | ,               | <pad>        | ✗     |
|    11 | .               | <pad>        | ✗     |
|    12 | .               | <pad>        | ✗     |
|    13 | </s>            | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | </s>            | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | ,               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | </s>            | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | ▁לא             | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            | <pad>        | ✗     |
|    24 | ▁זמן            | <pad>        | ✗     |
|    25 | </s>            | <pad>        | ✗     |
|    26 | </s>            | <pad>        | ✗     |
|    27 | ▁כאן            | <pad>        | ✗     |
|    28 | ▁ואני           | <pad>        | ✗     |
|    29 | <pad>           | <pad>        | ✓     |
|    30 | ▁עם             | <pad>        | ✗     |
|    31 | ▁אני            | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | ▁את             | <pad>        | ✗     |
|    34 | ▁את             | <pad>        | ✗     |
|    35 | ▁את             | <pad>        | ✗     |
|    36 | ▁עם             | <pad>        | ✗     |
|    37 | ▁כאן            | <pad>        | ✗     |
|    38 | ▁את             | <pad>        | ✗     |
|    39 | ▁כאן            | <pad>        | ✗     |
|    40 | ▁כאן            |              | ✗     |

2025-01-01 02:04:09,972 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:04:09,977 - TrainingLogger - INFO - Gradient norm: 5.6757
2025-01-01 02:04:18,023 - TrainingLogger - INFO - Step 52110, Batch metrics: Loss: 7.4822, Accuracy: 0.0613, Perplexity: 1776.0782
2025-01-01 02:04:24,845 - TrainingLogger - INFO - Step 52120, Batch metrics: Loss: 7.6669, Accuracy: 0.1111, Perplexity: 2136.3416
2025-01-01 02:04:31,897 - TrainingLogger - INFO - Step 52130, Batch metrics: Loss: 7.4892, Accuracy: 0.0734, Perplexity: 1788.5611
2025-01-01 02:04:38,801 - TrainingLogger - INFO - Step 52140, Batch metrics: Loss: 7.4769, Accuracy: 0.0750, Perplexity: 1766.7521
2025-01-01 02:04:45,904 - TrainingLogger - INFO - Step 52150, Batch metrics: Loss: 7.8208, Accuracy: 0.0625, Perplexity: 2491.9096
2025-01-01 02:04:53,265 - TrainingLogger - INFO - Step 52160, Batch metrics: Loss: 7.5222, Accuracy: 0.0896, Perplexity: 1848.5648
2025-01-01 02:05:01,089 - TrainingLogger - INFO - Step 52170, Batch metrics: Loss: 7.4974, Accuracy: 0.0734, Perplexity: 1803.2716
2025-01-01 02:05:08,514 - TrainingLogger - INFO - Step 52180, Batch metrics: Loss: 7.4249, Accuracy: 0.0645, Perplexity: 1677.2975
2025-01-01 02:05:15,713 - TrainingLogger - INFO - Step 52190, Batch metrics: Loss: 7.5081, Accuracy: 0.1053, Perplexity: 1822.7471
2025-01-01 02:05:22,797 - TrainingLogger - INFO - Step 52200, Batch metrics: Loss: 7.7399, Accuracy: 0.0380, Perplexity: 2298.1321
2025-01-01 02:05:22,797 - TrainingLogger - INFO - Step 52200, Prediction vs Actual:
2025-01-01 02:05:22,797 - TrainingLogger - INFO - Input 1: טיל נופל פה ושם אבל כל היישוב בחרדה כל השנה
2025-01-01 02:05:22,798 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:05:22,798 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁טיל         | ✗     |
|     1 | ▁-              | ▁נופל        | ✗     |
|     2 | ▁-              | ▁פה          | ✗     |
|     3 | ▁-              | ▁ושם         | ✗     |
|     4 | ▁-              | ▁אבל         | ✗     |
|     5 | ▁הוא            | ▁כל          | ✗     |
|     6 | ▁זה             | ▁היי         | ✗     |
|     7 | ,               | שוב          | ✗     |
|     8 | ה               | ▁ב           | ✗     |
|     9 | ים              | חרדה         | ✗     |
|    10 | ▁שלו            | ▁כל          | ✗     |
|    11 | ▁היום           | ▁השנה        | ✗     |
|    12 | ,               | <pad>        | ✗     |
|    13 | ,               | <pad>        | ✗     |
|    14 | <pad>           | <pad>        | ✓     |
|    15 | ,               | <pad>        | ✗     |
|    16 | ,               | <pad>        | ✗     |
|    17 | <pad>           | <pad>        | ✓     |
|    18 | <pad>           | <pad>        | ✓     |
|    19 | ,               | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | <pad>           | <pad>        | ✓     |
|    22 | ה               | <pad>        | ✗     |
|    23 | <pad>           | <pad>        | ✓     |
|    24 | <pad>           | <pad>        | ✓     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | ,               | <pad>        | ✗     |
|    27 | </s>            | <pad>        | ✗     |
|    28 | ,               | <pad>        | ✗     |
|    29 | ▁זה             | <pad>        | ✗     |
|    30 | ,               | <pad>        | ✗     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | ,               | <pad>        | ✗     |
|    33 | ▁הוא            | <pad>        | ✗     |
|    34 | <pad>           | <pad>        | ✓     |
|    35 | ,               | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | <pad>           | <pad>        | ✓     |
|    38 | ,               | <pad>        | ✗     |
|    39 | ▁היא            | <pad>        | ✗     |
|    40 | ,               |              | ✗     |

2025-01-01 02:05:22,798 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:05:22,803 - TrainingLogger - INFO - Gradient norm: 9.3282
2025-01-01 02:05:30,504 - TrainingLogger - INFO - Step 52210, Batch metrics: Loss: 7.1702, Accuracy: 0.0667, Perplexity: 1300.1174
2025-01-01 02:05:37,266 - TrainingLogger - INFO - Step 52220, Batch metrics: Loss: 7.8792, Accuracy: 0.0897, Perplexity: 2641.8023
2025-01-01 02:05:44,853 - TrainingLogger - INFO - Step 52230, Batch metrics: Loss: 7.2783, Accuracy: 0.0920, Perplexity: 1448.5038
2025-01-01 02:05:52,097 - TrainingLogger - INFO - Step 52240, Batch metrics: Loss: 7.8504, Accuracy: 0.0726, Perplexity: 2566.6677
2025-01-01 02:05:59,002 - TrainingLogger - INFO - Step 52250, Batch metrics: Loss: 7.8803, Accuracy: 0.0426, Perplexity: 2644.6206
2025-01-01 02:06:05,707 - TrainingLogger - INFO - Step 52260, Batch metrics: Loss: 7.3551, Accuracy: 0.0889, Perplexity: 1564.2133
2025-01-01 02:06:13,308 - TrainingLogger - INFO - Step 52270, Batch metrics: Loss: 7.5997, Accuracy: 0.0561, Perplexity: 1997.6603
2025-01-01 02:06:19,969 - TrainingLogger - INFO - Step 52280, Batch metrics: Loss: 6.7434, Accuracy: 0.1148, Perplexity: 848.4697
2025-01-01 02:06:27,165 - TrainingLogger - INFO - Step 52290, Batch metrics: Loss: 7.7189, Accuracy: 0.0667, Perplexity: 2250.5336
2025-01-01 02:06:34,400 - TrainingLogger - INFO - Step 52300, Batch metrics: Loss: 7.0950, Accuracy: 0.0625, Perplexity: 1205.8905
2025-01-01 02:06:34,400 - TrainingLogger - INFO - Step 52300, Prediction vs Actual:
2025-01-01 02:06:34,400 - TrainingLogger - INFO - Input 1: מי יודע אם האמריקנים יתמכו בנו, מי יודע מי יהיה אז בבית הלבן
2025-01-01 02:06:34,401 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:06:34,401 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁מי          | ✗     |
|     1 | י               | ▁יודע        | ✗     |
|     2 | ▁-              | ▁אם          | ✗     |
|     3 | ▁-              | ▁האמריקנים   | ✗     |
|     4 | ▁שלי            | ▁ית          | ✗     |
|     5 | נהג             | מכו          | ✗     |
|     6 | ▁בהם            | ▁בנו         | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | ▁הם             | ▁מי          | ✗     |
|     9 | ▁יודע           | ▁יודע        | ✓     |
|    10 | ,               | ▁מי          | ✗     |
|    11 | ▁הם             | ▁יהיה        | ✗     |
|    12 | ▁טוב            | ▁אז          | ✗     |
|    13 | .               | ▁בבית        | ✗     |
|    14 | ▁המשפט          | ▁הלבן        | ✗     |
|    15 | .               | <pad>        | ✗     |
|    16 | .               | <pad>        | ✗     |
|    17 | .               | <pad>        | ✗     |
|    18 | .               | <pad>        | ✗     |
|    19 | ▁יהיה           | <pad>        | ✗     |
|    20 | .               | <pad>        | ✗     |
|    21 | .               | <pad>        | ✗     |
|    22 | .               | <pad>        | ✗     |
|    23 | .               | <pad>        | ✗     |
|    24 | .               | <pad>        | ✗     |
|    25 | ▁יהיה           |              | ✗     |

2025-01-01 02:06:34,401 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:06:34,406 - TrainingLogger - INFO - Gradient norm: 8.1979
2025-01-01 02:06:41,579 - TrainingLogger - INFO - Step 52310, Batch metrics: Loss: 7.8791, Accuracy: 0.0159, Perplexity: 2641.4585
2025-01-01 02:06:48,320 - TrainingLogger - INFO - Step 52320, Batch metrics: Loss: 7.5434, Accuracy: 0.0833, Perplexity: 1888.2856
2025-01-01 02:06:55,847 - TrainingLogger - INFO - Step 52330, Batch metrics: Loss: 7.6470, Accuracy: 0.0573, Perplexity: 2094.3627
2025-01-01 02:07:03,218 - TrainingLogger - INFO - Step 52340, Batch metrics: Loss: 7.5515, Accuracy: 0.0659, Perplexity: 1903.6683
2025-01-01 02:07:10,319 - TrainingLogger - INFO - Step 52350, Batch metrics: Loss: 7.6319, Accuracy: 0.0338, Perplexity: 2062.8849
2025-01-01 02:07:17,553 - TrainingLogger - INFO - Step 52360, Batch metrics: Loss: 7.3848, Accuracy: 0.0641, Perplexity: 1611.2801
2025-01-01 02:07:24,707 - TrainingLogger - INFO - Step 52370, Batch metrics: Loss: 7.3101, Accuracy: 0.1154, Perplexity: 1495.3789
2025-01-01 02:07:32,585 - TrainingLogger - INFO - Step 52380, Batch metrics: Loss: 7.2709, Accuracy: 0.0730, Perplexity: 1437.9033
2025-01-01 02:07:39,830 - TrainingLogger - INFO - Step 52390, Batch metrics: Loss: 7.7403, Accuracy: 0.0847, Perplexity: 2299.1602
2025-01-01 02:07:46,693 - TrainingLogger - INFO - Step 52400, Batch metrics: Loss: 7.3939, Accuracy: 0.0579, Perplexity: 1626.0608
2025-01-01 02:07:46,693 - TrainingLogger - INFO - Step 52400, Prediction vs Actual:
2025-01-01 02:07:46,693 - TrainingLogger - INFO - Input 1: עצוב לנו מאוד, מלא רגשות מעורבים, אבל לעכשיו זה מה שאנחנו רואים לנכון עבורנו, עם כל העצב שמהול בתוך זה
2025-01-01 02:07:46,694 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:07:46,694 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁עצוב        | ✗     |
|     1 | :               | ▁לנו         | ✗     |
|     2 | ▁-              | ▁מאוד        | ✗     |
|     3 | .               | ,            | ✗     |
|     4 | <pad>           | ▁מלא         | ✗     |
|     5 | ▁זמן            | ▁רגשות       | ✗     |
|     6 | .               | ▁מעורבים     | ✗     |
|     7 | .               | ,            | ✗     |
|     8 | </s>            | ▁אבל         | ✗     |
|     9 | ▁זה             | ▁לעכשיו      | ✗     |
|    10 | ,               | ▁זה          | ✗     |
|    11 | ▁לא             | ▁מה          | ✗     |
|    12 | ▁שצריך          | ▁שאנחנו      | ✗     |
|    13 | ▁עושים          | ▁רואים       | ✗     |
|    14 | ▁כאן            | ▁לנכון       | ✗     |
|    15 | ▁לעשות          | ▁עבורנו      | ✗     |
|    16 | .               | ,            | ✗     |
|    17 | </s>            | ▁עם          | ✗     |
|    18 | ▁זאת            | ▁כל          | ✗     |
|    19 | ▁אחד            | ▁העצב        | ✗     |
|    20 | ▁הזה            | ▁שמה         | ✗     |
|    21 | ר               | ול           | ✗     |
|    22 | ת               | ▁בתוך        | ✗     |
|    23 | ▁הבית           | ▁זה          | ✗     |
|    24 | ,               | <pad>        | ✗     |
|    25 | ,               | <pad>        | ✗     |
|    26 | ,               | <pad>        | ✗     |
|    27 | ,               | <pad>        | ✗     |
|    28 | </s>            | <pad>        | ✗     |
|    29 | </s>            | <pad>        | ✗     |
|    30 | </s>            | <pad>        | ✗     |
|    31 | ,               | <pad>        | ✗     |
|    32 | </s>            | <pad>        | ✗     |
|    33 | </s>            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | </s>            | <pad>        | ✗     |
|    36 | </s>            | <pad>        | ✗     |
|    37 | </s>            | <pad>        | ✗     |
|    38 | </s>            |              | ✗     |

2025-01-01 02:07:46,694 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:07:46,699 - TrainingLogger - INFO - Gradient norm: 8.9714
2025-01-01 02:07:53,725 - TrainingLogger - INFO - Step 52410, Batch metrics: Loss: 7.2737, Accuracy: 0.0946, Perplexity: 1441.9219
2025-01-01 02:08:00,779 - TrainingLogger - INFO - Step 52420, Batch metrics: Loss: 8.0750, Accuracy: 0.0544, Perplexity: 3212.9674
2025-01-01 02:08:08,109 - TrainingLogger - INFO - Step 52430, Batch metrics: Loss: 7.4801, Accuracy: 0.0748, Perplexity: 1772.3929
2025-01-01 02:08:15,169 - TrainingLogger - INFO - Step 52440, Batch metrics: Loss: 7.1542, Accuracy: 0.1228, Perplexity: 1279.4698
2025-01-01 02:08:22,068 - TrainingLogger - INFO - Step 52450, Batch metrics: Loss: 7.3735, Accuracy: 0.0581, Perplexity: 1593.1582
2025-01-01 02:08:29,445 - TrainingLogger - INFO - Step 52460, Batch metrics: Loss: 7.1382, Accuracy: 0.0885, Perplexity: 1259.1998
2025-01-01 02:08:37,370 - TrainingLogger - INFO - Step 52470, Batch metrics: Loss: 7.3442, Accuracy: 0.0960, Perplexity: 1547.1195
2025-01-01 02:08:44,559 - TrainingLogger - INFO - Step 52480, Batch metrics: Loss: 7.5820, Accuracy: 0.1000, Perplexity: 1962.5039
2025-01-01 02:08:52,279 - TrainingLogger - INFO - Step 52490, Batch metrics: Loss: 6.8362, Accuracy: 0.0983, Perplexity: 930.9699
2025-01-01 02:08:59,051 - TrainingLogger - INFO - Step 52500, Batch metrics: Loss: 7.3950, Accuracy: 0.0787, Perplexity: 1627.8063
2025-01-01 02:08:59,051 - TrainingLogger - INFO - Step 52500, Prediction vs Actual:
2025-01-01 02:08:59,085 - TrainingLogger - INFO - Input 1: אנחנו בצומת או עסקה או הסלמה
2025-01-01 02:08:59,086 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:08:59,086 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | .               | ▁אנחנו       | ✗     |
|     1 | ▁-              | ▁בצומת       | ✗     |
|     2 | ▁ילדים          | ▁או          | ✗     |
|     3 | ▁משהו           | ▁עסקה        | ✗     |
|     4 | .               | ▁או          | ✗     |
|     5 | ▁יותר           | ▁הסל         | ✗     |
|     6 | ים              | מה           | ✗     |
|     7 | ▁את             | <pad>        | ✗     |
|     8 | ▁שלנו           | <pad>        | ✗     |
|     9 | <pad>           | <pad>        | ✓     |
|    10 | ▁שלנו           | <pad>        | ✗     |
|    11 | ▁של             | <pad>        | ✗     |
|    12 | </s>            | <pad>        | ✗     |
|    13 | <pad>           | <pad>        | ✓     |
|    14 | ▁שלנו           | <pad>        | ✗     |
|    15 | <pad>           | <pad>        | ✓     |
|    16 | <pad>           | <pad>        | ✓     |
|    17 | ▁את             | <pad>        | ✗     |
|    18 | ▁את             | <pad>        | ✗     |
|    19 | .               | <pad>        | ✗     |
|    20 | ▁שלנו           | <pad>        | ✗     |
|    21 | ▁שלנו           | <pad>        | ✗     |
|    22 | <pad>           | <pad>        | ✓     |
|    23 | ▁שלנו           | <pad>        | ✗     |
|    24 | ▁שלנו           | <pad>        | ✗     |
|    25 | <pad>           | <pad>        | ✓     |
|    26 | ▁את             | <pad>        | ✗     |
|    27 | <pad>           | <pad>        | ✓     |
|    28 | <pad>           | <pad>        | ✓     |
|    29 | ים              | <pad>        | ✗     |
|    30 | <pad>           | <pad>        | ✓     |
|    31 | <pad>           | <pad>        | ✓     |
|    32 | ▁שלנו           | <pad>        | ✗     |
|    33 | ▁את             | <pad>        | ✗     |
|    34 | .               | <pad>        | ✗     |
|    35 | <pad>           | <pad>        | ✓     |
|    36 | ▁שלנו           | <pad>        | ✗     |
|    37 | ▁שלנו           | <pad>        | ✗     |
|    38 | ▁שלנו           | <pad>        | ✗     |
|    39 | ▁שלנו           | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | ▁שלנו           | <pad>        | ✗     |
|    42 | ▁שלנו           |              | ✗     |

2025-01-01 02:08:59,086 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:08:59,091 - TrainingLogger - INFO - Gradient norm: 9.4306
2025-01-01 02:09:06,689 - TrainingLogger - INFO - Step 52510, Batch metrics: Loss: 7.9089, Accuracy: 0.0779, Perplexity: 2721.4401
2025-01-01 02:09:13,729 - TrainingLogger - INFO - Step 52520, Batch metrics: Loss: 7.5237, Accuracy: 0.0870, Perplexity: 1851.3761
2025-01-01 02:09:20,690 - TrainingLogger - INFO - Step 52530, Batch metrics: Loss: 7.0881, Accuracy: 0.0867, Perplexity: 1197.5838
2025-01-01 02:09:28,816 - TrainingLogger - INFO - Step 52540, Batch metrics: Loss: 7.9185, Accuracy: 0.0459, Perplexity: 2747.6463
2025-01-01 02:09:36,235 - TrainingLogger - INFO - Step 52550, Batch metrics: Loss: 7.4920, Accuracy: 0.0415, Perplexity: 1793.5701
2025-01-01 02:09:43,790 - TrainingLogger - INFO - Step 52560, Batch metrics: Loss: 7.0165, Accuracy: 0.0950, Perplexity: 1114.8851
2025-01-01 02:09:50,635 - TrainingLogger - INFO - Step 52570, Batch metrics: Loss: 7.1488, Accuracy: 0.0761, Perplexity: 1272.5851
2025-01-01 02:09:57,510 - TrainingLogger - INFO - Step 52580, Batch metrics: Loss: 7.5715, Accuracy: 0.0933, Perplexity: 1942.1425
2025-01-01 02:10:04,876 - TrainingLogger - INFO - Step 52590, Batch metrics: Loss: 7.4506, Accuracy: 0.0675, Perplexity: 1720.9375
2025-01-01 02:10:12,104 - TrainingLogger - INFO - Step 52600, Batch metrics: Loss: 7.1485, Accuracy: 0.1005, Perplexity: 1272.2186
2025-01-01 02:10:12,105 - TrainingLogger - INFO - Step 52600, Prediction vs Actual:
2025-01-01 02:10:12,105 - TrainingLogger - INFO - Input 1: פה יש מקום להעביר מסר שאנחנו שותפים, ובשותפות אתה מקבל את החלק היחסי שמגיע לך כי אתה מסתכל על הטווח הארוך, על העבודה המשותפת ביחד
2025-01-01 02:10:12,105 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:10:12,105 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | ה               | ▁פה          | ✗     |
|     1 | ,               | ▁יש          | ✗     |
|     2 | ▁לא             | ▁מקום        | ✗     |
|     3 | ▁ראשון          | ▁להעביר      | ✗     |
|     4 | ▁הוא            | ▁מסר         | ✗     |
|     5 | ות              | ▁שאנחנו      | ✗     |
|     6 | ▁צריכים         | ▁שותפים      | ✗     |
|     7 | ▁בו             | ,            | ✗     |
|     8 | <pad>           | ▁וב          | ✗     |
|     9 | ד               | שותפות       | ✗     |
|    10 | ▁עם             | ▁אתה         | ✗     |
|    11 | ▁יודע           | ▁מקבל        | ✗     |
|    12 | ▁את             | ▁את          | ✓     |
|    13 | ▁זה             | ▁החלק        | ✗     |
|    14 | ▁שלך            | ▁היחס        | ✗     |
|    15 | י               | י            | ✓     |
|    16 | ▁שלך            | ▁שמגיע       | ✗     |
|    17 | ▁לך             | ▁לך          | ✓     |
|    18 | .               | ▁כי          | ✗     |
|    19 | ת               | ▁אתה         | ✗     |
|    20 | ▁יכול           | ▁מסתכל       | ✗     |
|    21 | ▁על             | ▁על          | ✓     |
|    22 | ▁עצמך           | ▁הטווח       | ✗     |
|    23 | ▁שלך            | ▁הארוך       | ✗     |
|    24 | ▁ביותר          | ,            | ✗     |
|    25 | </s>            | ▁על          | ✗     |
|    26 | ▁עצמך           | ▁העבודה      | ✗     |
|    27 | ▁שלך            | ▁המשותפת     | ✗     |
|    28 | ▁שלך            | ▁ביחד        | ✗     |
|    29 | ▁עם             | <pad>        | ✗     |
|    30 | ▁עם             | <pad>        | ✗     |
|    31 | .               | <pad>        | ✗     |
|    32 | ▁שלך            | <pad>        | ✗     |
|    33 | ▁שלך            | <pad>        | ✗     |
|    34 | </s>            | <pad>        | ✗     |
|    35 | .               | <pad>        | ✗     |
|    36 | <pad>           | <pad>        | ✓     |
|    37 | ▁שלך            | <pad>        | ✗     |
|    38 | <pad>           | <pad>        | ✓     |
|    39 | ▁שלך            | <pad>        | ✗     |
|    40 | <pad>           | <pad>        | ✓     |
|    41 | ▁שלך            | <pad>        | ✗     |
|    42 | ▁שלך            | <pad>        | ✗     |
|    43 | ▁שלך            | <pad>        | ✗     |
|    44 | </s>            |              | ✗     |

2025-01-01 02:10:12,105 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:10:12,110 - TrainingLogger - INFO - Gradient norm: 8.2177
2025-01-01 02:10:19,315 - TrainingLogger - INFO - Step 52610, Batch metrics: Loss: 7.5421, Accuracy: 0.0936, Perplexity: 1885.7311
2025-01-01 02:10:26,166 - TrainingLogger - INFO - Step 52620, Batch metrics: Loss: 7.1643, Accuracy: 0.0710, Perplexity: 1292.3992
2025-01-01 02:10:33,959 - TrainingLogger - INFO - Step 52630, Batch metrics: Loss: 7.5257, Accuracy: 0.0613, Perplexity: 1855.1204
2025-01-01 02:10:40,712 - TrainingLogger - INFO - Step 52640, Batch metrics: Loss: 7.2088, Accuracy: 0.1026, Perplexity: 1351.2522
2025-01-01 02:10:47,905 - TrainingLogger - INFO - Step 52650, Batch metrics: Loss: 7.4772, Accuracy: 0.0564, Perplexity: 1767.2686
2025-01-01 02:10:55,117 - TrainingLogger - INFO - Step 52660, Batch metrics: Loss: 7.5598, Accuracy: 0.0579, Perplexity: 1919.4582
2025-01-01 02:11:02,035 - TrainingLogger - INFO - Step 52670, Batch metrics: Loss: 7.4795, Accuracy: 0.0946, Perplexity: 1771.3613
2025-01-01 02:11:09,054 - TrainingLogger - INFO - Step 52680, Batch metrics: Loss: 7.7276, Accuracy: 0.0844, Perplexity: 2270.2341
2025-01-01 02:11:16,344 - TrainingLogger - INFO - Step 52690, Batch metrics: Loss: 7.7790, Accuracy: 0.0432, Perplexity: 2389.9437
2025-01-01 02:11:22,929 - TrainingLogger - INFO - Step 52700, Batch metrics: Loss: 7.6665, Accuracy: 0.0309, Perplexity: 2135.4982
2025-01-01 02:11:22,930 - TrainingLogger - INFO - Step 52700, Prediction vs Actual:
2025-01-01 02:11:22,930 - TrainingLogger - INFO - Input 1: הוא השאיר מורשת שחייבים לקדש ולממש
2025-01-01 02:11:22,930 - TrainingLogger - INFO - Token-wise comparison:
2025-01-01 02:11:22,930 - TrainingLogger - INFO - 
| Index | Predicted Token | Actual Token | Match |
|-------|-----------------|--------------|-------|
|     0 | </s>            | ▁הוא         | ✗     |
|     1 | ▁-              | ▁השאיר       | ✗     |
|     2 | יות             | ▁מורשת       | ✗     |
|     3 | ▁ראשונה         | ▁שחייב       | ✗     |
|     4 | ת               | ים           | ✗     |
|     5 | ▁לנו            | ▁ל           | ✗     |
|     6 | בלום            | קדש          | ✗     |
|     7 | ▁את             | ▁ול          | ✗     |
|     8 | ירות            | ממש          | ✗     |
|     9 | ▁את             | <pad>        | ✗     |
|    10 | ▁את             | <pad>        | ✗     |
|    11 | </s>            | <pad>        | ✗     |
|    12 | ים              | <pad>        | ✗     |
|    13 | ▁את             | <pad>        | ✗     |
|    14 | ים              | <pad>        | ✗     |
|    15 | ▁את             | <pad>        | ✗     |
|    16 | ▁את             | <pad>        | ✗     |
|    17 | ים              | <pad>        | ✗     |
|    18 | ▁את             | <pad>        | ✗     |
|    19 | ▁את             | <pad>        | ✗     |
|    20 | </s>            | <pad>        | ✗     |
|    21 | </s>            | <pad>        | ✗     |
|    22 | </s>            | <pad>        | ✗     |
|    23 | </s>            |              | ✗     |

2025-01-01 02:11:22,930 - TrainingLogger - INFO - Learning rate (group 0): 0.000045
2025-01-01 02:11:22,935 - TrainingLogger - INFO - Gradient norm: 7.8416
2025-01-01 02:11:29,914 - TrainingLogger - INFO - Step 52710, Batch metrics: Loss: 7.2764, Accuracy: 0.0896, Perplexity: 1445.7064
2025-01-01 02:11:37,281 - TrainingLogger - INFO - Step 52720, Batch metrics: Loss: 7.8205, Accuracy: 0.0798, Perplexity: 2491.1160
2025-01-01 02:11:44,384 - TrainingLogger - INFO - Step 52730, Batch metrics: Loss: 7.6817, Accuracy: 0.0843, Perplexity: 2168.2681
2025-01-01 02:11:52,040 - TrainingLogger - INFO - Step 52740, Batch metrics: Loss: 6.9998, Accuracy: 0.1295, Perplexity: 1096.3592
2025-01-01 02:11:59,711 - TrainingLogger - INFO - Step 52750, Batch metrics: Loss: 7.7484, Accuracy: 0.0533, Perplexity: 2317.8083
2025-01-01 02:12:06,530 - TrainingLogger - INFO - Step 52760, Batch metrics: Loss: 8.1032, Accuracy: 0.0739, Perplexity: 3305.0334
2025-01-01 02:12:09,553 - TrainingLogger - ERROR - Error during forward pass: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 17.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.75 GiB is allocated by PyTorch, and 688.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-01-01 02:12:09,554 - TrainingLogger - ERROR - Traceback: Traceback (most recent call last):
  File "/home/moshe/Documents/GitHub/TALL/src/train_model.py", line 176, in train
    logits = self.model(input_ids_1,
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/src/model.py", line 175, in forward
    x = self.custom_encoder2(
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/models/marian/modeling_marian.py", line 737, in forward
    attention_mask = _prepare_4d_attention_mask(attention_mask, inputs_embeds.dtype)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/modeling_attn_mask_utils.py", line 422, in _prepare_4d_attention_mask
    return AttentionMaskConverter._expand_mask(mask=mask, dtype=dtype, tgt_len=tgt_len)
  File "/home/moshe/Documents/GitHub/TALL/.venv/lib/python3.10/site-packages/transformers/modeling_attn_mask_utils.py", line 188, in _expand_mask
    return inverted_mask.masked_fill(inverted_mask.to(torch.bool), torch.finfo(dtype).min)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 20.00 MiB. GPU 0 has a total capacity of 15.70 GiB of which 17.00 MiB is free. Including non-PyTorch memory, this process has 15.67 GiB memory in use. Of the allocated memory 14.75 GiB is allocated by PyTorch, and 688.87 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

2025-01-01 02:12:09,554 - TrainingLogger - ERROR - input_ids_1 shape: torch.Size([8, 39]), device: cuda:0
